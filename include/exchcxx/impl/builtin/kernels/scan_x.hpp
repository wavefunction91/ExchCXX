#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinSCAN_X > :
  public mgga_screening_interface< BuiltinSCAN_X > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;

  static constexpr double dens_tol  = 1e-15;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000027e-20;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = false;
  static constexpr double exx_coeff = 0.0;

  static constexpr double c1 = 0.667;
  static constexpr double c2 = 0.8;
  static constexpr double d = 1.24;
  static constexpr double k1 = 0.065;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t21 = constants::m_cbrt_6;
    constexpr double t22 = constants::m_pi_sq;
    constexpr double t23 = constants::m_cbrt_pi_sq;
    constexpr double t27 = constants::m_cbrt_2;
    constexpr double t24 = t23 * t23;
    constexpr double t25 = 0.1e1 / t24;
    constexpr double t26 = t21 * t25;
    constexpr double t28 = t27 * t27;
    constexpr double t39 = 0.1e3 / 0.6561e4 / k1 - 0.73e2 / 0.648e3;
    constexpr double t40 = t21 * t21;
    constexpr double t42 = t23 * t22;
    constexpr double t43 = 0.1e1 / t42;
    constexpr double t44 = t39 * t40 * t43;
    constexpr double t125 = 0.1e1 / t23;
    constexpr double t126 = t40 * t125;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = t4 / t5 * t18;
    const double t20 = safe_math::cbrt( rho );
    const double t29 = sigma * t28;
    const double t30 = rho * rho;
    const double t31 = t20 * t20;
    const double t33 = 0.1e1 / t31 / t30;
    const double t34 = t29 * t33;
    const double t35 = t26 * t34;
    const double t45 = sigma * sigma;
    const double t46 = t45 * t27;
    const double t47 = t30 * t30;
    const double t48 = t47 * rho;
    const double t50 = 0.1e1 / t20 / t48;
    const double t55 = safe_math::exp( -0.27e2 / 0.8e2 * t39 * t21 * t25 * t34 );
    const double t56 = t50 * t55;
    const double t60 = safe_math::sqrt( 0.146e3 );
    const double t61 = t60 * t21;
    const double t62 = t61 * t25;
    const double t65 = tau * t28;
    const double t66 = t31 * rho;
    const double t67 = 0.1e1 / t66;
    const double t73 = 0.5e1 / 0.9e1 * ( t65 * t67 - t34 / 0.8e1 ) * t21 * t25;
    const double t74 = 0.1e1 - t73;
    const double t76 = t74 * t74;
    const double t78 = safe_math::exp( -t76 / 0.2e1 );
    const double t81 = 0.7e1 / 0.1296e5 * t62 * t34 + t60 * t74 * t78 / 0.1e3;
    const double t82 = t81 * t81;
    const double t83 = k1 + 0.5e1 / 0.972e3 * t35 + t44 * t46 * t56 / 0.288e3 + t82;
    const double t88 = 0.1e1 + k1 * ( 0.1e1 - k1 / t83 );
    const double t89 = t73 <= 0.1e1;
    const double t90 = safe_math::log( DBL_EPSILON );
    const double t93 = t90 / ( -t90 + c1 );
    const double t94 = -t93 < t73;
    const double t95 = t73 < -t93;
    const double t96 = piecewise_functor_3( t95, t73, -t93 );
    const double t97 = c1 * t96;
    const double t98 = 0.1e1 - t96;
    const double t99 = 0.1e1 / t98;
    const double t101 = safe_math::exp( -t97 * t99 );
    const double t102 = piecewise_functor_3( t94, 0.0, t101 );
    const double t103 = fabs( d );
    const double t106 = safe_math::log( DBL_EPSILON / t103 );
    const double t109 = ( -t106 + c2 ) / t106;
    const double t110 = t73 < -t109;
    const double t111 = piecewise_functor_3( t110, -t109, t73 );
    const double t112 = 0.1e1 - t111;
    const double t115 = safe_math::exp( c2 / t112 );
    const double t117 = piecewise_functor_3( t110, 0.0, -d * t115 );
    const double t118 = piecewise_functor_3( t89, t102, t117 );
    const double t119 = 0.1e1 - t118;
    const double t122 = t88 * t119 + 0.1174e1 * t118;
    const double t124 = safe_math::sqrt( 0.3e1 );
    const double t127 = safe_math::sqrt( sigma );
    const double t128 = t127 * t27;
    const double t130 = 0.1e1 / t20 / rho;
    const double t132 = t126 * t128 * t130;
    const double t133 = safe_math::sqrt( t132 );
    const double t137 = safe_math::exp( -0.98958e1 * t124 / t133 );
    const double t138 = 0.1e1 - t137;
    const double t142 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t20 * t122 * t138 );


    eps = 0.2e1 * t142;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t21 = constants::m_cbrt_6;
    constexpr double t22 = constants::m_pi_sq;
    constexpr double t23 = constants::m_cbrt_pi_sq;
    constexpr double t27 = constants::m_cbrt_2;
    constexpr double t24 = t23 * t23;
    constexpr double t25 = 0.1e1 / t24;
    constexpr double t26 = t21 * t25;
    constexpr double t28 = t27 * t27;
    constexpr double t39 = 0.1e3 / 0.6561e4 / k1 - 0.73e2 / 0.648e3;
    constexpr double t40 = t21 * t21;
    constexpr double t42 = t23 * t22;
    constexpr double t43 = 0.1e1 / t42;
    constexpr double t44 = t39 * t40 * t43;
    constexpr double t125 = 0.1e1 / t23;
    constexpr double t126 = t40 * t125;
    constexpr double t148 = k1 * k1;
    constexpr double t165 = t39 * t39;
    constexpr double t166 = t22 * t22;
    constexpr double t167 = 0.1e1 / t166;
    constexpr double t168 = t165 * t167;
    constexpr double t210 = d * c2;
    constexpr double t257 = t25 * t28;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = t4 / t5 * t18;
    const double t20 = safe_math::cbrt( rho );
    const double t29 = sigma * t28;
    const double t30 = rho * rho;
    const double t31 = t20 * t20;
    const double t33 = 0.1e1 / t31 / t30;
    const double t34 = t29 * t33;
    const double t35 = t26 * t34;
    const double t45 = sigma * sigma;
    const double t46 = t45 * t27;
    const double t47 = t30 * t30;
    const double t48 = t47 * rho;
    const double t50 = 0.1e1 / t20 / t48;
    const double t55 = safe_math::exp( -0.27e2 / 0.8e2 * t39 * t21 * t25 * t34 );
    const double t56 = t50 * t55;
    const double t60 = safe_math::sqrt( 0.146e3 );
    const double t61 = t60 * t21;
    const double t62 = t61 * t25;
    const double t65 = tau * t28;
    const double t66 = t31 * rho;
    const double t67 = 0.1e1 / t66;
    const double t73 = 0.5e1 / 0.9e1 * ( t65 * t67 - t34 / 0.8e1 ) * t21 * t25;
    const double t74 = 0.1e1 - t73;
    const double t76 = t74 * t74;
    const double t78 = safe_math::exp( -t76 / 0.2e1 );
    const double t81 = 0.7e1 / 0.1296e5 * t62 * t34 + t60 * t74 * t78 / 0.1e3;
    const double t82 = t81 * t81;
    const double t83 = k1 + 0.5e1 / 0.972e3 * t35 + t44 * t46 * t56 / 0.288e3 + t82;
    const double t88 = 0.1e1 + k1 * ( 0.1e1 - k1 / t83 );
    const double t89 = t73 <= 0.1e1;
    const double t90 = safe_math::log( DBL_EPSILON );
    const double t93 = t90 / ( -t90 + c1 );
    const double t94 = -t93 < t73;
    const double t95 = t73 < -t93;
    const double t96 = piecewise_functor_3( t95, t73, -t93 );
    const double t97 = c1 * t96;
    const double t98 = 0.1e1 - t96;
    const double t99 = 0.1e1 / t98;
    const double t101 = safe_math::exp( -t97 * t99 );
    const double t102 = piecewise_functor_3( t94, 0.0, t101 );
    const double t103 = fabs( d );
    const double t106 = safe_math::log( DBL_EPSILON / t103 );
    const double t109 = ( -t106 + c2 ) / t106;
    const double t110 = t73 < -t109;
    const double t111 = piecewise_functor_3( t110, -t109, t73 );
    const double t112 = 0.1e1 - t111;
    const double t115 = safe_math::exp( c2 / t112 );
    const double t117 = piecewise_functor_3( t110, 0.0, -d * t115 );
    const double t118 = piecewise_functor_3( t89, t102, t117 );
    const double t119 = 0.1e1 - t118;
    const double t122 = t88 * t119 + 0.1174e1 * t118;
    const double t124 = safe_math::sqrt( 0.3e1 );
    const double t127 = safe_math::sqrt( sigma );
    const double t128 = t127 * t27;
    const double t130 = 0.1e1 / t20 / rho;
    const double t132 = t126 * t128 * t130;
    const double t133 = safe_math::sqrt( t132 );
    const double t137 = safe_math::exp( -0.98958e1 * t124 / t133 );
    const double t138 = 0.1e1 - t137;
    const double t142 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t20 * t122 * t138 );
    const double t143 = 0.1e1 / t31;
    const double t149 = t83 * t83;
    const double t151 = t148 / t149;
    const double t152 = t30 * rho;
    const double t154 = 0.1e1 / t31 / t152;
    const double t155 = t29 * t154;
    const double t158 = t47 * t30;
    const double t160 = 0.1e1 / t20 / t158;
    const double t161 = t160 * t55;
    const double t169 = t45 * sigma;
    const double t170 = t47 * t47;
    const double t171 = t170 * rho;
    const double t172 = 0.1e1 / t171;
    const double t182 = -0.5e1 / 0.3e1 * t65 * t33 + t155 / 0.3e1;
    const double t184 = t26 * t78;
    const double t187 = t60 * t76;
    const double t191 = -0.7e1 / 0.486e4 * t62 * t155 - t60 * t182 * t184 / 0.18e3 + t187 * t182 * t184 / 0.18e3;
    const double t194 = -0.1e2 / 0.729e3 * t26 * t155 - t44 * t46 * t161 / 0.54e2 + 0.3e1 / 0.8e2 * t168 * t169 * t172 * t55 + 0.2e1 * t81 * t191;
    const double t195 = t194 * t119;
    const double t197 = t182 * t21;
    const double t199 = 0.5e1 / 0.9e1 * t197 * t25;
    const double t200 = piecewise_functor_3( t95, t199, 0.0 );
    const double t203 = t98 * t98;
    const double t204 = 0.1e1 / t203;
    const double t205 = t204 * t200;
    const double t207 = -c1 * t200 * t99 - t97 * t205;
    const double t208 = t207 * t101;
    const double t209 = piecewise_functor_3( t94, 0.0, t208 );
    const double t211 = t112 * t112;
    const double t212 = 0.1e1 / t211;
    const double t213 = piecewise_functor_3( t110, 0.0, t199 );
    const double t217 = piecewise_functor_3( t110, 0.0, -t210 * t212 * t213 * t115 );
    const double t218 = piecewise_functor_3( t89, t209, t217 );
    const double t221 = t151 * t195 - t88 * t218 + 0.1174e1 * t218;
    const double t226 = safe_math::pow( 0.3e1, 0.1e1 / 0.6e1 );
    const double t227 = t226 * t226;
    const double t228 = t227 * t227;
    const double t230 = t228 * t226 * t18;
    const double t231 = 0.1e1 / t30;
    const double t232 = t231 * t122;
    const double t234 = 0.1e1 / t133 / t132;
    const double t236 = t230 * t232 * t234;
    const double t238 = t126 * t128 * t137;
    const double t242 = piecewise_functor_3( t3, 0.0, -t19 * t143 * t122 * t138 / 0.8e1 - 0.3e1 / 0.8e1 * t19 * t20 * t221 * t138 - 0.16891736332904387511e1 * t236 * t238 );
    const double t245 = t28 * t33;
    const double t246 = t245 * t26;
    const double t248 = sigma * t27;
    const double t252 = 0.1e1 / t170;
    const double t261 = t60 * t28;
    const double t262 = t261 * t33;
    const double t263 = t262 * t184;
    const double t265 = t187 * t28;
    const double t267 = t25 * t78;
    const double t269 = t265 * t33 * t21 * t267;
    const double t271 = 0.7e1 / 0.1296e5 * t61 * t257 * t33 + t263 / 0.144e4 - t269 / 0.144e4;
    const double t274 = 0.5e1 / 0.972e3 * t246 + t44 * t248 * t56 / 0.144e3 - 0.9e1 / 0.64e3 * t168 * t45 * t252 * t55 + 0.2e1 * t81 * t271;
    const double t275 = t274 * t119;
    const double t277 = 0.5e1 / 0.72e2 * t246;
    const double t278 = piecewise_functor_3( t95, -t277, 0.0 );
    const double t279 = c1 * t278;
    const double t281 = t204 * t278;
    const double t283 = -t279 * t99 - t97 * t281;
    const double t284 = t283 * t101;
    const double t285 = piecewise_functor_3( t94, 0.0, t284 );
    const double t286 = piecewise_functor_3( t110, 0.0, -t277 );
    const double t290 = piecewise_functor_3( t110, 0.0, -t210 * t212 * t286 * t115 );
    const double t291 = piecewise_functor_3( t89, t285, t290 );
    const double t294 = t151 * t275 - t88 * t291 + 0.1174e1 * t291;
    const double t299 = 0.1e1 / rho;
    const double t300 = t299 * t122;
    const double t302 = t230 * t300 * t234;
    const double t303 = 0.1e1 / t127;
    const double t306 = t126 * t303 * t27 * t137;
    const double t310 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t20 * t294 * t138 + 0.63344011248391453166e0 * t302 * t306 );
    const double t312 = t261 * t67;
    const double t318 = t265 * t67 * t21 * t267 / 0.18e3 - t312 * t184 / 0.18e3;
    const double t319 = t81 * t318;
    const double t323 = t28 * t67;
    const double t325 = 0.5e1 / 0.9e1 * t323 * t26;
    const double t326 = piecewise_functor_3( t95, t325, 0.0 );
    const double t327 = c1 * t326;
    const double t331 = -t97 * t204 * t326 - t327 * t99;
    const double t332 = t331 * t101;
    const double t333 = piecewise_functor_3( t94, 0.0, t332 );
    const double t334 = piecewise_functor_3( t110, 0.0, t325 );
    const double t338 = piecewise_functor_3( t110, 0.0, -t210 * t212 * t334 * t115 );
    const double t339 = piecewise_functor_3( t89, t333, t338 );
    const double t342 = 0.2e1 * t151 * t319 * t119 - t88 * t339 + 0.1174e1 * t339;
    const double t347 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t20 * t342 * t138 );


    eps = 0.2e1 * t142;
    vrho = 0.2e1 * rho * t242 + 0.2e1 * t142;
    vsigma = 0.2e1 * rho * t310;
    vlapl = 0.e0;
    vtau = 0.2e1 * rho * t347;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t29 = constants::m_cbrt_6;
    constexpr double t30 = constants::m_pi_sq;
    constexpr double t31 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t32 = t31 * t31;
    constexpr double t33 = 0.1e1 / t32;
    constexpr double t34 = t29 * t33;
    constexpr double t45 = 0.1e3 / 0.6561e4 / k1 - 0.73e2 / 0.648e3;
    constexpr double t46 = t29 * t29;
    constexpr double t47 = t45 * t46;
    constexpr double t48 = t31 * t30;
    constexpr double t49 = 0.1e1 / t48;
    constexpr double t50 = t47 * t49;
    constexpr double t57 = t45 * t29;
    constexpr double t129 = 0.1e1 / t31;
    constexpr double t130 = t46 * t129;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = t6 * t26;
    const double t28 = safe_math::cbrt( t7 );
    const double t35 = rho_a * rho_a;
    const double t36 = safe_math::cbrt( rho_a );
    const double t37 = t36 * t36;
    const double t38 = t37 * t35;
    const double t39 = 0.1e1 / t38;
    const double t40 = sigma_aa * t39;
    const double t41 = t34 * t40;
    const double t51 = sigma_aa * sigma_aa;
    const double t52 = t35 * t35;
    const double t53 = t52 * rho_a;
    const double t55 = 0.1e1 / t36 / t53;
    const double t56 = t51 * t55;
    const double t58 = t33 * sigma_aa;
    const double t59 = t58 * t39;
    const double t62 = safe_math::exp( -0.27e2 / 0.8e2 * t57 * t59 );
    const double t66 = safe_math::sqrt( 0.146e3 );
    const double t67 = t66 * t29;
    const double t70 = t37 * rho_a;
    const double t71 = 0.1e1 / t70;
    const double t77 = 0.5e1 / 0.9e1 * ( tau_a * t71 - t40 / 0.8e1 ) * t29 * t33;
    const double t78 = 0.1e1 - t77;
    const double t80 = t78 * t78;
    const double t82 = safe_math::exp( -t80 / 0.2e1 );
    const double t85 = 0.7e1 / 0.1296e5 * t67 * t59 + t66 * t78 * t82 / 0.1e3;
    const double t86 = t85 * t85;
    const double t87 = k1 + 0.5e1 / 0.972e3 * t41 + t50 * t56 * t62 / 0.576e3 + t86;
    const double t92 = 0.1e1 + k1 * ( 0.1e1 - k1 / t87 );
    const double t93 = t77 <= 0.1e1;
    const double t94 = safe_math::log( DBL_EPSILON );
    const double t97 = t94 / ( -t94 + c1 );
    const double t98 = -t97 < t77;
    const double t99 = t77 < -t97;
    const double t100 = piecewise_functor_3( t99, t77, -t97 );
    const double t101 = c1 * t100;
    const double t102 = 0.1e1 - t100;
    const double t103 = 0.1e1 / t102;
    const double t105 = safe_math::exp( -t101 * t103 );
    const double t106 = piecewise_functor_3( t98, 0.0, t105 );
    const double t107 = fabs( d );
    const double t110 = safe_math::log( DBL_EPSILON / t107 );
    const double t113 = ( -t110 + c2 ) / t110;
    const double t114 = t77 < -t113;
    const double t115 = piecewise_functor_3( t114, -t113, t77 );
    const double t116 = 0.1e1 - t115;
    const double t119 = safe_math::exp( c2 / t116 );
    const double t121 = piecewise_functor_3( t114, 0.0, -d * t119 );
    const double t122 = piecewise_functor_3( t93, t106, t121 );
    const double t123 = 0.1e1 - t122;
    const double t126 = t92 * t123 + 0.1174e1 * t122;
    const double t127 = t28 * t126;
    const double t128 = safe_math::sqrt( 0.3e1 );
    const double t131 = safe_math::sqrt( sigma_aa );
    const double t132 = t36 * rho_a;
    const double t133 = 0.1e1 / t132;
    const double t135 = t130 * t131 * t133;
    const double t136 = safe_math::sqrt( t135 );
    const double t140 = safe_math::exp( -0.98958e1 * t128 / t136 );
    const double t141 = 0.1e1 - t140;
    const double t142 = t127 * t141;
    const double t145 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t142 );
    const double t146 = rho_b <= dens_tol;
    const double t147 = -t17;
    const double t149 = piecewise_functor_5( t15, t12, t11, t16, t147 * t8 );
    const double t150 = 0.1e1 + t149;
    const double t151 = t150 <= zeta_tol;
    const double t152 = safe_math::cbrt( t150 );
    const double t154 = piecewise_functor_3( t151, t23, t152 * t150 );
    const double t155 = t6 * t154;
    const double t156 = rho_b * rho_b;
    const double t157 = safe_math::cbrt( rho_b );
    const double t158 = t157 * t157;
    const double t159 = t158 * t156;
    const double t160 = 0.1e1 / t159;
    const double t161 = sigma_bb * t160;
    const double t162 = t34 * t161;
    const double t164 = sigma_bb * sigma_bb;
    const double t165 = t156 * t156;
    const double t166 = t165 * rho_b;
    const double t168 = 0.1e1 / t157 / t166;
    const double t169 = t164 * t168;
    const double t170 = t33 * sigma_bb;
    const double t171 = t170 * t160;
    const double t174 = safe_math::exp( -0.27e2 / 0.8e2 * t57 * t171 );
    const double t180 = t158 * rho_b;
    const double t181 = 0.1e1 / t180;
    const double t187 = 0.5e1 / 0.9e1 * ( tau_b * t181 - t161 / 0.8e1 ) * t29 * t33;
    const double t188 = 0.1e1 - t187;
    const double t190 = t188 * t188;
    const double t192 = safe_math::exp( -t190 / 0.2e1 );
    const double t195 = 0.7e1 / 0.1296e5 * t67 * t171 + t66 * t188 * t192 / 0.1e3;
    const double t196 = t195 * t195;
    const double t197 = k1 + 0.5e1 / 0.972e3 * t162 + t50 * t169 * t174 / 0.576e3 + t196;
    const double t202 = 0.1e1 + k1 * ( 0.1e1 - k1 / t197 );
    const double t203 = t187 <= 0.1e1;
    const double t204 = -t97 < t187;
    const double t205 = t187 < -t97;
    const double t206 = piecewise_functor_3( t205, t187, -t97 );
    const double t207 = c1 * t206;
    const double t208 = 0.1e1 - t206;
    const double t209 = 0.1e1 / t208;
    const double t211 = safe_math::exp( -t207 * t209 );
    const double t212 = piecewise_functor_3( t204, 0.0, t211 );
    const double t213 = t187 < -t113;
    const double t214 = piecewise_functor_3( t213, -t113, t187 );
    const double t215 = 0.1e1 - t214;
    const double t218 = safe_math::exp( c2 / t215 );
    const double t220 = piecewise_functor_3( t213, 0.0, -d * t218 );
    const double t221 = piecewise_functor_3( t203, t212, t220 );
    const double t222 = 0.1e1 - t221;
    const double t225 = t202 * t222 + 0.1174e1 * t221;
    const double t226 = t28 * t225;
    const double t227 = safe_math::sqrt( sigma_bb );
    const double t228 = t157 * rho_b;
    const double t229 = 0.1e1 / t228;
    const double t231 = t130 * t227 * t229;
    const double t232 = safe_math::sqrt( t231 );
    const double t236 = safe_math::exp( -0.98958e1 * t128 / t232 );
    const double t237 = 0.1e1 - t236;
    const double t238 = t226 * t237;
    const double t241 = piecewise_functor_3( t146, 0.0, -0.3e1 / 0.8e1 * t155 * t238 );


    eps = t145 + t241;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t29 = constants::m_cbrt_6;
    constexpr double t30 = constants::m_pi_sq;
    constexpr double t31 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t32 = t31 * t31;
    constexpr double t33 = 0.1e1 / t32;
    constexpr double t34 = t29 * t33;
    constexpr double t45 = 0.1e3 / 0.6561e4 / k1 - 0.73e2 / 0.648e3;
    constexpr double t46 = t29 * t29;
    constexpr double t47 = t45 * t46;
    constexpr double t48 = t31 * t30;
    constexpr double t49 = 0.1e1 / t48;
    constexpr double t50 = t47 * t49;
    constexpr double t57 = t45 * t29;
    constexpr double t129 = 0.1e1 / t31;
    constexpr double t130 = t46 * t129;
    constexpr double t259 = k1 * k1;
    constexpr double t276 = t45 * t45;
    constexpr double t277 = t30 * t30;
    constexpr double t278 = 0.1e1 / t277;
    constexpr double t279 = t276 * t278;
    constexpr double t322 = d * c2;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = t6 * t26;
    const double t28 = safe_math::cbrt( t7 );
    const double t35 = rho_a * rho_a;
    const double t36 = safe_math::cbrt( rho_a );
    const double t37 = t36 * t36;
    const double t38 = t37 * t35;
    const double t39 = 0.1e1 / t38;
    const double t40 = sigma_aa * t39;
    const double t41 = t34 * t40;
    const double t51 = sigma_aa * sigma_aa;
    const double t52 = t35 * t35;
    const double t53 = t52 * rho_a;
    const double t55 = 0.1e1 / t36 / t53;
    const double t56 = t51 * t55;
    const double t58 = t33 * sigma_aa;
    const double t59 = t58 * t39;
    const double t62 = safe_math::exp( -0.27e2 / 0.8e2 * t57 * t59 );
    const double t66 = safe_math::sqrt( 0.146e3 );
    const double t67 = t66 * t29;
    const double t70 = t37 * rho_a;
    const double t71 = 0.1e1 / t70;
    const double t77 = 0.5e1 / 0.9e1 * ( tau_a * t71 - t40 / 0.8e1 ) * t29 * t33;
    const double t78 = 0.1e1 - t77;
    const double t80 = t78 * t78;
    const double t82 = safe_math::exp( -t80 / 0.2e1 );
    const double t85 = 0.7e1 / 0.1296e5 * t67 * t59 + t66 * t78 * t82 / 0.1e3;
    const double t86 = t85 * t85;
    const double t87 = k1 + 0.5e1 / 0.972e3 * t41 + t50 * t56 * t62 / 0.576e3 + t86;
    const double t92 = 0.1e1 + k1 * ( 0.1e1 - k1 / t87 );
    const double t93 = t77 <= 0.1e1;
    const double t94 = safe_math::log( DBL_EPSILON );
    const double t97 = t94 / ( -t94 + c1 );
    const double t98 = -t97 < t77;
    const double t99 = t77 < -t97;
    const double t100 = piecewise_functor_3( t99, t77, -t97 );
    const double t101 = c1 * t100;
    const double t102 = 0.1e1 - t100;
    const double t103 = 0.1e1 / t102;
    const double t105 = safe_math::exp( -t101 * t103 );
    const double t106 = piecewise_functor_3( t98, 0.0, t105 );
    const double t107 = fabs( d );
    const double t110 = safe_math::log( DBL_EPSILON / t107 );
    const double t113 = ( -t110 + c2 ) / t110;
    const double t114 = t77 < -t113;
    const double t115 = piecewise_functor_3( t114, -t113, t77 );
    const double t116 = 0.1e1 - t115;
    const double t119 = safe_math::exp( c2 / t116 );
    const double t121 = piecewise_functor_3( t114, 0.0, -d * t119 );
    const double t122 = piecewise_functor_3( t93, t106, t121 );
    const double t123 = 0.1e1 - t122;
    const double t126 = t92 * t123 + 0.1174e1 * t122;
    const double t127 = t28 * t126;
    const double t128 = safe_math::sqrt( 0.3e1 );
    const double t131 = safe_math::sqrt( sigma_aa );
    const double t132 = t36 * rho_a;
    const double t133 = 0.1e1 / t132;
    const double t135 = t130 * t131 * t133;
    const double t136 = safe_math::sqrt( t135 );
    const double t140 = safe_math::exp( -0.98958e1 * t128 / t136 );
    const double t141 = 0.1e1 - t140;
    const double t142 = t127 * t141;
    const double t145 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t142 );
    const double t146 = rho_b <= dens_tol;
    const double t147 = -t17;
    const double t149 = piecewise_functor_5( t15, t12, t11, t16, t147 * t8 );
    const double t150 = 0.1e1 + t149;
    const double t151 = t150 <= zeta_tol;
    const double t152 = safe_math::cbrt( t150 );
    const double t154 = piecewise_functor_3( t151, t23, t152 * t150 );
    const double t155 = t6 * t154;
    const double t156 = rho_b * rho_b;
    const double t157 = safe_math::cbrt( rho_b );
    const double t158 = t157 * t157;
    const double t159 = t158 * t156;
    const double t160 = 0.1e1 / t159;
    const double t161 = sigma_bb * t160;
    const double t162 = t34 * t161;
    const double t164 = sigma_bb * sigma_bb;
    const double t165 = t156 * t156;
    const double t166 = t165 * rho_b;
    const double t168 = 0.1e1 / t157 / t166;
    const double t169 = t164 * t168;
    const double t170 = t33 * sigma_bb;
    const double t171 = t170 * t160;
    const double t174 = safe_math::exp( -0.27e2 / 0.8e2 * t57 * t171 );
    const double t180 = t158 * rho_b;
    const double t181 = 0.1e1 / t180;
    const double t187 = 0.5e1 / 0.9e1 * ( tau_b * t181 - t161 / 0.8e1 ) * t29 * t33;
    const double t188 = 0.1e1 - t187;
    const double t190 = t188 * t188;
    const double t192 = safe_math::exp( -t190 / 0.2e1 );
    const double t195 = 0.7e1 / 0.1296e5 * t67 * t171 + t66 * t188 * t192 / 0.1e3;
    const double t196 = t195 * t195;
    const double t197 = k1 + 0.5e1 / 0.972e3 * t162 + t50 * t169 * t174 / 0.576e3 + t196;
    const double t202 = 0.1e1 + k1 * ( 0.1e1 - k1 / t197 );
    const double t203 = t187 <= 0.1e1;
    const double t204 = -t97 < t187;
    const double t205 = t187 < -t97;
    const double t206 = piecewise_functor_3( t205, t187, -t97 );
    const double t207 = c1 * t206;
    const double t208 = 0.1e1 - t206;
    const double t209 = 0.1e1 / t208;
    const double t211 = safe_math::exp( -t207 * t209 );
    const double t212 = piecewise_functor_3( t204, 0.0, t211 );
    const double t213 = t187 < -t113;
    const double t214 = piecewise_functor_3( t213, -t113, t187 );
    const double t215 = 0.1e1 - t214;
    const double t218 = safe_math::exp( c2 / t215 );
    const double t220 = piecewise_functor_3( t213, 0.0, -d * t218 );
    const double t221 = piecewise_functor_3( t203, t212, t220 );
    const double t222 = 0.1e1 - t221;
    const double t225 = t202 * t222 + 0.1174e1 * t221;
    const double t226 = t28 * t225;
    const double t227 = safe_math::sqrt( sigma_bb );
    const double t228 = t157 * rho_b;
    const double t229 = 0.1e1 / t228;
    const double t231 = t130 * t227 * t229;
    const double t232 = safe_math::sqrt( t231 );
    const double t236 = safe_math::exp( -0.98958e1 * t128 / t232 );
    const double t237 = 0.1e1 - t236;
    const double t238 = t226 * t237;
    const double t241 = piecewise_functor_3( t146, 0.0, -0.3e1 / 0.8e1 * t155 * t238 );
    const double t242 = t7 * t7;
    const double t243 = 0.1e1 / t242;
    const double t244 = t17 * t243;
    const double t246 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t244 );
    const double t249 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t246 );
    const double t250 = t6 * t249;
    const double t253 = t28 * t28;
    const double t254 = 0.1e1 / t253;
    const double t255 = t254 * t126;
    const double t256 = t255 * t141;
    const double t258 = t27 * t256 / 0.8e1;
    const double t260 = t87 * t87;
    const double t262 = t259 / t260;
    const double t263 = t35 * rho_a;
    const double t265 = 0.1e1 / t37 / t263;
    const double t266 = sigma_aa * t265;
    const double t269 = t52 * t35;
    const double t271 = 0.1e1 / t36 / t269;
    const double t280 = t51 * sigma_aa;
    const double t281 = t52 * t52;
    const double t282 = t281 * rho_a;
    const double t283 = 0.1e1 / t282;
    const double t294 = -0.5e1 / 0.3e1 * tau_a * t39 + t266 / 0.3e1;
    const double t296 = t34 * t82;
    const double t299 = t66 * t80;
    const double t303 = -0.7e1 / 0.486e4 * t67 * t58 * t265 - t66 * t294 * t296 / 0.18e3 + t299 * t294 * t296 / 0.18e3;
    const double t306 = -0.1e2 / 0.729e3 * t34 * t266 - t50 * t51 * t271 * t62 / 0.108e3 + 0.3e1 / 0.32e3 * t279 * t280 * t283 * t62 + 0.2e1 * t85 * t303;
    const double t307 = t306 * t123;
    const double t309 = t294 * t29;
    const double t311 = 0.5e1 / 0.9e1 * t309 * t33;
    const double t312 = piecewise_functor_3( t99, t311, 0.0 );
    const double t315 = t102 * t102;
    const double t316 = 0.1e1 / t315;
    const double t317 = t316 * t312;
    const double t319 = -t103 * t312 * c1 - t101 * t317;
    const double t320 = t319 * t105;
    const double t321 = piecewise_functor_3( t98, 0.0, t320 );
    const double t323 = t116 * t116;
    const double t324 = 0.1e1 / t323;
    const double t325 = piecewise_functor_3( t114, 0.0, t311 );
    const double t329 = piecewise_functor_3( t114, 0.0, -t322 * t324 * t325 * t119 );
    const double t330 = piecewise_functor_3( t93, t321, t329 );
    const double t333 = t262 * t307 - t92 * t330 + 0.1174e1 * t330;
    const double t334 = t28 * t333;
    const double t335 = t334 * t141;
    const double t338 = safe_math::pow( 0.3e1, 0.1e1 / 0.6e1 );
    const double t339 = t338 * t338;
    const double t340 = t339 * t339;
    const double t341 = t340 * t338;
    const double t342 = t341 * t26;
    const double t344 = 0.1e1 / t136 / t135;
    const double t345 = t127 * t344;
    const double t346 = t342 * t345;
    const double t348 = 0.1e1 / t36 / t35;
    const double t351 = t130 * t131 * t348 * t140;
    const double t355 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t250 * t142 - t258 - 0.3e1 / 0.8e1 * t27 * t335 - 0.16891736332904387511e1 * t346 * t351 );
    const double t356 = t147 * t243;
    const double t358 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t356 );
    const double t361 = piecewise_functor_3( t151, 0.0, 0.4e1 / 0.3e1 * t152 * t358 );
    const double t362 = t6 * t361;
    const double t365 = t254 * t225;
    const double t366 = t365 * t237;
    const double t368 = t155 * t366 / 0.8e1;
    const double t370 = piecewise_functor_3( t146, 0.0, -0.3e1 / 0.8e1 * t362 * t238 - t368 );
    const double t374 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t244 );
    const double t377 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t374 );
    const double t378 = t6 * t377;
    const double t382 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t378 * t142 - t258 );
    const double t384 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t356 );
    const double t387 = piecewise_functor_3( t151, 0.0, 0.4e1 / 0.3e1 * t152 * t384 );
    const double t388 = t6 * t387;
    const double t391 = t197 * t197;
    const double t393 = t259 / t391;
    const double t394 = t156 * rho_b;
    const double t396 = 0.1e1 / t158 / t394;
    const double t397 = sigma_bb * t396;
    const double t400 = t165 * t156;
    const double t402 = 0.1e1 / t157 / t400;
    const double t407 = t164 * sigma_bb;
    const double t408 = t165 * t165;
    const double t409 = t408 * rho_b;
    const double t410 = 0.1e1 / t409;
    const double t421 = -0.5e1 / 0.3e1 * tau_b * t160 + t397 / 0.3e1;
    const double t423 = t34 * t192;
    const double t426 = t66 * t190;
    const double t430 = -0.7e1 / 0.486e4 * t67 * t170 * t396 - t66 * t421 * t423 / 0.18e3 + t426 * t421 * t423 / 0.18e3;
    const double t433 = -0.1e2 / 0.729e3 * t34 * t397 - t50 * t164 * t402 * t174 / 0.108e3 + 0.3e1 / 0.32e3 * t279 * t407 * t410 * t174 + 0.2e1 * t195 * t430;
    const double t434 = t433 * t222;
    const double t436 = t421 * t29;
    const double t438 = 0.5e1 / 0.9e1 * t436 * t33;
    const double t439 = piecewise_functor_3( t205, t438, 0.0 );
    const double t442 = t208 * t208;
    const double t443 = 0.1e1 / t442;
    const double t444 = t443 * t439;
    const double t446 = -t209 * t439 * c1 - t207 * t444;
    const double t447 = t446 * t211;
    const double t448 = piecewise_functor_3( t204, 0.0, t447 );
    const double t449 = t215 * t215;
    const double t450 = 0.1e1 / t449;
    const double t451 = piecewise_functor_3( t213, 0.0, t438 );
    const double t455 = piecewise_functor_3( t213, 0.0, -t322 * t450 * t451 * t218 );
    const double t456 = piecewise_functor_3( t203, t448, t455 );
    const double t459 = t393 * t434 - t202 * t456 + 0.1174e1 * t456;
    const double t460 = t28 * t459;
    const double t461 = t460 * t237;
    const double t464 = t341 * t154;
    const double t466 = 0.1e1 / t232 / t231;
    const double t467 = t226 * t466;
    const double t468 = t464 * t467;
    const double t470 = 0.1e1 / t157 / t156;
    const double t473 = t130 * t227 * t470 * t236;
    const double t477 = piecewise_functor_3( t146, 0.0, -0.3e1 / 0.8e1 * t388 * t238 - t368 - 0.3e1 / 0.8e1 * t155 * t461 - 0.16891736332904387511e1 * t468 * t473 );
    const double t481 = t39 * t29 * t33;
    const double t487 = 0.1e1 / t281;
    const double t495 = t66 * t39;
    const double t496 = t495 * t296;
    const double t499 = t299 * t39 * t296;
    const double t501 = 0.7e1 / 0.1296e5 * t67 * t33 * t39 + t496 / 0.144e4 - t499 / 0.144e4;
    const double t504 = 0.5e1 / 0.972e3 * t481 + t50 * sigma_aa * t55 * t62 / 0.288e3 - 0.9e1 / 0.256e4 * t279 * t51 * t487 * t62 + 0.2e1 * t85 * t501;
    const double t505 = t504 * t123;
    const double t507 = 0.5e1 / 0.72e2 * t481;
    const double t508 = piecewise_functor_3( t99, -t507, 0.0 );
    const double t509 = c1 * t508;
    const double t511 = t316 * t508;
    const double t513 = -t101 * t511 - t103 * t509;
    const double t514 = t513 * t105;
    const double t515 = piecewise_functor_3( t98, 0.0, t514 );
    const double t516 = piecewise_functor_3( t114, 0.0, -t507 );
    const double t520 = piecewise_functor_3( t114, 0.0, -t322 * t324 * t516 * t119 );
    const double t521 = piecewise_functor_3( t93, t515, t520 );
    const double t524 = t262 * t505 - t92 * t521 + 0.1174e1 * t521;
    const double t525 = t28 * t524;
    const double t526 = t525 * t141;
    const double t529 = 0.1e1 / t131;
    const double t532 = t130 * t529 * t133 * t140;
    const double t536 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t526 + 0.63344011248391453166e0 * t346 * t532 );
    const double t538 = t160 * t29 * t33;
    const double t544 = 0.1e1 / t408;
    const double t552 = t66 * t160;
    const double t553 = t552 * t423;
    const double t556 = t426 * t160 * t423;
    const double t558 = 0.7e1 / 0.1296e5 * t67 * t33 * t160 + t553 / 0.144e4 - t556 / 0.144e4;
    const double t561 = 0.5e1 / 0.972e3 * t538 + t50 * sigma_bb * t168 * t174 / 0.288e3 - 0.9e1 / 0.256e4 * t279 * t164 * t544 * t174 + 0.2e1 * t195 * t558;
    const double t562 = t561 * t222;
    const double t564 = 0.5e1 / 0.72e2 * t538;
    const double t565 = piecewise_functor_3( t205, -t564, 0.0 );
    const double t566 = c1 * t565;
    const double t568 = t443 * t565;
    const double t570 = -t207 * t568 - t209 * t566;
    const double t571 = t570 * t211;
    const double t572 = piecewise_functor_3( t204, 0.0, t571 );
    const double t573 = piecewise_functor_3( t213, 0.0, -t564 );
    const double t577 = piecewise_functor_3( t213, 0.0, -t322 * t450 * t573 * t218 );
    const double t578 = piecewise_functor_3( t203, t572, t577 );
    const double t581 = t393 * t562 - t202 * t578 + 0.1174e1 * t578;
    const double t582 = t28 * t581;
    const double t583 = t582 * t237;
    const double t586 = 0.1e1 / t227;
    const double t589 = t130 * t586 * t229 * t236;
    const double t593 = piecewise_functor_3( t146, 0.0, -0.3e1 / 0.8e1 * t155 * t583 + 0.63344011248391453166e0 * t468 * t589 );
    const double t594 = t66 * t71;
    const double t599 = t299 * t71 * t296 / 0.18e3 - t594 * t296 / 0.18e3;
    const double t600 = t85 * t599;
    const double t606 = 0.5e1 / 0.9e1 * t71 * t29 * t33;
    const double t607 = piecewise_functor_3( t99, t606, 0.0 );
    const double t608 = c1 * t607;
    const double t612 = -t101 * t316 * t607 - t103 * t608;
    const double t613 = t612 * t105;
    const double t614 = piecewise_functor_3( t98, 0.0, t613 );
    const double t615 = piecewise_functor_3( t114, 0.0, t606 );
    const double t619 = piecewise_functor_3( t114, 0.0, -t322 * t324 * t615 * t119 );
    const double t620 = piecewise_functor_3( t93, t614, t619 );
    const double t623 = 0.2e1 * t262 * t600 * t123 - t92 * t620 + 0.1174e1 * t620;
    const double t624 = t28 * t623;
    const double t625 = t624 * t141;
    const double t628 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t625 );
    const double t629 = t66 * t181;
    const double t634 = t426 * t181 * t423 / 0.18e3 - t629 * t423 / 0.18e3;
    const double t635 = t195 * t634;
    const double t641 = 0.5e1 / 0.9e1 * t181 * t29 * t33;
    const double t642 = piecewise_functor_3( t205, t641, 0.0 );
    const double t643 = c1 * t642;
    const double t647 = -t207 * t443 * t642 - t209 * t643;
    const double t648 = t647 * t211;
    const double t649 = piecewise_functor_3( t204, 0.0, t648 );
    const double t650 = piecewise_functor_3( t213, 0.0, t641 );
    const double t654 = piecewise_functor_3( t213, 0.0, -t322 * t450 * t650 * t218 );
    const double t655 = piecewise_functor_3( t203, t649, t654 );
    const double t658 = 0.2e1 * t393 * t635 * t222 - t202 * t655 + 0.1174e1 * t655;
    const double t659 = t28 * t658;
    const double t660 = t659 * t237;
    const double t663 = piecewise_functor_3( t146, 0.0, -0.3e1 / 0.8e1 * t155 * t660 );


    eps = t145 + t241;
    vrho_a = t145 + t241 + t7 * ( t355 + t370 );
    vrho_b = t145 + t241 + t7 * ( t382 + t477 );
    vsigma_aa = t7 * t536;
    vsigma_ab = 0.e0;
    vsigma_bb = t7 * t593;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t7 * t628;
    vtau_b = t7 * t663;

  }


};

struct BuiltinSCAN_X : detail::BuiltinKernelImpl< BuiltinSCAN_X > {

  BuiltinSCAN_X( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinSCAN_X >(p) { }
  
  virtual ~BuiltinSCAN_X() = default;

};



} // namespace ExchCXX
