#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinR2SCAN_C > :
  public mgga_screening_interface< BuiltinR2SCAN_C > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;

  static constexpr double dens_tol  = 1e-15;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000027e-20;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = false;
  static constexpr double exx_coeff = 0.0;

  static constexpr double eta = 0.001;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t40 = constants::m_cbrt_2;
    constexpr double t61 = constants::m_pi_sq;
    constexpr double t175 = constants::m_cbrt_6;
    constexpr double t176 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t19 = t2 * t2;
    constexpr double t20 = t4 * t4;
    constexpr double t21 = t19 * t20;
    constexpr double t41 = t40 - 0.1e1;
    constexpr double t43 = 0.1e1 / t41 / 0.2e1;
    constexpr double t90 = 0.1e1 / t4;
    constexpr double t177 = t176 * t176;
    constexpr double t178 = 0.1e1 / t177;
    constexpr double t179 = t175 * t178;
    constexpr double t180 = t40 * t40;
    constexpr double t181 = t179 * t180;
    constexpr double t185 = t175 * t175;
    constexpr double t187 = 0.1e1 / t176 / t61;
    constexpr double t188 = t185 * t187;


    const double t8 = safe_math::cbrt( rho );
    const double t10 = t7 / t8;
    const double t11 = t5 * t10;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t16 = 0.8969e0 * t11;
    const double t17 = pow_3_2( t11 );
    const double t18 = 0.204775e0 * t17;
    const double t22 = t8 * t8;
    const double t25 = t21 * t6 / t22;
    const double t26 = 0.123235e0 * t25;
    const double t27 = 0.379785e1 * t14 + t16 + t18 + t26;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = 0.1e1 <= zeta_tol;
    const double t35 = safe_math::cbrt( zeta_tol );
    const double t37 = piecewise_functor_3( t34, t35 * zeta_tol, 1.0 );
    const double t39 = 0.2e1 * t37 - 0.2e1;
    const double t44 = t39 * t43;
    const double t46 = 0.1e1 + 0.278125e-1 * t11;
    const double t48 = 0.905775e0 * t11;
    const double t49 = 0.1100325e0 * t17;
    const double t50 = 0.1241775e0 * t25;
    const double t51 = 0.51785e1 * t14 + t48 + t49 + t50;
    const double t54 = 0.1e1 + 0.29608749977793437516e2 / t51;
    const double t55 = safe_math::log( t54 );
    const double t58 = 0.19751673498613801407e-1 * t44 * t46 * t55;
    const double t59 = safe_math::log( 0.2e1 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 / t61;
    const double t64 = t35 * t35;
    const double t65 = piecewise_functor_3( t34, t64, 1.0 );
    const double t66 = t65 * t65;
    const double t67 = t66 * t65;
    const double t69 = 0.1e1 / t60;
    const double t71 = 0.1e1 / t67;
    const double t72 = t61 * t71;
    const double t74 = safe_math::exp( -( -t33 + t58 ) * t69 * t72 );
    const double t75 = t74 - 0.1e1;
    const double t77 = 0.1e1 + 0.25e-1 * t11;
    const double t79 = 0.1e1 + 0.4445e-1 * t11;
    const double t80 = 0.1e1 / t79;
    const double t81 = t77 * t80;
    const double t82 = rho * rho;
    const double t84 = 0.1e1 / t8 / t82;
    const double t88 = 0.1e1 / t66;
    const double t93 = 0.1e1 / t75;
    const double t94 = t6 * t69 * t93;
    const double t95 = t88 * t19 * t90 * t94;
    const double t99 = piecewise_functor_3( t34, t64 * zeta_tol, 1.0 );
    const double t100 = 0.1e1 / t99;
    const double t101 = t69 * t100;
    const double t102 = t71 * t93;
    const double t103 = safe_math::sqrt( 0.4e1 );
    const double t104 = t103 * t14;
    const double t106 = 0.3138525e-1 * t11;
    const double t107 = 0.1e1 + 0.22225e-1 * t104 + t106;
    const double t108 = t107 * t107;
    const double t113 = 0.1e1 - 0.2363e1 * t41 * t39 * t43;
    const double t114 = 0.1e1 / t108 * t113;
    const double t115 = 0.1e1 / t14;
    const double t116 = t103 * t115;
    const double t118 = 0.4445e-1 * t116 + 0.125541e0;
    const double t122 = 0.1898925e1 * t104 + t16 + t18 + t26;
    const double t125 = 0.1e1 + 0.16081979498692535067e2 / t122;
    const double t126 = safe_math::log( t125 );
    const double t128 = t122 * t122;
    const double t129 = 0.1e1 / t128;
    const double t130 = t13 * t129;
    const double t132 = safe_math::sqrt( t11 );
    const double t135 = 0.379785e1 * t116 + 0.35876e1 + 0.122865e1 * t132 + 0.24647e0 * t11;
    const double t136 = 0.1e1 / t125;
    const double t137 = t135 * t136;
    const double t141 = 0.258925e1 * t104 + t48 + t49 + t50;
    const double t144 = 0.1e1 + 0.29608749977793437516e2 / t141;
    const double t145 = safe_math::log( t144 );
    const double t148 = t44 * t46;
    const double t149 = t141 * t141;
    const double t150 = 0.1e1 / t149;
    const double t154 = 0.51785e1 * t116 + 0.36231e1 + 0.660195e0 * t132 + 0.248355e0 * t11;
    const double t156 = 0.1e1 / t144;
    const double t157 = t150 * t154 * t156;
    const double t160 = 0.285764e-1 * t114 * t118 + 0.1328816518e-1 * t126 - 0.1e1 * t130 * t137 - 0.21973736767207854065e-2 * t44 * t145 + 0.5848223622634646207e0 * t148 * t157;
    const double t165 = 0.1e1 + 0.4445e-1 * t14 + t106;
    const double t166 = 0.1e1 / t165;
    const double t172 = 0.5e1 * t5 * t10 * t160 - 0.45e2 * eta * ( -0.285764e-1 * t166 * t113 + t33 - t58 );
    const double t174 = t101 * t102 * t172;
    const double t183 = 0.1e1 / t22 / t82;
    const double t184 = sigma * t183;
    const double t189 = sigma * sigma;
    const double t190 = t40 * t189;
    const double t191 = t82 * t82;
    const double t192 = t191 * rho;
    const double t194 = 0.1e1 / t8 / t192;
    const double t198 = safe_math::exp( -0.20444604078896369094e0 * t188 * t190 * t194 );
    const double t200 = t181 * t184 * t198;
    const double t203 = 0.1e1 + 0.27439371595564631661e-1 * t81 * sigma * t84 * t40 * t95 + 0.43341108700271342816e-1 * t174 * t200;
    const double t204 = pow_1_4( t203 );
    const double t206 = 0.1e1 - 0.1e1 / t204;
    const double t208 = t75 * t206 + 0.1e1;
    const double t209 = safe_math::log( t208 );
    const double t211 = t63 * t67 * t209;
    const double t213 = 0.1e1 / t22 / rho;
    const double t216 = tau * t213 - t184 / 0.8e1;
    const double t220 = eta * sigma;
    const double t223 = 0.3e1 / 0.2e2 * t185 * t177 * t40 + t220 * t183 / 0.8e1;
    const double t224 = 0.1e1 / t223;
    const double t225 = t216 * t224;
    const double t226 = t225 <= 0.e0;
    const double t227 = 0.e0 < t225;
    const double t228 = piecewise_functor_3( t227, 0.0, t225 );
    const double t229 = 0.1e1 - t228;
    const double t230 = 0.1e1 / t229;
    const double t233 = safe_math::exp( -0.64e0 * t228 * t230 );
    const double t234 = t225 <= 0.25e1;
    const double t235 = 0.25e1 < t225;
    const double t236 = piecewise_functor_3( t235, 0.25e1, t225 );
    const double t238 = t236 * t236;
    const double t240 = t238 * t236;
    const double t242 = t238 * t238;
    const double t244 = t242 * t236;
    const double t246 = t242 * t238;
    const double t251 = piecewise_functor_3( t235, t225, 0.25e1 );
    const double t252 = 0.1e1 - t251;
    const double t255 = safe_math::exp( 0.15e1 / t252 );
    const double t257 = piecewise_functor_5( t226, t233, t234, 0.1e1 - 0.64e0 * t236 - 0.4352e0 * t238 - 0.1535685604549e1 * t240 + 0.3061560252175e1 * t242 - 0.1915710236206e1 * t244 + 0.516884468372e0 * t246 - 0.51848879792e-1 * t242 * t240, -0.7e0 * t255 );
    const double t260 = safe_math::exp( 0.1e1 * t166 );
    const double t261 = t260 - 0.1e1;
    const double t262 = t180 * sigma;
    const double t263 = t262 * t183;
    const double t266 = 0.1e1 + 0.21337642104376358333e-1 * t179 * t263;
    const double t267 = pow_1_4( t266 );
    const double t269 = 0.1e1 - 0.1e1 / t267;
    const double t271 = t261 * t269 + 0.1e1;
    const double t272 = safe_math::log( t271 );
    const double t276 = ( -0.285764e-1 * t166 + 0.285764e-1 * t272 ) * t113 + t33 - t58 - t211;
    const double t277 = t257 * t276;


    eps = -t33 + t58 + t211 + t277;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t40 = constants::m_cbrt_2;
    constexpr double t61 = constants::m_pi_sq;
    constexpr double t175 = constants::m_cbrt_6;
    constexpr double t176 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t19 = t2 * t2;
    constexpr double t20 = t4 * t4;
    constexpr double t21 = t19 * t20;
    constexpr double t41 = t40 - 0.1e1;
    constexpr double t43 = 0.1e1 / t41 / 0.2e1;
    constexpr double t90 = 0.1e1 / t4;
    constexpr double t177 = t176 * t176;
    constexpr double t178 = 0.1e1 / t177;
    constexpr double t179 = t175 * t178;
    constexpr double t180 = t40 * t40;
    constexpr double t181 = t179 * t180;
    constexpr double t185 = t175 * t175;
    constexpr double t187 = 0.1e1 / t176 / t61;
    constexpr double t188 = t185 * t187;
    constexpr double t288 = t4 * t7;
    constexpr double t363 = t90 * t6;
    constexpr double t416 = t5 * t7;
    constexpr double t577 = t178 * t180;
    constexpr double t594 = t19 * t90;


    const double t8 = safe_math::cbrt( rho );
    const double t10 = t7 / t8;
    const double t11 = t5 * t10;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t16 = 0.8969e0 * t11;
    const double t17 = pow_3_2( t11 );
    const double t18 = 0.204775e0 * t17;
    const double t22 = t8 * t8;
    const double t25 = t21 * t6 / t22;
    const double t26 = 0.123235e0 * t25;
    const double t27 = 0.379785e1 * t14 + t16 + t18 + t26;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = 0.1e1 <= zeta_tol;
    const double t35 = safe_math::cbrt( zeta_tol );
    const double t37 = piecewise_functor_3( t34, t35 * zeta_tol, 1.0 );
    const double t39 = 0.2e1 * t37 - 0.2e1;
    const double t44 = t39 * t43;
    const double t46 = 0.1e1 + 0.278125e-1 * t11;
    const double t48 = 0.905775e0 * t11;
    const double t49 = 0.1100325e0 * t17;
    const double t50 = 0.1241775e0 * t25;
    const double t51 = 0.51785e1 * t14 + t48 + t49 + t50;
    const double t54 = 0.1e1 + 0.29608749977793437516e2 / t51;
    const double t55 = safe_math::log( t54 );
    const double t58 = 0.19751673498613801407e-1 * t44 * t46 * t55;
    const double t59 = safe_math::log( 0.2e1 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 / t61;
    const double t64 = t35 * t35;
    const double t65 = piecewise_functor_3( t34, t64, 1.0 );
    const double t66 = t65 * t65;
    const double t67 = t66 * t65;
    const double t69 = 0.1e1 / t60;
    const double t71 = 0.1e1 / t67;
    const double t72 = t61 * t71;
    const double t74 = safe_math::exp( -( -t33 + t58 ) * t69 * t72 );
    const double t75 = t74 - 0.1e1;
    const double t77 = 0.1e1 + 0.25e-1 * t11;
    const double t79 = 0.1e1 + 0.4445e-1 * t11;
    const double t80 = 0.1e1 / t79;
    const double t81 = t77 * t80;
    const double t82 = rho * rho;
    const double t84 = 0.1e1 / t8 / t82;
    const double t88 = 0.1e1 / t66;
    const double t93 = 0.1e1 / t75;
    const double t94 = t6 * t69 * t93;
    const double t95 = t88 * t19 * t90 * t94;
    const double t99 = piecewise_functor_3( t34, t64 * zeta_tol, 1.0 );
    const double t100 = 0.1e1 / t99;
    const double t101 = t69 * t100;
    const double t102 = t71 * t93;
    const double t103 = safe_math::sqrt( 0.4e1 );
    const double t104 = t103 * t14;
    const double t106 = 0.3138525e-1 * t11;
    const double t107 = 0.1e1 + 0.22225e-1 * t104 + t106;
    const double t108 = t107 * t107;
    const double t113 = 0.1e1 - 0.2363e1 * t41 * t39 * t43;
    const double t114 = 0.1e1 / t108 * t113;
    const double t115 = 0.1e1 / t14;
    const double t116 = t103 * t115;
    const double t118 = 0.4445e-1 * t116 + 0.125541e0;
    const double t122 = 0.1898925e1 * t104 + t16 + t18 + t26;
    const double t125 = 0.1e1 + 0.16081979498692535067e2 / t122;
    const double t126 = safe_math::log( t125 );
    const double t128 = t122 * t122;
    const double t129 = 0.1e1 / t128;
    const double t130 = t13 * t129;
    const double t132 = safe_math::sqrt( t11 );
    const double t135 = 0.379785e1 * t116 + 0.35876e1 + 0.122865e1 * t132 + 0.24647e0 * t11;
    const double t136 = 0.1e1 / t125;
    const double t137 = t135 * t136;
    const double t141 = 0.258925e1 * t104 + t48 + t49 + t50;
    const double t144 = 0.1e1 + 0.29608749977793437516e2 / t141;
    const double t145 = safe_math::log( t144 );
    const double t148 = t44 * t46;
    const double t149 = t141 * t141;
    const double t150 = 0.1e1 / t149;
    const double t154 = 0.51785e1 * t116 + 0.36231e1 + 0.660195e0 * t132 + 0.248355e0 * t11;
    const double t156 = 0.1e1 / t144;
    const double t157 = t150 * t154 * t156;
    const double t160 = 0.285764e-1 * t114 * t118 + 0.1328816518e-1 * t126 - 0.1e1 * t130 * t137 - 0.21973736767207854065e-2 * t44 * t145 + 0.5848223622634646207e0 * t148 * t157;
    const double t165 = 0.1e1 + 0.4445e-1 * t14 + t106;
    const double t166 = 0.1e1 / t165;
    const double t172 = 0.5e1 * t5 * t10 * t160 - 0.45e2 * eta * ( -0.285764e-1 * t166 * t113 + t33 - t58 );
    const double t174 = t101 * t102 * t172;
    const double t183 = 0.1e1 / t22 / t82;
    const double t184 = sigma * t183;
    const double t189 = sigma * sigma;
    const double t190 = t40 * t189;
    const double t191 = t82 * t82;
    const double t192 = t191 * rho;
    const double t194 = 0.1e1 / t8 / t192;
    const double t198 = safe_math::exp( -0.20444604078896369094e0 * t188 * t190 * t194 );
    const double t200 = t181 * t184 * t198;
    const double t203 = 0.1e1 + 0.27439371595564631661e-1 * t81 * sigma * t84 * t40 * t95 + 0.43341108700271342816e-1 * t174 * t200;
    const double t204 = pow_1_4( t203 );
    const double t206 = 0.1e1 - 0.1e1 / t204;
    const double t208 = t75 * t206 + 0.1e1;
    const double t209 = safe_math::log( t208 );
    const double t211 = t63 * t67 * t209;
    const double t213 = 0.1e1 / t22 / rho;
    const double t216 = tau * t213 - t184 / 0.8e1;
    const double t220 = eta * sigma;
    const double t223 = 0.3e1 / 0.2e2 * t185 * t177 * t40 + t220 * t183 / 0.8e1;
    const double t224 = 0.1e1 / t223;
    const double t225 = t216 * t224;
    const double t226 = t225 <= 0.e0;
    const double t227 = 0.e0 < t225;
    const double t228 = piecewise_functor_3( t227, 0.0, t225 );
    const double t229 = 0.1e1 - t228;
    const double t230 = 0.1e1 / t229;
    const double t233 = safe_math::exp( -0.64e0 * t228 * t230 );
    const double t234 = t225 <= 0.25e1;
    const double t235 = 0.25e1 < t225;
    const double t236 = piecewise_functor_3( t235, 0.25e1, t225 );
    const double t238 = t236 * t236;
    const double t240 = t238 * t236;
    const double t242 = t238 * t238;
    const double t244 = t242 * t236;
    const double t246 = t242 * t238;
    const double t251 = piecewise_functor_3( t235, t225, 0.25e1 );
    const double t252 = 0.1e1 - t251;
    const double t255 = safe_math::exp( 0.15e1 / t252 );
    const double t257 = piecewise_functor_5( t226, t233, t234, 0.1e1 - 0.64e0 * t236 - 0.4352e0 * t238 - 0.1535685604549e1 * t240 + 0.3061560252175e1 * t242 - 0.1915710236206e1 * t244 + 0.516884468372e0 * t246 - 0.51848879792e-1 * t242 * t240, -0.7e0 * t255 );
    const double t260 = safe_math::exp( 0.1e1 * t166 );
    const double t261 = t260 - 0.1e1;
    const double t262 = t180 * sigma;
    const double t263 = t262 * t183;
    const double t266 = 0.1e1 + 0.21337642104376358333e-1 * t179 * t263;
    const double t267 = pow_1_4( t266 );
    const double t269 = 0.1e1 - 0.1e1 / t267;
    const double t271 = t261 * t269 + 0.1e1;
    const double t272 = safe_math::log( t271 );
    const double t276 = ( -0.285764e-1 * t166 + 0.285764e-1 * t272 ) * t113 + t33 - t58 - t211;
    const double t277 = t257 * t276;
    const double t279 = 0.1e1 / t8 / rho;
    const double t280 = t7 * t279;
    const double t282 = t5 * t280 * t31;
    const double t283 = 0.11073470983333333333e-2 * t282;
    const double t284 = t27 * t27;
    const double t285 = 0.1e1 / t284;
    const double t286 = t13 * t285;
    const double t287 = t115 * t2;
    const double t289 = t288 * t279;
    const double t290 = t287 * t289;
    const double t292 = t5 * t280;
    const double t293 = 0.29896666666666666667e0 * t292;
    const double t294 = t132 * t2;
    const double t295 = t294 * t289;
    const double t296 = 0.1023875e0 * t295;
    const double t298 = t21 * t6 * t213;
    const double t299 = 0.82156666666666666667e-1 * t298;
    const double t300 = -0.632975e0 * t290 - t293 - t296 - t299;
    const double t301 = 0.1e1 / t30;
    const double t302 = t300 * t301;
    const double t303 = t286 * t302;
    const double t304 = 0.1e1 * t303;
    const double t305 = t44 * t2;
    const double t308 = t305 * t288 * t279 * t55;
    const double t309 = 0.18311447306006545054e-3 * t308;
    const double t310 = t51 * t51;
    const double t311 = 0.1e1 / t310;
    const double t313 = 0.301925e0 * t292;
    const double t314 = 0.5501625e-1 * t295;
    const double t315 = 0.82785e-1 * t298;
    const double t316 = -0.86308333333333333334e0 * t290 - t313 - t314 - t315;
    const double t318 = 0.1e1 / t54;
    const double t319 = t311 * t316 * t318;
    const double t320 = t148 * t319;
    const double t321 = 0.5848223622634646207e0 * t320;
    const double t322 = t283 + t304 - t309 - t321;
    const double t323 = t322 * t69;
    const double t324 = t323 * t61;
    const double t325 = t71 * t74;
    const double t326 = t325 * t206;
    const double t329 = 0.1e1 / t204 / t203;
    const double t330 = t75 * t329;
    const double t331 = t82 * rho;
    const double t333 = 0.1e1 / t22 / t331;
    const double t334 = t333 * t80;
    const double t336 = t40 * t88;
    const double t337 = t69 * t93;
    const double t338 = t336 * t337;
    const double t341 = t79 * t79;
    const double t342 = 0.1e1 / t341;
    const double t343 = t77 * t342;
    const double t344 = sigma * t333;
    const double t349 = 0.1e1 / t8 / t331;
    const double t355 = t81 * sigma;
    const double t356 = t84 * t40;
    const double t357 = t66 * t66;
    const double t359 = 0.1e1 / t357 / t65;
    const double t360 = t359 * t19;
    const double t362 = t355 * t356 * t360;
    const double t364 = t60 * t60;
    const double t365 = 0.1e1 / t364;
    const double t366 = t363 * t365;
    const double t367 = t75 * t75;
    const double t368 = 0.1e1 / t367;
    const double t369 = t368 * t322;
    const double t370 = t61 * t74;
    const double t372 = t366 * t369 * t370;
    const double t375 = t365 * t100;
    const double t376 = t357 * t66;
    const double t377 = 0.1e1 / t376;
    const double t378 = t375 * t377;
    const double t379 = t368 * t172;
    const double t380 = t379 * t179;
    const double t381 = t378 * t380;
    const double t382 = t198 * t322;
    const double t383 = t382 * t370;
    const double t384 = t263 * t383;
    const double t392 = 0.1e1 / t108 / t107 * t113;
    const double t393 = safe_math::pow( 0.4e1, 0.1e1 / 0.6e1 );
    const double t394 = t393 * t115;
    const double t395 = t5 * t279;
    const double t396 = t394 * t395;
    const double t398 = 0.1046175e-1 * t292;
    const double t399 = -0.14816666666666666667e-1 * t396 - t398;
    const double t400 = t118 * t399;
    const double t403 = t114 * t393;
    const double t405 = 0.1e1 / t14 / t11;
    const double t406 = t405 * t2;
    const double t412 = -0.126595e1 * t396 - t293 - t296 - t299;
    const double t417 = t279 * t129;
    const double t421 = t128 * t122;
    const double t422 = 0.1e1 / t421;
    const double t423 = t13 * t422;
    const double t427 = t393 * t405;
    const double t428 = t427 * t395;
    const double t430 = 0.1e1/safe_math::sqrt( t11 );
    const double t431 = t430 * t2;
    const double t432 = t431 * t289;
    const double t435 = 0.25319e1 * t428 - 0.204775e0 * t432 - 0.82156666666666666667e-1 * t292;
    const double t436 = t435 * t136;
    const double t439 = t128 * t128;
    const double t440 = 0.1e1 / t439;
    const double t441 = t13 * t440;
    const double t442 = t125 * t125;
    const double t443 = 0.1e1 / t442;
    const double t444 = t135 * t443;
    const double t449 = -0.17261666666666666667e1 * t396 - t313 - t314 - t315;
    const double t454 = t44 * t5;
    const double t458 = t149 * t141;
    const double t459 = 0.1e1 / t458;
    const double t460 = t459 * t154;
    const double t461 = t156 * t449;
    const double t468 = 0.34523333333333333333e1 * t428 - 0.1100325e0 * t432 - 0.82785e-1 * t292;
    const double t470 = t150 * t468 * t156;
    const double t473 = t149 * t149;
    const double t474 = 0.1e1 / t473;
    const double t475 = t474 * t154;
    const double t476 = t144 * t144;
    const double t477 = 0.1e1 / t476;
    const double t478 = t477 * t449;
    const double t482 = -0.571528e-1 * t392 * t400 + 0.84681398666666666666e-3 * t403 * t406 * t4 * t279 - 0.2137e0 * t129 * t412 * t136 + 0.17808333333333333333e-1 * t416 * t417 * t137 + 0.2e1 * t423 * t137 * t412 - 0.1e1 * t130 * t436 - 0.16081979498692535067e2 * t441 * t444 * t412 + 0.65061487801810439052e-1 * t44 * t150 * t449 * t156 - 0.54217906501508699211e-2 * t454 * t280 * t157 - 0.11696447245269292414e1 * t148 * t460 * t461 + 0.5848223622634646207e0 * t148 * t470 + 0.17315859105681463759e2 * t148 * t475 * t478;
    const double t486 = t165 * t165;
    const double t487 = 0.1e1 / t486;
    const double t488 = t487 * t113;
    const double t490 = -0.74083333333333333333e-2 * t290 - t398;
    const double t496 = -0.5e1 / 0.3e1 * t5 * t280 * t160 + 0.5e1 * t5 * t10 * t482 - 0.45e2 * eta * ( 0.285764e-1 * t488 * t490 - t283 - t304 + t309 + t321 );
    const double t498 = t101 * t102 * t496;
    const double t502 = t181 * t344 * t198;
    const double t505 = t101 * t102;
    const double t506 = t189 * sigma;
    const double t507 = t172 * t506;
    const double t508 = t191 * t191;
    const double t509 = t508 * rho;
    const double t510 = 0.1e1 / t509;
    const double t511 = t510 * t198;
    const double t515 = -0.27439371595564631661e-2 * t334 * sigma * t338 + 0.48787202696913915093e-2 * t343 * t344 * t338 - 0.64025200389650807209e-1 * t81 * sigma * t349 * t40 * t95 + 0.27439371595564631661e-1 * t362 * t372 + 0.43341108700271342816e-1 * t381 * t384 + 0.43341108700271342816e-1 * t498 * t200 - 0.11557628986739024751e0 * t174 * t502 + 0.58218257753910989057e-2 * t505 * t507 * t511;
    const double t518 = -t324 * t326 + t330 * t515 / 0.4e1;
    const double t520 = 0.1e1 / t208;
    const double t522 = t63 * t67 * t518 * t520;
    const double t526 = -0.5e1 / 0.3e1 * tau * t183 + t344 / 0.3e1;
    const double t528 = t223 * t223;
    const double t529 = 0.1e1 / t528;
    const double t530 = t216 * t529;
    const double t531 = t220 * t333;
    const double t534 = t526 * t224 + t530 * t531 / 0.3e1;
    const double t535 = piecewise_functor_3( t227, 0.0, t534 );
    const double t538 = t229 * t229;
    const double t539 = 0.1e1 / t538;
    const double t540 = t228 * t539;
    const double t543 = -0.64e0 * t535 * t230 - 0.64e0 * t540 * t535;
    const double t544 = t543 * t233;
    const double t545 = piecewise_functor_3( t235, 0.0, t534 );
    const double t547 = t236 * t545;
    const double t549 = t238 * t545;
    const double t551 = t240 * t545;
    const double t553 = t242 * t545;
    const double t555 = t244 * t545;
    const double t560 = t252 * t252;
    const double t561 = 0.1e1 / t560;
    const double t562 = piecewise_functor_3( t235, t534, 0.0 );
    const double t566 = piecewise_functor_5( t226, t544, t234, -0.64e0 * t545 - 0.8704e0 * t547 - 0.4607056813647e1 * t549 + 0.122462410087e2 * t551 - 0.957855118103e1 * t553 + 0.3101306810232e1 * t555 - 0.362942158544e0 * t246 * t545, -0.105e1 * t561 * t562 * t255 );
    const double t567 = t566 * t276;
    const double t568 = t487 * t490;
    const double t570 = t260 * t269;
    const double t574 = 0.1e1 / t267 / t266;
    const double t575 = t261 * t574;
    const double t576 = t575 * t175;
    const double t581 = -0.1e1 * t568 * t570 - 0.14225094736250905555e-1 * t576 * t577 * t344;
    const double t582 = 0.1e1 / t271;
    const double t587 = ( 0.285764e-1 * t568 + 0.285764e-1 * t581 * t582 ) * t113 - t283 - t304 + t309 + t321 - t522;
    const double t588 = t257 * t587;
    const double t591 = t63 * t67;
    const double t595 = t594 * t94;
    const double t598 = t180 * t183;
    const double t599 = t598 * t198;
    const double t600 = t179 * t599;
    const double t604 = 0.1e1 / t508;
    const double t605 = t604 * t198;
    const double t609 = 0.27439371595564631661e-1 * t81 * t356 * t88 * t595 + 0.43341108700271342816e-1 * t174 * t600 - 0.21831846657716620896e-2 * t505 * t172 * t189 * t605;
    const double t610 = t609 * t520;
    const double t613 = t591 * t330 * t610 / 0.4e1;
    const double t614 = t183 * t224;
    const double t615 = eta * t183;
    const double t618 = -t530 * t615 / 0.8e1 - t614 / 0.8e1;
    const double t619 = piecewise_functor_3( t227, 0.0, t618 );
    const double t624 = -0.64e0 * t619 * t230 - 0.64e0 * t540 * t619;
    const double t625 = t624 * t233;
    const double t626 = piecewise_functor_3( t235, 0.0, t618 );
    const double t628 = t236 * t626;
    const double t630 = t238 * t626;
    const double t632 = t240 * t626;
    const double t634 = t242 * t626;
    const double t636 = t244 * t626;
    const double t641 = piecewise_functor_3( t235, t618, 0.0 );
    const double t645 = piecewise_functor_5( t226, t625, t234, -0.64e0 * t626 - 0.8704e0 * t628 - 0.4607056813647e1 * t630 + 0.122462410087e2 * t632 - 0.957855118103e1 * t634 + 0.3101306810232e1 * t636 - 0.362942158544e0 * t246 * t626, -0.105e1 * t561 * t641 * t255 );
    const double t646 = t645 * t276;
    const double t647 = t575 * t179;
    const double t648 = t582 * t113;
    const double t652 = 0.15243824895787514157e-3 * t647 * t598 * t648 - t613;
    const double t653 = t257 * t652;
    const double t655 = t213 * t224;
    const double t656 = piecewise_functor_3( t227, 0.0, t655 );
    const double t661 = -0.64e0 * t656 * t230 - 0.64e0 * t540 * t656;
    const double t662 = t661 * t233;
    const double t663 = piecewise_functor_3( t235, 0.0, t655 );
    const double t665 = t236 * t663;
    const double t667 = t238 * t663;
    const double t669 = t240 * t663;
    const double t671 = t242 * t663;
    const double t673 = t244 * t663;
    const double t678 = piecewise_functor_3( t235, t655, 0.0 );
    const double t682 = piecewise_functor_5( t226, t662, t234, -0.64e0 * t663 - 0.8704e0 * t665 - 0.4607056813647e1 * t667 + 0.122462410087e2 * t669 - 0.957855118103e1 * t671 + 0.3101306810232e1 * t673 - 0.362942158544e0 * t246 * t663, -0.105e1 * t561 * t678 * t255 );
    const double t683 = rho * t682;


    eps = -t33 + t58 + t211 + t277;
    vrho = -t33 + t58 + t211 + t277 + rho * ( t283 + t304 - t309 - t321 + t522 + t567 + t588 );
    vsigma = rho * ( t613 + t646 + t653 );
    vlapl = 0.e0;
    vtau = t683 * t276;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t57 = constants::m_cbrt_2;
    constexpr double t95 = constants::m_pi_sq;
    constexpr double t255 = constants::m_cbrt_6;
    constexpr double t256 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t20 = t2 * t2;
    constexpr double t21 = t4 * t4;
    constexpr double t22 = t20 * t21;
    constexpr double t58 = t57 - 0.1e1;
    constexpr double t60 = 0.1e1 / t58 / 0.2e1;
    constexpr double t130 = 0.1e1 / t4;
    constexpr double t257 = t256 * t256;
    constexpr double t258 = 0.1e1 / t257;
    constexpr double t259 = t255 * t258;
    constexpr double t260 = t57 * t57;
    constexpr double t261 = t259 * t260;
    constexpr double t265 = t255 * t255;
    constexpr double t267 = 0.1e1 / t256 / t95;
    constexpr double t268 = t265 * t267;
    constexpr double t313 = t265 * t257;


    const double t8 = rho_a + rho_b;
    const double t9 = safe_math::cbrt( t8 );
    const double t11 = t7 / t9;
    const double t12 = t5 * t11;
    const double t14 = 0.1e1 + 0.53425e-1 * t12;
    const double t15 = safe_math::sqrt( t12 );
    const double t17 = 0.8969e0 * t12;
    const double t18 = pow_3_2( t12 );
    const double t19 = 0.204775e0 * t18;
    const double t23 = t9 * t9;
    const double t26 = t22 * t6 / t23;
    const double t27 = 0.123235e0 * t26;
    const double t28 = 0.379785e1 * t15 + t17 + t19 + t27;
    const double t31 = 0.1e1 + 0.16081979498692535067e2 / t28;
    const double t32 = safe_math::log( t31 );
    const double t34 = 0.621814e-1 * t14 * t32;
    const double t35 = rho_a - rho_b;
    const double t36 = t35 * t35;
    const double t37 = t36 * t36;
    const double t38 = t8 * t8;
    const double t39 = t38 * t38;
    const double t40 = 0.1e1 / t39;
    const double t41 = t37 * t40;
    const double t42 = 0.1e1 / t8;
    const double t43 = t35 * t42;
    const double t44 = 0.1e1 + t43;
    const double t45 = t44 <= zeta_tol;
    const double t46 = safe_math::cbrt( zeta_tol );
    const double t47 = t46 * zeta_tol;
    const double t48 = safe_math::cbrt( t44 );
    const double t49 = t48 * t44;
    const double t50 = piecewise_functor_3( t45, t47, t49 );
    const double t51 = 0.1e1 - t43;
    const double t52 = t51 <= zeta_tol;
    const double t53 = safe_math::cbrt( t51 );
    const double t54 = t53 * t51;
    const double t55 = piecewise_functor_3( t52, t47, t54 );
    const double t56 = t50 + t55 - 0.2e1;
    const double t61 = t56 * t60;
    const double t63 = 0.1e1 + 0.5137e-1 * t12;
    const double t65 = 0.1549425e1 * t12;
    const double t66 = 0.420775e0 * t18;
    const double t67 = 0.1562925e0 * t26;
    const double t68 = 0.705945e1 * t15 + t65 + t66 + t67;
    const double t71 = 0.1e1 + 0.32163958997385070134e2 / t68;
    const double t72 = safe_math::log( t71 );
    const double t76 = 0.1e1 + 0.278125e-1 * t12;
    const double t78 = 0.905775e0 * t12;
    const double t79 = 0.1100325e0 * t18;
    const double t80 = 0.1241775e0 * t26;
    const double t81 = 0.51785e1 * t15 + t78 + t79 + t80;
    const double t84 = 0.1e1 + 0.29608749977793437516e2 / t81;
    const double t85 = safe_math::log( t84 );
    const double t86 = t76 * t85;
    const double t88 = -0.310907e-1 * t63 * t72 + t34 - 0.19751673498613801407e-1 * t86;
    const double t89 = t61 * t88;
    const double t90 = t41 * t89;
    const double t92 = 0.19751673498613801407e-1 * t61 * t86;
    const double t93 = safe_math::log( 0.2e1 );
    const double t94 = 0.1e1 - t93;
    const double t97 = t94 / t95;
    const double t98 = t46 * t46;
    const double t99 = t48 * t48;
    const double t100 = piecewise_functor_3( t45, t98, t99 );
    const double t101 = t53 * t53;
    const double t102 = piecewise_functor_3( t52, t98, t101 );
    const double t104 = t100 / 0.2e1 + t102 / 0.2e1;
    const double t105 = t104 * t104;
    const double t106 = t105 * t104;
    const double t108 = 0.1e1 / t94;
    const double t109 = ( -t34 + t90 + t92 ) * t108;
    const double t110 = 0.1e1 / t106;
    const double t111 = t95 * t110;
    const double t113 = safe_math::exp( -t109 * t111 );
    const double t114 = t113 - 0.1e1;
    const double t116 = 0.1e1 + 0.25e-1 * t12;
    const double t118 = 0.1e1 + 0.4445e-1 * t12;
    const double t119 = 0.1e1 / t118;
    const double t120 = t116 * t119;
    const double t122 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t124 = 0.1e1 / t9 / t38;
    const double t125 = t122 * t124;
    const double t128 = 0.1e1 / t105;
    const double t129 = t128 * t20;
    const double t132 = t6 * t108;
    const double t133 = 0.1e1 / t114;
    const double t134 = t132 * t133;
    const double t135 = t129 * t130 * t134;
    const double t138 = t98 * zeta_tol;
    const double t139 = t99 * t44;
    const double t140 = piecewise_functor_3( t45, t138, t139 );
    const double t141 = t101 * t51;
    const double t142 = piecewise_functor_3( t52, t138, t141 );
    const double t144 = t140 / 0.2e1 + t142 / 0.2e1;
    const double t146 = t108 / t144;
    const double t147 = t110 * t133;
    const double t148 = safe_math::sqrt( 0.4e1 );
    const double t149 = t148 * t15;
    const double t151 = 0.3138525e-1 * t12;
    const double t152 = 0.1e1 + 0.22225e-1 * t149 + t151;
    const double t153 = t152 * t152;
    const double t154 = 0.1e1 / t153;
    const double t158 = 0.1e1 - 0.2363e1 * t58 * t56 * t60;
    const double t159 = t154 * t158;
    const double t160 = t37 * t37;
    const double t161 = t160 * t37;
    const double t162 = t39 * t39;
    const double t163 = t162 * t39;
    const double t164 = 0.1e1 / t163;
    const double t166 = -t161 * t164 + 0.1e1;
    const double t167 = 0.1e1 / t15;
    const double t168 = t148 * t167;
    const double t170 = 0.4445e-1 * t168 + 0.125541e0;
    const double t171 = t166 * t170;
    const double t175 = 0.1898925e1 * t149 + t17 + t19 + t27;
    const double t178 = 0.1e1 + 0.16081979498692535067e2 / t175;
    const double t179 = safe_math::log( t178 );
    const double t180 = 0.1328816518e-1 * t179;
    const double t181 = t175 * t175;
    const double t182 = 0.1e1 / t181;
    const double t183 = t14 * t182;
    const double t185 = safe_math::sqrt( t12 );
    const double t188 = 0.379785e1 * t168 + 0.35876e1 + 0.122865e1 * t185 + 0.24647e0 * t12;
    const double t189 = 0.1e1 / t178;
    const double t190 = t188 * t189;
    const double t192 = 0.1e1 * t183 * t190;
    const double t194 = 0.3529725e1 * t149 + t65 + t66 + t67;
    const double t197 = 0.1e1 + 0.32163958997385070134e2 / t194;
    const double t198 = safe_math::log( t197 );
    const double t200 = t194 * t194;
    const double t201 = 0.1e1 / t200;
    const double t202 = t63 * t201;
    const double t206 = 0.705945e1 * t168 + 0.61977e1 + 0.252465e1 * t185 + 0.312585e0 * t12;
    const double t207 = 0.1e1 / t197;
    const double t208 = t206 * t207;
    const double t212 = 0.258925e1 * t149 + t78 + t79 + t80;
    const double t215 = 0.1e1 + 0.29608749977793437516e2 / t212;
    const double t216 = safe_math::log( t215 );
    const double t218 = t212 * t212;
    const double t219 = 0.1e1 / t218;
    const double t220 = t76 * t219;
    const double t224 = 0.51785e1 * t168 + 0.36231e1 + 0.660195e0 * t185 + 0.248355e0 * t12;
    const double t225 = 0.1e1 / t215;
    const double t226 = t224 * t225;
    const double t229 = -0.6388517036e-2 * t198 + 0.1e1 * t202 * t208 + t180 - t192 - 0.21973736767207854065e-2 * t216 + 0.5848223622634646207e0 * t220 * t226;
    const double t230 = t61 * t229;
    const double t234 = t61 * t76;
    const double t236 = t219 * t224 * t225;
    const double t239 = 0.285764e-1 * t159 * t171 + t180 - t192 - t41 * t230 - 0.21973736767207854065e-2 * t61 * t216 + 0.5848223622634646207e0 * t234 * t236;
    const double t244 = 0.1e1 + 0.4445e-1 * t15 + t151;
    const double t245 = 0.1e1 / t244;
    const double t246 = t245 * t158;
    const double t252 = 0.5e1 * t5 * t11 * t239 - 0.45e2 * eta * ( -0.285764e-1 * t246 * t166 + t34 - t90 - t92 );
    const double t253 = t147 * t252;
    const double t254 = t146 * t253;
    const double t263 = 0.1e1 / t23 / t38;
    const double t264 = t122 * t263;
    const double t269 = t122 * t122;
    const double t270 = t57 * t269;
    const double t271 = t39 * t8;
    const double t273 = 0.1e1 / t9 / t271;
    const double t277 = safe_math::exp( -0.20444604078896369094e0 * t268 * t270 * t273 );
    const double t279 = t261 * t264 * t277;
    const double t282 = 0.1e1 + 0.27439371595564631661e-1 * t120 * t125 * t57 * t135 + 0.43341108700271342816e-1 * t254 * t279;
    const double t283 = pow_1_4( t282 );
    const double t285 = 0.1e1 - 0.1e1 / t283;
    const double t287 = t114 * t285 + 0.1e1;
    const double t288 = safe_math::log( t287 );
    const double t290 = t97 * t106 * t288;
    const double t291 = safe_math::cbrt( rho_a );
    const double t292 = t291 * t291;
    const double t294 = 0.1e1 / t292 / rho_a;
    const double t295 = tau_a * t294;
    const double t296 = t44 / 0.2e1;
    const double t297 = safe_math::cbrt( t296 );
    const double t298 = t297 * t297;
    const double t299 = t298 * t296;
    const double t301 = safe_math::cbrt( rho_b );
    const double t302 = t301 * t301;
    const double t304 = 0.1e1 / t302 / rho_b;
    const double t305 = tau_b * t304;
    const double t306 = t51 / 0.2e1;
    const double t307 = safe_math::cbrt( t306 );
    const double t308 = t307 * t307;
    const double t309 = t308 * t306;
    const double t312 = t295 * t299 + t305 * t309 - t264 / 0.8e1;
    const double t317 = eta * t122;
    const double t320 = 0.3e1 / 0.1e2 * t313 * ( t299 + t309 ) + t317 * t263 / 0.8e1;
    const double t321 = 0.1e1 / t320;
    const double t322 = t312 * t321;
    const double t323 = t322 <= 0.e0;
    const double t324 = 0.e0 < t322;
    const double t325 = piecewise_functor_3( t324, 0.0, t322 );
    const double t326 = 0.1e1 - t325;
    const double t327 = 0.1e1 / t326;
    const double t330 = safe_math::exp( -0.64e0 * t325 * t327 );
    const double t331 = t322 <= 0.25e1;
    const double t332 = 0.25e1 < t322;
    const double t333 = piecewise_functor_3( t332, 0.25e1, t322 );
    const double t335 = t333 * t333;
    const double t337 = t335 * t333;
    const double t339 = t335 * t335;
    const double t341 = t339 * t333;
    const double t343 = t339 * t335;
    const double t348 = piecewise_functor_3( t332, t322, 0.25e1 );
    const double t349 = 0.1e1 - t348;
    const double t352 = safe_math::exp( 0.15e1 / t349 );
    const double t354 = piecewise_functor_5( t323, t330, t331, 0.1e1 - 0.64e0 * t333 - 0.4352e0 * t335 - 0.1535685604549e1 * t337 + 0.3061560252175e1 * t339 - 0.1915710236206e1 * t341 + 0.516884468372e0 * t343 - 0.51848879792e-1 * t339 * t337, -0.7e0 * t352 );
    const double t357 = safe_math::exp( 0.1e1 * t245 );
    const double t358 = t357 - 0.1e1;
    const double t359 = t260 * t122;
    const double t360 = t359 * t263;
    const double t363 = 0.1e1 + 0.21337642104376358333e-1 * t259 * t360;
    const double t364 = pow_1_4( t363 );
    const double t366 = 0.1e1 - 0.1e1 / t364;
    const double t368 = t358 * t366 + 0.1e1;
    const double t369 = safe_math::log( t368 );
    const double t371 = -0.285764e-1 * t245 + 0.285764e-1 * t369;
    const double t372 = t371 * t158;
    const double t374 = t372 * t166 - t290 + t34 - t90 - t92;
    const double t375 = t354 * t374;


    eps = -t34 + t90 + t92 + t290 + t375;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t57 = constants::m_cbrt_2;
    constexpr double t95 = constants::m_pi_sq;
    constexpr double t255 = constants::m_cbrt_6;
    constexpr double t256 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t20 = t2 * t2;
    constexpr double t21 = t4 * t4;
    constexpr double t22 = t20 * t21;
    constexpr double t58 = t57 - 0.1e1;
    constexpr double t60 = 0.1e1 / t58 / 0.2e1;
    constexpr double t130 = 0.1e1 / t4;
    constexpr double t257 = t256 * t256;
    constexpr double t258 = 0.1e1 / t257;
    constexpr double t259 = t255 * t258;
    constexpr double t260 = t57 * t57;
    constexpr double t261 = t259 * t260;
    constexpr double t265 = t255 * t255;
    constexpr double t267 = 0.1e1 / t256 / t95;
    constexpr double t268 = t265 * t267;
    constexpr double t313 = t265 * t257;
    constexpr double t386 = t4 * t7;
    constexpr double t528 = t20 * t130;
    constexpr double t529 = t528 * t6;
    constexpr double t550 = t258 * t260;
    constexpr double t625 = t5 * t7;


    const double t8 = rho_a + rho_b;
    const double t9 = safe_math::cbrt( t8 );
    const double t11 = t7 / t9;
    const double t12 = t5 * t11;
    const double t14 = 0.1e1 + 0.53425e-1 * t12;
    const double t15 = safe_math::sqrt( t12 );
    const double t17 = 0.8969e0 * t12;
    const double t18 = pow_3_2( t12 );
    const double t19 = 0.204775e0 * t18;
    const double t23 = t9 * t9;
    const double t26 = t22 * t6 / t23;
    const double t27 = 0.123235e0 * t26;
    const double t28 = 0.379785e1 * t15 + t17 + t19 + t27;
    const double t31 = 0.1e1 + 0.16081979498692535067e2 / t28;
    const double t32 = safe_math::log( t31 );
    const double t34 = 0.621814e-1 * t14 * t32;
    const double t35 = rho_a - rho_b;
    const double t36 = t35 * t35;
    const double t37 = t36 * t36;
    const double t38 = t8 * t8;
    const double t39 = t38 * t38;
    const double t40 = 0.1e1 / t39;
    const double t41 = t37 * t40;
    const double t42 = 0.1e1 / t8;
    const double t43 = t35 * t42;
    const double t44 = 0.1e1 + t43;
    const double t45 = t44 <= zeta_tol;
    const double t46 = safe_math::cbrt( zeta_tol );
    const double t47 = t46 * zeta_tol;
    const double t48 = safe_math::cbrt( t44 );
    const double t49 = t48 * t44;
    const double t50 = piecewise_functor_3( t45, t47, t49 );
    const double t51 = 0.1e1 - t43;
    const double t52 = t51 <= zeta_tol;
    const double t53 = safe_math::cbrt( t51 );
    const double t54 = t53 * t51;
    const double t55 = piecewise_functor_3( t52, t47, t54 );
    const double t56 = t50 + t55 - 0.2e1;
    const double t61 = t56 * t60;
    const double t63 = 0.1e1 + 0.5137e-1 * t12;
    const double t65 = 0.1549425e1 * t12;
    const double t66 = 0.420775e0 * t18;
    const double t67 = 0.1562925e0 * t26;
    const double t68 = 0.705945e1 * t15 + t65 + t66 + t67;
    const double t71 = 0.1e1 + 0.32163958997385070134e2 / t68;
    const double t72 = safe_math::log( t71 );
    const double t76 = 0.1e1 + 0.278125e-1 * t12;
    const double t78 = 0.905775e0 * t12;
    const double t79 = 0.1100325e0 * t18;
    const double t80 = 0.1241775e0 * t26;
    const double t81 = 0.51785e1 * t15 + t78 + t79 + t80;
    const double t84 = 0.1e1 + 0.29608749977793437516e2 / t81;
    const double t85 = safe_math::log( t84 );
    const double t86 = t76 * t85;
    const double t88 = -0.310907e-1 * t63 * t72 + t34 - 0.19751673498613801407e-1 * t86;
    const double t89 = t61 * t88;
    const double t90 = t41 * t89;
    const double t92 = 0.19751673498613801407e-1 * t61 * t86;
    const double t93 = safe_math::log( 0.2e1 );
    const double t94 = 0.1e1 - t93;
    const double t97 = t94 / t95;
    const double t98 = t46 * t46;
    const double t99 = t48 * t48;
    const double t100 = piecewise_functor_3( t45, t98, t99 );
    const double t101 = t53 * t53;
    const double t102 = piecewise_functor_3( t52, t98, t101 );
    const double t104 = t100 / 0.2e1 + t102 / 0.2e1;
    const double t105 = t104 * t104;
    const double t106 = t105 * t104;
    const double t108 = 0.1e1 / t94;
    const double t109 = ( -t34 + t90 + t92 ) * t108;
    const double t110 = 0.1e1 / t106;
    const double t111 = t95 * t110;
    const double t113 = safe_math::exp( -t109 * t111 );
    const double t114 = t113 - 0.1e1;
    const double t116 = 0.1e1 + 0.25e-1 * t12;
    const double t118 = 0.1e1 + 0.4445e-1 * t12;
    const double t119 = 0.1e1 / t118;
    const double t120 = t116 * t119;
    const double t122 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t124 = 0.1e1 / t9 / t38;
    const double t125 = t122 * t124;
    const double t128 = 0.1e1 / t105;
    const double t129 = t128 * t20;
    const double t132 = t6 * t108;
    const double t133 = 0.1e1 / t114;
    const double t134 = t132 * t133;
    const double t135 = t129 * t130 * t134;
    const double t138 = t98 * zeta_tol;
    const double t139 = t99 * t44;
    const double t140 = piecewise_functor_3( t45, t138, t139 );
    const double t141 = t101 * t51;
    const double t142 = piecewise_functor_3( t52, t138, t141 );
    const double t144 = t140 / 0.2e1 + t142 / 0.2e1;
    const double t146 = t108 / t144;
    const double t147 = t110 * t133;
    const double t148 = safe_math::sqrt( 0.4e1 );
    const double t149 = t148 * t15;
    const double t151 = 0.3138525e-1 * t12;
    const double t152 = 0.1e1 + 0.22225e-1 * t149 + t151;
    const double t153 = t152 * t152;
    const double t154 = 0.1e1 / t153;
    const double t158 = 0.1e1 - 0.2363e1 * t58 * t56 * t60;
    const double t159 = t154 * t158;
    const double t160 = t37 * t37;
    const double t161 = t160 * t37;
    const double t162 = t39 * t39;
    const double t163 = t162 * t39;
    const double t164 = 0.1e1 / t163;
    const double t166 = -t161 * t164 + 0.1e1;
    const double t167 = 0.1e1 / t15;
    const double t168 = t148 * t167;
    const double t170 = 0.4445e-1 * t168 + 0.125541e0;
    const double t171 = t166 * t170;
    const double t175 = 0.1898925e1 * t149 + t17 + t19 + t27;
    const double t178 = 0.1e1 + 0.16081979498692535067e2 / t175;
    const double t179 = safe_math::log( t178 );
    const double t180 = 0.1328816518e-1 * t179;
    const double t181 = t175 * t175;
    const double t182 = 0.1e1 / t181;
    const double t183 = t14 * t182;
    const double t185 = safe_math::sqrt( t12 );
    const double t188 = 0.379785e1 * t168 + 0.35876e1 + 0.122865e1 * t185 + 0.24647e0 * t12;
    const double t189 = 0.1e1 / t178;
    const double t190 = t188 * t189;
    const double t192 = 0.1e1 * t183 * t190;
    const double t194 = 0.3529725e1 * t149 + t65 + t66 + t67;
    const double t197 = 0.1e1 + 0.32163958997385070134e2 / t194;
    const double t198 = safe_math::log( t197 );
    const double t200 = t194 * t194;
    const double t201 = 0.1e1 / t200;
    const double t202 = t63 * t201;
    const double t206 = 0.705945e1 * t168 + 0.61977e1 + 0.252465e1 * t185 + 0.312585e0 * t12;
    const double t207 = 0.1e1 / t197;
    const double t208 = t206 * t207;
    const double t212 = 0.258925e1 * t149 + t78 + t79 + t80;
    const double t215 = 0.1e1 + 0.29608749977793437516e2 / t212;
    const double t216 = safe_math::log( t215 );
    const double t218 = t212 * t212;
    const double t219 = 0.1e1 / t218;
    const double t220 = t76 * t219;
    const double t224 = 0.51785e1 * t168 + 0.36231e1 + 0.660195e0 * t185 + 0.248355e0 * t12;
    const double t225 = 0.1e1 / t215;
    const double t226 = t224 * t225;
    const double t229 = -0.6388517036e-2 * t198 + 0.1e1 * t202 * t208 + t180 - t192 - 0.21973736767207854065e-2 * t216 + 0.5848223622634646207e0 * t220 * t226;
    const double t230 = t61 * t229;
    const double t234 = t61 * t76;
    const double t236 = t219 * t224 * t225;
    const double t239 = 0.285764e-1 * t159 * t171 + t180 - t192 - t41 * t230 - 0.21973736767207854065e-2 * t61 * t216 + 0.5848223622634646207e0 * t234 * t236;
    const double t244 = 0.1e1 + 0.4445e-1 * t15 + t151;
    const double t245 = 0.1e1 / t244;
    const double t246 = t245 * t158;
    const double t252 = 0.5e1 * t5 * t11 * t239 - 0.45e2 * eta * ( -0.285764e-1 * t246 * t166 + t34 - t90 - t92 );
    const double t253 = t147 * t252;
    const double t254 = t146 * t253;
    const double t263 = 0.1e1 / t23 / t38;
    const double t264 = t122 * t263;
    const double t269 = t122 * t122;
    const double t270 = t57 * t269;
    const double t271 = t39 * t8;
    const double t273 = 0.1e1 / t9 / t271;
    const double t277 = safe_math::exp( -0.20444604078896369094e0 * t268 * t270 * t273 );
    const double t279 = t261 * t264 * t277;
    const double t282 = 0.1e1 + 0.27439371595564631661e-1 * t120 * t125 * t57 * t135 + 0.43341108700271342816e-1 * t254 * t279;
    const double t283 = pow_1_4( t282 );
    const double t285 = 0.1e1 - 0.1e1 / t283;
    const double t287 = t114 * t285 + 0.1e1;
    const double t288 = safe_math::log( t287 );
    const double t290 = t97 * t106 * t288;
    const double t291 = safe_math::cbrt( rho_a );
    const double t292 = t291 * t291;
    const double t294 = 0.1e1 / t292 / rho_a;
    const double t295 = tau_a * t294;
    const double t296 = t44 / 0.2e1;
    const double t297 = safe_math::cbrt( t296 );
    const double t298 = t297 * t297;
    const double t299 = t298 * t296;
    const double t301 = safe_math::cbrt( rho_b );
    const double t302 = t301 * t301;
    const double t304 = 0.1e1 / t302 / rho_b;
    const double t305 = tau_b * t304;
    const double t306 = t51 / 0.2e1;
    const double t307 = safe_math::cbrt( t306 );
    const double t308 = t307 * t307;
    const double t309 = t308 * t306;
    const double t312 = t295 * t299 + t305 * t309 - t264 / 0.8e1;
    const double t317 = eta * t122;
    const double t320 = 0.3e1 / 0.1e2 * t313 * ( t299 + t309 ) + t317 * t263 / 0.8e1;
    const double t321 = 0.1e1 / t320;
    const double t322 = t312 * t321;
    const double t323 = t322 <= 0.e0;
    const double t324 = 0.e0 < t322;
    const double t325 = piecewise_functor_3( t324, 0.0, t322 );
    const double t326 = 0.1e1 - t325;
    const double t327 = 0.1e1 / t326;
    const double t330 = safe_math::exp( -0.64e0 * t325 * t327 );
    const double t331 = t322 <= 0.25e1;
    const double t332 = 0.25e1 < t322;
    const double t333 = piecewise_functor_3( t332, 0.25e1, t322 );
    const double t335 = t333 * t333;
    const double t337 = t335 * t333;
    const double t339 = t335 * t335;
    const double t341 = t339 * t333;
    const double t343 = t339 * t335;
    const double t348 = piecewise_functor_3( t332, t322, 0.25e1 );
    const double t349 = 0.1e1 - t348;
    const double t352 = safe_math::exp( 0.15e1 / t349 );
    const double t354 = piecewise_functor_5( t323, t330, t331, 0.1e1 - 0.64e0 * t333 - 0.4352e0 * t335 - 0.1535685604549e1 * t337 + 0.3061560252175e1 * t339 - 0.1915710236206e1 * t341 + 0.516884468372e0 * t343 - 0.51848879792e-1 * t339 * t337, -0.7e0 * t352 );
    const double t357 = safe_math::exp( 0.1e1 * t245 );
    const double t358 = t357 - 0.1e1;
    const double t359 = t260 * t122;
    const double t360 = t359 * t263;
    const double t363 = 0.1e1 + 0.21337642104376358333e-1 * t259 * t360;
    const double t364 = pow_1_4( t363 );
    const double t366 = 0.1e1 - 0.1e1 / t364;
    const double t368 = t358 * t366 + 0.1e1;
    const double t369 = safe_math::log( t368 );
    const double t371 = -0.285764e-1 * t245 + 0.285764e-1 * t369;
    const double t372 = t371 * t158;
    const double t374 = t372 * t166 - t290 + t34 - t90 - t92;
    const double t375 = t354 * t374;
    const double t377 = 0.1e1 / t9 / t8;
    const double t378 = t7 * t377;
    const double t380 = t5 * t378 * t32;
    const double t381 = 0.11073470983333333333e-2 * t380;
    const double t382 = t28 * t28;
    const double t383 = 0.1e1 / t382;
    const double t384 = t14 * t383;
    const double t385 = t167 * t2;
    const double t387 = t386 * t377;
    const double t388 = t385 * t387;
    const double t390 = t5 * t378;
    const double t391 = 0.29896666666666666667e0 * t390;
    const double t392 = t185 * t2;
    const double t393 = t392 * t387;
    const double t394 = 0.1023875e0 * t393;
    const double t398 = t22 * t6 / t23 / t8;
    const double t399 = 0.82156666666666666667e-1 * t398;
    const double t400 = -0.632975e0 * t388 - t391 - t394 - t399;
    const double t401 = 0.1e1 / t31;
    const double t402 = t400 * t401;
    const double t403 = t384 * t402;
    const double t404 = 0.1e1 * t403;
    const double t405 = t36 * t35;
    const double t406 = t405 * t40;
    const double t407 = t406 * t89;
    const double t408 = 0.4e1 * t407;
    const double t409 = 0.1e1 / t271;
    const double t410 = t37 * t409;
    const double t411 = t410 * t89;
    const double t412 = 0.4e1 * t411;
    const double t413 = 0.1e1 / t38;
    const double t414 = t35 * t413;
    const double t415 = t42 - t414;
    const double t418 = piecewise_functor_3( t45, 0.0, 0.4e1 / 0.3e1 * t48 * t415 );
    const double t419 = -t415;
    const double t422 = piecewise_functor_3( t52, 0.0, 0.4e1 / 0.3e1 * t53 * t419 );
    const double t423 = t418 + t422;
    const double t424 = t423 * t60;
    const double t425 = t424 * t88;
    const double t426 = t41 * t425;
    const double t430 = t68 * t68;
    const double t431 = 0.1e1 / t430;
    const double t432 = t63 * t431;
    const double t434 = 0.516475e0 * t390;
    const double t435 = 0.2103875e0 * t393;
    const double t436 = 0.104195e0 * t398;
    const double t437 = -0.1176575e1 * t388 - t434 - t435 - t436;
    const double t438 = 0.1e1 / t71;
    const double t439 = t437 * t438;
    const double t445 = t81 * t81;
    const double t446 = 0.1e1 / t445;
    const double t447 = t76 * t446;
    const double t449 = 0.301925e0 * t390;
    const double t450 = 0.5501625e-1 * t393;
    const double t451 = 0.82785e-1 * t398;
    const double t452 = -0.86308333333333333334e0 * t388 - t449 - t450 - t451;
    const double t453 = 0.1e1 / t84;
    const double t454 = t452 * t453;
    const double t457 = 0.53237641966666666666e-3 * t5 * t378 * t72 + 0.1e1 * t432 * t439 - t381 - t404 + 0.18311447306006545054e-3 * t5 * t378 * t85 + 0.5848223622634646207e0 * t447 * t454;
    const double t458 = t61 * t457;
    const double t459 = t41 * t458;
    const double t460 = t424 * t86;
    const double t461 = 0.19751673498613801407e-1 * t460;
    const double t462 = t61 * t2;
    const double t464 = t386 * t377 * t85;
    const double t465 = t462 * t464;
    const double t466 = 0.18311447306006545054e-3 * t465;
    const double t468 = t446 * t452 * t453;
    const double t469 = t234 * t468;
    const double t470 = 0.5848223622634646207e0 * t469;
    const double t471 = t105 * t288;
    const double t472 = 0.1e1 / t48;
    const double t473 = t472 * t415;
    const double t475 = piecewise_functor_3( t45, 0.0, 0.2e1 / 0.3e1 * t473 );
    const double t476 = 0.1e1 / t53;
    const double t477 = t476 * t419;
    const double t479 = piecewise_functor_3( t52, 0.0, 0.2e1 / 0.3e1 * t477 );
    const double t481 = t475 / 0.2e1 + t479 / 0.2e1;
    const double t483 = t97 * t471 * t481;
    const double t484 = 0.3e1 * t483;
    const double t486 = ( t381 + t404 + t408 - t412 + t426 + t459 + t461 - t466 - t470 ) * t108;
    const double t488 = t105 * t105;
    const double t489 = 0.1e1 / t488;
    const double t490 = t95 * t489;
    const double t491 = t490 * t481;
    const double t494 = 0.3e1 * t109 * t491 - t486 * t111;
    const double t495 = t494 * t113;
    const double t496 = t495 * t285;
    const double t498 = 0.1e1 / t283 / t282;
    const double t499 = t114 * t498;
    const double t500 = t38 * t8;
    const double t502 = 0.1e1 / t23 / t500;
    const double t503 = t502 * t119;
    const double t505 = t57 * t128;
    const double t506 = t108 * t133;
    const double t507 = t505 * t506;
    const double t509 = 0.27439371595564631661e-2 * t503 * t122 * t507;
    const double t510 = t118 * t118;
    const double t511 = 0.1e1 / t510;
    const double t512 = t116 * t511;
    const double t513 = t122 * t502;
    const double t514 = t512 * t513;
    const double t516 = 0.48787202696913915093e-2 * t514 * t507;
    const double t518 = 0.1e1 / t9 / t500;
    const double t523 = 0.64025200389650807209e-1 * t120 * t122 * t518 * t57 * t135;
    const double t524 = t120 * t122;
    const double t525 = t124 * t57;
    const double t526 = t525 * t110;
    const double t527 = t524 * t526;
    const double t530 = t506 * t481;
    const double t531 = t529 * t530;
    const double t534 = t525 * t128;
    const double t535 = t524 * t534;
    const double t536 = t114 * t114;
    const double t537 = 0.1e1 / t536;
    const double t538 = t108 * t537;
    const double t539 = t538 * t495;
    const double t540 = t529 * t539;
    const double t543 = t144 * t144;
    const double t545 = t108 / t543;
    const double t546 = t545 * t110;
    const double t547 = t133 * t252;
    const double t548 = t547 * t255;
    const double t549 = t546 * t548;
    const double t551 = t550 * t122;
    const double t552 = t263 * t277;
    const double t555 = piecewise_functor_3( t45, 0.0, 0.5e1 / 0.3e1 * t99 * t415 );
    const double t558 = piecewise_functor_3( t52, 0.0, 0.5e1 / 0.3e1 * t101 * t419 );
    const double t560 = t555 / 0.2e1 + t558 / 0.2e1;
    const double t561 = t552 * t560;
    const double t562 = t551 * t561;
    const double t565 = t146 * t489;
    const double t566 = t565 * t548;
    const double t567 = t552 * t481;
    const double t568 = t551 * t567;
    const double t571 = t146 * t110;
    const double t572 = t537 * t252;
    const double t573 = t572 * t255;
    const double t574 = t571 * t573;
    const double t576 = t551 * t552 * t495;
    const double t581 = 0.5e1 / 0.3e1 * t5 * t378 * t239;
    const double t583 = 0.1e1 / t153 / t152;
    const double t584 = t583 * t158;
    const double t585 = safe_math::pow( 0.4e1, 0.1e1 / 0.6e1 );
    const double t586 = t585 * t167;
    const double t587 = t5 * t377;
    const double t588 = t586 * t587;
    const double t590 = 0.1046175e-1 * t390;
    const double t591 = -0.14816666666666666667e-1 * t588 - t590;
    const double t594 = 0.571528e-1 * t584 * t171 * t591;
    const double t595 = t154 * t58;
    const double t596 = t595 * t423;
    const double t597 = t60 * t166;
    const double t598 = t597 * t170;
    const double t601 = t160 * t405;
    const double t602 = t601 * t164;
    const double t603 = t162 * t271;
    const double t604 = 0.1e1 / t603;
    const double t605 = t161 * t604;
    const double t607 = -0.12e2 * t602 + 0.12e2 * t605;
    const double t608 = t607 * t170;
    const double t611 = t166 * t585;
    const double t612 = t159 * t611;
    const double t614 = 0.1e1 / t15 / t12;
    const double t615 = t614 * t2;
    const double t616 = t4 * t377;
    const double t617 = t615 * t616;
    const double t619 = 0.84681398666666666666e-3 * t612 * t617;
    const double t621 = -0.126595e1 * t588 - t391 - t394 - t399;
    const double t624 = 0.2137e0 * t182 * t621 * t189;
    const double t626 = t377 * t182;
    const double t629 = 0.17808333333333333333e-1 * t625 * t626 * t190;
    const double t630 = t181 * t175;
    const double t631 = 0.1e1 / t630;
    const double t632 = t14 * t631;
    const double t635 = 0.2e1 * t632 * t190 * t621;
    const double t636 = t585 * t614;
    const double t637 = t636 * t587;
    const double t639 = 0.1e1/safe_math::sqrt( t12 );
    const double t640 = t639 * t2;
    const double t641 = t640 * t387;
    const double t644 = 0.25319e1 * t637 - 0.204775e0 * t641 - 0.82156666666666666667e-1 * t390;
    const double t645 = t644 * t189;
    const double t647 = 0.1e1 * t183 * t645;
    const double t648 = t181 * t181;
    const double t649 = 0.1e1 / t648;
    const double t650 = t14 * t649;
    const double t651 = t178 * t178;
    const double t652 = 0.1e1 / t651;
    const double t653 = t188 * t652;
    const double t656 = 0.16081979498692535067e2 * t650 * t653 * t621;
    const double t658 = 0.4e1 * t406 * t230;
    const double t660 = 0.4e1 * t410 * t230;
    const double t661 = t424 * t229;
    const double t664 = -0.235315e1 * t588 - t434 - t435 - t436;
    const double t668 = t377 * t201;
    const double t672 = t200 * t194;
    const double t673 = 0.1e1 / t672;
    const double t674 = t63 * t673;
    const double t681 = 0.47063e1 * t637 - 0.42077500000000000001e0 * t641 - 0.104195e0 * t390;
    const double t682 = t681 * t207;
    const double t685 = t200 * t200;
    const double t686 = 0.1e1 / t685;
    const double t687 = t63 * t686;
    const double t688 = t197 * t197;
    const double t689 = 0.1e1 / t688;
    const double t690 = t206 * t689;
    const double t695 = -0.17261666666666666667e1 * t588 - t449 - t450 - t451;
    const double t697 = t219 * t695 * t225;
    const double t699 = t377 * t219;
    const double t703 = t218 * t212;
    const double t704 = 0.1e1 / t703;
    const double t705 = t76 * t704;
    const double t706 = t226 * t695;
    const double t712 = 0.34523333333333333333e1 * t637 - 0.1100325e0 * t641 - 0.82785e-1 * t390;
    const double t713 = t712 * t225;
    const double t716 = t218 * t218;
    const double t717 = 0.1e1 / t716;
    const double t718 = t76 * t717;
    const double t719 = t215 * t215;
    const double t720 = 0.1e1 / t719;
    const double t721 = t224 * t720;
    const double t722 = t721 * t695;
    const double t725 = 0.20548e0 * t201 * t664 * t207 - 0.17123333333333333333e-1 * t625 * t668 * t208 - 0.2e1 * t674 * t208 * t664 + 0.1e1 * t202 * t682 + 0.32163958997385070134e2 * t687 * t690 * t664 - t624 + t629 + t635 - t647 - t656 + 0.65061487801810439052e-1 * t697 - 0.54217906501508699211e-2 * t625 * t699 * t226 - 0.11696447245269292414e1 * t705 * t706 + 0.5848223622634646207e0 * t220 * t713 + 0.17315859105681463759e2 * t718 * t722;
    const double t726 = t61 * t725;
    const double t727 = t41 * t726;
    const double t731 = 0.65061487801810439052e-1 * t61 * t697;
    const double t732 = t424 * t76;
    const double t735 = t61 * t5;
    const double t736 = t378 * t236;
    const double t738 = 0.54217906501508699211e-2 * t735 * t736;
    const double t739 = t704 * t224;
    const double t740 = t225 * t695;
    const double t741 = t739 * t740;
    const double t743 = 0.11696447245269292414e1 * t234 * t741;
    const double t745 = t219 * t712 * t225;
    const double t747 = 0.5848223622634646207e0 * t234 * t745;
    const double t748 = t717 * t224;
    const double t749 = t720 * t695;
    const double t750 = t748 * t749;
    const double t752 = 0.17315859105681463759e2 * t234 * t750;
    const double t753 = -t594 - 0.675260332e-1 * t596 * t598 + 0.285764e-1 * t159 * t608 + t619 - t624 + t629 + t635 - t647 - t656 - t658 + t660 - t41 * t661 - t727 - 0.21973736767207854065e-2 * t424 * t216 + t731 + 0.5848223622634646207e0 * t732 * t236 - t738 - t743 + t747 + t752;
    const double t757 = t244 * t244;
    const double t758 = 0.1e1 / t757;
    const double t759 = t758 * t158;
    const double t761 = -0.74083333333333333333e-2 * t388 - t590;
    const double t764 = 0.285764e-1 * t759 * t166 * t761;
    const double t765 = t245 * t58;
    const double t766 = t424 * t166;
    const double t771 = t764 + 0.675260332e-1 * t765 * t766 - 0.285764e-1 * t246 * t607 - t381 - t404 - t408 + t412 - t426 - t459 - t461 + t466 + t470;
    const double t774 = 0.5e1 * t5 * t11 * t753 - 0.45e2 * eta * t771 - t581;
    const double t775 = t147 * t774;
    const double t776 = t146 * t775;
    const double t780 = t261 * t513 * t277;
    const double t782 = 0.11557628986739024751e0 * t254 * t780;
    const double t783 = t146 * t147;
    const double t784 = t269 * t122;
    const double t785 = t252 * t784;
    const double t786 = t162 * t8;
    const double t787 = 0.1e1 / t786;
    const double t788 = t787 * t277;
    const double t791 = 0.58218257753910989057e-2 * t783 * t785 * t788;
    const double t792 = -t509 + t516 - t523 - 0.54878743191129263322e-1 * t527 * t531 - 0.27439371595564631661e-1 * t535 * t540 - 0.43341108700271342816e-1 * t549 * t562 - 0.13002332610081402845e0 * t566 * t568 - 0.43341108700271342816e-1 * t574 * t576 + 0.43341108700271342816e-1 * t776 * t279 - t782 + t791;
    const double t795 = t496 + t499 * t792 / 0.4e1;
    const double t797 = 0.1e1 / t287;
    const double t799 = t97 * t106 * t795 * t797;
    const double t800 = rho_a * rho_a;
    const double t802 = 0.1e1 / t292 / t800;
    const double t803 = tau_a * t802;
    const double t806 = t415 / 0.2e1;
    const double t807 = t298 * t806;
    const double t810 = -t806;
    const double t811 = t308 * t810;
    const double t814 = t513 / 0.3e1;
    const double t815 = -0.5e1 / 0.3e1 * t803 * t299 + 0.5e1 / 0.3e1 * t295 * t807 + 0.5e1 / 0.3e1 * t305 * t811 + t814;
    const double t817 = t320 * t320;
    const double t818 = 0.1e1 / t817;
    const double t819 = t312 * t818;
    const double t825 = t317 * t502 / 0.3e1;
    const double t826 = 0.3e1 / 0.1e2 * t313 * ( 0.5e1 / 0.3e1 * t807 + 0.5e1 / 0.3e1 * t811 ) - t825;
    const double t828 = t815 * t321 - t819 * t826;
    const double t829 = piecewise_functor_3( t324, 0.0, t828 );
    const double t832 = t326 * t326;
    const double t833 = 0.1e1 / t832;
    const double t834 = t325 * t833;
    const double t837 = -0.64e0 * t829 * t327 - 0.64e0 * t834 * t829;
    const double t838 = t837 * t330;
    const double t839 = piecewise_functor_3( t332, 0.0, t828 );
    const double t841 = t333 * t839;
    const double t843 = t335 * t839;
    const double t845 = t337 * t839;
    const double t847 = t339 * t839;
    const double t849 = t341 * t839;
    const double t854 = t349 * t349;
    const double t855 = 0.1e1 / t854;
    const double t856 = piecewise_functor_3( t332, t828, 0.0 );
    const double t860 = piecewise_functor_5( t323, t838, t331, -0.64e0 * t839 - 0.8704e0 * t841 - 0.4607056813647e1 * t843 + 0.122462410087e2 * t845 - 0.957855118103e1 * t847 + 0.3101306810232e1 * t849 - 0.362942158544e0 * t343 * t839, -0.105e1 * t855 * t856 * t352 );
    const double t861 = t860 * t374;
    const double t862 = t758 * t761;
    const double t864 = t357 * t366;
    const double t868 = 0.1e1 / t364 / t363;
    const double t869 = t358 * t868;
    const double t870 = t869 * t255;
    const double t874 = -0.1e1 * t862 * t864 - 0.14225094736250905555e-1 * t870 * t550 * t513;
    const double t875 = 0.1e1 / t368;
    const double t878 = 0.285764e-1 * t862 + 0.285764e-1 * t874 * t875;
    const double t879 = t878 * t158;
    const double t880 = t879 * t166;
    const double t881 = t371 * t58;
    const double t885 = t880 - 0.2363e1 * t881 * t766 + t372 * t607 - t381 - t404 - t408 + t412 - t426 - t459 - t461 + t466 + t470 - t484 - t799;
    const double t886 = t354 * t885;
    const double t887 = t381 + t404 + t408 - t412 + t426 + t459 + t461 - t466 - t470 + t484 + t799 + t861 + t886;
    const double t889 = -t42 - t414;
    const double t892 = piecewise_functor_3( t45, 0.0, 0.4e1 / 0.3e1 * t48 * t889 );
    const double t893 = -t889;
    const double t896 = piecewise_functor_3( t52, 0.0, 0.4e1 / 0.3e1 * t53 * t893 );
    const double t897 = t892 + t896;
    const double t898 = t897 * t60;
    const double t899 = t898 * t88;
    const double t900 = t41 * t899;
    const double t901 = t898 * t86;
    const double t902 = 0.19751673498613801407e-1 * t901;
    const double t903 = t472 * t889;
    const double t905 = piecewise_functor_3( t45, 0.0, 0.2e1 / 0.3e1 * t903 );
    const double t906 = t476 * t893;
    const double t908 = piecewise_functor_3( t52, 0.0, 0.2e1 / 0.3e1 * t906 );
    const double t910 = t905 / 0.2e1 + t908 / 0.2e1;
    const double t912 = t97 * t471 * t910;
    const double t913 = 0.3e1 * t912;
    const double t915 = ( t381 + t404 - t408 - t412 + t900 + t459 + t902 - t466 - t470 ) * t108;
    const double t917 = t490 * t910;
    const double t920 = 0.3e1 * t109 * t917 - t915 * t111;
    const double t921 = t920 * t113;
    const double t923 = t506 * t910;
    const double t924 = t529 * t923;
    const double t927 = t538 * t921;
    const double t928 = t529 * t927;
    const double t933 = piecewise_functor_3( t45, 0.0, 0.5e1 / 0.3e1 * t99 * t889 );
    const double t936 = piecewise_functor_3( t52, 0.0, 0.5e1 / 0.3e1 * t101 * t893 );
    const double t938 = t933 / 0.2e1 + t936 / 0.2e1;
    const double t939 = t552 * t938;
    const double t940 = t551 * t939;
    const double t943 = t552 * t910;
    const double t944 = t551 * t943;
    const double t948 = t551 * t552 * t921;
    const double t951 = t595 * t897;
    const double t955 = 0.12e2 * t602 + 0.12e2 * t605;
    const double t956 = t955 * t170;
    const double t959 = t898 * t229;
    const double t963 = t898 * t76;
    const double t966 = -t594 - 0.675260332e-1 * t951 * t598 + 0.285764e-1 * t159 * t956 + t619 - t624 + t629 + t635 - t647 - t656 + t658 + t660 - t41 * t959 - t727 - 0.21973736767207854065e-2 * t898 * t216 + t731 + 0.5848223622634646207e0 * t963 * t236 - t738 - t743 + t747 + t752;
    const double t970 = t898 * t166;
    const double t975 = t764 + 0.675260332e-1 * t765 * t970 - 0.285764e-1 * t246 * t955 - t381 - t404 + t408 + t412 - t900 - t459 - t902 + t466 + t470;
    const double t978 = 0.5e1 * t5 * t11 * t966 - 0.45e2 * eta * t975 - t581;
    const double t979 = t147 * t978;
    const double t980 = t146 * t979;
    const double t983 = -t509 + t516 - t523 - 0.54878743191129263322e-1 * t527 * t924 - 0.27439371595564631661e-1 * t535 * t928 - 0.43341108700271342816e-1 * t549 * t940 - 0.13002332610081402845e0 * t566 * t944 - 0.43341108700271342816e-1 * t574 * t948 + 0.43341108700271342816e-1 * t980 * t279 - t782 + t791;
    const double t986 = t921 * t285 + t499 * t983 / 0.4e1;
    const double t989 = t97 * t106 * t986 * t797;
    const double t990 = t889 / 0.2e1;
    const double t991 = t298 * t990;
    const double t994 = rho_b * rho_b;
    const double t996 = 0.1e1 / t302 / t994;
    const double t997 = tau_b * t996;
    const double t1000 = -t990;
    const double t1001 = t308 * t1000;
    const double t1004 = 0.5e1 / 0.3e1 * t295 * t991 - 0.5e1 / 0.3e1 * t997 * t309 + 0.5e1 / 0.3e1 * t305 * t1001 + t814;
    const double t1010 = 0.3e1 / 0.1e2 * t313 * ( 0.5e1 / 0.3e1 * t991 + 0.5e1 / 0.3e1 * t1001 ) - t825;
    const double t1012 = t1004 * t321 - t819 * t1010;
    const double t1013 = piecewise_functor_3( t324, 0.0, t1012 );
    const double t1018 = -0.64e0 * t1013 * t327 - 0.64e0 * t834 * t1013;
    const double t1019 = t1018 * t330;
    const double t1020 = piecewise_functor_3( t332, 0.0, t1012 );
    const double t1022 = t333 * t1020;
    const double t1024 = t335 * t1020;
    const double t1026 = t337 * t1020;
    const double t1028 = t339 * t1020;
    const double t1030 = t341 * t1020;
    const double t1035 = piecewise_functor_3( t332, t1012, 0.0 );
    const double t1039 = piecewise_functor_5( t323, t1019, t331, -0.64e0 * t1020 - 0.8704e0 * t1022 - 0.4607056813647e1 * t1024 + 0.122462410087e2 * t1026 - 0.957855118103e1 * t1028 + 0.3101306810232e1 * t1030 - 0.362942158544e0 * t343 * t1020, -0.105e1 * t855 * t1035 * t352 );
    const double t1040 = t1039 * t374;
    const double t1044 = t880 - 0.2363e1 * t881 * t970 + t372 * t955 - t381 - t404 + t408 + t412 - t900 - t459 - t902 + t466 + t470 - t913 - t989;
    const double t1045 = t354 * t1044;
    const double t1046 = t381 + t404 - t408 - t412 + t900 + t459 + t902 - t466 - t470 + t913 + t989 + t1040 + t1045;
    const double t1048 = t97 * t106;
    const double t1050 = t528 * t134;
    const double t1051 = t120 * t534 * t1050;
    const double t1053 = t260 * t263;
    const double t1054 = t1053 * t277;
    const double t1055 = t259 * t1054;
    const double t1056 = t254 * t1055;
    const double t1058 = t252 * t269;
    const double t1059 = 0.1e1 / t162;
    const double t1060 = t1059 * t277;
    const double t1062 = t783 * t1058 * t1060;
    const double t1064 = 0.27439371595564631661e-1 * t1051 + 0.43341108700271342816e-1 * t1056 - 0.21831846657716620896e-2 * t1062;
    const double t1065 = t1064 * t797;
    const double t1066 = t499 * t1065;
    const double t1068 = t1048 * t1066 / 0.4e1;
    const double t1070 = eta * t263;
    const double t1072 = -t819 * t1070 - t263 * t321;
    const double t1073 = t1072 / 0.8e1;
    const double t1074 = piecewise_functor_3( t324, 0.0, t1073 );
    const double t1079 = -0.64e0 * t1074 * t327 - 0.64e0 * t834 * t1074;
    const double t1080 = t1079 * t330;
    const double t1081 = piecewise_functor_3( t332, 0.0, t1073 );
    const double t1083 = t333 * t1081;
    const double t1085 = t335 * t1081;
    const double t1087 = t337 * t1081;
    const double t1089 = t339 * t1081;
    const double t1091 = t341 * t1081;
    const double t1096 = piecewise_functor_3( t332, t1073, 0.0 );
    const double t1100 = piecewise_functor_5( t323, t1080, t331, -0.64e0 * t1081 - 0.8704e0 * t1083 - 0.4607056813647e1 * t1085 + 0.122462410087e2 * t1087 - 0.957855118103e1 * t1089 + 0.3101306810232e1 * t1091 - 0.362942158544e0 * t343 * t1081, -0.105e1 * t855 * t1096 * t352 );
    const double t1101 = t1100 * t374;
    const double t1102 = t869 * t259;
    const double t1103 = t875 * t158;
    const double t1104 = t1103 * t166;
    const double t1106 = t1102 * t1053 * t1104;
    const double t1108 = 0.15243824895787514157e-3 * t1106 - t1068;
    const double t1109 = t354 * t1108;
    const double t1114 = 0.54878743191129263322e-1 * t1051 + 0.86682217400542685632e-1 * t1056 - 0.43663693315433241794e-2 * t1062;
    const double t1115 = t1114 * t797;
    const double t1116 = t499 * t1115;
    const double t1118 = t1048 * t1116 / 0.4e1;
    const double t1119 = t1072 / 0.4e1;
    const double t1120 = piecewise_functor_3( t324, 0.0, t1119 );
    const double t1125 = -0.64e0 * t1120 * t327 - 0.64e0 * t834 * t1120;
    const double t1126 = t1125 * t330;
    const double t1127 = piecewise_functor_3( t332, 0.0, t1119 );
    const double t1129 = t333 * t1127;
    const double t1131 = t335 * t1127;
    const double t1133 = t337 * t1127;
    const double t1135 = t339 * t1127;
    const double t1137 = t341 * t1127;
    const double t1142 = piecewise_functor_3( t332, t1119, 0.0 );
    const double t1146 = piecewise_functor_5( t323, t1126, t331, -0.64e0 * t1127 - 0.8704e0 * t1129 - 0.4607056813647e1 * t1131 + 0.122462410087e2 * t1133 - 0.957855118103e1 * t1135 + 0.3101306810232e1 * t1137 - 0.362942158544e0 * t343 * t1127, -0.105e1 * t855 * t1142 * t352 );
    const double t1147 = t1146 * t374;
    const double t1149 = 0.30487649791575028312e-3 * t1106 - t1118;
    const double t1150 = t354 * t1149;
    const double t1152 = t294 * t299;
    const double t1153 = t1152 * t321;
    const double t1154 = piecewise_functor_3( t324, 0.0, t1153 );
    const double t1159 = -0.64e0 * t1154 * t327 - 0.64e0 * t834 * t1154;
    const double t1160 = t1159 * t330;
    const double t1161 = piecewise_functor_3( t332, 0.0, t1153 );
    const double t1163 = t333 * t1161;
    const double t1165 = t335 * t1161;
    const double t1167 = t337 * t1161;
    const double t1169 = t339 * t1161;
    const double t1171 = t341 * t1161;
    const double t1176 = piecewise_functor_3( t332, t1153, 0.0 );
    const double t1180 = piecewise_functor_5( t323, t1160, t331, -0.64e0 * t1161 - 0.8704e0 * t1163 - 0.4607056813647e1 * t1165 + 0.122462410087e2 * t1167 - 0.957855118103e1 * t1169 + 0.3101306810232e1 * t1171 - 0.362942158544e0 * t343 * t1161, -0.105e1 * t855 * t1176 * t352 );
    const double t1181 = t8 * t1180;
    const double t1182 = t304 * t309;
    const double t1183 = t1182 * t321;
    const double t1184 = piecewise_functor_3( t324, 0.0, t1183 );
    const double t1189 = -0.64e0 * t1184 * t327 - 0.64e0 * t834 * t1184;
    const double t1190 = t1189 * t330;
    const double t1191 = piecewise_functor_3( t332, 0.0, t1183 );
    const double t1193 = t333 * t1191;
    const double t1195 = t335 * t1191;
    const double t1197 = t337 * t1191;
    const double t1199 = t339 * t1191;
    const double t1201 = t341 * t1191;
    const double t1206 = piecewise_functor_3( t332, t1183, 0.0 );
    const double t1210 = piecewise_functor_5( t323, t1190, t331, -0.64e0 * t1191 - 0.8704e0 * t1193 - 0.4607056813647e1 * t1195 + 0.122462410087e2 * t1197 - 0.957855118103e1 * t1199 + 0.3101306810232e1 * t1201 - 0.362942158544e0 * t343 * t1191, -0.105e1 * t855 * t1206 * t352 );
    const double t1211 = t8 * t1210;


    eps = -t34 + t90 + t92 + t290 + t375;
    vrho_a = t8 * t887 + t290 - t34 + t375 + t90 + t92;
    vrho_b = t8 * t1046 + t290 - t34 + t375 + t90 + t92;
    vsigma_aa = t8 * ( t1068 + t1101 + t1109 );
    vsigma_ab = t8 * ( t1118 + t1147 + t1150 );
    vsigma_bb = vsigma_aa;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t1181 * t374;
    vtau_b = t1211 * t374;

  }


};

struct BuiltinR2SCAN_C : detail::BuiltinKernelImpl< BuiltinR2SCAN_C > {

  BuiltinR2SCAN_C( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinR2SCAN_C >(p) { }
  
  virtual ~BuiltinR2SCAN_C() = default;

};



} // namespace ExchCXX