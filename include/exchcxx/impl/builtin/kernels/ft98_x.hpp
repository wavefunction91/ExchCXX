#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinFT98_X > :
  public mgga_screening_interface< BuiltinFT98_X > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = true;
  static constexpr bool is_kedf = false;
  static constexpr bool is_epc  = false;

  static constexpr double dens_tol  = 1e-12;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000021e-16;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = false;
  static constexpr double exx_coeff = 0.0;

  static constexpr double a = 0.00528014;
  static constexpr double b = 0.00003904539;
  static constexpr double a1 = 2.816049;
  static constexpr double a2 = 0.879058;
  static constexpr double b1 = 0.398773;
  static constexpr double b2 = 66.364138;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(tau);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_2;
    constexpr double t128 = constants::m_cbrt_one_ov_pi;
    constexpr double t131 = constants::m_cbrt_4;
    constexpr double t6 = 0.1e1 / t5;
    constexpr double t7 = t4 * t6;
    constexpr double t23 = t22 * t22;
    constexpr double t57 = b2 * b2;
    constexpr double t115 = t22 - 0.1e1;
    constexpr double t126 = t4 * t4;
    constexpr double t129 = t128 * t128;
    constexpr double t130 = t126 * t129;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t21 = a1 * sigma;
    const double t24 = rho * rho;
    const double t25 = t19 * t19;
    const double t27 = 0.1e1 / t25 / t24;
    const double t28 = t23 * t27;
    const double t30 = t21 * t28 + 0.1e1;
    const double t31 = safe_math::sqrt( t30 );
    const double t32 = a * t31;
    const double t33 = b1 * sigma;
    const double t35 = t33 * t28 + 0.1e1;
    const double t36 = pow_1_4( t35 );
    const double t37 = t36 * t36;
    const double t38 = t37 * t36;
    const double t39 = 0.1e1 / t38;
    const double t40 = t32 * t39;
    const double t41 = sigma * t23;
    const double t42 = t41 * t27;
    const double t44 = lapl * t23;
    const double t46 = 0.1e1 / t25 / rho;
    const double t48 = -t44 * t46 + t42;
    const double t49 = t48 * t48;
    const double t50 = a2 * t49;
    const double t51 = 0.1e1 + t42;
    const double t52 = t51 * t51;
    const double t53 = 0.1e1 / t52;
    const double t56 = b * ( t50 * t53 + 0.1e1 );
    const double t59 = safe_math::sqrt( t57 + 0.1e1 );
    const double t60 = t59 - b2;
    const double t61 = sigma * sigma;
    const double t62 = t61 * t22;
    const double t63 = t24 * t24;
    const double t64 = t63 * rho;
    const double t66 = 0.1e1 / t19 / t64;
    const double t67 = t62 * t66;
    const double t68 = 0.2e1 * t67;
    const double t69 = lapl * lapl;
    const double t70 = t69 * t22;
    const double t71 = t24 * rho;
    const double t73 = 0.1e1 / t19 / t71;
    const double t74 = t70 * t73;
    const double t75 = 0.2e1 * t74;
    const double t76 = t68 - t75 - b2;
    const double t77 = pow_1_4( DBL_EPSILON );
    const double t78 = 0.1e1 / t77;
    const double t79 = t76 < -t78;
    const double t85 = t76 * t76;
    const double t86 = t85 * t76;
    const double t87 = 0.1e1 / t86;
    const double t89 = t85 * t85;
    const double t90 = t89 * t76;
    const double t91 = 0.1e1 / t90;
    const double t96 = piecewise_functor_3( 0.e0 < t76, t76, -t76 );
    const double t97 = t96 < t77;
    const double t100 = t89 * t85;
    const double t102 = t89 * t89;
    const double t105 = -t78 < t76;
    const double t106 = piecewise_functor_3( t105, t76, -t78 );
    const double t107 = t106 * t106;
    const double t108 = 0.1e1 + t107;
    const double t109 = safe_math::sqrt( t108 );
    const double t110 = t106 + t109;
    const double t112 = piecewise_functor_5( t79, -0.4e1 * t67 + 0.4e1 * t74 + 0.2e1 * b2 - 0.1e1 / t76 / 0.2e1 + t87 / 0.8e1 - t91 / 0.16e2, t97, 0.1e1 - t68 + t75 + b2 + t85 / 0.2e1 - t89 / 0.8e1 + t100 / 0.16e2 - 0.5e1 / 0.128e3 * t102, 0.1e1 / t110 );
    const double t114 = t60 * t112 + 0.1e1;
    const double t116 = t115 * t60;
    const double t118 = t116 * t112 + 0.1e1;
    const double t119 = t118 * t118;
    const double t120 = t119 * t118;
    const double t121 = 0.1e1 / t120;
    const double t122 = t114 * t121;
    const double t123 = t122 * t49;
    const double t125 = t56 * t123 + t40 * t42 + 0.1e1;
    const double t133 = b * sigma;
    const double t137 = 0.1e1 + 0.81e2 / 0.4e1 * t130 * t131 * t133 * t28;
    const double t138 = 0.1e1 / t137;
    const double t139 = t125 * t138;
    const double t140 = safe_math::sqrt( t139 );
    const double t144 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t140 );


    eps = 0.2e1 * t144;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(tau);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_2;
    constexpr double t128 = constants::m_cbrt_one_ov_pi;
    constexpr double t131 = constants::m_cbrt_4;
    constexpr double t6 = 0.1e1 / t5;
    constexpr double t7 = t4 * t6;
    constexpr double t23 = t22 * t22;
    constexpr double t57 = b2 * b2;
    constexpr double t115 = t22 - 0.1e1;
    constexpr double t126 = t4 * t4;
    constexpr double t129 = t128 * t128;
    constexpr double t130 = t126 * t129;
    constexpr double t252 = t131 * b;
    constexpr double t338 = b * a2;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t21 = a1 * sigma;
    const double t24 = rho * rho;
    const double t25 = t19 * t19;
    const double t27 = 0.1e1 / t25 / t24;
    const double t28 = t23 * t27;
    const double t30 = t21 * t28 + 0.1e1;
    const double t31 = safe_math::sqrt( t30 );
    const double t32 = a * t31;
    const double t33 = b1 * sigma;
    const double t35 = t33 * t28 + 0.1e1;
    const double t36 = pow_1_4( t35 );
    const double t37 = t36 * t36;
    const double t38 = t37 * t36;
    const double t39 = 0.1e1 / t38;
    const double t40 = t32 * t39;
    const double t41 = sigma * t23;
    const double t42 = t41 * t27;
    const double t44 = lapl * t23;
    const double t46 = 0.1e1 / t25 / rho;
    const double t48 = -t44 * t46 + t42;
    const double t49 = t48 * t48;
    const double t50 = a2 * t49;
    const double t51 = 0.1e1 + t42;
    const double t52 = t51 * t51;
    const double t53 = 0.1e1 / t52;
    const double t56 = b * ( t50 * t53 + 0.1e1 );
    const double t59 = safe_math::sqrt( t57 + 0.1e1 );
    const double t60 = t59 - b2;
    const double t61 = sigma * sigma;
    const double t62 = t61 * t22;
    const double t63 = t24 * t24;
    const double t64 = t63 * rho;
    const double t66 = 0.1e1 / t19 / t64;
    const double t67 = t62 * t66;
    const double t68 = 0.2e1 * t67;
    const double t69 = lapl * lapl;
    const double t70 = t69 * t22;
    const double t71 = t24 * rho;
    const double t73 = 0.1e1 / t19 / t71;
    const double t74 = t70 * t73;
    const double t75 = 0.2e1 * t74;
    const double t76 = t68 - t75 - b2;
    const double t77 = pow_1_4( DBL_EPSILON );
    const double t78 = 0.1e1 / t77;
    const double t79 = t76 < -t78;
    const double t85 = t76 * t76;
    const double t86 = t85 * t76;
    const double t87 = 0.1e1 / t86;
    const double t89 = t85 * t85;
    const double t90 = t89 * t76;
    const double t91 = 0.1e1 / t90;
    const double t96 = piecewise_functor_3( 0.e0 < t76, t76, -t76 );
    const double t97 = t96 < t77;
    const double t100 = t89 * t85;
    const double t102 = t89 * t89;
    const double t105 = -t78 < t76;
    const double t106 = piecewise_functor_3( t105, t76, -t78 );
    const double t107 = t106 * t106;
    const double t108 = 0.1e1 + t107;
    const double t109 = safe_math::sqrt( t108 );
    const double t110 = t106 + t109;
    const double t112 = piecewise_functor_5( t79, -0.4e1 * t67 + 0.4e1 * t74 + 0.2e1 * b2 - 0.1e1 / t76 / 0.2e1 + t87 / 0.8e1 - t91 / 0.16e2, t97, 0.1e1 - t68 + t75 + b2 + t85 / 0.2e1 - t89 / 0.8e1 + t100 / 0.16e2 - 0.5e1 / 0.128e3 * t102, 0.1e1 / t110 );
    const double t114 = t60 * t112 + 0.1e1;
    const double t116 = t115 * t60;
    const double t118 = t116 * t112 + 0.1e1;
    const double t119 = t118 * t118;
    const double t120 = t119 * t118;
    const double t121 = 0.1e1 / t120;
    const double t122 = t114 * t121;
    const double t123 = t122 * t49;
    const double t125 = t56 * t123 + t40 * t42 + 0.1e1;
    const double t133 = b * sigma;
    const double t137 = 0.1e1 + 0.81e2 / 0.4e1 * t130 * t131 * t133 * t28;
    const double t138 = 0.1e1 / t137;
    const double t139 = t125 * t138;
    const double t140 = safe_math::sqrt( t139 );
    const double t144 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t140 );
    const double t145 = 0.1e1 / t25;
    const double t146 = t18 * t145;
    const double t150 = t7 * t18;
    const double t151 = 0.1e1 / t140;
    const double t152 = t19 * t151;
    const double t154 = a / t31;
    const double t155 = t154 * t39;
    const double t156 = t63 * t24;
    const double t158 = 0.1e1 / t19 / t156;
    const double t159 = t158 * a1;
    const double t164 = 0.1e1 / t38 / t35;
    const double t165 = t32 * t164;
    const double t166 = t158 * b1;
    const double t171 = 0.1e1 / t25 / t71;
    const double t172 = t41 * t171;
    const double t175 = a2 * t48;
    const double t179 = -0.8e1 / 0.3e1 * t172 + 0.5e1 / 0.3e1 * t44 * t27;
    const double t184 = 0.1e1 / t52 / t51;
    const double t185 = t50 * t184;
    const double t189 = b * ( 0.2e1 * t175 * t53 * t179 + 0.16e2 / 0.3e1 * t185 * t172 );
    const double t191 = t56 * t60;
    const double t192 = t62 * t158;
    const double t195 = 0.1e1 / t19 / t63;
    const double t196 = t70 * t195;
    const double t198 = 0.1e1 / t85;
    const double t199 = 0.32e2 / 0.3e1 * t192;
    const double t200 = 0.2e2 / 0.3e1 * t196;
    const double t201 = -t199 + t200;
    const double t204 = 0.1e1 / t89;
    const double t207 = 0.1e1 / t100;
    const double t216 = t89 * t86;
    const double t220 = t110 * t110;
    const double t221 = 0.1e1 / t220;
    const double t222 = piecewise_functor_3( t105, t201, 0.0 );
    const double t223 = 0.1e1 / t109;
    const double t224 = t223 * t106;
    const double t226 = t224 * t222 + t222;
    const double t228 = piecewise_functor_5( t79, 0.64e2 / 0.3e1 * t192 - 0.4e2 / 0.3e1 * t196 + t198 * t201 / 0.2e1 - 0.3e1 / 0.8e1 * t204 * t201 + 0.5e1 / 0.16e2 * t207 * t201, t97, t199 - t200 + t76 * t201 - t86 * t201 / 0.2e1 + 0.3e1 / 0.8e1 * t90 * t201 - 0.5e1 / 0.16e2 * t216 * t201, -t221 * t226 );
    const double t229 = t228 * t121;
    const double t230 = t229 * t49;
    const double t232 = t119 * t119;
    const double t233 = 0.1e1 / t232;
    const double t234 = t114 * t233;
    const double t235 = t56 * t234;
    const double t236 = t49 * t115;
    const double t237 = t60 * t228;
    const double t238 = t236 * t237;
    const double t241 = t56 * t114;
    const double t242 = t121 * t48;
    const double t243 = t242 * t179;
    const double t246 = -0.8e1 / 0.3e1 * t155 * t62 * t159 + 0.4e1 * t165 * t62 * t166 - 0.8e1 / 0.3e1 * t40 * t172 + t189 * t123 + t191 * t230 - 0.3e1 * t235 * t238 + 0.2e1 * t241 * t243;
    const double t248 = t137 * t137;
    const double t249 = 0.1e1 / t248;
    const double t251 = t125 * t249 * t130;
    const double t253 = t252 * t172;
    const double t256 = t246 * t138 + 0.54e2 * t251 * t253;
    const double t261 = piecewise_functor_3( t3, 0.0, -t7 * t146 * t140 / 0.8e1 - 0.3e1 / 0.16e2 * t150 * t152 * t256 );
    const double t264 = sigma * t22;
    const double t272 = t39 * t23;
    const double t275 = t53 * t23;
    const double t276 = t275 * t27;
    const double t278 = t184 * t23;
    const double t279 = t278 * t27;
    const double t283 = b * ( 0.2e1 * t175 * t276 - 0.2e1 * t50 * t279 );
    const double t285 = t264 * t66;
    const double t287 = t198 * sigma;
    const double t288 = t22 * t66;
    const double t291 = t204 * sigma;
    const double t294 = t207 * sigma;
    const double t298 = 0.4e1 * t285;
    const double t299 = t76 * sigma;
    const double t302 = t86 * sigma;
    const double t305 = t90 * sigma;
    const double t308 = t216 * sigma;
    const double t312 = piecewise_functor_3( t105, t298, 0.0 );
    const double t314 = t224 * t312 + t312;
    const double t316 = piecewise_functor_5( t79, -0.8e1 * t285 + 0.2e1 * t287 * t288 - 0.3e1 / 0.2e1 * t291 * t288 + 0.5e1 / 0.4e1 * t294 * t288, t97, -t298 + 0.4e1 * t299 * t288 - 0.2e1 * t302 * t288 + 0.3e1 / 0.2e1 * t305 * t288 - 0.5e1 / 0.4e1 * t308 * t288, -t221 * t314 );
    const double t317 = t316 * t121;
    const double t318 = t317 * t49;
    const double t320 = t60 * t316;
    const double t321 = t236 * t320;
    const double t324 = t242 * t28;
    const double t325 = t241 * t324;
    const double t327 = t155 * t264 * t66 * a1 - 0.3e1 / 0.2e1 * t165 * t264 * t66 * b1 + t32 * t272 * t27 + t283 * t123 + t191 * t318 - 0.3e1 * t235 * t321 + 0.2e1 * t325;
    const double t329 = t252 * t28;
    const double t332 = t327 * t138 - 0.81e2 / 0.4e1 * t251 * t329;
    const double t336 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.16e2 * t150 * t152 * t332 );
    const double t339 = t49 * t48;
    const double t340 = t339 * t53;
    const double t341 = t338 * t340;
    const double t342 = t23 * t46;
    const double t343 = t342 * t122;
    const double t346 = lapl * t22;
    const double t347 = t346 * t73;
    const double t349 = t198 * lapl;
    const double t350 = t22 * t73;
    const double t353 = t204 * lapl;
    const double t356 = t207 * lapl;
    const double t360 = 0.4e1 * t347;
    const double t361 = t76 * lapl;
    const double t364 = t86 * lapl;
    const double t367 = t90 * lapl;
    const double t370 = t216 * lapl;
    const double t374 = piecewise_functor_3( t105, -t360, 0.0 );
    const double t376 = t224 * t374 + t374;
    const double t378 = piecewise_functor_5( t79, 0.8e1 * t347 - 0.2e1 * t349 * t350 + 0.3e1 / 0.2e1 * t353 * t350 - 0.5e1 / 0.4e1 * t356 * t350, t97, t360 - 0.4e1 * t361 * t350 + 0.2e1 * t364 * t350 - 0.3e1 / 0.2e1 * t367 * t350 + 0.5e1 / 0.4e1 * t370 * t350, -t221 * t376 );
    const double t379 = t378 * t121;
    const double t380 = t379 * t49;
    const double t382 = t60 * t378;
    const double t383 = t236 * t382;
    const double t386 = t242 * t342;
    const double t389 = t191 * t380 - 0.3e1 * t235 * t383 - 0.2e1 * t241 * t386 - 0.2e1 * t341 * t343;
    const double t390 = t389 * t138;
    const double t394 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.16e2 * t150 * t152 * t390 );


    eps = 0.2e1 * t144;
    vrho = 0.2e1 * rho * t261 + 0.2e1 * t144;
    vsigma = 0.2e1 * rho * t336;
    vlapl = 0.2e1 * rho * t394;
    vtau = 0.e0;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(sigma_ab);
    (void)(tau_a);
    (void)(tau_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t116 = constants::m_cbrt_2;
    constexpr double t130 = constants::m_cbrt_one_ov_pi;
    constexpr double t133 = constants::m_cbrt_4;
    constexpr double t5 = 0.1e1 / t4;
    constexpr double t6 = t3 * t5;
    constexpr double t62 = b2 * b2;
    constexpr double t83 = 0.2e1 * b2;
    constexpr double t117 = t116 - 0.1e1;
    constexpr double t128 = t3 * t3;
    constexpr double t131 = t130 * t130;
    constexpr double t132 = t128 * t131;
    constexpr double t134 = t132 * t133;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t30 = rho_a * rho_a;
    const double t31 = safe_math::cbrt( rho_a );
    const double t32 = t31 * t31;
    const double t34 = 0.1e1 / t32 / t30;
    const double t36 = a1 * sigma_aa * t34 + 0.1e1;
    const double t37 = safe_math::sqrt( t36 );
    const double t38 = a * t37;
    const double t39 = b1 * sigma_aa;
    const double t41 = t39 * t34 + 0.1e1;
    const double t42 = pow_1_4( t41 );
    const double t43 = t42 * t42;
    const double t44 = t43 * t42;
    const double t45 = 0.1e1 / t44;
    const double t46 = t45 * sigma_aa;
    const double t49 = sigma_aa * t34;
    const double t51 = 0.1e1 / t32 / rho_a;
    const double t53 = -lapl_a * t51 + t49;
    const double t54 = t53 * t53;
    const double t55 = a2 * t54;
    const double t56 = 0.1e1 + t49;
    const double t57 = t56 * t56;
    const double t58 = 0.1e1 / t57;
    const double t61 = b * ( t55 * t58 + 0.1e1 );
    const double t64 = safe_math::sqrt( t62 + 0.1e1 );
    const double t65 = t64 - b2;
    const double t66 = sigma_aa * sigma_aa;
    const double t67 = t30 * t30;
    const double t68 = t67 * rho_a;
    const double t70 = 0.1e1 / t31 / t68;
    const double t71 = t66 * t70;
    const double t72 = lapl_a * lapl_a;
    const double t73 = t30 * rho_a;
    const double t75 = 0.1e1 / t31 / t73;
    const double t76 = t72 * t75;
    const double t77 = t71 - t76 - b2;
    const double t78 = pow_1_4( DBL_EPSILON );
    const double t79 = 0.1e1 / t78;
    const double t80 = t77 < -t79;
    const double t86 = t77 * t77;
    const double t87 = t86 * t77;
    const double t88 = 0.1e1 / t87;
    const double t90 = t86 * t86;
    const double t91 = t90 * t77;
    const double t92 = 0.1e1 / t91;
    const double t97 = piecewise_functor_3( 0.e0 < t77, t77, -t77 );
    const double t98 = t97 < t78;
    const double t101 = t90 * t86;
    const double t103 = t90 * t90;
    const double t106 = -t79 < t77;
    const double t107 = piecewise_functor_3( t106, t77, -t79 );
    const double t108 = t107 * t107;
    const double t109 = 0.1e1 + t108;
    const double t110 = safe_math::sqrt( t109 );
    const double t111 = t107 + t110;
    const double t113 = piecewise_functor_5( t80, -0.2e1 * t71 + 0.2e1 * t76 + t83 - 0.1e1 / t77 / 0.2e1 + t88 / 0.8e1 - t92 / 0.16e2, t98, 0.1e1 - t71 + t76 + b2 + t86 / 0.2e1 - t90 / 0.8e1 + t101 / 0.16e2 - 0.5e1 / 0.128e3 * t103, 0.1e1 / t111 );
    const double t115 = t65 * t113 + 0.1e1;
    const double t118 = t117 * t65;
    const double t120 = t118 * t113 + 0.1e1;
    const double t121 = t120 * t120;
    const double t122 = t121 * t120;
    const double t123 = 0.1e1 / t122;
    const double t124 = t115 * t123;
    const double t125 = t124 * t54;
    const double t127 = t38 * t46 * t34 + t61 * t125 + 0.1e1;
    const double t135 = b * sigma_aa;
    const double t139 = 0.1e1 + 0.81e2 / 0.4e1 * t134 * t135 * t34;
    const double t140 = 0.1e1 / t139;
    const double t141 = t127 * t140;
    const double t142 = safe_math::sqrt( t141 );
    const double t146 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t142 );
    const double t147 = rho_b <= dens_tol;
    const double t148 = -t17;
    const double t150 = piecewise_functor_5( t15, t12, t11, t16, t148 * t8 );
    const double t151 = 0.1e1 + t150;
    const double t152 = t151 <= zeta_tol;
    const double t153 = safe_math::cbrt( t151 );
    const double t155 = piecewise_functor_3( t152, t23, t153 * t151 );
    const double t156 = t155 * t27;
    const double t158 = rho_b * rho_b;
    const double t159 = safe_math::cbrt( rho_b );
    const double t160 = t159 * t159;
    const double t162 = 0.1e1 / t160 / t158;
    const double t164 = a1 * sigma_bb * t162 + 0.1e1;
    const double t165 = safe_math::sqrt( t164 );
    const double t166 = a * t165;
    const double t167 = b1 * sigma_bb;
    const double t169 = t167 * t162 + 0.1e1;
    const double t170 = pow_1_4( t169 );
    const double t171 = t170 * t170;
    const double t172 = t171 * t170;
    const double t173 = 0.1e1 / t172;
    const double t174 = t173 * sigma_bb;
    const double t177 = sigma_bb * t162;
    const double t179 = 0.1e1 / t160 / rho_b;
    const double t181 = -lapl_b * t179 + t177;
    const double t182 = t181 * t181;
    const double t183 = a2 * t182;
    const double t184 = 0.1e1 + t177;
    const double t185 = t184 * t184;
    const double t186 = 0.1e1 / t185;
    const double t189 = b * ( t183 * t186 + 0.1e1 );
    const double t190 = sigma_bb * sigma_bb;
    const double t191 = t158 * t158;
    const double t192 = t191 * rho_b;
    const double t194 = 0.1e1 / t159 / t192;
    const double t195 = t190 * t194;
    const double t196 = lapl_b * lapl_b;
    const double t197 = t158 * rho_b;
    const double t199 = 0.1e1 / t159 / t197;
    const double t200 = t196 * t199;
    const double t201 = t195 - t200 - b2;
    const double t202 = t201 < -t79;
    const double t207 = t201 * t201;
    const double t208 = t207 * t201;
    const double t209 = 0.1e1 / t208;
    const double t211 = t207 * t207;
    const double t212 = t211 * t201;
    const double t213 = 0.1e1 / t212;
    const double t218 = piecewise_functor_3( 0.e0 < t201, t201, -t201 );
    const double t219 = t218 < t78;
    const double t222 = t211 * t207;
    const double t224 = t211 * t211;
    const double t227 = -t79 < t201;
    const double t228 = piecewise_functor_3( t227, t201, -t79 );
    const double t229 = t228 * t228;
    const double t230 = 0.1e1 + t229;
    const double t231 = safe_math::sqrt( t230 );
    const double t232 = t228 + t231;
    const double t234 = piecewise_functor_5( t202, -0.2e1 * t195 + 0.2e1 * t200 + t83 - 0.1e1 / t201 / 0.2e1 + t209 / 0.8e1 - t213 / 0.16e2, t219, 0.1e1 - t195 + t200 + b2 + t207 / 0.2e1 - t211 / 0.8e1 + t222 / 0.16e2 - 0.5e1 / 0.128e3 * t224, 0.1e1 / t232 );
    const double t236 = t65 * t234 + 0.1e1;
    const double t238 = t118 * t234 + 0.1e1;
    const double t239 = t238 * t238;
    const double t240 = t239 * t238;
    const double t241 = 0.1e1 / t240;
    const double t242 = t236 * t241;
    const double t243 = t242 * t182;
    const double t245 = t166 * t174 * t162 + t189 * t243 + 0.1e1;
    const double t246 = b * sigma_bb;
    const double t250 = 0.1e1 + 0.81e2 / 0.4e1 * t134 * t246 * t162;
    const double t251 = 0.1e1 / t250;
    const double t252 = t245 * t251;
    const double t253 = safe_math::sqrt( t252 );
    const double t257 = piecewise_functor_3( t147, 0.0, -0.3e1 / 0.8e1 * t6 * t156 * t253 );


    eps = t146 + t257;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(sigma_ab);
    (void)(tau_a);
    (void)(tau_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t116 = constants::m_cbrt_2;
    constexpr double t130 = constants::m_cbrt_one_ov_pi;
    constexpr double t133 = constants::m_cbrt_4;
    constexpr double t5 = 0.1e1 / t4;
    constexpr double t6 = t3 * t5;
    constexpr double t62 = b2 * b2;
    constexpr double t83 = 0.2e1 * b2;
    constexpr double t117 = t116 - 0.1e1;
    constexpr double t128 = t3 * t3;
    constexpr double t131 = t130 * t130;
    constexpr double t132 = t128 * t131;
    constexpr double t134 = t132 * t133;
    constexpr double t378 = t133 * b;
    constexpr double t597 = t131 * t133;
    constexpr double t674 = b * a2;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t30 = rho_a * rho_a;
    const double t31 = safe_math::cbrt( rho_a );
    const double t32 = t31 * t31;
    const double t34 = 0.1e1 / t32 / t30;
    const double t36 = a1 * sigma_aa * t34 + 0.1e1;
    const double t37 = safe_math::sqrt( t36 );
    const double t38 = a * t37;
    const double t39 = b1 * sigma_aa;
    const double t41 = t39 * t34 + 0.1e1;
    const double t42 = pow_1_4( t41 );
    const double t43 = t42 * t42;
    const double t44 = t43 * t42;
    const double t45 = 0.1e1 / t44;
    const double t46 = t45 * sigma_aa;
    const double t49 = sigma_aa * t34;
    const double t51 = 0.1e1 / t32 / rho_a;
    const double t53 = -lapl_a * t51 + t49;
    const double t54 = t53 * t53;
    const double t55 = a2 * t54;
    const double t56 = 0.1e1 + t49;
    const double t57 = t56 * t56;
    const double t58 = 0.1e1 / t57;
    const double t61 = b * ( t55 * t58 + 0.1e1 );
    const double t64 = safe_math::sqrt( t62 + 0.1e1 );
    const double t65 = t64 - b2;
    const double t66 = sigma_aa * sigma_aa;
    const double t67 = t30 * t30;
    const double t68 = t67 * rho_a;
    const double t70 = 0.1e1 / t31 / t68;
    const double t71 = t66 * t70;
    const double t72 = lapl_a * lapl_a;
    const double t73 = t30 * rho_a;
    const double t75 = 0.1e1 / t31 / t73;
    const double t76 = t72 * t75;
    const double t77 = t71 - t76 - b2;
    const double t78 = pow_1_4( DBL_EPSILON );
    const double t79 = 0.1e1 / t78;
    const double t80 = t77 < -t79;
    const double t86 = t77 * t77;
    const double t87 = t86 * t77;
    const double t88 = 0.1e1 / t87;
    const double t90 = t86 * t86;
    const double t91 = t90 * t77;
    const double t92 = 0.1e1 / t91;
    const double t97 = piecewise_functor_3( 0.e0 < t77, t77, -t77 );
    const double t98 = t97 < t78;
    const double t101 = t90 * t86;
    const double t103 = t90 * t90;
    const double t106 = -t79 < t77;
    const double t107 = piecewise_functor_3( t106, t77, -t79 );
    const double t108 = t107 * t107;
    const double t109 = 0.1e1 + t108;
    const double t110 = safe_math::sqrt( t109 );
    const double t111 = t107 + t110;
    const double t113 = piecewise_functor_5( t80, -0.2e1 * t71 + 0.2e1 * t76 + t83 - 0.1e1 / t77 / 0.2e1 + t88 / 0.8e1 - t92 / 0.16e2, t98, 0.1e1 - t71 + t76 + b2 + t86 / 0.2e1 - t90 / 0.8e1 + t101 / 0.16e2 - 0.5e1 / 0.128e3 * t103, 0.1e1 / t111 );
    const double t115 = t65 * t113 + 0.1e1;
    const double t118 = t117 * t65;
    const double t120 = t118 * t113 + 0.1e1;
    const double t121 = t120 * t120;
    const double t122 = t121 * t120;
    const double t123 = 0.1e1 / t122;
    const double t124 = t115 * t123;
    const double t125 = t124 * t54;
    const double t127 = t38 * t46 * t34 + t61 * t125 + 0.1e1;
    const double t135 = b * sigma_aa;
    const double t139 = 0.1e1 + 0.81e2 / 0.4e1 * t134 * t135 * t34;
    const double t140 = 0.1e1 / t139;
    const double t141 = t127 * t140;
    const double t142 = safe_math::sqrt( t141 );
    const double t146 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t142 );
    const double t147 = rho_b <= dens_tol;
    const double t148 = -t17;
    const double t150 = piecewise_functor_5( t15, t12, t11, t16, t148 * t8 );
    const double t151 = 0.1e1 + t150;
    const double t152 = t151 <= zeta_tol;
    const double t153 = safe_math::cbrt( t151 );
    const double t155 = piecewise_functor_3( t152, t23, t153 * t151 );
    const double t156 = t155 * t27;
    const double t158 = rho_b * rho_b;
    const double t159 = safe_math::cbrt( rho_b );
    const double t160 = t159 * t159;
    const double t162 = 0.1e1 / t160 / t158;
    const double t164 = a1 * sigma_bb * t162 + 0.1e1;
    const double t165 = safe_math::sqrt( t164 );
    const double t166 = a * t165;
    const double t167 = b1 * sigma_bb;
    const double t169 = t167 * t162 + 0.1e1;
    const double t170 = pow_1_4( t169 );
    const double t171 = t170 * t170;
    const double t172 = t171 * t170;
    const double t173 = 0.1e1 / t172;
    const double t174 = t173 * sigma_bb;
    const double t177 = sigma_bb * t162;
    const double t179 = 0.1e1 / t160 / rho_b;
    const double t181 = -lapl_b * t179 + t177;
    const double t182 = t181 * t181;
    const double t183 = a2 * t182;
    const double t184 = 0.1e1 + t177;
    const double t185 = t184 * t184;
    const double t186 = 0.1e1 / t185;
    const double t189 = b * ( t183 * t186 + 0.1e1 );
    const double t190 = sigma_bb * sigma_bb;
    const double t191 = t158 * t158;
    const double t192 = t191 * rho_b;
    const double t194 = 0.1e1 / t159 / t192;
    const double t195 = t190 * t194;
    const double t196 = lapl_b * lapl_b;
    const double t197 = t158 * rho_b;
    const double t199 = 0.1e1 / t159 / t197;
    const double t200 = t196 * t199;
    const double t201 = t195 - t200 - b2;
    const double t202 = t201 < -t79;
    const double t207 = t201 * t201;
    const double t208 = t207 * t201;
    const double t209 = 0.1e1 / t208;
    const double t211 = t207 * t207;
    const double t212 = t211 * t201;
    const double t213 = 0.1e1 / t212;
    const double t218 = piecewise_functor_3( 0.e0 < t201, t201, -t201 );
    const double t219 = t218 < t78;
    const double t222 = t211 * t207;
    const double t224 = t211 * t211;
    const double t227 = -t79 < t201;
    const double t228 = piecewise_functor_3( t227, t201, -t79 );
    const double t229 = t228 * t228;
    const double t230 = 0.1e1 + t229;
    const double t231 = safe_math::sqrt( t230 );
    const double t232 = t228 + t231;
    const double t234 = piecewise_functor_5( t202, -0.2e1 * t195 + 0.2e1 * t200 + t83 - 0.1e1 / t201 / 0.2e1 + t209 / 0.8e1 - t213 / 0.16e2, t219, 0.1e1 - t195 + t200 + b2 + t207 / 0.2e1 - t211 / 0.8e1 + t222 / 0.16e2 - 0.5e1 / 0.128e3 * t224, 0.1e1 / t232 );
    const double t236 = t65 * t234 + 0.1e1;
    const double t238 = t118 * t234 + 0.1e1;
    const double t239 = t238 * t238;
    const double t240 = t239 * t238;
    const double t241 = 0.1e1 / t240;
    const double t242 = t236 * t241;
    const double t243 = t242 * t182;
    const double t245 = t166 * t174 * t162 + t189 * t243 + 0.1e1;
    const double t246 = b * sigma_bb;
    const double t250 = 0.1e1 + 0.81e2 / 0.4e1 * t134 * t246 * t162;
    const double t251 = 0.1e1 / t250;
    const double t252 = t245 * t251;
    const double t253 = safe_math::sqrt( t252 );
    const double t257 = piecewise_functor_3( t147, 0.0, -0.3e1 / 0.8e1 * t6 * t156 * t253 );
    const double t258 = t7 * t7;
    const double t259 = 0.1e1 / t258;
    const double t260 = t17 * t259;
    const double t262 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t260 );
    const double t265 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t262 );
    const double t266 = t265 * t27;
    const double t270 = t27 * t27;
    const double t271 = 0.1e1 / t270;
    const double t272 = t26 * t271;
    const double t275 = t6 * t272 * t142 / 0.8e1;
    const double t276 = t6 * t26;
    const double t277 = 0.1e1 / t142;
    const double t278 = t27 * t277;
    const double t280 = a / t37;
    const double t281 = t280 * t45;
    const double t282 = t67 * t30;
    const double t284 = 0.1e1 / t31 / t282;
    const double t285 = t66 * t284;
    const double t290 = 0.1e1 / t44 / t41;
    const double t291 = t38 * t290;
    const double t296 = 0.1e1 / t32 / t73;
    const double t300 = a2 * t53;
    const double t301 = sigma_aa * t296;
    const double t305 = -0.8e1 / 0.3e1 * t301 + 0.5e1 / 0.3e1 * lapl_a * t34;
    const double t310 = 0.1e1 / t57 / t56;
    const double t311 = t310 * sigma_aa;
    const double t312 = t311 * t296;
    const double t316 = b * ( 0.2e1 * t300 * t58 * t305 + 0.16e2 / 0.3e1 * t55 * t312 );
    const double t318 = t61 * t65;
    const double t321 = 0.1e1 / t31 / t67;
    const double t322 = t72 * t321;
    const double t324 = 0.1e1 / t86;
    const double t325 = 0.16e2 / 0.3e1 * t285;
    const double t326 = 0.1e2 / 0.3e1 * t322;
    const double t327 = -t325 + t326;
    const double t330 = 0.1e1 / t90;
    const double t333 = 0.1e1 / t101;
    const double t342 = t90 * t87;
    const double t346 = t111 * t111;
    const double t347 = 0.1e1 / t346;
    const double t348 = piecewise_functor_3( t106, t327, 0.0 );
    const double t349 = 0.1e1 / t110;
    const double t350 = t349 * t107;
    const double t352 = t350 * t348 + t348;
    const double t354 = piecewise_functor_5( t80, 0.32e2 / 0.3e1 * t285 - 0.2e2 / 0.3e1 * t322 + t324 * t327 / 0.2e1 - 0.3e1 / 0.8e1 * t330 * t327 + 0.5e1 / 0.16e2 * t333 * t327, t98, t325 - t326 + t77 * t327 - t87 * t327 / 0.2e1 + 0.3e1 / 0.8e1 * t91 * t327 - 0.5e1 / 0.16e2 * t342 * t327, -t347 * t352 );
    const double t355 = t354 * t123;
    const double t356 = t355 * t54;
    const double t358 = t121 * t121;
    const double t359 = 0.1e1 / t358;
    const double t360 = t115 * t359;
    const double t361 = t61 * t360;
    const double t362 = t54 * t117;
    const double t363 = t65 * t354;
    const double t364 = t362 * t363;
    const double t367 = t61 * t115;
    const double t368 = t123 * t53;
    const double t369 = t368 * t305;
    const double t372 = -0.4e1 / 0.3e1 * t281 * t285 * a1 + 0.2e1 * t291 * t285 * b1 - 0.8e1 / 0.3e1 * t38 * t46 * t296 + t316 * t125 + t318 * t356 - 0.3e1 * t361 * t364 + 0.2e1 * t367 * t369;
    const double t374 = t139 * t139;
    const double t375 = 0.1e1 / t374;
    const double t376 = t127 * t375;
    const double t377 = t376 * t132;
    const double t379 = t378 * t301;
    const double t382 = t372 * t140 + 0.54e2 * t377 * t379;
    const double t383 = t278 * t382;
    const double t387 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t266 * t142 - t275 - 0.3e1 / 0.16e2 * t276 * t383 );
    const double t388 = t148 * t259;
    const double t390 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t388 );
    const double t393 = piecewise_functor_3( t152, 0.0, 0.4e1 / 0.3e1 * t153 * t390 );
    const double t394 = t393 * t27;
    const double t398 = t155 * t271;
    const double t401 = t6 * t398 * t253 / 0.8e1;
    const double t403 = piecewise_functor_3( t147, 0.0, -0.3e1 / 0.8e1 * t6 * t394 * t253 - t401 );
    const double t407 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t260 );
    const double t410 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t407 );
    const double t411 = t410 * t27;
    const double t416 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t411 * t142 - t275 );
    const double t418 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t388 );
    const double t421 = piecewise_functor_3( t152, 0.0, 0.4e1 / 0.3e1 * t153 * t418 );
    const double t422 = t421 * t27;
    const double t426 = t6 * t155;
    const double t427 = 0.1e1 / t253;
    const double t428 = t27 * t427;
    const double t430 = a / t165;
    const double t431 = t430 * t173;
    const double t432 = t191 * t158;
    const double t434 = 0.1e1 / t159 / t432;
    const double t435 = t190 * t434;
    const double t440 = 0.1e1 / t172 / t169;
    const double t441 = t166 * t440;
    const double t446 = 0.1e1 / t160 / t197;
    const double t450 = a2 * t181;
    const double t451 = sigma_bb * t446;
    const double t455 = -0.8e1 / 0.3e1 * t451 + 0.5e1 / 0.3e1 * lapl_b * t162;
    const double t460 = 0.1e1 / t185 / t184;
    const double t461 = t460 * sigma_bb;
    const double t462 = t461 * t446;
    const double t466 = b * ( 0.2e1 * t450 * t186 * t455 + 0.16e2 / 0.3e1 * t183 * t462 );
    const double t468 = t189 * t65;
    const double t471 = 0.1e1 / t159 / t191;
    const double t472 = t196 * t471;
    const double t474 = 0.1e1 / t207;
    const double t475 = 0.16e2 / 0.3e1 * t435;
    const double t476 = 0.1e2 / 0.3e1 * t472;
    const double t477 = -t475 + t476;
    const double t480 = 0.1e1 / t211;
    const double t483 = 0.1e1 / t222;
    const double t492 = t211 * t208;
    const double t496 = t232 * t232;
    const double t497 = 0.1e1 / t496;
    const double t498 = piecewise_functor_3( t227, t477, 0.0 );
    const double t499 = 0.1e1 / t231;
    const double t500 = t499 * t228;
    const double t502 = t500 * t498 + t498;
    const double t504 = piecewise_functor_5( t202, 0.32e2 / 0.3e1 * t435 - 0.2e2 / 0.3e1 * t472 + t474 * t477 / 0.2e1 - 0.3e1 / 0.8e1 * t480 * t477 + 0.5e1 / 0.16e2 * t483 * t477, t219, t475 - t476 + t201 * t477 - t208 * t477 / 0.2e1 + 0.3e1 / 0.8e1 * t212 * t477 - 0.5e1 / 0.16e2 * t492 * t477, -t497 * t502 );
    const double t505 = t504 * t241;
    const double t506 = t505 * t182;
    const double t508 = t239 * t239;
    const double t509 = 0.1e1 / t508;
    const double t510 = t236 * t509;
    const double t511 = t189 * t510;
    const double t512 = t182 * t117;
    const double t513 = t65 * t504;
    const double t514 = t512 * t513;
    const double t517 = t189 * t236;
    const double t518 = t241 * t181;
    const double t519 = t518 * t455;
    const double t522 = -0.4e1 / 0.3e1 * t431 * t435 * a1 + 0.2e1 * t441 * t435 * b1 - 0.8e1 / 0.3e1 * t166 * t174 * t446 + t466 * t243 + t468 * t506 - 0.3e1 * t511 * t514 + 0.2e1 * t517 * t519;
    const double t524 = t250 * t250;
    const double t525 = 0.1e1 / t524;
    const double t526 = t245 * t525;
    const double t527 = t526 * t132;
    const double t528 = t378 * t451;
    const double t531 = t522 * t251 + 0.54e2 * t527 * t528;
    const double t532 = t428 * t531;
    const double t536 = piecewise_functor_3( t147, 0.0, -0.3e1 / 0.8e1 * t6 * t422 * t253 - t401 - 0.3e1 / 0.16e2 * t426 * t532 );
    const double t539 = sigma_aa * t70;
    const double t548 = t58 * t34;
    const double t550 = t310 * t34;
    const double t554 = b * ( 0.2e1 * t300 * t548 - 0.2e1 * t55 * t550 );
    const double t557 = t324 * sigma_aa;
    const double t559 = t330 * sigma_aa;
    const double t562 = t333 * sigma_aa;
    const double t566 = 0.2e1 * t539;
    const double t567 = t77 * sigma_aa;
    const double t570 = t87 * sigma_aa;
    const double t572 = t91 * sigma_aa;
    const double t575 = t342 * sigma_aa;
    const double t579 = piecewise_functor_3( t106, t566, 0.0 );
    const double t581 = t350 * t579 + t579;
    const double t583 = piecewise_functor_5( t80, -0.4e1 * t539 + t557 * t70 - 0.3e1 / 0.4e1 * t559 * t70 + 0.5e1 / 0.8e1 * t562 * t70, t98, -t566 + 0.2e1 * t567 * t70 - t570 * t70 + 0.3e1 / 0.4e1 * t572 * t70 - 0.5e1 / 0.8e1 * t575 * t70, -t347 * t581 );
    const double t584 = t583 * t123;
    const double t585 = t584 * t54;
    const double t587 = t65 * t583;
    const double t588 = t362 * t587;
    const double t591 = t368 * t34;
    const double t592 = t367 * t591;
    const double t594 = t281 * t539 * a1 / 0.2e1 - 0.3e1 / 0.4e1 * t291 * t539 * b1 + t38 * t45 * t34 + t554 * t125 + t318 * t585 - 0.3e1 * t361 * t588 + 0.2e1 * t592;
    const double t596 = t376 * t128;
    const double t598 = b * t34;
    const double t599 = t597 * t598;
    const double t602 = t594 * t140 - 0.81e2 / 0.4e1 * t596 * t599;
    const double t603 = t278 * t602;
    const double t606 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.16e2 * t276 * t603 );
    const double t607 = sigma_bb * t194;
    const double t616 = t186 * t162;
    const double t618 = t460 * t162;
    const double t622 = b * ( -0.2e1 * t183 * t618 + 0.2e1 * t450 * t616 );
    const double t625 = t474 * sigma_bb;
    const double t627 = t480 * sigma_bb;
    const double t630 = t483 * sigma_bb;
    const double t634 = 0.2e1 * t607;
    const double t635 = t201 * sigma_bb;
    const double t638 = t208 * sigma_bb;
    const double t640 = t212 * sigma_bb;
    const double t643 = t492 * sigma_bb;
    const double t647 = piecewise_functor_3( t227, t634, 0.0 );
    const double t649 = t500 * t647 + t647;
    const double t651 = piecewise_functor_5( t202, -0.4e1 * t607 + t625 * t194 - 0.3e1 / 0.4e1 * t627 * t194 + 0.5e1 / 0.8e1 * t630 * t194, t219, -t634 + 0.2e1 * t635 * t194 - t638 * t194 + 0.3e1 / 0.4e1 * t640 * t194 - 0.5e1 / 0.8e1 * t643 * t194, -t497 * t649 );
    const double t652 = t651 * t241;
    const double t653 = t652 * t182;
    const double t655 = t65 * t651;
    const double t656 = t512 * t655;
    const double t659 = t518 * t162;
    const double t660 = t517 * t659;
    const double t662 = t431 * t607 * a1 / 0.2e1 - 0.3e1 / 0.4e1 * t441 * t607 * b1 + t166 * t173 * t162 + t622 * t243 + t468 * t653 - 0.3e1 * t511 * t656 + 0.2e1 * t660;
    const double t664 = t526 * t128;
    const double t665 = b * t162;
    const double t666 = t597 * t665;
    const double t669 = t662 * t251 - 0.81e2 / 0.4e1 * t664 * t666;
    const double t670 = t428 * t669;
    const double t673 = piecewise_functor_3( t147, 0.0, -0.3e1 / 0.16e2 * t426 * t670 );
    const double t675 = t54 * t53;
    const double t676 = t674 * t675;
    const double t677 = t58 * t51;
    const double t678 = t677 * t124;
    const double t681 = lapl_a * t75;
    const double t683 = t324 * lapl_a;
    const double t685 = t330 * lapl_a;
    const double t688 = t333 * lapl_a;
    const double t692 = 0.2e1 * t681;
    const double t693 = t77 * lapl_a;
    const double t696 = t87 * lapl_a;
    const double t698 = t91 * lapl_a;
    const double t701 = t342 * lapl_a;
    const double t705 = piecewise_functor_3( t106, -t692, 0.0 );
    const double t707 = t350 * t705 + t705;
    const double t709 = piecewise_functor_5( t80, 0.4e1 * t681 - t683 * t75 + 0.3e1 / 0.4e1 * t685 * t75 - 0.5e1 / 0.8e1 * t688 * t75, t98, t692 - 0.2e1 * t693 * t75 + t696 * t75 - 0.3e1 / 0.4e1 * t698 * t75 + 0.5e1 / 0.8e1 * t701 * t75, -t347 * t707 );
    const double t710 = t709 * t123;
    const double t711 = t710 * t54;
    const double t713 = t65 * t709;
    const double t714 = t362 * t713;
    const double t717 = t368 * t51;
    const double t720 = t318 * t711 - 0.3e1 * t361 * t714 - 0.2e1 * t367 * t717 - 0.2e1 * t676 * t678;
    const double t721 = t720 * t140;
    const double t722 = t278 * t721;
    const double t725 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.16e2 * t276 * t722 );
    const double t726 = t182 * t181;
    const double t727 = t674 * t726;
    const double t728 = t186 * t179;
    const double t729 = t728 * t242;
    const double t732 = lapl_b * t199;
    const double t734 = t474 * lapl_b;
    const double t736 = t480 * lapl_b;
    const double t739 = t483 * lapl_b;
    const double t743 = 0.2e1 * t732;
    const double t744 = t201 * lapl_b;
    const double t747 = t208 * lapl_b;
    const double t749 = t212 * lapl_b;
    const double t752 = t492 * lapl_b;
    const double t756 = piecewise_functor_3( t227, -t743, 0.0 );
    const double t758 = t500 * t756 + t756;
    const double t760 = piecewise_functor_5( t202, 0.4e1 * t732 - t734 * t199 + 0.3e1 / 0.4e1 * t736 * t199 - 0.5e1 / 0.8e1 * t739 * t199, t219, t743 - 0.2e1 * t744 * t199 + t747 * t199 - 0.3e1 / 0.4e1 * t749 * t199 + 0.5e1 / 0.8e1 * t752 * t199, -t497 * t758 );
    const double t761 = t760 * t241;
    const double t762 = t761 * t182;
    const double t764 = t65 * t760;
    const double t765 = t512 * t764;
    const double t768 = t518 * t179;
    const double t771 = t468 * t762 - 0.3e1 * t511 * t765 - 0.2e1 * t517 * t768 - 0.2e1 * t727 * t729;
    const double t772 = t771 * t251;
    const double t773 = t428 * t772;
    const double t776 = piecewise_functor_3( t147, 0.0, -0.3e1 / 0.16e2 * t426 * t773 );


    eps = t146 + t257;
    vrho_a = t146 + t257 + t7 * ( t387 + t403 );
    vrho_b = t146 + t257 + t7 * ( t416 + t536 );
    vsigma_aa = t7 * t606;
    vsigma_ab = 0.e0;
    vsigma_bb = t7 * t673;
    vlapl_a = t7 * t725;
    vlapl_b = t7 * t776;
    vtau_a = 0.e0;
    vtau_b = 0.e0;

  }


};

struct BuiltinFT98_X : detail::BuiltinKernelImpl< BuiltinFT98_X > {

  BuiltinFT98_X( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinFT98_X >(p) { }
  
  virtual ~BuiltinFT98_X() = default;

};



} // namespace ExchCXX