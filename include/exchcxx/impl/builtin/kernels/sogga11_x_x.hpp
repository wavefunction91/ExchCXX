/**
 * ExchCXX 
 *
 * Copyright (c) Microsoft Corporation.
 *
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * (1) Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 * 
 * (2) Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 * 
 * (3) Neither the name of the University of California, Lawrence Berkeley
 * National Laboratory, U.S. Dept. of Energy nor the names of its contributors
 * may be used to endorse or promote products derived from this software
 * without specific prior written permission.
 * 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 * 
 * You are under no obligation whatsoever to provide any bug fixes, patches,
 * or upgrades to the features, functionality or performance of the source
 * code ("Enhancements") to anyone; however, if you choose to make your
 * Enhancements available either publicly, or directly to Lawrence Berkeley
 * National Laboratory, without imposing a separate written license agreement
 * for such Enhancements, then you hereby grant the following license: a
 * non-exclusive, royalty-free perpetual license to install, use, modify,
 * prepare derivative works, incorporate into other computer software,
 * distribute, and sublicense such enhancements or derivative works thereof,
 * in binary and source code form.
 */


#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinSOGGA11_X_X > :
  public gga_screening_interface< BuiltinSOGGA11_X_X > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = true;
  static constexpr bool is_mgga = false;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;
  static constexpr bool is_epc  = false;

  static constexpr double dens_tol  = 1e-15;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000027e-20;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;


  static constexpr double kappa = 0.552;
  static constexpr double mu = 0.1234567901234567901234567901234567901235;
  static constexpr double a_0 = 0.29925;
  static constexpr double a_1 = 3.21638;
  static constexpr double a_2 = -3.55605;
  static constexpr double a_3 = 7.65852;
  static constexpr double a_4 = -11.2830;
  static constexpr double a_5 = 5.25813;
  static constexpr double b_0 = 0.29925;
  static constexpr double b_1 = -2.88595;
  static constexpr double b_2 = 3.23617;
  static constexpr double b_3 = -2.45393;
  static constexpr double b_4 = -3.75495;
  static constexpr double b_5 = 3.96613;
  static constexpr double cx = 0.4015;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double& eps ) {

    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_6;
    constexpr double t25 = constants::m_cbrt_pi_sq;
    constexpr double t31 = constants::m_cbrt_2;
    constexpr double t6 = t3 / t4;
    constexpr double t21 = a_1;
    constexpr double t23 = mu * t22;
    constexpr double t26 = t25 * t25;
    constexpr double t27 = 0.1e1 / t26;
    constexpr double t28 = t23 * t27;
    constexpr double t29 = 0.1e1 / kappa;
    constexpr double t32 = t31 * t31;
    constexpr double t45 = a_2;
    constexpr double t48 = a_3;
    constexpr double t51 = a_4;
    constexpr double t54 = a_5;
    constexpr double t58 = b_1;
    constexpr double t62 = b_2;
    constexpr double t65 = b_3;
    constexpr double t68 = b_4;
    constexpr double t71 = b_5;


    const double t2 = rho / 0.2e1 <= dens_tol;
    const double t7 = 0.1e1 <= zeta_tol;
    const double t8 = zeta_tol - 0.1e1;
    const double t10 = piecewise_functor_5( t7, t8, t7, -t8, 0.0 );
    const double t11 = 0.1e1 + t10;
    const double t13 = safe_math::cbrt( zeta_tol );
    const double t15 = safe_math::cbrt( t11 );
    const double t17 = piecewise_functor_3( t11 <= zeta_tol, t13 * zeta_tol, t15 * t11 );
    const double t18 = safe_math::cbrt( rho );
    const double t19 = t17 * t18;
    const double t30 = t29 * sigma;
    const double t33 = rho * rho;
    const double t34 = t18 * t18;
    const double t36 = 0.1e1 / t34 / t33;
    const double t37 = t32 * t36;
    const double t40 = t28 * t30 * t37 / 0.24e2;
    const double t41 = 0.1e1 + t40;
    const double t43 = 0.1e1 - 0.1e1 / t41;
    const double t46 = t43 * t43;
    const double t49 = t46 * t43;
    const double t52 = t46 * t46;
    const double t59 = safe_math::exp( -t40 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 * t60;
    const double t66 = t63 * t60;
    const double t69 = t63 * t63;
    const double t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + a_0 + b_0;
    const double t78 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t74 );


    eps = 0.2e1 * t78;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double& eps, double& vrho, double& vsigma ) {

    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_6;
    constexpr double t25 = constants::m_cbrt_pi_sq;
    constexpr double t31 = constants::m_cbrt_2;
    constexpr double t6 = t3 / t4;
    constexpr double t21 = a_1;
    constexpr double t23 = mu * t22;
    constexpr double t26 = t25 * t25;
    constexpr double t27 = 0.1e1 / t26;
    constexpr double t28 = t23 * t27;
    constexpr double t29 = 0.1e1 / kappa;
    constexpr double t32 = t31 * t31;
    constexpr double t45 = a_2;
    constexpr double t48 = a_3;
    constexpr double t51 = a_4;
    constexpr double t54 = a_5;
    constexpr double t58 = b_1;
    constexpr double t62 = b_2;
    constexpr double t65 = b_3;
    constexpr double t68 = b_4;
    constexpr double t71 = b_5;
    constexpr double t88 = t27 * t29;
    constexpr double t116 = t22 * t27;
    constexpr double t117 = t58 * mu * t116;
    constexpr double t151 = t29 * t32;


    const double t2 = rho / 0.2e1 <= dens_tol;
    const double t7 = 0.1e1 <= zeta_tol;
    const double t8 = zeta_tol - 0.1e1;
    const double t10 = piecewise_functor_5( t7, t8, t7, -t8, 0.0 );
    const double t11 = 0.1e1 + t10;
    const double t13 = safe_math::cbrt( zeta_tol );
    const double t15 = safe_math::cbrt( t11 );
    const double t17 = piecewise_functor_3( t11 <= zeta_tol, t13 * zeta_tol, t15 * t11 );
    const double t18 = safe_math::cbrt( rho );
    const double t19 = t17 * t18;
    const double t30 = t29 * sigma;
    const double t33 = rho * rho;
    const double t34 = t18 * t18;
    const double t36 = 0.1e1 / t34 / t33;
    const double t37 = t32 * t36;
    const double t40 = t28 * t30 * t37 / 0.24e2;
    const double t41 = 0.1e1 + t40;
    const double t43 = 0.1e1 - 0.1e1 / t41;
    const double t46 = t43 * t43;
    const double t49 = t46 * t43;
    const double t52 = t46 * t46;
    const double t59 = safe_math::exp( -t40 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 * t60;
    const double t66 = t63 * t60;
    const double t69 = t63 * t63;
    const double t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + a_0 + b_0;
    const double t78 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t74 );
    const double t80 = t17 / t34;
    const double t84 = t41 * t41;
    const double t85 = 0.1e1 / t84;
    const double t87 = t21 * t85 * t23;
    const double t89 = sigma * t32;
    const double t90 = t33 * rho;
    const double t92 = 0.1e1 / t34 / t90;
    const double t94 = t88 * t89 * t92;
    const double t97 = t45 * t43;
    const double t98 = t85 * mu;
    const double t99 = t98 * t22;
    const double t100 = t97 * t99;
    const double t103 = t48 * t46;
    const double t104 = t103 * t99;
    const double t107 = t51 * t49;
    const double t108 = t107 * t99;
    const double t111 = t54 * t52;
    const double t112 = t111 * t99;
    const double t118 = t32 * t92;
    const double t119 = t118 * t59;
    const double t120 = t30 * t119;
    const double t123 = t62 * t60;
    const double t124 = t123 * t28;
    const double t127 = t65 * t63;
    const double t128 = t127 * t28;
    const double t131 = t68 * t66;
    const double t132 = t131 * t28;
    const double t135 = t71 * t69;
    const double t136 = t135 * t28;
    const double t139 = -t87 * t94 / 0.9e1 - 0.2e1 / 0.9e1 * t100 * t94 - t104 * t94 / 0.3e1 - 0.4e1 / 0.9e1 * t108 * t94 - 0.5e1 / 0.9e1 * t112 * t94 - t117 * t120 / 0.9e1 - 0.2e1 / 0.9e1 * t124 * t120 - t128 * t120 / 0.3e1 - 0.4e1 / 0.9e1 * t132 * t120 - 0.5e1 / 0.9e1 * t136 * t120;
    const double t144 = piecewise_functor_3( t2, 0.0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t139 );
    const double t150 = t97 * t98;
    const double t153 = t116 * t151 * t36;
    const double t156 = t103 * t98;
    const double t159 = t107 * t98;
    const double t162 = t111 * t98;
    const double t169 = t123 * t23;
    const double t171 = t88 * t37 * t59;
    const double t174 = t127 * t23;
    const double t177 = t131 * t23;
    const double t180 = t135 * t23;
    const double t183 = t87 * t88 * t37 / 0.24e2 + t150 * t153 / 0.12e2 + t156 * t153 / 0.8e1 + t159 * t153 / 0.6e1 + 0.5e1 / 0.24e2 * t162 * t153 + t117 * t151 * t36 * t59 / 0.24e2 + t169 * t171 / 0.12e2 + t174 * t171 / 0.8e1 + t177 * t171 / 0.6e1 + 0.5e1 / 0.24e2 * t180 * t171;
    const double t187 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t183 );


    eps = 0.2e1 * t78;
    vrho = 0.2e1 * rho * t144 + 0.2e1 * t78;
    vsigma = 0.2e1 * rho * t187;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_fxc_unpolar_impl( double rho, double sigma, double& v2rho2, double& v2rhosigma, double& v2sigma2 ) {

    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_6;
    constexpr double t24 = constants::m_pi_sq;
    constexpr double t25 = constants::m_cbrt_pi_sq;
    constexpr double t31 = constants::m_cbrt_2;
    constexpr double t6 = t3 / t4;
    constexpr double t21 = a_1;
    constexpr double t23 = mu * t22;
    constexpr double t26 = t25 * t25;
    constexpr double t27 = 0.1e1 / t26;
    constexpr double t28 = t23 * t27;
    constexpr double t29 = 0.1e1 / kappa;
    constexpr double t32 = t31 * t31;
    constexpr double t45 = a_2;
    constexpr double t48 = a_3;
    constexpr double t51 = a_4;
    constexpr double t54 = a_5;
    constexpr double t58 = b_1;
    constexpr double t62 = b_2;
    constexpr double t65 = b_3;
    constexpr double t68 = b_4;
    constexpr double t71 = b_5;
    constexpr double t88 = t27 * t29;
    constexpr double t116 = t22 * t27;
    constexpr double t117 = t58 * mu * t116;
    constexpr double t151 = t29 * t32;
    constexpr double t201 = mu * mu;
    constexpr double t203 = t22 * t22;
    constexpr double t207 = 0.1e1 / t25 / t24;
    constexpr double t208 = kappa * kappa;
    constexpr double t209 = 0.1e1 / t208;
    constexpr double t210 = t207 * t209;
    constexpr double t246 = t201 * t203;
    constexpr double t247 = t246 * t207;
    constexpr double t316 = t203 * t207;
    constexpr double t317 = t58 * t201 * t316;
    constexpr double t321 = t62 * t201 * t316;
    constexpr double t343 = t209 * t31;


    const double t2 = rho / 0.2e1 <= dens_tol;
    const double t7 = 0.1e1 <= zeta_tol;
    const double t8 = zeta_tol - 0.1e1;
    const double t10 = piecewise_functor_5( t7, t8, t7, -t8, 0.0 );
    const double t11 = 0.1e1 + t10;
    const double t13 = safe_math::cbrt( zeta_tol );
    const double t15 = safe_math::cbrt( t11 );
    const double t17 = piecewise_functor_3( t11 <= zeta_tol, t13 * zeta_tol, t15 * t11 );
    const double t18 = safe_math::cbrt( rho );
    const double t19 = t17 * t18;
    const double t30 = t29 * sigma;
    const double t33 = rho * rho;
    const double t34 = t18 * t18;
    const double t36 = 0.1e1 / t34 / t33;
    const double t37 = t32 * t36;
    const double t40 = t28 * t30 * t37 / 0.24e2;
    const double t41 = 0.1e1 + t40;
    const double t43 = 0.1e1 - 0.1e1 / t41;
    const double t46 = t43 * t43;
    const double t49 = t46 * t43;
    const double t52 = t46 * t46;
    const double t59 = safe_math::exp( -t40 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 * t60;
    const double t66 = t63 * t60;
    const double t69 = t63 * t63;
    const double t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + a_0 + b_0;
    const double t80 = t17 / t34;
    const double t84 = t41 * t41;
    const double t85 = 0.1e1 / t84;
    const double t87 = t21 * t85 * t23;
    const double t89 = sigma * t32;
    const double t90 = t33 * rho;
    const double t92 = 0.1e1 / t34 / t90;
    const double t94 = t88 * t89 * t92;
    const double t97 = t45 * t43;
    const double t98 = t85 * mu;
    const double t99 = t98 * t22;
    const double t100 = t97 * t99;
    const double t103 = t48 * t46;
    const double t104 = t103 * t99;
    const double t107 = t51 * t49;
    const double t108 = t107 * t99;
    const double t111 = t54 * t52;
    const double t112 = t111 * t99;
    const double t118 = t32 * t92;
    const double t119 = t118 * t59;
    const double t120 = t30 * t119;
    const double t123 = t62 * t60;
    const double t124 = t123 * t28;
    const double t127 = t65 * t63;
    const double t128 = t127 * t28;
    const double t131 = t68 * t66;
    const double t132 = t131 * t28;
    const double t135 = t71 * t69;
    const double t136 = t135 * t28;
    const double t139 = -t87 * t94 / 0.9e1 - 0.2e1 / 0.9e1 * t100 * t94 - t104 * t94 / 0.3e1 - 0.4e1 / 0.9e1 * t108 * t94 - 0.5e1 / 0.9e1 * t112 * t94 - t117 * t120 / 0.9e1 - 0.2e1 / 0.9e1 * t124 * t120 - t128 * t120 / 0.3e1 - 0.4e1 / 0.9e1 * t132 * t120 - 0.5e1 / 0.9e1 * t136 * t120;
    const double t144 = piecewise_functor_3( t2, 0.0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t139 );
    const double t150 = t97 * t98;
    const double t153 = t116 * t151 * t36;
    const double t156 = t103 * t98;
    const double t159 = t107 * t98;
    const double t162 = t111 * t98;
    const double t169 = t123 * t23;
    const double t171 = t88 * t37 * t59;
    const double t174 = t127 * t23;
    const double t177 = t131 * t23;
    const double t180 = t135 * t23;
    const double t183 = t87 * t88 * t37 / 0.24e2 + t150 * t153 / 0.12e2 + t156 * t153 / 0.8e1 + t159 * t153 / 0.6e1 + 0.5e1 / 0.24e2 * t162 * t153 + t117 * t151 * t36 * t59 / 0.24e2 + t169 * t171 / 0.12e2 + t174 * t171 / 0.8e1 + t177 * t171 / 0.6e1 + 0.5e1 / 0.24e2 * t180 * t171;
    const double t187 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t183 );
    const double t192 = t17 / t34 / rho;
    const double t199 = t84 * t41;
    const double t200 = 0.1e1 / t199;
    const double t202 = t200 * t201;
    const double t204 = t202 * t203;
    const double t205 = t97 * t204;
    const double t211 = sigma * sigma;
    const double t212 = t211 * t31;
    const double t213 = t33 * t33;
    const double t216 = 0.1e1 / t18 / t213 / t90;
    const double t218 = t210 * t212 * t216;
    const double t221 = t48 * t43;
    const double t222 = t84 * t84;
    const double t223 = 0.1e1 / t222;
    const double t224 = t223 * t201;
    const double t225 = t224 * t203;
    const double t226 = t221 * t225;
    const double t229 = t103 * t204;
    const double t232 = t51 * t46;
    const double t233 = t232 * t225;
    const double t236 = t107 * t204;
    const double t239 = t54 * t49;
    const double t240 = t239 * t225;
    const double t243 = t111 * t204;
    const double t248 = t123 * t247;
    const double t249 = t209 * t211;
    const double t250 = t31 * t216;
    const double t251 = t250 * t59;
    const double t252 = t249 * t251;
    const double t255 = t65 * t60;
    const double t256 = t255 * t247;
    const double t257 = t59 * t59;
    const double t258 = t250 * t257;
    const double t259 = t249 * t258;
    const double t262 = t127 * t247;
    const double t265 = t68 * t63;
    const double t266 = t265 * t247;
    const double t269 = t131 * t247;
    const double t272 = t71 * t66;
    const double t273 = t272 * t247;
    const double t276 = t135 * t247;
    const double t279 = -0.8e1 / 0.81e2 * t205 * t218 + 0.4e1 / 0.27e2 * t226 * t218 - 0.4e1 / 0.27e2 * t229 * t218 + 0.8e1 / 0.27e2 * t233 * t218 - 0.16e2 / 0.81e2 * t236 * t218 + 0.4e2 / 0.81e2 * t240 * t218 - 0.2e2 / 0.81e2 * t243 * t218 - 0.4e1 / 0.81e2 * t248 * t252 + 0.4e1 / 0.27e2 * t256 * t259 - 0.2e1 / 0.27e2 * t262 * t252 + 0.8e1 / 0.27e2 * t266 * t259 - 0.8e1 / 0.81e2 * t269 * t252 + 0.4e2 / 0.81e2 * t273 * t259 - 0.1e2 / 0.81e2 * t276 * t252;
    const double t281 = 0.1e1 / t34 / t213;
    const double t282 = t32 * t281;
    const double t283 = t282 * t59;
    const double t284 = t30 * t283;
    const double t292 = t88 * t89 * t281;
    const double t308 = t21 * t200 * t246;
    const double t312 = t45 * t223 * t246;
    const double t324 = 0.11e2 / 0.9e1 * t128 * t284 + 0.44e2 / 0.27e2 * t132 * t284 + 0.55e2 / 0.27e2 * t136 * t284 + 0.44e2 / 0.27e2 * t108 * t292 + 0.55e2 / 0.27e2 * t112 * t292 + 0.22e2 / 0.27e2 * t124 * t284 + 0.22e2 / 0.27e2 * t100 * t292 + 0.11e2 / 0.9e1 * t104 * t292 + 0.11e2 / 0.27e2 * t87 * t292 + 0.11e2 / 0.27e2 * t117 * t284 - 0.4e1 / 0.81e2 * t308 * t218 + 0.4e1 / 0.81e2 * t312 * t218 - 0.2e1 / 0.81e2 * t317 * t252 + 0.4e1 / 0.81e2 * t321 * t259;
    const double t325 = t279 + t324;
    const double t330 = piecewise_functor_3( t2, 0.0, t6 * t192 * t74 / 0.12e2 - t6 * t80 * t139 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t325 );
    const double t344 = t213 * t33;
    const double t346 = 0.1e1 / t18 / t344;
    const double t347 = t346 * t257;
    const double t349 = t343 * t347 * sigma;
    const double t354 = t343 * t346 * sigma * t59;
    const double t357 = t31 * t346;
    const double t359 = t210 * t357 * sigma;
    const double t380 = -t87 * t88 * t118 / 0.9e1 - t117 * t151 * t92 * t59 / 0.9e1 - 0.5e1 / 0.27e2 * t273 * t349 + 0.5e1 / 0.108e3 * t276 * t354 + t205 * t359 / 0.27e2 - t226 * t359 / 0.18e2 + t229 * t359 / 0.18e2 - t233 * t359 / 0.9e1 + 0.2e1 / 0.27e2 * t236 * t359 - 0.5e1 / 0.27e2 * t240 * t359 + 0.5e1 / 0.54e2 * t243 * t359 + t248 * t354 / 0.54e2 - t256 * t349 / 0.18e2 + t262 * t354 / 0.36e2;
    const double t386 = t116 * t151 * t92;
    const double t395 = t88 * t119;
    const double t412 = -t266 * t349 / 0.9e1 + t269 * t354 / 0.27e2 - 0.2e1 / 0.9e1 * t150 * t386 - t156 * t386 / 0.3e1 - 0.4e1 / 0.9e1 * t159 * t386 - 0.5e1 / 0.9e1 * t162 * t386 - 0.2e1 / 0.9e1 * t169 * t395 - t174 * t395 / 0.3e1 - 0.4e1 / 0.9e1 * t177 * t395 - 0.5e1 / 0.9e1 * t180 * t395 + t308 * t359 / 0.54e2 - t312 * t359 / 0.54e2 + t317 * t354 / 0.108e3 - t321 * t349 / 0.54e2;
    const double t413 = t380 + t412;
    const double t418 = piecewise_functor_3( t2, 0.0, -t6 * t80 * t183 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t413 );
    const double t421 = t213 * rho;
    const double t423 = 0.1e1 / t18 / t421;
    const double t424 = t31 * t423;
    const double t425 = t210 * t424;
    const double t430 = t97 * t202;
    const double t432 = t316 * t343 * t423;
    const double t435 = t221 * t224;
    const double t438 = t103 * t202;
    const double t441 = t232 * t224;
    const double t444 = t107 * t202;
    const double t447 = t239 * t224;
    const double t450 = t111 * t202;
    const double t461 = t123 * t246;
    const double t463 = t210 * t424 * t59;
    const double t466 = t255 * t246;
    const double t468 = t210 * t424 * t257;
    const double t471 = t127 * t246;
    const double t474 = t265 * t246;
    const double t477 = t131 * t246;
    const double t480 = t272 * t246;
    const double t483 = t135 * t246;
    const double t486 = -t308 * t425 / 0.144e3 + t312 * t425 / 0.144e3 - t430 * t432 / 0.72e2 + t435 * t432 / 0.48e2 - t438 * t432 / 0.48e2 + t441 * t432 / 0.24e2 - t444 * t432 / 0.36e2 + 0.5e1 / 0.72e2 * t447 * t432 - 0.5e1 / 0.144e3 * t450 * t432 - t317 * t343 * t423 * t59 / 0.288e3 + t321 * t343 * t423 * t257 / 0.144e3 - t461 * t463 / 0.144e3 + t466 * t468 / 0.48e2 - t471 * t463 / 0.96e2 + t474 * t468 / 0.24e2 - t477 * t463 / 0.72e2 + 0.5e1 / 0.72e2 * t480 * t468 - 0.5e1 / 0.288e3 * t483 * t463;
    const double t490 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t486 );


    v2rho2 = 0.2e1 * rho * t330 + 0.4e1 * t144;
    v2rhosigma = 0.2e1 * rho * t418 + 0.2e1 * t187;
    v2sigma2 = 0.2e1 * rho * t490;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_vxc_fxc_unpolar_impl( double rho, double sigma, double& vrho, double& vsigma, double& v2rho2, double& v2rhosigma, double& v2sigma2 ) {

    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_6;
    constexpr double t24 = constants::m_pi_sq;
    constexpr double t25 = constants::m_cbrt_pi_sq;
    constexpr double t31 = constants::m_cbrt_2;
    constexpr double t6 = t3 / t4;
    constexpr double t21 = a_1;
    constexpr double t23 = mu * t22;
    constexpr double t26 = t25 * t25;
    constexpr double t27 = 0.1e1 / t26;
    constexpr double t28 = t23 * t27;
    constexpr double t29 = 0.1e1 / kappa;
    constexpr double t32 = t31 * t31;
    constexpr double t45 = a_2;
    constexpr double t48 = a_3;
    constexpr double t51 = a_4;
    constexpr double t54 = a_5;
    constexpr double t58 = b_1;
    constexpr double t62 = b_2;
    constexpr double t65 = b_3;
    constexpr double t68 = b_4;
    constexpr double t71 = b_5;
    constexpr double t88 = t27 * t29;
    constexpr double t116 = t22 * t27;
    constexpr double t117 = t58 * mu * t116;
    constexpr double t151 = t29 * t32;
    constexpr double t201 = mu * mu;
    constexpr double t203 = t22 * t22;
    constexpr double t207 = 0.1e1 / t25 / t24;
    constexpr double t208 = kappa * kappa;
    constexpr double t209 = 0.1e1 / t208;
    constexpr double t210 = t207 * t209;
    constexpr double t246 = t201 * t203;
    constexpr double t247 = t246 * t207;
    constexpr double t316 = t203 * t207;
    constexpr double t317 = t58 * t201 * t316;
    constexpr double t321 = t62 * t201 * t316;
    constexpr double t343 = t209 * t31;


    const double t2 = rho / 0.2e1 <= dens_tol;
    const double t7 = 0.1e1 <= zeta_tol;
    const double t8 = zeta_tol - 0.1e1;
    const double t10 = piecewise_functor_5( t7, t8, t7, -t8, 0.0 );
    const double t11 = 0.1e1 + t10;
    const double t13 = safe_math::cbrt( zeta_tol );
    const double t15 = safe_math::cbrt( t11 );
    const double t17 = piecewise_functor_3( t11 <= zeta_tol, t13 * zeta_tol, t15 * t11 );
    const double t18 = safe_math::cbrt( rho );
    const double t19 = t17 * t18;
    const double t30 = t29 * sigma;
    const double t33 = rho * rho;
    const double t34 = t18 * t18;
    const double t36 = 0.1e1 / t34 / t33;
    const double t37 = t32 * t36;
    const double t40 = t28 * t30 * t37 / 0.24e2;
    const double t41 = 0.1e1 + t40;
    const double t43 = 0.1e1 - 0.1e1 / t41;
    const double t46 = t43 * t43;
    const double t49 = t46 * t43;
    const double t52 = t46 * t46;
    const double t59 = safe_math::exp( -t40 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 * t60;
    const double t66 = t63 * t60;
    const double t69 = t63 * t63;
    const double t74 = t54 * t52 * t43 + t71 * t69 * t60 + t21 * t43 + t45 * t46 + t48 * t49 + t51 * t52 + t58 * t60 + t62 * t63 + t65 * t66 + t68 * t69 + a_0 + b_0;
    const double t78 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t74 );
    const double t80 = t17 / t34;
    const double t84 = t41 * t41;
    const double t85 = 0.1e1 / t84;
    const double t87 = t21 * t85 * t23;
    const double t89 = sigma * t32;
    const double t90 = t33 * rho;
    const double t92 = 0.1e1 / t34 / t90;
    const double t94 = t88 * t89 * t92;
    const double t97 = t45 * t43;
    const double t98 = t85 * mu;
    const double t99 = t98 * t22;
    const double t100 = t97 * t99;
    const double t103 = t48 * t46;
    const double t104 = t103 * t99;
    const double t107 = t51 * t49;
    const double t108 = t107 * t99;
    const double t111 = t54 * t52;
    const double t112 = t111 * t99;
    const double t118 = t32 * t92;
    const double t119 = t118 * t59;
    const double t120 = t30 * t119;
    const double t123 = t62 * t60;
    const double t124 = t123 * t28;
    const double t127 = t65 * t63;
    const double t128 = t127 * t28;
    const double t131 = t68 * t66;
    const double t132 = t131 * t28;
    const double t135 = t71 * t69;
    const double t136 = t135 * t28;
    const double t139 = -t87 * t94 / 0.9e1 - 0.2e1 / 0.9e1 * t100 * t94 - t104 * t94 / 0.3e1 - 0.4e1 / 0.9e1 * t108 * t94 - 0.5e1 / 0.9e1 * t112 * t94 - t117 * t120 / 0.9e1 - 0.2e1 / 0.9e1 * t124 * t120 - t128 * t120 / 0.3e1 - 0.4e1 / 0.9e1 * t132 * t120 - 0.5e1 / 0.9e1 * t136 * t120;
    const double t144 = piecewise_functor_3( t2, 0.0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t139 );
    const double t150 = t97 * t98;
    const double t153 = t116 * t151 * t36;
    const double t156 = t103 * t98;
    const double t159 = t107 * t98;
    const double t162 = t111 * t98;
    const double t169 = t123 * t23;
    const double t171 = t88 * t37 * t59;
    const double t174 = t127 * t23;
    const double t177 = t131 * t23;
    const double t180 = t135 * t23;
    const double t183 = t87 * t88 * t37 / 0.24e2 + t150 * t153 / 0.12e2 + t156 * t153 / 0.8e1 + t159 * t153 / 0.6e1 + 0.5e1 / 0.24e2 * t162 * t153 + t117 * t151 * t36 * t59 / 0.24e2 + t169 * t171 / 0.12e2 + t174 * t171 / 0.8e1 + t177 * t171 / 0.6e1 + 0.5e1 / 0.24e2 * t180 * t171;
    const double t187 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t183 );
    const double t192 = t17 / t34 / rho;
    const double t199 = t84 * t41;
    const double t200 = 0.1e1 / t199;
    const double t202 = t200 * t201;
    const double t204 = t202 * t203;
    const double t205 = t97 * t204;
    const double t211 = sigma * sigma;
    const double t212 = t211 * t31;
    const double t213 = t33 * t33;
    const double t216 = 0.1e1 / t18 / t213 / t90;
    const double t218 = t210 * t212 * t216;
    const double t221 = t48 * t43;
    const double t222 = t84 * t84;
    const double t223 = 0.1e1 / t222;
    const double t224 = t223 * t201;
    const double t225 = t224 * t203;
    const double t226 = t221 * t225;
    const double t229 = t103 * t204;
    const double t232 = t51 * t46;
    const double t233 = t232 * t225;
    const double t236 = t107 * t204;
    const double t239 = t54 * t49;
    const double t240 = t239 * t225;
    const double t243 = t111 * t204;
    const double t248 = t123 * t247;
    const double t249 = t209 * t211;
    const double t250 = t31 * t216;
    const double t251 = t250 * t59;
    const double t252 = t249 * t251;
    const double t255 = t65 * t60;
    const double t256 = t255 * t247;
    const double t257 = t59 * t59;
    const double t258 = t250 * t257;
    const double t259 = t249 * t258;
    const double t262 = t127 * t247;
    const double t265 = t68 * t63;
    const double t266 = t265 * t247;
    const double t269 = t131 * t247;
    const double t272 = t71 * t66;
    const double t273 = t272 * t247;
    const double t276 = t135 * t247;
    const double t279 = -0.8e1 / 0.81e2 * t205 * t218 + 0.4e1 / 0.27e2 * t226 * t218 - 0.4e1 / 0.27e2 * t229 * t218 + 0.8e1 / 0.27e2 * t233 * t218 - 0.16e2 / 0.81e2 * t236 * t218 + 0.4e2 / 0.81e2 * t240 * t218 - 0.2e2 / 0.81e2 * t243 * t218 - 0.4e1 / 0.81e2 * t248 * t252 + 0.4e1 / 0.27e2 * t256 * t259 - 0.2e1 / 0.27e2 * t262 * t252 + 0.8e1 / 0.27e2 * t266 * t259 - 0.8e1 / 0.81e2 * t269 * t252 + 0.4e2 / 0.81e2 * t273 * t259 - 0.1e2 / 0.81e2 * t276 * t252;
    const double t281 = 0.1e1 / t34 / t213;
    const double t282 = t32 * t281;
    const double t283 = t282 * t59;
    const double t284 = t30 * t283;
    const double t292 = t88 * t89 * t281;
    const double t308 = t21 * t200 * t246;
    const double t312 = t45 * t223 * t246;
    const double t324 = 0.11e2 / 0.9e1 * t128 * t284 + 0.44e2 / 0.27e2 * t132 * t284 + 0.55e2 / 0.27e2 * t136 * t284 + 0.44e2 / 0.27e2 * t108 * t292 + 0.55e2 / 0.27e2 * t112 * t292 + 0.22e2 / 0.27e2 * t124 * t284 + 0.22e2 / 0.27e2 * t100 * t292 + 0.11e2 / 0.9e1 * t104 * t292 + 0.11e2 / 0.27e2 * t87 * t292 + 0.11e2 / 0.27e2 * t117 * t284 - 0.4e1 / 0.81e2 * t308 * t218 + 0.4e1 / 0.81e2 * t312 * t218 - 0.2e1 / 0.81e2 * t317 * t252 + 0.4e1 / 0.81e2 * t321 * t259;
    const double t325 = t279 + t324;
    const double t330 = piecewise_functor_3( t2, 0.0, t6 * t192 * t74 / 0.12e2 - t6 * t80 * t139 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t325 );
    const double t344 = t213 * t33;
    const double t346 = 0.1e1 / t18 / t344;
    const double t347 = t346 * t257;
    const double t349 = t343 * t347 * sigma;
    const double t354 = t343 * t346 * sigma * t59;
    const double t357 = t31 * t346;
    const double t359 = t210 * t357 * sigma;
    const double t380 = -t87 * t88 * t118 / 0.9e1 - t117 * t151 * t92 * t59 / 0.9e1 - 0.5e1 / 0.27e2 * t273 * t349 + 0.5e1 / 0.108e3 * t276 * t354 + t205 * t359 / 0.27e2 - t226 * t359 / 0.18e2 + t229 * t359 / 0.18e2 - t233 * t359 / 0.9e1 + 0.2e1 / 0.27e2 * t236 * t359 - 0.5e1 / 0.27e2 * t240 * t359 + 0.5e1 / 0.54e2 * t243 * t359 + t248 * t354 / 0.54e2 - t256 * t349 / 0.18e2 + t262 * t354 / 0.36e2;
    const double t386 = t116 * t151 * t92;
    const double t395 = t88 * t119;
    const double t412 = -t266 * t349 / 0.9e1 + t269 * t354 / 0.27e2 - 0.2e1 / 0.9e1 * t150 * t386 - t156 * t386 / 0.3e1 - 0.4e1 / 0.9e1 * t159 * t386 - 0.5e1 / 0.9e1 * t162 * t386 - 0.2e1 / 0.9e1 * t169 * t395 - t174 * t395 / 0.3e1 - 0.4e1 / 0.9e1 * t177 * t395 - 0.5e1 / 0.9e1 * t180 * t395 + t308 * t359 / 0.54e2 - t312 * t359 / 0.54e2 + t317 * t354 / 0.108e3 - t321 * t349 / 0.54e2;
    const double t413 = t380 + t412;
    const double t418 = piecewise_functor_3( t2, 0.0, -t6 * t80 * t183 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t413 );
    const double t421 = t213 * rho;
    const double t423 = 0.1e1 / t18 / t421;
    const double t424 = t31 * t423;
    const double t425 = t210 * t424;
    const double t430 = t97 * t202;
    const double t432 = t316 * t343 * t423;
    const double t435 = t221 * t224;
    const double t438 = t103 * t202;
    const double t441 = t232 * t224;
    const double t444 = t107 * t202;
    const double t447 = t239 * t224;
    const double t450 = t111 * t202;
    const double t461 = t123 * t246;
    const double t463 = t210 * t424 * t59;
    const double t466 = t255 * t246;
    const double t468 = t210 * t424 * t257;
    const double t471 = t127 * t246;
    const double t474 = t265 * t246;
    const double t477 = t131 * t246;
    const double t480 = t272 * t246;
    const double t483 = t135 * t246;
    const double t486 = -t308 * t425 / 0.144e3 + t312 * t425 / 0.144e3 - t430 * t432 / 0.72e2 + t435 * t432 / 0.48e2 - t438 * t432 / 0.48e2 + t441 * t432 / 0.24e2 - t444 * t432 / 0.36e2 + 0.5e1 / 0.72e2 * t447 * t432 - 0.5e1 / 0.144e3 * t450 * t432 - t317 * t343 * t423 * t59 / 0.288e3 + t321 * t343 * t423 * t257 / 0.144e3 - t461 * t463 / 0.144e3 + t466 * t468 / 0.48e2 - t471 * t463 / 0.96e2 + t474 * t468 / 0.24e2 - t477 * t463 / 0.72e2 + 0.5e1 / 0.72e2 * t480 * t468 - 0.5e1 / 0.288e3 * t483 * t463;
    const double t490 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t19 * t486 );


    vrho = 0.2e1 * rho * t144 + 0.2e1 * t78;
    vsigma = 0.2e1 * rho * t187;
    v2rho2 = 0.2e1 * rho * t330 + 0.4e1 * t144;
    v2rhosigma = 0.2e1 * rho * t418 + 0.2e1 * t187;
    v2sigma2 = 0.2e1 * rho * t490;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& eps ) {

    (void)(sigma_ab);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_pi;
    constexpr double t30 = constants::m_cbrt_6;
    constexpr double t33 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 / t3;
    constexpr double t28 = a_0;
    constexpr double t29 = a_1;
    constexpr double t31 = mu * t30;
    constexpr double t34 = t33 * t33;
    constexpr double t35 = 0.1e1 / t34;
    constexpr double t36 = t31 * t35;
    constexpr double t37 = 0.1e1 / kappa;
    constexpr double t51 = a_2;
    constexpr double t54 = a_3;
    constexpr double t57 = a_4;
    constexpr double t60 = a_5;
    constexpr double t63 = b_0;
    constexpr double t64 = b_1;
    constexpr double t68 = b_2;
    constexpr double t71 = b_3;
    constexpr double t74 = b_4;
    constexpr double t77 = b_5;


    const double t1 = rho_a <= dens_tol;
    const double t6 = rho_a + rho_b;
    const double t7 = 0.1e1 / t6;
    const double t10 = 0.2e1 * rho_a * t7 <= zeta_tol;
    const double t11 = zeta_tol - 0.1e1;
    const double t14 = 0.2e1 * rho_b * t7 <= zeta_tol;
    const double t15 = -t11;
    const double t16 = rho_a - rho_b;
    const double t18 = piecewise_functor_5( t10, t11, t14, t15, t16 * t7 );
    const double t19 = 0.1e1 + t18;
    const double t20 = t19 <= zeta_tol;
    const double t21 = safe_math::cbrt( zeta_tol );
    const double t22 = t21 * zeta_tol;
    const double t23 = safe_math::cbrt( t19 );
    const double t25 = piecewise_functor_3( t20, t22, t23 * t19 );
    const double t26 = safe_math::cbrt( t6 );
    const double t27 = t25 * t26;
    const double t38 = t37 * sigma_aa;
    const double t39 = rho_a * rho_a;
    const double t40 = safe_math::cbrt( rho_a );
    const double t41 = t40 * t40;
    const double t43 = 0.1e1 / t41 / t39;
    const double t46 = t36 * t38 * t43 / 0.24e2;
    const double t47 = 0.1e1 + t46;
    const double t49 = 0.1e1 - 0.1e1 / t47;
    const double t52 = t49 * t49;
    const double t55 = t52 * t49;
    const double t58 = t52 * t52;
    const double t65 = safe_math::exp( -t46 );
    const double t66 = 0.1e1 - t65;
    const double t69 = t66 * t66;
    const double t72 = t69 * t66;
    const double t75 = t69 * t69;
    const double t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
    const double t84 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t80 );
    const double t85 = rho_b <= dens_tol;
    const double t86 = -t16;
    const double t88 = piecewise_functor_5( t14, t11, t10, t15, t86 * t7 );
    const double t89 = 0.1e1 + t88;
    const double t90 = t89 <= zeta_tol;
    const double t91 = safe_math::cbrt( t89 );
    const double t93 = piecewise_functor_3( t90, t22, t91 * t89 );
    const double t94 = t93 * t26;
    const double t95 = t37 * sigma_bb;
    const double t96 = rho_b * rho_b;
    const double t97 = safe_math::cbrt( rho_b );
    const double t98 = t97 * t97;
    const double t100 = 0.1e1 / t98 / t96;
    const double t103 = t36 * t95 * t100 / 0.24e2;
    const double t104 = 0.1e1 + t103;
    const double t106 = 0.1e1 - 0.1e1 / t104;
    const double t108 = t106 * t106;
    const double t110 = t108 * t106;
    const double t112 = t108 * t108;
    const double t116 = safe_math::exp( -t103 );
    const double t117 = 0.1e1 - t116;
    const double t119 = t117 * t117;
    const double t121 = t119 * t117;
    const double t123 = t119 * t119;
    const double t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
    const double t131 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t127 );


    eps = t84 + t131;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb ) {

    (void)(sigma_ab);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_pi;
    constexpr double t30 = constants::m_cbrt_6;
    constexpr double t33 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 / t3;
    constexpr double t28 = a_0;
    constexpr double t29 = a_1;
    constexpr double t31 = mu * t30;
    constexpr double t34 = t33 * t33;
    constexpr double t35 = 0.1e1 / t34;
    constexpr double t36 = t31 * t35;
    constexpr double t37 = 0.1e1 / kappa;
    constexpr double t51 = a_2;
    constexpr double t54 = a_3;
    constexpr double t57 = a_4;
    constexpr double t60 = a_5;
    constexpr double t63 = b_0;
    constexpr double t64 = b_1;
    constexpr double t68 = b_2;
    constexpr double t71 = b_3;
    constexpr double t74 = b_4;
    constexpr double t77 = b_5;
    constexpr double t154 = t35 * t37;
    constexpr double t165 = t30 * t35;
    constexpr double t182 = t64 * mu;
    constexpr double t183 = t182 * t165;
    constexpr double t323 = t182 * t30;


    const double t1 = rho_a <= dens_tol;
    const double t6 = rho_a + rho_b;
    const double t7 = 0.1e1 / t6;
    const double t10 = 0.2e1 * rho_a * t7 <= zeta_tol;
    const double t11 = zeta_tol - 0.1e1;
    const double t14 = 0.2e1 * rho_b * t7 <= zeta_tol;
    const double t15 = -t11;
    const double t16 = rho_a - rho_b;
    const double t18 = piecewise_functor_5( t10, t11, t14, t15, t16 * t7 );
    const double t19 = 0.1e1 + t18;
    const double t20 = t19 <= zeta_tol;
    const double t21 = safe_math::cbrt( zeta_tol );
    const double t22 = t21 * zeta_tol;
    const double t23 = safe_math::cbrt( t19 );
    const double t25 = piecewise_functor_3( t20, t22, t23 * t19 );
    const double t26 = safe_math::cbrt( t6 );
    const double t27 = t25 * t26;
    const double t38 = t37 * sigma_aa;
    const double t39 = rho_a * rho_a;
    const double t40 = safe_math::cbrt( rho_a );
    const double t41 = t40 * t40;
    const double t43 = 0.1e1 / t41 / t39;
    const double t46 = t36 * t38 * t43 / 0.24e2;
    const double t47 = 0.1e1 + t46;
    const double t49 = 0.1e1 - 0.1e1 / t47;
    const double t52 = t49 * t49;
    const double t55 = t52 * t49;
    const double t58 = t52 * t52;
    const double t65 = safe_math::exp( -t46 );
    const double t66 = 0.1e1 - t65;
    const double t69 = t66 * t66;
    const double t72 = t69 * t66;
    const double t75 = t69 * t69;
    const double t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
    const double t84 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t80 );
    const double t85 = rho_b <= dens_tol;
    const double t86 = -t16;
    const double t88 = piecewise_functor_5( t14, t11, t10, t15, t86 * t7 );
    const double t89 = 0.1e1 + t88;
    const double t90 = t89 <= zeta_tol;
    const double t91 = safe_math::cbrt( t89 );
    const double t93 = piecewise_functor_3( t90, t22, t91 * t89 );
    const double t94 = t93 * t26;
    const double t95 = t37 * sigma_bb;
    const double t96 = rho_b * rho_b;
    const double t97 = safe_math::cbrt( rho_b );
    const double t98 = t97 * t97;
    const double t100 = 0.1e1 / t98 / t96;
    const double t103 = t36 * t95 * t100 / 0.24e2;
    const double t104 = 0.1e1 + t103;
    const double t106 = 0.1e1 - 0.1e1 / t104;
    const double t108 = t106 * t106;
    const double t110 = t108 * t106;
    const double t112 = t108 * t108;
    const double t116 = safe_math::exp( -t103 );
    const double t117 = 0.1e1 - t116;
    const double t119 = t117 * t117;
    const double t121 = t119 * t117;
    const double t123 = t119 * t119;
    const double t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
    const double t131 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t127 );
    const double t132 = t6 * t6;
    const double t133 = 0.1e1 / t132;
    const double t134 = t16 * t133;
    const double t136 = piecewise_functor_5( t10, 0.0, t14, 0.0, t7 - t134 );
    const double t139 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.3e1 * t23 * t136 );
    const double t140 = t139 * t26;
    const double t144 = t26 * t26;
    const double t145 = 0.1e1 / t144;
    const double t146 = t25 * t145;
    const double t149 = t5 * t146 * t80 / 0.8e1;
    const double t150 = t47 * t47;
    const double t151 = 0.1e1 / t150;
    const double t152 = t29 * t151;
    const double t153 = t152 * t31;
    const double t155 = t39 * rho_a;
    const double t157 = 0.1e1 / t41 / t155;
    const double t158 = sigma_aa * t157;
    const double t162 = t51 * t49;
    const double t163 = t151 * mu;
    const double t164 = t162 * t163;
    const double t167 = t165 * t38 * t157;
    const double t170 = t54 * t52;
    const double t171 = t170 * t163;
    const double t174 = t57 * t55;
    const double t175 = t174 * t163;
    const double t178 = t60 * t58;
    const double t179 = t178 * t163;
    const double t184 = t157 * t65;
    const double t188 = t68 * t66;
    const double t189 = t188 * t31;
    const double t191 = t154 * t158 * t65;
    const double t194 = t71 * t69;
    const double t195 = t194 * t31;
    const double t198 = t74 * t72;
    const double t199 = t198 * t31;
    const double t202 = t77 * t75;
    const double t203 = t202 * t31;
    const double t206 = -t153 * t154 * t158 / 0.9e1 - 0.2e1 / 0.9e1 * t164 * t167 - t171 * t167 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t167 - 0.5e1 / 0.9e1 * t179 * t167 - t183 * t38 * t184 / 0.9e1 - 0.2e1 / 0.9e1 * t189 * t191 - t195 * t191 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t191 - 0.5e1 / 0.9e1 * t203 * t191;
    const double t211 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t140 * t80 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t206 );
    const double t212 = t86 * t133;
    const double t214 = piecewise_functor_5( t14, 0.0, t10, 0.0, -t7 - t212 );
    const double t217 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t214 );
    const double t218 = t217 * t26;
    const double t222 = t93 * t145;
    const double t225 = t5 * t222 * t127 / 0.8e1;
    const double t227 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t218 * t127 - t225 );
    const double t231 = piecewise_functor_5( t10, 0.0, t14, 0.0, -t7 - t134 );
    const double t234 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.3e1 * t23 * t231 );
    const double t235 = t234 * t26;
    const double t240 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t235 * t80 - t149 );
    const double t242 = piecewise_functor_5( t14, 0.0, t10, 0.0, t7 - t212 );
    const double t245 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t242 );
    const double t246 = t245 * t26;
    const double t250 = t104 * t104;
    const double t251 = 0.1e1 / t250;
    const double t252 = t29 * t251;
    const double t253 = t252 * t31;
    const double t254 = t96 * rho_b;
    const double t256 = 0.1e1 / t98 / t254;
    const double t257 = sigma_bb * t256;
    const double t261 = t51 * t106;
    const double t262 = t251 * mu;
    const double t263 = t261 * t262;
    const double t265 = t165 * t95 * t256;
    const double t268 = t54 * t108;
    const double t269 = t268 * t262;
    const double t272 = t57 * t110;
    const double t273 = t272 * t262;
    const double t276 = t60 * t112;
    const double t277 = t276 * t262;
    const double t280 = t256 * t116;
    const double t284 = t68 * t117;
    const double t285 = t284 * t31;
    const double t287 = t154 * t257 * t116;
    const double t290 = t71 * t119;
    const double t291 = t290 * t31;
    const double t294 = t74 * t121;
    const double t295 = t294 * t31;
    const double t298 = t77 * t123;
    const double t299 = t298 * t31;
    const double t302 = -t253 * t154 * t257 / 0.9e1 - 0.2e1 / 0.9e1 * t263 * t265 - t269 * t265 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t265 - 0.5e1 / 0.9e1 * t277 * t265 - t183 * t95 * t280 / 0.9e1 - 0.2e1 / 0.9e1 * t285 * t287 - t291 * t287 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t287 - 0.5e1 / 0.9e1 * t299 * t287;
    const double t307 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t246 * t127 - t225 - 0.3e1 / 0.8e1 * t5 * t94 * t302 );
    const double t310 = t152 * mu;
    const double t312 = t165 * t37 * t43;
    const double t325 = t154 * t43 * t65;
    const double t336 = t310 * t312 / 0.24e2 + t164 * t312 / 0.12e2 + t171 * t312 / 0.8e1 + t175 * t312 / 0.6e1 + 0.5e1 / 0.24e2 * t179 * t312 + t323 * t325 / 0.24e2 + t189 * t325 / 0.12e2 + t195 * t325 / 0.8e1 + t199 * t325 / 0.6e1 + 0.5e1 / 0.24e2 * t203 * t325;
    const double t340 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t336 );
    const double t341 = t252 * mu;
    const double t343 = t165 * t37 * t100;
    const double t355 = t154 * t100 * t116;
    const double t366 = t341 * t343 / 0.24e2 + t263 * t343 / 0.12e2 + t269 * t343 / 0.8e1 + t273 * t343 / 0.6e1 + 0.5e1 / 0.24e2 * t277 * t343 + t323 * t355 / 0.24e2 + t285 * t355 / 0.12e2 + t291 * t355 / 0.8e1 + t295 * t355 / 0.6e1 + 0.5e1 / 0.24e2 * t299 * t355;
    const double t370 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t366 );


    eps = t84 + t131;
    vrho_a = t84 + t131 + t6 * ( t211 + t227 );
    vrho_b = t84 + t131 + t6 * ( t240 + t307 );
    vsigma_aa = t6 * t340;
    vsigma_ab = 0.e0;
    vsigma_bb = t6 * t370;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_fxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& v2rho2_aa, double& v2rho2_ab, double& v2rho2_bb, double& v2rhosigma_a_aa, double& v2rhosigma_a_ab, double& v2rhosigma_a_bb, double& v2rhosigma_b_aa, double& v2rhosigma_b_ab, double& v2rhosigma_b_bb, double& v2sigma2_aa_aa, double& v2sigma2_aa_ab, double& v2sigma2_aa_bb, double& v2sigma2_ab_ab, double& v2sigma2_ab_bb, double& v2sigma2_bb_bb ) {

    (void)(sigma_ab);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_pi;
    constexpr double t30 = constants::m_cbrt_6;
    constexpr double t32 = constants::m_pi_sq;
    constexpr double t33 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 / t3;
    constexpr double t28 = a_0;
    constexpr double t29 = a_1;
    constexpr double t31 = mu * t30;
    constexpr double t34 = t33 * t33;
    constexpr double t35 = 0.1e1 / t34;
    constexpr double t36 = t31 * t35;
    constexpr double t37 = 0.1e1 / kappa;
    constexpr double t51 = a_2;
    constexpr double t54 = a_3;
    constexpr double t57 = a_4;
    constexpr double t60 = a_5;
    constexpr double t63 = b_0;
    constexpr double t64 = b_1;
    constexpr double t68 = b_2;
    constexpr double t71 = b_3;
    constexpr double t74 = b_4;
    constexpr double t77 = b_5;
    constexpr double t154 = t35 * t37;
    constexpr double t165 = t30 * t35;
    constexpr double t182 = t64 * mu;
    constexpr double t183 = t182 * t165;
    constexpr double t323 = t182 * t30;
    constexpr double t411 = mu * mu;
    constexpr double t412 = t30 * t30;
    constexpr double t413 = t411 * t412;
    constexpr double t416 = 0.1e1 / t33 / t32;
    constexpr double t417 = kappa * kappa;
    constexpr double t418 = 0.1e1 / t417;
    constexpr double t419 = t416 * t418;
    constexpr double t435 = t64 * t411;
    constexpr double t436 = t412 * t416;
    constexpr double t437 = t435 * t436;
    constexpr double t443 = t68 * t411;
    constexpr double t444 = t443 * t436;
    constexpr double t1007 = t435 * t412;
    constexpr double t1012 = t443 * t412;


    const double t1 = rho_a <= dens_tol;
    const double t6 = rho_a + rho_b;
    const double t7 = 0.1e1 / t6;
    const double t10 = 0.2e1 * rho_a * t7 <= zeta_tol;
    const double t11 = zeta_tol - 0.1e1;
    const double t14 = 0.2e1 * rho_b * t7 <= zeta_tol;
    const double t15 = -t11;
    const double t16 = rho_a - rho_b;
    const double t18 = piecewise_functor_5( t10, t11, t14, t15, t16 * t7 );
    const double t19 = 0.1e1 + t18;
    const double t20 = t19 <= zeta_tol;
    const double t21 = safe_math::cbrt( zeta_tol );
    const double t22 = t21 * zeta_tol;
    const double t23 = safe_math::cbrt( t19 );
    const double t25 = piecewise_functor_3( t20, t22, t23 * t19 );
    const double t26 = safe_math::cbrt( t6 );
    const double t27 = t25 * t26;
    const double t38 = t37 * sigma_aa;
    const double t39 = rho_a * rho_a;
    const double t40 = safe_math::cbrt( rho_a );
    const double t41 = t40 * t40;
    const double t43 = 0.1e1 / t41 / t39;
    const double t46 = t36 * t38 * t43 / 0.24e2;
    const double t47 = 0.1e1 + t46;
    const double t49 = 0.1e1 - 0.1e1 / t47;
    const double t52 = t49 * t49;
    const double t55 = t52 * t49;
    const double t58 = t52 * t52;
    const double t65 = safe_math::exp( -t46 );
    const double t66 = 0.1e1 - t65;
    const double t69 = t66 * t66;
    const double t72 = t69 * t66;
    const double t75 = t69 * t69;
    const double t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
    const double t85 = rho_b <= dens_tol;
    const double t86 = -t16;
    const double t88 = piecewise_functor_5( t14, t11, t10, t15, t86 * t7 );
    const double t89 = 0.1e1 + t88;
    const double t90 = t89 <= zeta_tol;
    const double t91 = safe_math::cbrt( t89 );
    const double t93 = piecewise_functor_3( t90, t22, t91 * t89 );
    const double t94 = t93 * t26;
    const double t95 = t37 * sigma_bb;
    const double t96 = rho_b * rho_b;
    const double t97 = safe_math::cbrt( rho_b );
    const double t98 = t97 * t97;
    const double t100 = 0.1e1 / t98 / t96;
    const double t103 = t36 * t95 * t100 / 0.24e2;
    const double t104 = 0.1e1 + t103;
    const double t106 = 0.1e1 - 0.1e1 / t104;
    const double t108 = t106 * t106;
    const double t110 = t108 * t106;
    const double t112 = t108 * t108;
    const double t116 = safe_math::exp( -t103 );
    const double t117 = 0.1e1 - t116;
    const double t119 = t117 * t117;
    const double t121 = t119 * t117;
    const double t123 = t119 * t119;
    const double t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
    const double t132 = t6 * t6;
    const double t133 = 0.1e1 / t132;
    const double t134 = t16 * t133;
    const double t136 = piecewise_functor_5( t10, 0.0, t14, 0.0, t7 - t134 );
    const double t139 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.3e1 * t23 * t136 );
    const double t140 = t139 * t26;
    const double t144 = t26 * t26;
    const double t145 = 0.1e1 / t144;
    const double t146 = t25 * t145;
    const double t149 = t5 * t146 * t80 / 0.8e1;
    const double t150 = t47 * t47;
    const double t151 = 0.1e1 / t150;
    const double t152 = t29 * t151;
    const double t153 = t152 * t31;
    const double t155 = t39 * rho_a;
    const double t157 = 0.1e1 / t41 / t155;
    const double t158 = sigma_aa * t157;
    const double t162 = t51 * t49;
    const double t163 = t151 * mu;
    const double t164 = t162 * t163;
    const double t167 = t165 * t38 * t157;
    const double t170 = t54 * t52;
    const double t171 = t170 * t163;
    const double t174 = t57 * t55;
    const double t175 = t174 * t163;
    const double t178 = t60 * t58;
    const double t179 = t178 * t163;
    const double t184 = t157 * t65;
    const double t188 = t68 * t66;
    const double t189 = t188 * t31;
    const double t191 = t154 * t158 * t65;
    const double t194 = t71 * t69;
    const double t195 = t194 * t31;
    const double t198 = t74 * t72;
    const double t199 = t198 * t31;
    const double t202 = t77 * t75;
    const double t203 = t202 * t31;
    const double t206 = -t153 * t154 * t158 / 0.9e1 - 0.2e1 / 0.9e1 * t164 * t167 - t171 * t167 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t167 - 0.5e1 / 0.9e1 * t179 * t167 - t183 * t38 * t184 / 0.9e1 - 0.2e1 / 0.9e1 * t189 * t191 - t195 * t191 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t191 - 0.5e1 / 0.9e1 * t203 * t191;
    const double t211 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t140 * t80 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t206 );
    const double t212 = t86 * t133;
    const double t214 = piecewise_functor_5( t14, 0.0, t10, 0.0, -t7 - t212 );
    const double t217 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t214 );
    const double t218 = t217 * t26;
    const double t222 = t93 * t145;
    const double t225 = t5 * t222 * t127 / 0.8e1;
    const double t227 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t218 * t127 - t225 );
    const double t231 = piecewise_functor_5( t10, 0.0, t14, 0.0, -t7 - t134 );
    const double t234 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.3e1 * t23 * t231 );
    const double t235 = t234 * t26;
    const double t240 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t235 * t80 - t149 );
    const double t242 = piecewise_functor_5( t14, 0.0, t10, 0.0, t7 - t212 );
    const double t245 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t242 );
    const double t246 = t245 * t26;
    const double t250 = t104 * t104;
    const double t251 = 0.1e1 / t250;
    const double t252 = t29 * t251;
    const double t253 = t252 * t31;
    const double t254 = t96 * rho_b;
    const double t256 = 0.1e1 / t98 / t254;
    const double t257 = sigma_bb * t256;
    const double t261 = t51 * t106;
    const double t262 = t251 * mu;
    const double t263 = t261 * t262;
    const double t265 = t165 * t95 * t256;
    const double t268 = t54 * t108;
    const double t269 = t268 * t262;
    const double t272 = t57 * t110;
    const double t273 = t272 * t262;
    const double t276 = t60 * t112;
    const double t277 = t276 * t262;
    const double t280 = t256 * t116;
    const double t284 = t68 * t117;
    const double t285 = t284 * t31;
    const double t287 = t154 * t257 * t116;
    const double t290 = t71 * t119;
    const double t291 = t290 * t31;
    const double t294 = t74 * t121;
    const double t295 = t294 * t31;
    const double t298 = t77 * t123;
    const double t299 = t298 * t31;
    const double t302 = -t253 * t154 * t257 / 0.9e1 - 0.2e1 / 0.9e1 * t263 * t265 - t269 * t265 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t265 - 0.5e1 / 0.9e1 * t277 * t265 - t183 * t95 * t280 / 0.9e1 - 0.2e1 / 0.9e1 * t285 * t287 - t291 * t287 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t287 - 0.5e1 / 0.9e1 * t299 * t287;
    const double t307 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t246 * t127 - t225 - 0.3e1 / 0.8e1 * t5 * t94 * t302 );
    const double t310 = t152 * mu;
    const double t312 = t165 * t37 * t43;
    const double t325 = t154 * t43 * t65;
    const double t336 = t310 * t312 / 0.24e2 + t164 * t312 / 0.12e2 + t171 * t312 / 0.8e1 + t175 * t312 / 0.6e1 + 0.5e1 / 0.24e2 * t179 * t312 + t323 * t325 / 0.24e2 + t189 * t325 / 0.12e2 + t195 * t325 / 0.8e1 + t199 * t325 / 0.6e1 + 0.5e1 / 0.24e2 * t203 * t325;
    const double t340 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t336 );
    const double t341 = t252 * mu;
    const double t343 = t165 * t37 * t100;
    const double t355 = t154 * t100 * t116;
    const double t366 = t341 * t343 / 0.24e2 + t263 * t343 / 0.12e2 + t269 * t343 / 0.8e1 + t273 * t343 / 0.6e1 + 0.5e1 / 0.24e2 * t277 * t343 + t323 * t355 / 0.24e2 + t285 * t355 / 0.12e2 + t291 * t355 / 0.8e1 + t295 * t355 / 0.6e1 + 0.5e1 / 0.24e2 * t299 * t355;
    const double t370 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t366 );
    const double t373 = t23 * t23;
    const double t374 = 0.1e1 / t373;
    const double t375 = t136 * t136;
    const double t378 = t132 * t6;
    const double t379 = 0.1e1 / t378;
    const double t380 = t16 * t379;
    const double t383 = piecewise_functor_5( t10, 0.0, t14, 0.0, -0.2e1 * t133 + 0.2e1 * t380 );
    const double t387 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.9e1 * t374 * t375 + 0.4e1 / 0.3e1 * t23 * t383 );
    const double t388 = t387 * t26;
    const double t392 = t139 * t145;
    const double t394 = t5 * t392 * t80;
    const double t400 = 0.1e1 / t144 / t6;
    const double t401 = t25 * t400;
    const double t404 = t5 * t401 * t80 / 0.12e2;
    const double t406 = t5 * t146 * t206;
    const double t408 = t150 * t47;
    const double t409 = 0.1e1 / t408;
    const double t410 = t29 * t409;
    const double t414 = t410 * t413;
    const double t420 = sigma_aa * sigma_aa;
    const double t421 = t39 * t39;
    const double t424 = 0.1e1 / t40 / t421 / t155;
    const double t425 = t420 * t424;
    const double t426 = t419 * t425;
    const double t429 = t150 * t150;
    const double t430 = 0.1e1 / t429;
    const double t431 = t51 * t430;
    const double t432 = t431 * t413;
    const double t438 = t418 * t420;
    const double t439 = t424 * t65;
    const double t445 = t65 * t65;
    const double t446 = t424 * t445;
    const double t451 = 0.1e1 / t41 / t421;
    const double t452 = sigma_aa * t451;
    const double t456 = t451 * t65;
    const double t460 = t409 * t411;
    const double t461 = t162 * t460;
    const double t463 = t436 * t438 * t424;
    const double t466 = t54 * t49;
    const double t467 = t430 * t411;
    const double t468 = t466 * t467;
    const double t471 = t170 * t460;
    const double t474 = t57 * t52;
    const double t475 = t474 * t467;
    const double t478 = t174 * t460;
    const double t481 = t60 * t55;
    const double t482 = t481 * t467;
    const double t485 = t178 * t460;
    const double t488 = t188 * t413;
    const double t490 = t419 * t425 * t65;
    const double t493 = -0.2e1 / 0.81e2 * t414 * t426 + 0.2e1 / 0.81e2 * t432 * t426 - t437 * t438 * t439 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t438 * t446 + 0.11e2 / 0.27e2 * t153 * t154 * t452 + 0.11e2 / 0.27e2 * t183 * t38 * t456 - 0.4e1 / 0.81e2 * t461 * t463 + 0.2e1 / 0.27e2 * t468 * t463 - 0.2e1 / 0.27e2 * t471 * t463 + 0.4e1 / 0.27e2 * t475 * t463 - 0.8e1 / 0.81e2 * t478 * t463 + 0.2e2 / 0.81e2 * t482 * t463 - 0.1e2 / 0.81e2 * t485 * t463 - 0.2e1 / 0.81e2 * t488 * t490;
    const double t494 = t71 * t66;
    const double t495 = t494 * t413;
    const double t497 = t419 * t425 * t445;
    const double t500 = t194 * t413;
    const double t503 = t74 * t69;
    const double t504 = t503 * t413;
    const double t507 = t198 * t413;
    const double t510 = t77 * t72;
    const double t511 = t510 * t413;
    const double t514 = t202 * t413;
    const double t518 = t165 * t38 * t451;
    const double t528 = t154 * t452 * t65;
    const double t537 = 0.2e1 / 0.27e2 * t495 * t497 - t500 * t490 / 0.27e2 + 0.4e1 / 0.27e2 * t504 * t497 - 0.4e1 / 0.81e2 * t507 * t490 + 0.2e2 / 0.81e2 * t511 * t497 - 0.5e1 / 0.81e2 * t514 * t490 + 0.22e2 / 0.27e2 * t164 * t518 + 0.11e2 / 0.9e1 * t171 * t518 + 0.44e2 / 0.27e2 * t175 * t518 + 0.55e2 / 0.27e2 * t179 * t518 + 0.22e2 / 0.27e2 * t189 * t528 + 0.11e2 / 0.9e1 * t195 * t528 + 0.44e2 / 0.27e2 * t199 * t528 + 0.55e2 / 0.27e2 * t203 * t528;
    const double t538 = t493 + t537;
    const double t543 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t388 * t80 - t394 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t206 + t404 - t406 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t538 );
    const double t544 = t91 * t91;
    const double t545 = 0.1e1 / t544;
    const double t546 = t214 * t214;
    const double t549 = t86 * t379;
    const double t552 = piecewise_functor_5( t14, 0.0, t10, 0.0, 0.2e1 * t133 + 0.2e1 * t549 );
    const double t556 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.9e1 * t545 * t546 + 0.4e1 / 0.3e1 * t91 * t552 );
    const double t557 = t556 * t26;
    const double t561 = t217 * t145;
    const double t563 = t5 * t561 * t127;
    const double t565 = t93 * t400;
    const double t568 = t5 * t565 * t127 / 0.12e2;
    const double t570 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t557 * t127 - t563 / 0.4e1 + t568 );
    const double t586 = t234 * t145;
    const double t588 = t5 * t586 * t80;
    const double t610 = t245 * t145;
    const double t612 = t5 * t610 * t127;
    const double t619 = t5 * t222 * t302;
    const double t627 = t231 * t231;
    const double t632 = piecewise_functor_5( t10, 0.0, t14, 0.0, 0.2e1 * t133 + 0.2e1 * t380 );
    const double t636 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.9e1 * t374 * t627 + 0.4e1 / 0.3e1 * t23 * t632 );
    const double t637 = t636 * t26;
    const double t643 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t637 * t80 - t588 / 0.4e1 + t404 );
    const double t644 = t242 * t242;
    const double t649 = piecewise_functor_5( t14, 0.0, t10, 0.0, -0.2e1 * t133 + 0.2e1 * t549 );
    const double t653 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.9e1 * t545 * t644 + 0.4e1 / 0.3e1 * t91 * t649 );
    const double t654 = t653 * t26;
    const double t663 = t250 * t104;
    const double t664 = 0.1e1 / t663;
    const double t665 = t29 * t664;
    const double t666 = t665 * t413;
    const double t667 = sigma_bb * sigma_bb;
    const double t668 = t96 * t96;
    const double t671 = 0.1e1 / t97 / t668 / t254;
    const double t672 = t667 * t671;
    const double t673 = t419 * t672;
    const double t676 = t250 * t250;
    const double t677 = 0.1e1 / t676;
    const double t678 = t51 * t677;
    const double t679 = t678 * t413;
    const double t682 = t418 * t667;
    const double t683 = t671 * t116;
    const double t687 = t116 * t116;
    const double t688 = t671 * t687;
    const double t693 = 0.1e1 / t98 / t668;
    const double t694 = sigma_bb * t693;
    const double t698 = t693 * t116;
    const double t703 = t165 * t95 * t693;
    const double t713 = t154 * t694 * t116;
    const double t722 = -0.2e1 / 0.81e2 * t666 * t673 + 0.2e1 / 0.81e2 * t679 * t673 - t437 * t682 * t683 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t682 * t688 + 0.11e2 / 0.27e2 * t253 * t154 * t694 + 0.11e2 / 0.27e2 * t183 * t95 * t698 + 0.22e2 / 0.27e2 * t263 * t703 + 0.11e2 / 0.9e1 * t269 * t703 + 0.44e2 / 0.27e2 * t273 * t703 + 0.55e2 / 0.27e2 * t277 * t703 + 0.22e2 / 0.27e2 * t285 * t713 + 0.11e2 / 0.9e1 * t291 * t713 + 0.44e2 / 0.27e2 * t295 * t713 + 0.55e2 / 0.27e2 * t299 * t713;
    const double t723 = t664 * t411;
    const double t724 = t261 * t723;
    const double t726 = t436 * t682 * t671;
    const double t729 = t54 * t106;
    const double t730 = t677 * t411;
    const double t731 = t729 * t730;
    const double t734 = t268 * t723;
    const double t737 = t57 * t108;
    const double t738 = t737 * t730;
    const double t741 = t272 * t723;
    const double t744 = t60 * t110;
    const double t745 = t744 * t730;
    const double t748 = t276 * t723;
    const double t751 = t284 * t413;
    const double t753 = t419 * t672 * t116;
    const double t756 = t71 * t117;
    const double t757 = t756 * t413;
    const double t759 = t419 * t672 * t687;
    const double t762 = t290 * t413;
    const double t765 = t74 * t119;
    const double t766 = t765 * t413;
    const double t769 = t294 * t413;
    const double t772 = t77 * t121;
    const double t773 = t772 * t413;
    const double t776 = t298 * t413;
    const double t779 = -0.4e1 / 0.81e2 * t724 * t726 + 0.2e1 / 0.27e2 * t731 * t726 - 0.2e1 / 0.27e2 * t734 * t726 + 0.4e1 / 0.27e2 * t738 * t726 - 0.8e1 / 0.81e2 * t741 * t726 + 0.2e2 / 0.81e2 * t745 * t726 - 0.1e2 / 0.81e2 * t748 * t726 - 0.2e1 / 0.81e2 * t751 * t753 + 0.2e1 / 0.27e2 * t757 * t759 - t762 * t753 / 0.27e2 + 0.4e1 / 0.27e2 * t766 * t759 - 0.4e1 / 0.81e2 * t769 * t753 + 0.2e2 / 0.81e2 * t773 * t759 - 0.5e1 / 0.81e2 * t776 * t753;
    const double t780 = t722 + t779;
    const double t785 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t654 * t127 - t612 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t302 + t568 - t619 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * t780 );
    const double t793 = t5 * t146 * t336 / 0.8e1;
    const double t794 = t421 * t39;
    const double t796 = 0.1e1 / t40 / t794;
    const double t797 = sigma_aa * t796;
    const double t798 = t419 * t797;
    const double t801 = t418 * t796;
    const double t802 = sigma_aa * t65;
    const double t806 = t418 * sigma_aa;
    const double t807 = t796 * t445;
    const double t812 = t165 * t37 * t157;
    const double t821 = t154 * t184;
    const double t836 = -t432 * t798 / 0.108e3 + t437 * t801 * t802 / 0.216e3 - t444 * t806 * t807 / 0.108e3 - 0.2e1 / 0.9e1 * t164 * t812 - t171 * t812 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t812 - 0.5e1 / 0.9e1 * t179 * t812 - 0.2e1 / 0.9e1 * t189 * t821 - t195 * t821 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t821 - 0.5e1 / 0.9e1 * t203 * t821 + t414 * t798 / 0.108e3 - t323 * t821 / 0.9e1 - t310 * t812 / 0.9e1;
    const double t838 = t436 * t801 * sigma_aa;
    const double t846 = t419 * t797 * t65;
    const double t850 = t419 * t807 * sigma_aa;
    const double t871 = t478 * t838 / 0.27e2 - 0.5e1 / 0.54e2 * t482 * t838 + 0.5e1 / 0.108e3 * t485 * t838 + t488 * t846 / 0.108e3 - t495 * t850 / 0.36e2 + t500 * t846 / 0.72e2 - t504 * t850 / 0.18e2 + t507 * t846 / 0.54e2 - 0.5e1 / 0.54e2 * t511 * t850 + 0.5e1 / 0.216e3 * t514 * t846 + t461 * t838 / 0.54e2 - t468 * t838 / 0.36e2 + t471 * t838 / 0.36e2 - t475 * t838 / 0.18e2;
    const double t872 = t836 + t871;
    const double t877 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t140 * t336 - t793 - 0.3e1 / 0.8e1 * t5 * t27 * t872 );
    const double t884 = t5 * t222 * t366 / 0.8e1;
    const double t897 = t668 * t96;
    const double t899 = 0.1e1 / t97 / t897;
    const double t900 = t899 * sigma_bb;
    const double t902 = t419 * t900 * t116;
    const double t905 = t899 * t687;
    const double t907 = t419 * t905 * sigma_bb;
    const double t920 = t418 * t899;
    const double t922 = t436 * t920 * sigma_bb;
    const double t937 = t751 * t902 / 0.108e3 - t757 * t907 / 0.36e2 + t762 * t902 / 0.72e2 - t766 * t907 / 0.18e2 + t769 * t902 / 0.54e2 - 0.5e1 / 0.54e2 * t773 * t907 + 0.5e1 / 0.216e3 * t776 * t902 + t724 * t922 / 0.54e2 - t731 * t922 / 0.36e2 + t734 * t922 / 0.36e2 - t738 * t922 / 0.18e2 + t741 * t922 / 0.27e2 - 0.5e1 / 0.54e2 * t745 * t922 + 0.5e1 / 0.108e3 * t748 * t922;
    const double t938 = t154 * t280;
    const double t942 = t165 * t37 * t256;
    const double t945 = sigma_bb * t116;
    const double t949 = t418 * sigma_bb;
    const double t953 = t419 * t900;
    const double t974 = -t323 * t938 / 0.9e1 - t341 * t942 / 0.9e1 + t437 * t920 * t945 / 0.216e3 - t444 * t949 * t905 / 0.108e3 + t666 * t953 / 0.108e3 - t679 * t953 / 0.108e3 - 0.2e1 / 0.9e1 * t263 * t942 - t269 * t942 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t942 - 0.5e1 / 0.9e1 * t277 * t942 - 0.2e1 / 0.9e1 * t285 * t938 - t291 * t938 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t938 - 0.5e1 / 0.9e1 * t299 * t938;
    const double t975 = t937 + t974;
    const double t980 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t246 * t366 - t884 - 0.3e1 / 0.8e1 * t5 * t94 * t975 );
    const double t982 = t410 * t411;
    const double t983 = t421 * rho_a;
    const double t985 = 0.1e1 / t40 / t983;
    const double t987 = t436 * t418 * t985;
    const double t990 = t431 * t411;
    const double t1009 = t419 * t985 * t65;
    const double t1014 = t419 * t985 * t445;
    const double t1031 = -t982 * t987 / 0.288e3 + t990 * t987 / 0.288e3 - t461 * t987 / 0.144e3 + t468 * t987 / 0.96e2 - t471 * t987 / 0.96e2 + t475 * t987 / 0.48e2 - t478 * t987 / 0.72e2 + 0.5e1 / 0.144e3 * t482 * t987 - 0.5e1 / 0.288e3 * t485 * t987 - t1007 * t1009 / 0.576e3 + t1012 * t1014 / 0.288e3 - t488 * t1009 / 0.288e3 + t495 * t1014 / 0.96e2 - t500 * t1009 / 0.192e3 + t504 * t1014 / 0.48e2 - t507 * t1009 / 0.144e3 + 0.5e1 / 0.144e3 * t511 * t1014 - 0.5e1 / 0.576e3 * t514 * t1009;
    const double t1035 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t1031 );
    const double t1036 = t665 * t411;
    const double t1037 = t668 * rho_b;
    const double t1039 = 0.1e1 / t97 / t1037;
    const double t1041 = t436 * t418 * t1039;
    const double t1044 = t678 * t411;
    const double t1062 = t419 * t1039 * t116;
    const double t1066 = t419 * t1039 * t687;
    const double t1083 = -t1036 * t1041 / 0.288e3 + t1044 * t1041 / 0.288e3 - t724 * t1041 / 0.144e3 + t731 * t1041 / 0.96e2 - t734 * t1041 / 0.96e2 + t738 * t1041 / 0.48e2 - t741 * t1041 / 0.72e2 + 0.5e1 / 0.144e3 * t745 * t1041 - 0.5e1 / 0.288e3 * t748 * t1041 - t1007 * t1062 / 0.576e3 + t1012 * t1066 / 0.288e3 - t751 * t1062 / 0.288e3 + t757 * t1066 / 0.96e2 - t762 * t1062 / 0.192e3 + t766 * t1066 / 0.48e2 - t769 * t1062 / 0.144e3 + 0.5e1 / 0.144e3 * t773 * t1066 - 0.5e1 / 0.576e3 * t776 * t1062;
    const double t1087 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t1083 );


    v2rho2_aa = 0.2e1 * t211 + 0.2e1 * t227 + t6 * ( t543 + t570 );
    v2rho2_bb = 0.2e1 * t240 + 0.2e1 * t307 + t6 * ( t643 + t785 );
    v2rhosigma_a_aa = t6 * t877 + t340;
    v2rhosigma_b_bb = t6 * t980 + t370;
    v2sigma2_aa_aa = t6 * t1035;
    v2sigma2_bb_bb = t6 * t1087;
    v2rho2_ab = 0.0;
    v2rhosigma_a_ab = 0.0;
    v2rhosigma_a_bb = 0.0;
    v2rhosigma_b_aa = 0.0;
    v2rhosigma_b_ab = 0.0;
    v2sigma2_aa_ab = 0.0;
    v2sigma2_aa_bb = 0.0;
    v2sigma2_ab_ab = 0.0;
    v2sigma2_ab_bb = 0.0;



  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_vxc_fxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& v2rho2_aa, double& v2rho2_ab, double& v2rho2_bb, double& v2rhosigma_a_aa, double& v2rhosigma_a_ab, double& v2rhosigma_a_bb, double& v2rhosigma_b_aa, double& v2rhosigma_b_ab, double& v2rhosigma_b_bb, double& v2sigma2_aa_aa, double& v2sigma2_aa_ab, double& v2sigma2_aa_bb, double& v2sigma2_ab_ab, double& v2sigma2_ab_bb, double& v2sigma2_bb_bb ) {

    (void)(sigma_ab);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_pi;
    constexpr double t30 = constants::m_cbrt_6;
    constexpr double t32 = constants::m_pi_sq;
    constexpr double t33 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 / t3;
    constexpr double t28 = a_0;
    constexpr double t29 = a_1;
    constexpr double t31 = mu * t30;
    constexpr double t34 = t33 * t33;
    constexpr double t35 = 0.1e1 / t34;
    constexpr double t36 = t31 * t35;
    constexpr double t37 = 0.1e1 / kappa;
    constexpr double t51 = a_2;
    constexpr double t54 = a_3;
    constexpr double t57 = a_4;
    constexpr double t60 = a_5;
    constexpr double t63 = b_0;
    constexpr double t64 = b_1;
    constexpr double t68 = b_2;
    constexpr double t71 = b_3;
    constexpr double t74 = b_4;
    constexpr double t77 = b_5;
    constexpr double t154 = t35 * t37;
    constexpr double t165 = t30 * t35;
    constexpr double t182 = t64 * mu;
    constexpr double t183 = t182 * t165;
    constexpr double t323 = t182 * t30;
    constexpr double t411 = mu * mu;
    constexpr double t412 = t30 * t30;
    constexpr double t413 = t411 * t412;
    constexpr double t416 = 0.1e1 / t33 / t32;
    constexpr double t417 = kappa * kappa;
    constexpr double t418 = 0.1e1 / t417;
    constexpr double t419 = t416 * t418;
    constexpr double t435 = t64 * t411;
    constexpr double t436 = t412 * t416;
    constexpr double t437 = t435 * t436;
    constexpr double t443 = t68 * t411;
    constexpr double t444 = t443 * t436;
    constexpr double t1007 = t435 * t412;
    constexpr double t1012 = t443 * t412;


    const double t1 = rho_a <= dens_tol;
    const double t6 = rho_a + rho_b;
    const double t7 = 0.1e1 / t6;
    const double t10 = 0.2e1 * rho_a * t7 <= zeta_tol;
    const double t11 = zeta_tol - 0.1e1;
    const double t14 = 0.2e1 * rho_b * t7 <= zeta_tol;
    const double t15 = -t11;
    const double t16 = rho_a - rho_b;
    const double t18 = piecewise_functor_5( t10, t11, t14, t15, t16 * t7 );
    const double t19 = 0.1e1 + t18;
    const double t20 = t19 <= zeta_tol;
    const double t21 = safe_math::cbrt( zeta_tol );
    const double t22 = t21 * zeta_tol;
    const double t23 = safe_math::cbrt( t19 );
    const double t25 = piecewise_functor_3( t20, t22, t23 * t19 );
    const double t26 = safe_math::cbrt( t6 );
    const double t27 = t25 * t26;
    const double t38 = t37 * sigma_aa;
    const double t39 = rho_a * rho_a;
    const double t40 = safe_math::cbrt( rho_a );
    const double t41 = t40 * t40;
    const double t43 = 0.1e1 / t41 / t39;
    const double t46 = t36 * t38 * t43 / 0.24e2;
    const double t47 = 0.1e1 + t46;
    const double t49 = 0.1e1 - 0.1e1 / t47;
    const double t52 = t49 * t49;
    const double t55 = t52 * t49;
    const double t58 = t52 * t52;
    const double t65 = safe_math::exp( -t46 );
    const double t66 = 0.1e1 - t65;
    const double t69 = t66 * t66;
    const double t72 = t69 * t66;
    const double t75 = t69 * t69;
    const double t80 = t60 * t58 * t49 + t77 * t75 * t66 + t29 * t49 + t51 * t52 + t54 * t55 + t57 * t58 + t64 * t66 + t68 * t69 + t71 * t72 + t74 * t75 + t28 + t63;
    const double t84 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t80 );
    const double t85 = rho_b <= dens_tol;
    const double t86 = -t16;
    const double t88 = piecewise_functor_5( t14, t11, t10, t15, t86 * t7 );
    const double t89 = 0.1e1 + t88;
    const double t90 = t89 <= zeta_tol;
    const double t91 = safe_math::cbrt( t89 );
    const double t93 = piecewise_functor_3( t90, t22, t91 * t89 );
    const double t94 = t93 * t26;
    const double t95 = t37 * sigma_bb;
    const double t96 = rho_b * rho_b;
    const double t97 = safe_math::cbrt( rho_b );
    const double t98 = t97 * t97;
    const double t100 = 0.1e1 / t98 / t96;
    const double t103 = t36 * t95 * t100 / 0.24e2;
    const double t104 = 0.1e1 + t103;
    const double t106 = 0.1e1 - 0.1e1 / t104;
    const double t108 = t106 * t106;
    const double t110 = t108 * t106;
    const double t112 = t108 * t108;
    const double t116 = safe_math::exp( -t103 );
    const double t117 = 0.1e1 - t116;
    const double t119 = t117 * t117;
    const double t121 = t119 * t117;
    const double t123 = t119 * t119;
    const double t127 = t60 * t112 * t106 + t77 * t123 * t117 + t29 * t106 + t51 * t108 + t54 * t110 + t57 * t112 + t64 * t117 + t68 * t119 + t71 * t121 + t74 * t123 + t28 + t63;
    const double t131 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t127 );
    const double t132 = t6 * t6;
    const double t133 = 0.1e1 / t132;
    const double t134 = t16 * t133;
    const double t136 = piecewise_functor_5( t10, 0.0, t14, 0.0, t7 - t134 );
    const double t139 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.3e1 * t23 * t136 );
    const double t140 = t139 * t26;
    const double t144 = t26 * t26;
    const double t145 = 0.1e1 / t144;
    const double t146 = t25 * t145;
    const double t149 = t5 * t146 * t80 / 0.8e1;
    const double t150 = t47 * t47;
    const double t151 = 0.1e1 / t150;
    const double t152 = t29 * t151;
    const double t153 = t152 * t31;
    const double t155 = t39 * rho_a;
    const double t157 = 0.1e1 / t41 / t155;
    const double t158 = sigma_aa * t157;
    const double t162 = t51 * t49;
    const double t163 = t151 * mu;
    const double t164 = t162 * t163;
    const double t167 = t165 * t38 * t157;
    const double t170 = t54 * t52;
    const double t171 = t170 * t163;
    const double t174 = t57 * t55;
    const double t175 = t174 * t163;
    const double t178 = t60 * t58;
    const double t179 = t178 * t163;
    const double t184 = t157 * t65;
    const double t188 = t68 * t66;
    const double t189 = t188 * t31;
    const double t191 = t154 * t158 * t65;
    const double t194 = t71 * t69;
    const double t195 = t194 * t31;
    const double t198 = t74 * t72;
    const double t199 = t198 * t31;
    const double t202 = t77 * t75;
    const double t203 = t202 * t31;
    const double t206 = -t153 * t154 * t158 / 0.9e1 - 0.2e1 / 0.9e1 * t164 * t167 - t171 * t167 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t167 - 0.5e1 / 0.9e1 * t179 * t167 - t183 * t38 * t184 / 0.9e1 - 0.2e1 / 0.9e1 * t189 * t191 - t195 * t191 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t191 - 0.5e1 / 0.9e1 * t203 * t191;
    const double t211 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t140 * t80 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t206 );
    const double t212 = t86 * t133;
    const double t214 = piecewise_functor_5( t14, 0.0, t10, 0.0, -t7 - t212 );
    const double t217 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t214 );
    const double t218 = t217 * t26;
    const double t222 = t93 * t145;
    const double t225 = t5 * t222 * t127 / 0.8e1;
    const double t227 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t218 * t127 - t225 );
    const double t231 = piecewise_functor_5( t10, 0.0, t14, 0.0, -t7 - t134 );
    const double t234 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.3e1 * t23 * t231 );
    const double t235 = t234 * t26;
    const double t240 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t235 * t80 - t149 );
    const double t242 = piecewise_functor_5( t14, 0.0, t10, 0.0, t7 - t212 );
    const double t245 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t242 );
    const double t246 = t245 * t26;
    const double t250 = t104 * t104;
    const double t251 = 0.1e1 / t250;
    const double t252 = t29 * t251;
    const double t253 = t252 * t31;
    const double t254 = t96 * rho_b;
    const double t256 = 0.1e1 / t98 / t254;
    const double t257 = sigma_bb * t256;
    const double t261 = t51 * t106;
    const double t262 = t251 * mu;
    const double t263 = t261 * t262;
    const double t265 = t165 * t95 * t256;
    const double t268 = t54 * t108;
    const double t269 = t268 * t262;
    const double t272 = t57 * t110;
    const double t273 = t272 * t262;
    const double t276 = t60 * t112;
    const double t277 = t276 * t262;
    const double t280 = t256 * t116;
    const double t284 = t68 * t117;
    const double t285 = t284 * t31;
    const double t287 = t154 * t257 * t116;
    const double t290 = t71 * t119;
    const double t291 = t290 * t31;
    const double t294 = t74 * t121;
    const double t295 = t294 * t31;
    const double t298 = t77 * t123;
    const double t299 = t298 * t31;
    const double t302 = -t253 * t154 * t257 / 0.9e1 - 0.2e1 / 0.9e1 * t263 * t265 - t269 * t265 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t265 - 0.5e1 / 0.9e1 * t277 * t265 - t183 * t95 * t280 / 0.9e1 - 0.2e1 / 0.9e1 * t285 * t287 - t291 * t287 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t287 - 0.5e1 / 0.9e1 * t299 * t287;
    const double t307 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t246 * t127 - t225 - 0.3e1 / 0.8e1 * t5 * t94 * t302 );
    const double t310 = t152 * mu;
    const double t312 = t165 * t37 * t43;
    const double t325 = t154 * t43 * t65;
    const double t336 = t310 * t312 / 0.24e2 + t164 * t312 / 0.12e2 + t171 * t312 / 0.8e1 + t175 * t312 / 0.6e1 + 0.5e1 / 0.24e2 * t179 * t312 + t323 * t325 / 0.24e2 + t189 * t325 / 0.12e2 + t195 * t325 / 0.8e1 + t199 * t325 / 0.6e1 + 0.5e1 / 0.24e2 * t203 * t325;
    const double t340 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t336 );
    const double t341 = t252 * mu;
    const double t343 = t165 * t37 * t100;
    const double t355 = t154 * t100 * t116;
    const double t366 = t341 * t343 / 0.24e2 + t263 * t343 / 0.12e2 + t269 * t343 / 0.8e1 + t273 * t343 / 0.6e1 + 0.5e1 / 0.24e2 * t277 * t343 + t323 * t355 / 0.24e2 + t285 * t355 / 0.12e2 + t291 * t355 / 0.8e1 + t295 * t355 / 0.6e1 + 0.5e1 / 0.24e2 * t299 * t355;
    const double t370 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t366 );
    const double t373 = t23 * t23;
    const double t374 = 0.1e1 / t373;
    const double t375 = t136 * t136;
    const double t378 = t132 * t6;
    const double t379 = 0.1e1 / t378;
    const double t380 = t16 * t379;
    const double t383 = piecewise_functor_5( t10, 0.0, t14, 0.0, -0.2e1 * t133 + 0.2e1 * t380 );
    const double t387 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.9e1 * t374 * t375 + 0.4e1 / 0.3e1 * t23 * t383 );
    const double t388 = t387 * t26;
    const double t392 = t139 * t145;
    const double t394 = t5 * t392 * t80;
    const double t400 = 0.1e1 / t144 / t6;
    const double t401 = t25 * t400;
    const double t404 = t5 * t401 * t80 / 0.12e2;
    const double t406 = t5 * t146 * t206;
    const double t408 = t150 * t47;
    const double t409 = 0.1e1 / t408;
    const double t410 = t29 * t409;
    const double t414 = t410 * t413;
    const double t420 = sigma_aa * sigma_aa;
    const double t421 = t39 * t39;
    const double t424 = 0.1e1 / t40 / t421 / t155;
    const double t425 = t420 * t424;
    const double t426 = t419 * t425;
    const double t429 = t150 * t150;
    const double t430 = 0.1e1 / t429;
    const double t431 = t51 * t430;
    const double t432 = t431 * t413;
    const double t438 = t418 * t420;
    const double t439 = t424 * t65;
    const double t445 = t65 * t65;
    const double t446 = t424 * t445;
    const double t451 = 0.1e1 / t41 / t421;
    const double t452 = sigma_aa * t451;
    const double t456 = t451 * t65;
    const double t460 = t409 * t411;
    const double t461 = t162 * t460;
    const double t463 = t436 * t438 * t424;
    const double t466 = t54 * t49;
    const double t467 = t430 * t411;
    const double t468 = t466 * t467;
    const double t471 = t170 * t460;
    const double t474 = t57 * t52;
    const double t475 = t474 * t467;
    const double t478 = t174 * t460;
    const double t481 = t60 * t55;
    const double t482 = t481 * t467;
    const double t485 = t178 * t460;
    const double t488 = t188 * t413;
    const double t490 = t419 * t425 * t65;
    const double t493 = -0.2e1 / 0.81e2 * t414 * t426 + 0.2e1 / 0.81e2 * t432 * t426 - t437 * t438 * t439 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t438 * t446 + 0.11e2 / 0.27e2 * t153 * t154 * t452 + 0.11e2 / 0.27e2 * t183 * t38 * t456 - 0.4e1 / 0.81e2 * t461 * t463 + 0.2e1 / 0.27e2 * t468 * t463 - 0.2e1 / 0.27e2 * t471 * t463 + 0.4e1 / 0.27e2 * t475 * t463 - 0.8e1 / 0.81e2 * t478 * t463 + 0.2e2 / 0.81e2 * t482 * t463 - 0.1e2 / 0.81e2 * t485 * t463 - 0.2e1 / 0.81e2 * t488 * t490;
    const double t494 = t71 * t66;
    const double t495 = t494 * t413;
    const double t497 = t419 * t425 * t445;
    const double t500 = t194 * t413;
    const double t503 = t74 * t69;
    const double t504 = t503 * t413;
    const double t507 = t198 * t413;
    const double t510 = t77 * t72;
    const double t511 = t510 * t413;
    const double t514 = t202 * t413;
    const double t518 = t165 * t38 * t451;
    const double t528 = t154 * t452 * t65;
    const double t537 = 0.2e1 / 0.27e2 * t495 * t497 - t500 * t490 / 0.27e2 + 0.4e1 / 0.27e2 * t504 * t497 - 0.4e1 / 0.81e2 * t507 * t490 + 0.2e2 / 0.81e2 * t511 * t497 - 0.5e1 / 0.81e2 * t514 * t490 + 0.22e2 / 0.27e2 * t164 * t518 + 0.11e2 / 0.9e1 * t171 * t518 + 0.44e2 / 0.27e2 * t175 * t518 + 0.55e2 / 0.27e2 * t179 * t518 + 0.22e2 / 0.27e2 * t189 * t528 + 0.11e2 / 0.9e1 * t195 * t528 + 0.44e2 / 0.27e2 * t199 * t528 + 0.55e2 / 0.27e2 * t203 * t528;
    const double t538 = t493 + t537;
    const double t543 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t388 * t80 - t394 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t206 + t404 - t406 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t538 );
    const double t544 = t91 * t91;
    const double t545 = 0.1e1 / t544;
    const double t546 = t214 * t214;
    const double t549 = t86 * t379;
    const double t552 = piecewise_functor_5( t14, 0.0, t10, 0.0, 0.2e1 * t133 + 0.2e1 * t549 );
    const double t556 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.9e1 * t545 * t546 + 0.4e1 / 0.3e1 * t91 * t552 );
    const double t557 = t556 * t26;
    const double t561 = t217 * t145;
    const double t563 = t5 * t561 * t127;
    const double t565 = t93 * t400;
    const double t568 = t5 * t565 * t127 / 0.12e2;
    const double t570 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t557 * t127 - t563 / 0.4e1 + t568 );
    const double t586 = t234 * t145;
    const double t588 = t5 * t586 * t80;
    const double t610 = t245 * t145;
    const double t612 = t5 * t610 * t127;
    const double t619 = t5 * t222 * t302;
    const double t627 = t231 * t231;
    const double t632 = piecewise_functor_5( t10, 0.0, t14, 0.0, 0.2e1 * t133 + 0.2e1 * t380 );
    const double t636 = piecewise_functor_3( t20, 0.0, 0.4e1 / 0.9e1 * t374 * t627 + 0.4e1 / 0.3e1 * t23 * t632 );
    const double t637 = t636 * t26;
    const double t643 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t637 * t80 - t588 / 0.4e1 + t404 );
    const double t644 = t242 * t242;
    const double t649 = piecewise_functor_5( t14, 0.0, t10, 0.0, -0.2e1 * t133 + 0.2e1 * t549 );
    const double t653 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.9e1 * t545 * t644 + 0.4e1 / 0.3e1 * t91 * t649 );
    const double t654 = t653 * t26;
    const double t663 = t250 * t104;
    const double t664 = 0.1e1 / t663;
    const double t665 = t29 * t664;
    const double t666 = t665 * t413;
    const double t667 = sigma_bb * sigma_bb;
    const double t668 = t96 * t96;
    const double t671 = 0.1e1 / t97 / t668 / t254;
    const double t672 = t667 * t671;
    const double t673 = t419 * t672;
    const double t676 = t250 * t250;
    const double t677 = 0.1e1 / t676;
    const double t678 = t51 * t677;
    const double t679 = t678 * t413;
    const double t682 = t418 * t667;
    const double t683 = t671 * t116;
    const double t687 = t116 * t116;
    const double t688 = t671 * t687;
    const double t693 = 0.1e1 / t98 / t668;
    const double t694 = sigma_bb * t693;
    const double t698 = t693 * t116;
    const double t703 = t165 * t95 * t693;
    const double t713 = t154 * t694 * t116;
    const double t722 = -0.2e1 / 0.81e2 * t666 * t673 + 0.2e1 / 0.81e2 * t679 * t673 - t437 * t682 * t683 / 0.81e2 + 0.2e1 / 0.81e2 * t444 * t682 * t688 + 0.11e2 / 0.27e2 * t253 * t154 * t694 + 0.11e2 / 0.27e2 * t183 * t95 * t698 + 0.22e2 / 0.27e2 * t263 * t703 + 0.11e2 / 0.9e1 * t269 * t703 + 0.44e2 / 0.27e2 * t273 * t703 + 0.55e2 / 0.27e2 * t277 * t703 + 0.22e2 / 0.27e2 * t285 * t713 + 0.11e2 / 0.9e1 * t291 * t713 + 0.44e2 / 0.27e2 * t295 * t713 + 0.55e2 / 0.27e2 * t299 * t713;
    const double t723 = t664 * t411;
    const double t724 = t261 * t723;
    const double t726 = t436 * t682 * t671;
    const double t729 = t54 * t106;
    const double t730 = t677 * t411;
    const double t731 = t729 * t730;
    const double t734 = t268 * t723;
    const double t737 = t57 * t108;
    const double t738 = t737 * t730;
    const double t741 = t272 * t723;
    const double t744 = t60 * t110;
    const double t745 = t744 * t730;
    const double t748 = t276 * t723;
    const double t751 = t284 * t413;
    const double t753 = t419 * t672 * t116;
    const double t756 = t71 * t117;
    const double t757 = t756 * t413;
    const double t759 = t419 * t672 * t687;
    const double t762 = t290 * t413;
    const double t765 = t74 * t119;
    const double t766 = t765 * t413;
    const double t769 = t294 * t413;
    const double t772 = t77 * t121;
    const double t773 = t772 * t413;
    const double t776 = t298 * t413;
    const double t779 = -0.4e1 / 0.81e2 * t724 * t726 + 0.2e1 / 0.27e2 * t731 * t726 - 0.2e1 / 0.27e2 * t734 * t726 + 0.4e1 / 0.27e2 * t738 * t726 - 0.8e1 / 0.81e2 * t741 * t726 + 0.2e2 / 0.81e2 * t745 * t726 - 0.1e2 / 0.81e2 * t748 * t726 - 0.2e1 / 0.81e2 * t751 * t753 + 0.2e1 / 0.27e2 * t757 * t759 - t762 * t753 / 0.27e2 + 0.4e1 / 0.27e2 * t766 * t759 - 0.4e1 / 0.81e2 * t769 * t753 + 0.2e2 / 0.81e2 * t773 * t759 - 0.5e1 / 0.81e2 * t776 * t753;
    const double t780 = t722 + t779;
    const double t785 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t654 * t127 - t612 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t246 * t302 + t568 - t619 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t94 * t780 );
    const double t793 = t5 * t146 * t336 / 0.8e1;
    const double t794 = t421 * t39;
    const double t796 = 0.1e1 / t40 / t794;
    const double t797 = sigma_aa * t796;
    const double t798 = t419 * t797;
    const double t801 = t418 * t796;
    const double t802 = sigma_aa * t65;
    const double t806 = t418 * sigma_aa;
    const double t807 = t796 * t445;
    const double t812 = t165 * t37 * t157;
    const double t821 = t154 * t184;
    const double t836 = -t432 * t798 / 0.108e3 + t437 * t801 * t802 / 0.216e3 - t444 * t806 * t807 / 0.108e3 - 0.2e1 / 0.9e1 * t164 * t812 - t171 * t812 / 0.3e1 - 0.4e1 / 0.9e1 * t175 * t812 - 0.5e1 / 0.9e1 * t179 * t812 - 0.2e1 / 0.9e1 * t189 * t821 - t195 * t821 / 0.3e1 - 0.4e1 / 0.9e1 * t199 * t821 - 0.5e1 / 0.9e1 * t203 * t821 + t414 * t798 / 0.108e3 - t323 * t821 / 0.9e1 - t310 * t812 / 0.9e1;
    const double t838 = t436 * t801 * sigma_aa;
    const double t846 = t419 * t797 * t65;
    const double t850 = t419 * t807 * sigma_aa;
    const double t871 = t478 * t838 / 0.27e2 - 0.5e1 / 0.54e2 * t482 * t838 + 0.5e1 / 0.108e3 * t485 * t838 + t488 * t846 / 0.108e3 - t495 * t850 / 0.36e2 + t500 * t846 / 0.72e2 - t504 * t850 / 0.18e2 + t507 * t846 / 0.54e2 - 0.5e1 / 0.54e2 * t511 * t850 + 0.5e1 / 0.216e3 * t514 * t846 + t461 * t838 / 0.54e2 - t468 * t838 / 0.36e2 + t471 * t838 / 0.36e2 - t475 * t838 / 0.18e2;
    const double t872 = t836 + t871;
    const double t877 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t140 * t336 - t793 - 0.3e1 / 0.8e1 * t5 * t27 * t872 );
    const double t884 = t5 * t222 * t366 / 0.8e1;
    const double t897 = t668 * t96;
    const double t899 = 0.1e1 / t97 / t897;
    const double t900 = t899 * sigma_bb;
    const double t902 = t419 * t900 * t116;
    const double t905 = t899 * t687;
    const double t907 = t419 * t905 * sigma_bb;
    const double t920 = t418 * t899;
    const double t922 = t436 * t920 * sigma_bb;
    const double t937 = t751 * t902 / 0.108e3 - t757 * t907 / 0.36e2 + t762 * t902 / 0.72e2 - t766 * t907 / 0.18e2 + t769 * t902 / 0.54e2 - 0.5e1 / 0.54e2 * t773 * t907 + 0.5e1 / 0.216e3 * t776 * t902 + t724 * t922 / 0.54e2 - t731 * t922 / 0.36e2 + t734 * t922 / 0.36e2 - t738 * t922 / 0.18e2 + t741 * t922 / 0.27e2 - 0.5e1 / 0.54e2 * t745 * t922 + 0.5e1 / 0.108e3 * t748 * t922;
    const double t938 = t154 * t280;
    const double t942 = t165 * t37 * t256;
    const double t945 = sigma_bb * t116;
    const double t949 = t418 * sigma_bb;
    const double t953 = t419 * t900;
    const double t974 = -t323 * t938 / 0.9e1 - t341 * t942 / 0.9e1 + t437 * t920 * t945 / 0.216e3 - t444 * t949 * t905 / 0.108e3 + t666 * t953 / 0.108e3 - t679 * t953 / 0.108e3 - 0.2e1 / 0.9e1 * t263 * t942 - t269 * t942 / 0.3e1 - 0.4e1 / 0.9e1 * t273 * t942 - 0.5e1 / 0.9e1 * t277 * t942 - 0.2e1 / 0.9e1 * t285 * t938 - t291 * t938 / 0.3e1 - 0.4e1 / 0.9e1 * t295 * t938 - 0.5e1 / 0.9e1 * t299 * t938;
    const double t975 = t937 + t974;
    const double t980 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t246 * t366 - t884 - 0.3e1 / 0.8e1 * t5 * t94 * t975 );
    const double t982 = t410 * t411;
    const double t983 = t421 * rho_a;
    const double t985 = 0.1e1 / t40 / t983;
    const double t987 = t436 * t418 * t985;
    const double t990 = t431 * t411;
    const double t1009 = t419 * t985 * t65;
    const double t1014 = t419 * t985 * t445;
    const double t1031 = -t982 * t987 / 0.288e3 + t990 * t987 / 0.288e3 - t461 * t987 / 0.144e3 + t468 * t987 / 0.96e2 - t471 * t987 / 0.96e2 + t475 * t987 / 0.48e2 - t478 * t987 / 0.72e2 + 0.5e1 / 0.144e3 * t482 * t987 - 0.5e1 / 0.288e3 * t485 * t987 - t1007 * t1009 / 0.576e3 + t1012 * t1014 / 0.288e3 - t488 * t1009 / 0.288e3 + t495 * t1014 / 0.96e2 - t500 * t1009 / 0.192e3 + t504 * t1014 / 0.48e2 - t507 * t1009 / 0.144e3 + 0.5e1 / 0.144e3 * t511 * t1014 - 0.5e1 / 0.576e3 * t514 * t1009;
    const double t1035 = piecewise_functor_3( t1, 0.0, -0.3e1 / 0.8e1 * t5 * t27 * t1031 );
    const double t1036 = t665 * t411;
    const double t1037 = t668 * rho_b;
    const double t1039 = 0.1e1 / t97 / t1037;
    const double t1041 = t436 * t418 * t1039;
    const double t1044 = t678 * t411;
    const double t1062 = t419 * t1039 * t116;
    const double t1066 = t419 * t1039 * t687;
    const double t1083 = -t1036 * t1041 / 0.288e3 + t1044 * t1041 / 0.288e3 - t724 * t1041 / 0.144e3 + t731 * t1041 / 0.96e2 - t734 * t1041 / 0.96e2 + t738 * t1041 / 0.48e2 - t741 * t1041 / 0.72e2 + 0.5e1 / 0.144e3 * t745 * t1041 - 0.5e1 / 0.288e3 * t748 * t1041 - t1007 * t1062 / 0.576e3 + t1012 * t1066 / 0.288e3 - t751 * t1062 / 0.288e3 + t757 * t1066 / 0.96e2 - t762 * t1062 / 0.192e3 + t766 * t1066 / 0.48e2 - t769 * t1062 / 0.144e3 + 0.5e1 / 0.144e3 * t773 * t1066 - 0.5e1 / 0.576e3 * t776 * t1062;
    const double t1087 = piecewise_functor_3( t85, 0.0, -0.3e1 / 0.8e1 * t5 * t94 * t1083 );


    vrho_a = t84 + t131 + t6 * ( t211 + t227 );
    vrho_b = t84 + t131 + t6 * ( t240 + t307 );
    vsigma_aa = t6 * t340;
    vsigma_ab = 0.e0;
    vsigma_bb = t6 * t370;
    v2rho2_aa = 0.2e1 * t211 + 0.2e1 * t227 + t6 * ( t543 + t570 );
    v2rho2_bb = 0.2e1 * t240 + 0.2e1 * t307 + t6 * ( t643 + t785 );
    v2rhosigma_a_aa = t6 * t877 + t340;
    v2rhosigma_b_bb = t6 * t980 + t370;
    v2sigma2_aa_aa = t6 * t1035;
    v2sigma2_bb_bb = t6 * t1087;
    v2rho2_ab = 0.0;
    v2rhosigma_a_ab = 0.0;
    v2rhosigma_a_bb = 0.0;
    v2rhosigma_b_aa = 0.0;
    v2rhosigma_b_ab = 0.0;
    v2sigma2_aa_ab = 0.0;
    v2sigma2_aa_bb = 0.0;
    v2sigma2_ab_ab = 0.0;
    v2sigma2_ab_bb = 0.0;



  }


};

struct BuiltinSOGGA11_X_X : detail::BuiltinKernelImpl< BuiltinSOGGA11_X_X > {

  BuiltinSOGGA11_X_X( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinSOGGA11_X_X >(p) { }
  
  virtual ~BuiltinSOGGA11_X_X() = default;

};



} // namespace ExchCXX
