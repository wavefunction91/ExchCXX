#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinM062X_X > :
  public mgga_screening_interface< BuiltinM062X_X > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;
  static constexpr bool is_epc  = false;

  static constexpr double dens_tol  = 1e-15;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000027e-20;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = true;
  static constexpr double exx_coeff = 0.54;

  static constexpr double a_0 = 0.46;
  static constexpr double a_1 = -0.2206052;
  static constexpr double a_2 = -9.431788e-02;
  static constexpr double a_3 = 2.164494e+00;
  static constexpr double a_4 = -2.556466e+00;
  static constexpr double a_5 = -1.422133e+01;
  static constexpr double a_6 = 1.555044e+01;
  static constexpr double a_7 = 3.598078e+01;
  static constexpr double a_8 = -2.722754e+01;
  static constexpr double a_9 = -3.924093e+01;
  static constexpr double a_10 = 1.522808e+01;
  static constexpr double a_11 = 1.522227e+01;
  static constexpr double csi_HF = 1.0;
  static constexpr double cx = 0.54;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_6;
    constexpr double t24 = constants::m_cbrt_pi_sq;
    constexpr double t28 = constants::m_cbrt_2;
    constexpr double t25 = t24 * t24;
    constexpr double t26 = 0.1e1 / t25;
    constexpr double t27 = t22 * t26;
    constexpr double t29 = t28 * t28;
    constexpr double t43 = a_1;
    constexpr double t44 = t22 * t22;
    constexpr double t46 = 0.3e1 / 0.1e2 * t44 * t25;
    constexpr double t56 = a_2;
    constexpr double t62 = a_3;
    constexpr double t68 = a_4;
    constexpr double t74 = a_5;
    constexpr double t80 = a_6;
    constexpr double t86 = a_7;
    constexpr double t92 = a_8;
    constexpr double t98 = a_9;
    constexpr double t104 = a_10;
    constexpr double t110 = a_11;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = t4 / t5 * t18;
    const double t20 = safe_math::cbrt( rho );
    const double t21 = t20 * csi_HF;
    const double t30 = sigma * t29;
    const double t31 = rho * rho;
    const double t32 = t20 * t20;
    const double t34 = 0.1e1 / t32 / t31;
    const double t38 = 0.804e0 + 0.91464571985215458336e-2 * t27 * t30 * t34;
    const double t41 = 0.1804e1 - 0.646416e0 / t38;
    const double t47 = tau * t29;
    const double t49 = 0.1e1 / t32 / rho;
    const double t50 = t47 * t49;
    const double t51 = t46 - t50;
    const double t52 = t43 * t51;
    const double t53 = t46 + t50;
    const double t54 = 0.1e1 / t53;
    const double t57 = t51 * t51;
    const double t58 = t56 * t57;
    const double t59 = t53 * t53;
    const double t60 = 0.1e1 / t59;
    const double t63 = t57 * t51;
    const double t64 = t62 * t63;
    const double t65 = t59 * t53;
    const double t66 = 0.1e1 / t65;
    const double t69 = t57 * t57;
    const double t70 = t68 * t69;
    const double t71 = t59 * t59;
    const double t72 = 0.1e1 / t71;
    const double t75 = t69 * t51;
    const double t76 = t74 * t75;
    const double t77 = t71 * t53;
    const double t78 = 0.1e1 / t77;
    const double t81 = t69 * t57;
    const double t82 = t80 * t81;
    const double t83 = t71 * t59;
    const double t84 = 0.1e1 / t83;
    const double t87 = t69 * t63;
    const double t88 = t86 * t87;
    const double t89 = t71 * t65;
    const double t90 = 0.1e1 / t89;
    const double t93 = t69 * t69;
    const double t94 = t92 * t93;
    const double t95 = t71 * t71;
    const double t96 = 0.1e1 / t95;
    const double t99 = t93 * t51;
    const double t100 = t98 * t99;
    const double t102 = 0.1e1 / t95 / t53;
    const double t105 = t93 * t57;
    const double t106 = t104 * t105;
    const double t108 = 0.1e1 / t95 / t59;
    const double t112 = t110 * t93 * t63;
    const double t114 = 0.1e1 / t95 / t65;
    const double t116 = t100 * t102 + t106 * t108 + t112 * t114 + t52 * t54 + t58 * t60 + t64 * t66 + t70 * t72 + t76 * t78 + t82 * t84 + t88 * t90 + t94 * t96 + a_0;
    const double t117 = t41 * t116;
    const double t121 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t21 * t117 );


    eps = 0.2e1 * t121;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t22 = constants::m_cbrt_6;
    constexpr double t24 = constants::m_cbrt_pi_sq;
    constexpr double t28 = constants::m_cbrt_2;
    constexpr double t25 = t24 * t24;
    constexpr double t26 = 0.1e1 / t25;
    constexpr double t27 = t22 * t26;
    constexpr double t29 = t28 * t28;
    constexpr double t43 = a_1;
    constexpr double t44 = t22 * t22;
    constexpr double t46 = 0.3e1 / 0.1e2 * t44 * t25;
    constexpr double t56 = a_2;
    constexpr double t62 = a_3;
    constexpr double t68 = a_4;
    constexpr double t74 = a_5;
    constexpr double t80 = a_6;
    constexpr double t86 = a_7;
    constexpr double t92 = a_8;
    constexpr double t98 = a_9;
    constexpr double t104 = a_10;
    constexpr double t110 = a_11;
    constexpr double t237 = t26 * t29;
    constexpr double t244 = t43 * t29;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = t4 / t5 * t18;
    const double t20 = safe_math::cbrt( rho );
    const double t21 = t20 * csi_HF;
    const double t30 = sigma * t29;
    const double t31 = rho * rho;
    const double t32 = t20 * t20;
    const double t34 = 0.1e1 / t32 / t31;
    const double t38 = 0.804e0 + 0.91464571985215458336e-2 * t27 * t30 * t34;
    const double t41 = 0.1804e1 - 0.646416e0 / t38;
    const double t47 = tau * t29;
    const double t49 = 0.1e1 / t32 / rho;
    const double t50 = t47 * t49;
    const double t51 = t46 - t50;
    const double t52 = t43 * t51;
    const double t53 = t46 + t50;
    const double t54 = 0.1e1 / t53;
    const double t57 = t51 * t51;
    const double t58 = t56 * t57;
    const double t59 = t53 * t53;
    const double t60 = 0.1e1 / t59;
    const double t63 = t57 * t51;
    const double t64 = t62 * t63;
    const double t65 = t59 * t53;
    const double t66 = 0.1e1 / t65;
    const double t69 = t57 * t57;
    const double t70 = t68 * t69;
    const double t71 = t59 * t59;
    const double t72 = 0.1e1 / t71;
    const double t75 = t69 * t51;
    const double t76 = t74 * t75;
    const double t77 = t71 * t53;
    const double t78 = 0.1e1 / t77;
    const double t81 = t69 * t57;
    const double t82 = t80 * t81;
    const double t83 = t71 * t59;
    const double t84 = 0.1e1 / t83;
    const double t87 = t69 * t63;
    const double t88 = t86 * t87;
    const double t89 = t71 * t65;
    const double t90 = 0.1e1 / t89;
    const double t93 = t69 * t69;
    const double t94 = t92 * t93;
    const double t95 = t71 * t71;
    const double t96 = 0.1e1 / t95;
    const double t99 = t93 * t51;
    const double t100 = t98 * t99;
    const double t102 = 0.1e1 / t95 / t53;
    const double t105 = t93 * t57;
    const double t106 = t104 * t105;
    const double t108 = 0.1e1 / t95 / t59;
    const double t112 = t110 * t93 * t63;
    const double t114 = 0.1e1 / t95 / t65;
    const double t116 = t100 * t102 + t106 * t108 + t112 * t114 + t52 * t54 + t58 * t60 + t64 * t66 + t70 * t72 + t76 * t78 + t82 * t84 + t88 * t90 + t94 * t96 + a_0;
    const double t117 = t41 * t116;
    const double t121 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t21 * t117 );
    const double t123 = 0.1e1 / t32 * csi_HF;
    const double t127 = t4 * t18;
    const double t128 = t31 * rho;
    const double t130 = 0.1e1 / t20 / t128;
    const double t131 = t130 * csi_HF;
    const double t132 = t38 * t38;
    const double t133 = 0.1e1 / t132;
    const double t135 = t127 * t131 * t133;
    const double t137 = t27 * t30 * t116;
    const double t140 = t43 * tau;
    const double t145 = t52 * t60;
    const double t146 = t47 * t34;
    const double t149 = t56 * t51;
    const double t150 = t149 * t60;
    const double t153 = t58 * t66;
    const double t156 = t62 * t57;
    const double t157 = t156 * t66;
    const double t160 = t64 * t72;
    const double t163 = t68 * t63;
    const double t164 = t163 * t72;
    const double t167 = t70 * t78;
    const double t170 = t74 * t69;
    const double t171 = t170 * t78;
    const double t174 = t76 * t84;
    const double t177 = t80 * t75;
    const double t178 = t177 * t84;
    const double t181 = 0.5e1 / 0.3e1 * t140 * t29 * t34 * t54 + 0.5e1 / 0.3e1 * t145 * t146 + 0.1e2 / 0.3e1 * t150 * t146 + 0.1e2 / 0.3e1 * t153 * t146 + 0.5e1 * t157 * t146 + 0.5e1 * t160 * t146 + 0.2e2 / 0.3e1 * t164 * t146 + 0.2e2 / 0.3e1 * t167 * t146 + 0.25e2 / 0.3e1 * t171 * t146 + 0.25e2 / 0.3e1 * t174 * t146 + 0.1e2 * t178 * t146;
    const double t182 = t82 * t90;
    const double t185 = t86 * t81;
    const double t186 = t185 * t90;
    const double t189 = t88 * t96;
    const double t192 = t92 * t87;
    const double t193 = t192 * t96;
    const double t196 = t94 * t102;
    const double t199 = t98 * t93;
    const double t200 = t199 * t102;
    const double t203 = t100 * t108;
    const double t206 = t104 * t99;
    const double t207 = t206 * t108;
    const double t210 = t106 * t114;
    const double t213 = t110 * t105;
    const double t214 = t213 * t114;
    const double t218 = 0.1e1 / t95 / t71;
    const double t219 = t112 * t218;
    const double t222 = 0.1e2 * t182 * t146 + 0.35e2 / 0.3e1 * t186 * t146 + 0.35e2 / 0.3e1 * t189 * t146 + 0.4e2 / 0.3e1 * t193 * t146 + 0.4e2 / 0.3e1 * t196 * t146 + 0.15e2 * t200 * t146 + 0.15e2 * t203 * t146 + 0.5e2 / 0.3e1 * t207 * t146 + 0.5e2 / 0.3e1 * t210 * t146 + 0.55e2 / 0.3e1 * t214 * t146 + 0.55e2 / 0.3e1 * t219 * t146;
    const double t223 = t181 + t222;
    const double t224 = t41 * t223;
    const double t229 = piecewise_functor_3( t3, 0.0, -t19 * t123 * t117 / 0.8e1 + 0.40369036088841097646e-2 * t135 * t137 - 0.3e1 / 0.8e1 * t19 * t21 * t224 );
    const double t235 = t127 / t20 / t31 * csi_HF;
    const double t236 = t133 * t22;
    const double t239 = t236 * t237 * t116;
    const double t242 = piecewise_functor_3( t3, 0.0, -0.15138388533315411618e-2 * t235 * t239 );
    const double t247 = t60 * t29;
    const double t248 = t247 * t49;
    const double t252 = t66 * t29;
    const double t253 = t252 * t49;
    const double t258 = t72 * t29;
    const double t259 = t258 * t49;
    const double t264 = t78 * t29;
    const double t265 = t264 * t49;
    const double t270 = t84 * t29;
    const double t271 = t270 * t49;
    const double t276 = -t244 * t49 * t54 - 0.2e1 * t149 * t248 - 0.3e1 * t156 * t253 - 0.4e1 * t163 * t259 - 0.5e1 * t170 * t265 - 0.6e1 * t177 * t271 - t248 * t52 - 0.2e1 * t253 * t58 - 0.3e1 * t259 * t64 - 0.4e1 * t265 * t70 - 0.5e1 * t271 * t76;
    const double t277 = t90 * t29;
    const double t278 = t277 * t49;
    const double t283 = t96 * t29;
    const double t284 = t283 * t49;
    const double t289 = t102 * t29;
    const double t290 = t289 * t49;
    const double t295 = t108 * t29;
    const double t296 = t295 * t49;
    const double t301 = t114 * t29;
    const double t302 = t301 * t49;
    const double t307 = t218 * t29;
    const double t311 = -0.11e2 * t112 * t307 * t49 - 0.9e1 * t100 * t296 - 0.1e2 * t106 * t302 - 0.7e1 * t185 * t278 - 0.8e1 * t192 * t284 - 0.9e1 * t199 * t290 - 0.1e2 * t206 * t296 - 0.11e2 * t213 * t302 - 0.6e1 * t278 * t82 - 0.7e1 * t284 * t88 - 0.8e1 * t290 * t94;
    const double t312 = t276 + t311;
    const double t313 = t41 * t312;
    const double t317 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t21 * t313 );


    eps = 0.2e1 * t121;
    vrho = 0.2e1 * rho * t229 + 0.2e1 * t121;
    vsigma = 0.2e1 * rho * t242;
    vlapl = 0.e0;
    vtau = 0.2e1 * rho * t317;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t30 = constants::m_cbrt_6;
    constexpr double t32 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t33 = t32 * t32;
    constexpr double t34 = 0.1e1 / t33;
    constexpr double t35 = t30 * t34;
    constexpr double t48 = a_0;
    constexpr double t49 = a_1;
    constexpr double t50 = t30 * t30;
    constexpr double t52 = 0.3e1 / 0.1e2 * t50 * t33;
    constexpr double t61 = a_2;
    constexpr double t67 = a_3;
    constexpr double t73 = a_4;
    constexpr double t79 = a_5;
    constexpr double t85 = a_6;
    constexpr double t91 = a_7;
    constexpr double t97 = a_8;
    constexpr double t103 = a_9;
    constexpr double t109 = a_10;
    constexpr double t115 = a_11;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = t6 * t26;
    const double t28 = safe_math::cbrt( t7 );
    const double t29 = t28 * csi_HF;
    const double t36 = rho_a * rho_a;
    const double t37 = safe_math::cbrt( rho_a );
    const double t38 = t37 * t37;
    const double t40 = 0.1e1 / t38 / t36;
    const double t44 = 0.804e0 + 0.91464571985215458336e-2 * t35 * sigma_aa * t40;
    const double t47 = 0.1804e1 - 0.646416e0 / t44;
    const double t54 = 0.1e1 / t38 / rho_a;
    const double t55 = tau_a * t54;
    const double t56 = t52 - t55;
    const double t57 = t49 * t56;
    const double t58 = t52 + t55;
    const double t59 = 0.1e1 / t58;
    const double t62 = t56 * t56;
    const double t63 = t61 * t62;
    const double t64 = t58 * t58;
    const double t65 = 0.1e1 / t64;
    const double t68 = t62 * t56;
    const double t69 = t67 * t68;
    const double t70 = t64 * t58;
    const double t71 = 0.1e1 / t70;
    const double t74 = t62 * t62;
    const double t75 = t73 * t74;
    const double t76 = t64 * t64;
    const double t77 = 0.1e1 / t76;
    const double t80 = t74 * t56;
    const double t81 = t79 * t80;
    const double t82 = t76 * t58;
    const double t83 = 0.1e1 / t82;
    const double t86 = t74 * t62;
    const double t87 = t85 * t86;
    const double t88 = t76 * t64;
    const double t89 = 0.1e1 / t88;
    const double t92 = t74 * t68;
    const double t93 = t91 * t92;
    const double t94 = t76 * t70;
    const double t95 = 0.1e1 / t94;
    const double t98 = t74 * t74;
    const double t99 = t97 * t98;
    const double t100 = t76 * t76;
    const double t101 = 0.1e1 / t100;
    const double t104 = t98 * t56;
    const double t105 = t103 * t104;
    const double t107 = 0.1e1 / t100 / t58;
    const double t110 = t98 * t62;
    const double t111 = t109 * t110;
    const double t113 = 0.1e1 / t100 / t64;
    const double t117 = t115 * t98 * t68;
    const double t119 = 0.1e1 / t100 / t70;
    const double t121 = t99 * t101 + t105 * t107 + t111 * t113 + t117 * t119 + t57 * t59 + t63 * t65 + t69 * t71 + t75 * t77 + t81 * t83 + t87 * t89 + t93 * t95 + t48;
    const double t122 = t47 * t121;
    const double t123 = t29 * t122;
    const double t126 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t123 );
    const double t127 = rho_b <= dens_tol;
    const double t128 = -t17;
    const double t130 = piecewise_functor_5( t15, t12, t11, t16, t128 * t8 );
    const double t131 = 0.1e1 + t130;
    const double t132 = t131 <= zeta_tol;
    const double t133 = safe_math::cbrt( t131 );
    const double t135 = piecewise_functor_3( t132, t23, t133 * t131 );
    const double t136 = t6 * t135;
    const double t137 = rho_b * rho_b;
    const double t138 = safe_math::cbrt( rho_b );
    const double t139 = t138 * t138;
    const double t141 = 0.1e1 / t139 / t137;
    const double t145 = 0.804e0 + 0.91464571985215458336e-2 * t35 * sigma_bb * t141;
    const double t148 = 0.1804e1 - 0.646416e0 / t145;
    const double t150 = 0.1e1 / t139 / rho_b;
    const double t151 = tau_b * t150;
    const double t152 = t52 - t151;
    const double t153 = t49 * t152;
    const double t154 = t52 + t151;
    const double t155 = 0.1e1 / t154;
    const double t157 = t152 * t152;
    const double t158 = t61 * t157;
    const double t159 = t154 * t154;
    const double t160 = 0.1e1 / t159;
    const double t162 = t157 * t152;
    const double t163 = t67 * t162;
    const double t164 = t159 * t154;
    const double t165 = 0.1e1 / t164;
    const double t167 = t157 * t157;
    const double t168 = t73 * t167;
    const double t169 = t159 * t159;
    const double t170 = 0.1e1 / t169;
    const double t172 = t167 * t152;
    const double t173 = t79 * t172;
    const double t174 = t169 * t154;
    const double t175 = 0.1e1 / t174;
    const double t177 = t167 * t157;
    const double t178 = t85 * t177;
    const double t179 = t169 * t159;
    const double t180 = 0.1e1 / t179;
    const double t182 = t167 * t162;
    const double t183 = t91 * t182;
    const double t184 = t169 * t164;
    const double t185 = 0.1e1 / t184;
    const double t187 = t167 * t167;
    const double t188 = t97 * t187;
    const double t189 = t169 * t169;
    const double t190 = 0.1e1 / t189;
    const double t192 = t187 * t152;
    const double t193 = t103 * t192;
    const double t195 = 0.1e1 / t189 / t154;
    const double t197 = t187 * t157;
    const double t198 = t109 * t197;
    const double t200 = 0.1e1 / t189 / t159;
    const double t203 = t115 * t187 * t162;
    const double t205 = 0.1e1 / t189 / t164;
    const double t207 = t153 * t155 + t158 * t160 + t163 * t165 + t168 * t170 + t173 * t175 + t178 * t180 + t183 * t185 + t188 * t190 + t193 * t195 + t198 * t200 + t203 * t205 + t48;
    const double t208 = t148 * t207;
    const double t209 = t29 * t208;
    const double t212 = piecewise_functor_3( t127, 0.0, -0.3e1 / 0.8e1 * t136 * t209 );


    eps = t126 + t212;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t30 = constants::m_cbrt_6;
    constexpr double t32 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t33 = t32 * t32;
    constexpr double t34 = 0.1e1 / t33;
    constexpr double t35 = t30 * t34;
    constexpr double t48 = a_0;
    constexpr double t49 = a_1;
    constexpr double t50 = t30 * t30;
    constexpr double t52 = 0.3e1 / 0.1e2 * t50 * t33;
    constexpr double t61 = a_2;
    constexpr double t67 = a_3;
    constexpr double t73 = a_4;
    constexpr double t79 = a_5;
    constexpr double t85 = a_6;
    constexpr double t91 = a_7;
    constexpr double t97 = a_8;
    constexpr double t103 = a_9;
    constexpr double t109 = a_10;
    constexpr double t115 = a_11;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = t6 * t26;
    const double t28 = safe_math::cbrt( t7 );
    const double t29 = t28 * csi_HF;
    const double t36 = rho_a * rho_a;
    const double t37 = safe_math::cbrt( rho_a );
    const double t38 = t37 * t37;
    const double t40 = 0.1e1 / t38 / t36;
    const double t44 = 0.804e0 + 0.91464571985215458336e-2 * t35 * sigma_aa * t40;
    const double t47 = 0.1804e1 - 0.646416e0 / t44;
    const double t54 = 0.1e1 / t38 / rho_a;
    const double t55 = tau_a * t54;
    const double t56 = t52 - t55;
    const double t57 = t49 * t56;
    const double t58 = t52 + t55;
    const double t59 = 0.1e1 / t58;
    const double t62 = t56 * t56;
    const double t63 = t61 * t62;
    const double t64 = t58 * t58;
    const double t65 = 0.1e1 / t64;
    const double t68 = t62 * t56;
    const double t69 = t67 * t68;
    const double t70 = t64 * t58;
    const double t71 = 0.1e1 / t70;
    const double t74 = t62 * t62;
    const double t75 = t73 * t74;
    const double t76 = t64 * t64;
    const double t77 = 0.1e1 / t76;
    const double t80 = t74 * t56;
    const double t81 = t79 * t80;
    const double t82 = t76 * t58;
    const double t83 = 0.1e1 / t82;
    const double t86 = t74 * t62;
    const double t87 = t85 * t86;
    const double t88 = t76 * t64;
    const double t89 = 0.1e1 / t88;
    const double t92 = t74 * t68;
    const double t93 = t91 * t92;
    const double t94 = t76 * t70;
    const double t95 = 0.1e1 / t94;
    const double t98 = t74 * t74;
    const double t99 = t97 * t98;
    const double t100 = t76 * t76;
    const double t101 = 0.1e1 / t100;
    const double t104 = t98 * t56;
    const double t105 = t103 * t104;
    const double t107 = 0.1e1 / t100 / t58;
    const double t110 = t98 * t62;
    const double t111 = t109 * t110;
    const double t113 = 0.1e1 / t100 / t64;
    const double t117 = t115 * t98 * t68;
    const double t119 = 0.1e1 / t100 / t70;
    const double t121 = t99 * t101 + t105 * t107 + t111 * t113 + t117 * t119 + t57 * t59 + t63 * t65 + t69 * t71 + t75 * t77 + t81 * t83 + t87 * t89 + t93 * t95 + t48;
    const double t122 = t47 * t121;
    const double t123 = t29 * t122;
    const double t126 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t123 );
    const double t127 = rho_b <= dens_tol;
    const double t128 = -t17;
    const double t130 = piecewise_functor_5( t15, t12, t11, t16, t128 * t8 );
    const double t131 = 0.1e1 + t130;
    const double t132 = t131 <= zeta_tol;
    const double t133 = safe_math::cbrt( t131 );
    const double t135 = piecewise_functor_3( t132, t23, t133 * t131 );
    const double t136 = t6 * t135;
    const double t137 = rho_b * rho_b;
    const double t138 = safe_math::cbrt( rho_b );
    const double t139 = t138 * t138;
    const double t141 = 0.1e1 / t139 / t137;
    const double t145 = 0.804e0 + 0.91464571985215458336e-2 * t35 * sigma_bb * t141;
    const double t148 = 0.1804e1 - 0.646416e0 / t145;
    const double t150 = 0.1e1 / t139 / rho_b;
    const double t151 = tau_b * t150;
    const double t152 = t52 - t151;
    const double t153 = t49 * t152;
    const double t154 = t52 + t151;
    const double t155 = 0.1e1 / t154;
    const double t157 = t152 * t152;
    const double t158 = t61 * t157;
    const double t159 = t154 * t154;
    const double t160 = 0.1e1 / t159;
    const double t162 = t157 * t152;
    const double t163 = t67 * t162;
    const double t164 = t159 * t154;
    const double t165 = 0.1e1 / t164;
    const double t167 = t157 * t157;
    const double t168 = t73 * t167;
    const double t169 = t159 * t159;
    const double t170 = 0.1e1 / t169;
    const double t172 = t167 * t152;
    const double t173 = t79 * t172;
    const double t174 = t169 * t154;
    const double t175 = 0.1e1 / t174;
    const double t177 = t167 * t157;
    const double t178 = t85 * t177;
    const double t179 = t169 * t159;
    const double t180 = 0.1e1 / t179;
    const double t182 = t167 * t162;
    const double t183 = t91 * t182;
    const double t184 = t169 * t164;
    const double t185 = 0.1e1 / t184;
    const double t187 = t167 * t167;
    const double t188 = t97 * t187;
    const double t189 = t169 * t169;
    const double t190 = 0.1e1 / t189;
    const double t192 = t187 * t152;
    const double t193 = t103 * t192;
    const double t195 = 0.1e1 / t189 / t154;
    const double t197 = t187 * t157;
    const double t198 = t109 * t197;
    const double t200 = 0.1e1 / t189 / t159;
    const double t203 = t115 * t187 * t162;
    const double t205 = 0.1e1 / t189 / t164;
    const double t207 = t153 * t155 + t158 * t160 + t163 * t165 + t168 * t170 + t173 * t175 + t178 * t180 + t183 * t185 + t188 * t190 + t193 * t195 + t198 * t200 + t203 * t205 + t48;
    const double t208 = t148 * t207;
    const double t209 = t29 * t208;
    const double t212 = piecewise_functor_3( t127, 0.0, -0.3e1 / 0.8e1 * t136 * t209 );
    const double t213 = t7 * t7;
    const double t214 = 0.1e1 / t213;
    const double t215 = t17 * t214;
    const double t217 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t215 );
    const double t220 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t217 );
    const double t221 = t6 * t220;
    const double t224 = t28 * t28;
    const double t225 = 0.1e1 / t224;
    const double t226 = t225 * csi_HF;
    const double t227 = t226 * t122;
    const double t229 = t27 * t227 / 0.8e1;
    const double t230 = t3 * t26;
    const double t231 = t44 * t44;
    const double t232 = 0.1e1 / t231;
    const double t233 = t29 * t232;
    const double t234 = t230 * t233;
    const double t235 = t36 * rho_a;
    const double t237 = 0.1e1 / t38 / t235;
    const double t238 = sigma_aa * t237;
    const double t240 = t35 * t238 * t121;
    const double t243 = t49 * tau_a;
    const double t247 = t65 * tau_a;
    const double t248 = t247 * t40;
    const double t251 = t61 * t56;
    const double t254 = t71 * tau_a;
    const double t255 = t254 * t40;
    const double t258 = t67 * t62;
    const double t261 = t77 * tau_a;
    const double t262 = t261 * t40;
    const double t265 = t73 * t68;
    const double t268 = t83 * tau_a;
    const double t269 = t268 * t40;
    const double t272 = t79 * t74;
    const double t275 = t89 * tau_a;
    const double t276 = t275 * t40;
    const double t279 = t85 * t80;
    const double t282 = 0.5e1 / 0.3e1 * t243 * t40 * t59 + 0.5e1 / 0.3e1 * t57 * t248 + 0.1e2 / 0.3e1 * t251 * t248 + 0.1e2 / 0.3e1 * t63 * t255 + 0.5e1 * t258 * t255 + 0.5e1 * t69 * t262 + 0.2e2 / 0.3e1 * t265 * t262 + 0.2e2 / 0.3e1 * t75 * t269 + 0.25e2 / 0.3e1 * t272 * t269 + 0.25e2 / 0.3e1 * t81 * t276 + 0.1e2 * t279 * t276;
    const double t283 = t95 * tau_a;
    const double t284 = t283 * t40;
    const double t287 = t91 * t86;
    const double t290 = t101 * tau_a;
    const double t291 = t290 * t40;
    const double t294 = t97 * t92;
    const double t297 = t107 * tau_a;
    const double t298 = t297 * t40;
    const double t301 = t103 * t98;
    const double t304 = t113 * tau_a;
    const double t305 = t304 * t40;
    const double t308 = t109 * t104;
    const double t311 = t119 * tau_a;
    const double t312 = t311 * t40;
    const double t315 = t115 * t110;
    const double t319 = 0.1e1 / t100 / t76;
    const double t320 = t319 * tau_a;
    const double t324 = 0.1e2 * t87 * t284 + 0.35e2 / 0.3e1 * t287 * t284 + 0.35e2 / 0.3e1 * t93 * t291 + 0.4e2 / 0.3e1 * t294 * t291 + 0.4e2 / 0.3e1 * t99 * t298 + 0.15e2 * t301 * t298 + 0.15e2 * t105 * t305 + 0.5e2 / 0.3e1 * t308 * t305 + 0.5e2 / 0.3e1 * t111 * t312 + 0.55e2 / 0.3e1 * t315 * t312 + 0.55e2 / 0.3e1 * t117 * t320 * t40;
    const double t325 = t282 + t324;
    const double t326 = t47 * t325;
    const double t327 = t29 * t326;
    const double t331 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t221 * t123 - t229 + 0.40369036088841097646e-2 * t234 * t240 - 0.3e1 / 0.8e1 * t27 * t327 );
    const double t332 = t128 * t214;
    const double t334 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t332 );
    const double t337 = piecewise_functor_3( t132, 0.0, 0.4e1 / 0.3e1 * t133 * t334 );
    const double t338 = t6 * t337;
    const double t341 = t226 * t208;
    const double t343 = t136 * t341 / 0.8e1;
    const double t345 = piecewise_functor_3( t127, 0.0, -0.3e1 / 0.8e1 * t338 * t209 - t343 );
    const double t349 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t215 );
    const double t352 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t349 );
    const double t353 = t6 * t352;
    const double t357 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t353 * t123 - t229 );
    const double t359 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t332 );
    const double t362 = piecewise_functor_3( t132, 0.0, 0.4e1 / 0.3e1 * t133 * t359 );
    const double t363 = t6 * t362;
    const double t366 = t3 * t135;
    const double t367 = t145 * t145;
    const double t368 = 0.1e1 / t367;
    const double t369 = t29 * t368;
    const double t370 = t366 * t369;
    const double t371 = t137 * rho_b;
    const double t373 = 0.1e1 / t139 / t371;
    const double t374 = sigma_bb * t373;
    const double t376 = t35 * t374 * t207;
    const double t379 = t49 * tau_b;
    const double t383 = t160 * tau_b;
    const double t384 = t383 * t141;
    const double t387 = t61 * t152;
    const double t390 = t165 * tau_b;
    const double t391 = t390 * t141;
    const double t394 = t67 * t157;
    const double t397 = t170 * tau_b;
    const double t398 = t397 * t141;
    const double t401 = t73 * t162;
    const double t404 = t175 * tau_b;
    const double t405 = t404 * t141;
    const double t408 = t79 * t167;
    const double t411 = t180 * tau_b;
    const double t412 = t411 * t141;
    const double t415 = t85 * t172;
    const double t418 = 0.5e1 / 0.3e1 * t379 * t141 * t155 + 0.5e1 / 0.3e1 * t153 * t384 + 0.1e2 / 0.3e1 * t387 * t384 + 0.1e2 / 0.3e1 * t158 * t391 + 0.5e1 * t394 * t391 + 0.5e1 * t163 * t398 + 0.2e2 / 0.3e1 * t401 * t398 + 0.2e2 / 0.3e1 * t168 * t405 + 0.25e2 / 0.3e1 * t408 * t405 + 0.25e2 / 0.3e1 * t173 * t412 + 0.1e2 * t415 * t412;
    const double t419 = t185 * tau_b;
    const double t420 = t419 * t141;
    const double t423 = t91 * t177;
    const double t426 = t190 * tau_b;
    const double t427 = t426 * t141;
    const double t430 = t97 * t182;
    const double t433 = t195 * tau_b;
    const double t434 = t433 * t141;
    const double t437 = t103 * t187;
    const double t440 = t200 * tau_b;
    const double t441 = t440 * t141;
    const double t444 = t109 * t192;
    const double t447 = t205 * tau_b;
    const double t448 = t447 * t141;
    const double t451 = t115 * t197;
    const double t455 = 0.1e1 / t189 / t169;
    const double t456 = t455 * tau_b;
    const double t460 = 0.1e2 * t178 * t420 + 0.35e2 / 0.3e1 * t423 * t420 + 0.35e2 / 0.3e1 * t183 * t427 + 0.4e2 / 0.3e1 * t430 * t427 + 0.4e2 / 0.3e1 * t188 * t434 + 0.15e2 * t437 * t434 + 0.15e2 * t193 * t441 + 0.5e2 / 0.3e1 * t444 * t441 + 0.5e2 / 0.3e1 * t198 * t448 + 0.55e2 / 0.3e1 * t451 * t448 + 0.55e2 / 0.3e1 * t203 * t456 * t141;
    const double t461 = t418 + t460;
    const double t462 = t148 * t461;
    const double t463 = t29 * t462;
    const double t467 = piecewise_functor_3( t127, 0.0, -0.3e1 / 0.8e1 * t363 * t209 - t343 + 0.40369036088841097646e-2 * t370 * t376 - 0.3e1 / 0.8e1 * t136 * t463 );
    const double t470 = t230 * t29;
    const double t471 = t232 * t30;
    const double t472 = t34 * t40;
    const double t474 = t471 * t472 * t121;
    const double t477 = piecewise_functor_3( t2, 0.0, -0.15138388533315411618e-2 * t470 * t474 );
    const double t478 = t366 * t29;
    const double t479 = t368 * t30;
    const double t480 = t34 * t141;
    const double t482 = t479 * t480 * t207;
    const double t485 = piecewise_functor_3( t127, 0.0, -0.15138388533315411618e-2 * t478 * t482 );
    const double t488 = t65 * t54;
    const double t492 = t71 * t54;
    const double t497 = t77 * t54;
    const double t502 = t83 * t54;
    const double t507 = t89 * t54;
    const double t512 = -t49 * t54 * t59 - 0.2e1 * t251 * t488 - 0.3e1 * t258 * t492 - 0.4e1 * t265 * t497 - 0.5e1 * t272 * t502 - 0.6e1 * t279 * t507 - t57 * t488 - 0.2e1 * t63 * t492 - 0.3e1 * t69 * t497 - 0.4e1 * t75 * t502 - 0.5e1 * t81 * t507;
    const double t513 = t95 * t54;
    const double t518 = t101 * t54;
    const double t523 = t107 * t54;
    const double t528 = t113 * t54;
    const double t533 = t119 * t54;
    const double t541 = -0.11e2 * t117 * t319 * t54 - 0.9e1 * t105 * t528 - 0.1e2 * t111 * t533 - 0.7e1 * t287 * t513 - 0.8e1 * t294 * t518 - 0.9e1 * t301 * t523 - 0.1e2 * t308 * t528 - 0.11e2 * t315 * t533 - 0.6e1 * t87 * t513 - 0.7e1 * t93 * t518 - 0.8e1 * t99 * t523;
    const double t542 = t512 + t541;
    const double t543 = t47 * t542;
    const double t544 = t29 * t543;
    const double t547 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t544 );
    const double t550 = t160 * t150;
    const double t554 = t165 * t150;
    const double t559 = t170 * t150;
    const double t564 = t175 * t150;
    const double t569 = t180 * t150;
    const double t574 = -t49 * t150 * t155 - t153 * t550 - 0.2e1 * t158 * t554 - 0.3e1 * t163 * t559 - 0.4e1 * t168 * t564 - 0.5e1 * t173 * t569 - 0.2e1 * t387 * t550 - 0.3e1 * t394 * t554 - 0.4e1 * t401 * t559 - 0.5e1 * t408 * t564 - 0.6e1 * t415 * t569;
    const double t575 = t185 * t150;
    const double t580 = t190 * t150;
    const double t585 = t195 * t150;
    const double t590 = t200 * t150;
    const double t595 = t205 * t150;
    const double t603 = -0.11e2 * t203 * t455 * t150 - 0.6e1 * t178 * t575 - 0.7e1 * t183 * t580 - 0.8e1 * t188 * t585 - 0.9e1 * t193 * t590 - 0.1e2 * t198 * t595 - 0.7e1 * t423 * t575 - 0.8e1 * t430 * t580 - 0.9e1 * t437 * t585 - 0.1e2 * t444 * t590 - 0.11e2 * t451 * t595;
    const double t604 = t574 + t603;
    const double t605 = t148 * t604;
    const double t606 = t29 * t605;
    const double t609 = piecewise_functor_3( t127, 0.0, -0.3e1 / 0.8e1 * t136 * t606 );


    eps = t126 + t212;
    vrho_a = t126 + t212 + t7 * ( t331 + t345 );
    vrho_b = t126 + t212 + t7 * ( t357 + t467 );
    vsigma_aa = t7 * t477;
    vsigma_ab = 0.e0;
    vsigma_bb = t7 * t485;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t7 * t547;
    vtau_b = t7 * t609;

  }


};

struct BuiltinM062X_X : detail::BuiltinKernelImpl< BuiltinM062X_X > {

  BuiltinM062X_X( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinM062X_X >(p) { }
  
  virtual ~BuiltinM062X_X() = default;

};



} // namespace ExchCXX