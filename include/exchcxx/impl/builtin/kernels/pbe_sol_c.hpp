/**
 * ExchCXX 
 *
 * Copyright (c) Microsoft Corporation.
 *
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * (1) Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 * 
 * (2) Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 * 
 * (3) Neither the name of the University of California, Lawrence Berkeley
 * National Laboratory, U.S. Dept. of Energy nor the names of its contributors
 * may be used to endorse or promote products derived from this software
 * without specific prior written permission.
 * 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 * 
 * You are under no obligation whatsoever to provide any bug fixes, patches,
 * or upgrades to the features, functionality or performance of the source
 * code ("Enhancements") to anyone; however, if you choose to make your
 * Enhancements available either publicly, or directly to Lawrence Berkeley
 * National Laboratory, without imposing a separate written license agreement
 * for such Enhancements, then you hereby grant the following license: a
 * non-exclusive, royalty-free perpetual license to install, use, modify,
 * prepare derivative works, incorporate into other computer software,
 * distribute, and sublicense such enhancements or derivative works thereof,
 * in binary and source code form.
 */


#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinPBE_SOL_C > :
  public gga_screening_interface< BuiltinPBE_SOL_C > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = true;
  static constexpr bool is_mgga = false;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;
  static constexpr bool is_epc  = false;

  static constexpr double dens_tol  = 1e-12;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000021e-16;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;


  static constexpr double beta = 0.046;
  static constexpr double gamma = 0.031090690869654895034;
  static constexpr double BB = 1.;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double& eps ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t39 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t18 = t1 * t1;
    constexpr double t19 = t3 * t3;
    constexpr double t20 = t18 * t19;
    constexpr double t70 = 0.1e1 / t3;
    constexpr double t75 = BB * beta;
    constexpr double t76 = 0.1e1 / gamma;
    constexpr double t91 = t39 * t39;
    constexpr double t96 = 0.1e1 / t19;
    constexpr double t97 = t1 * t96;
    constexpr double t98 = t97 * t6;
    constexpr double t104 = beta * t76;


    const double t7 = safe_math::cbrt( rho );
    const double t10 = t4 * t6 / t7;
    const double t12 = 0.1e1 + 0.53425e-1 * t10;
    const double t13 = safe_math::sqrt( t10 );
    const double t16 = pow_3_2( t10 );
    const double t21 = t7 * t7;
    const double t24 = t20 * t5 / t21;
    const double t26 = 0.379785e1 * t13 + 0.8969e0 * t10 + 0.204775e0 * t16 + 0.123235e0 * t24;
    const double t29 = 0.1e1 + 0.16081979498692535067e2 / t26;
    const double t30 = safe_math::log( t29 );
    const double t32 = 0.621814e-1 * t12 * t30;
    const double t33 = 0.1e1 <= zeta_tol;
    const double t34 = safe_math::cbrt( zeta_tol );
    const double t36 = piecewise_functor_3( t33, t34 * zeta_tol, 1.0 );
    const double t43 = ( 0.2e1 * t36 - 0.2e1 ) / ( 0.2e1 * t39 - 0.2e1 );
    const double t45 = 0.1e1 + 0.278125e-1 * t10;
    const double t50 = 0.51785e1 * t13 + 0.905775e0 * t10 + 0.1100325e0 * t16 + 0.1241775e0 * t24;
    const double t53 = 0.1e1 + 0.29608749977793437516e2 / t50;
    const double t54 = safe_math::log( t53 );
    const double t57 = 0.19751673498613801407e-1 * t43 * t45 * t54;
    const double t58 = t34 * t34;
    const double t59 = piecewise_functor_3( t33, t58, 1.0 );
    const double t60 = t59 * t59;
    const double t61 = t60 * t59;
    const double t62 = gamma * t61;
    const double t63 = rho * rho;
    const double t65 = 0.1e1 / t7 / t63;
    const double t68 = 0.1e1 / t60;
    const double t72 = t68 * t18 * t70 * t5;
    const double t79 = 0.1e1 / t61;
    const double t81 = safe_math::exp( -( -t32 + t57 ) * t76 * t79 );
    const double t82 = t81 - 0.1e1;
    const double t83 = 0.1e1 / t82;
    const double t84 = t76 * t83;
    const double t85 = sigma * sigma;
    const double t87 = t75 * t84 * t85;
    const double t88 = t63 * t63;
    const double t90 = 0.1e1 / t21 / t88;
    const double t92 = t90 * t91;
    const double t93 = t60 * t60;
    const double t94 = 0.1e1 / t93;
    const double t95 = t92 * t94;
    const double t99 = t95 * t98;
    const double t102 = sigma * t65 * t39 * t72 / 0.96e2 + t87 * t99 / 0.3072e4;
    const double t103 = beta * t102;
    const double t107 = t104 * t83 * t102 + 0.1e1;
    const double t108 = 0.1e1 / t107;
    const double t109 = t76 * t108;
    const double t111 = t103 * t109 + 0.1e1;
    const double t112 = safe_math::log( t111 );
    const double t113 = t62 * t112;


    eps = -t32 + t57 + t113;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double& eps, double& vrho, double& vsigma ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t39 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t18 = t1 * t1;
    constexpr double t19 = t3 * t3;
    constexpr double t20 = t18 * t19;
    constexpr double t70 = 0.1e1 / t3;
    constexpr double t75 = BB * beta;
    constexpr double t76 = 0.1e1 / gamma;
    constexpr double t91 = t39 * t39;
    constexpr double t96 = 0.1e1 / t19;
    constexpr double t97 = t1 * t96;
    constexpr double t98 = t97 * t6;
    constexpr double t104 = beta * t76;
    constexpr double t125 = t3 * t6;
    constexpr double t170 = gamma * gamma;
    constexpr double t171 = 0.1e1 / t170;
    constexpr double t172 = t75 * t171;
    constexpr double t182 = t96 * t6;
    constexpr double t224 = t18 * t70 * t5;
    constexpr double t234 = beta * beta;


    const double t7 = safe_math::cbrt( rho );
    const double t10 = t4 * t6 / t7;
    const double t12 = 0.1e1 + 0.53425e-1 * t10;
    const double t13 = safe_math::sqrt( t10 );
    const double t16 = pow_3_2( t10 );
    const double t21 = t7 * t7;
    const double t24 = t20 * t5 / t21;
    const double t26 = 0.379785e1 * t13 + 0.8969e0 * t10 + 0.204775e0 * t16 + 0.123235e0 * t24;
    const double t29 = 0.1e1 + 0.16081979498692535067e2 / t26;
    const double t30 = safe_math::log( t29 );
    const double t32 = 0.621814e-1 * t12 * t30;
    const double t33 = 0.1e1 <= zeta_tol;
    const double t34 = safe_math::cbrt( zeta_tol );
    const double t36 = piecewise_functor_3( t33, t34 * zeta_tol, 1.0 );
    const double t43 = ( 0.2e1 * t36 - 0.2e1 ) / ( 0.2e1 * t39 - 0.2e1 );
    const double t45 = 0.1e1 + 0.278125e-1 * t10;
    const double t50 = 0.51785e1 * t13 + 0.905775e0 * t10 + 0.1100325e0 * t16 + 0.1241775e0 * t24;
    const double t53 = 0.1e1 + 0.29608749977793437516e2 / t50;
    const double t54 = safe_math::log( t53 );
    const double t57 = 0.19751673498613801407e-1 * t43 * t45 * t54;
    const double t58 = t34 * t34;
    const double t59 = piecewise_functor_3( t33, t58, 1.0 );
    const double t60 = t59 * t59;
    const double t61 = t60 * t59;
    const double t62 = gamma * t61;
    const double t63 = rho * rho;
    const double t65 = 0.1e1 / t7 / t63;
    const double t68 = 0.1e1 / t60;
    const double t72 = t68 * t18 * t70 * t5;
    const double t79 = 0.1e1 / t61;
    const double t81 = safe_math::exp( -( -t32 + t57 ) * t76 * t79 );
    const double t82 = t81 - 0.1e1;
    const double t83 = 0.1e1 / t82;
    const double t84 = t76 * t83;
    const double t85 = sigma * sigma;
    const double t87 = t75 * t84 * t85;
    const double t88 = t63 * t63;
    const double t90 = 0.1e1 / t21 / t88;
    const double t92 = t90 * t91;
    const double t93 = t60 * t60;
    const double t94 = 0.1e1 / t93;
    const double t95 = t92 * t94;
    const double t99 = t95 * t98;
    const double t102 = sigma * t65 * t39 * t72 / 0.96e2 + t87 * t99 / 0.3072e4;
    const double t103 = beta * t102;
    const double t107 = t104 * t83 * t102 + 0.1e1;
    const double t108 = 0.1e1 / t107;
    const double t109 = t76 * t108;
    const double t111 = t103 * t109 + 0.1e1;
    const double t112 = safe_math::log( t111 );
    const double t113 = t62 * t112;
    const double t115 = 0.1e1 / t7 / rho;
    const double t116 = t6 * t115;
    const double t118 = t4 * t116 * t30;
    const double t119 = 0.11073470983333333333e-2 * t118;
    const double t120 = t26 * t26;
    const double t121 = 0.1e1 / t120;
    const double t122 = t12 * t121;
    const double t124 = 0.1e1 / t13 * t1;
    const double t126 = t125 * t115;
    const double t127 = t124 * t126;
    const double t129 = t4 * t116;
    const double t131 = safe_math::sqrt( t10 );
    const double t132 = t131 * t1;
    const double t133 = t132 * t126;
    const double t138 = t20 * t5 / t21 / rho;
    const double t140 = -0.632975e0 * t127 - 0.29896666666666666667e0 * t129 - 0.1023875e0 * t133 - 0.82156666666666666667e-1 * t138;
    const double t141 = 0.1e1 / t29;
    const double t142 = t140 * t141;
    const double t143 = t122 * t142;
    const double t144 = 0.1e1 * t143;
    const double t145 = t43 * t1;
    const double t148 = t145 * t125 * t115 * t54;
    const double t149 = 0.18311447306006545054e-3 * t148;
    const double t150 = t43 * t45;
    const double t151 = t50 * t50;
    const double t152 = 0.1e1 / t151;
    const double t157 = -0.86308333333333333334e0 * t127 - 0.301925e0 * t129 - 0.5501625e-1 * t133 - 0.82785e-1 * t138;
    const double t159 = 0.1e1 / t53;
    const double t160 = t152 * t157 * t159;
    const double t161 = t150 * t160;
    const double t162 = 0.5848223622634646207e0 * t161;
    const double t163 = t63 * rho;
    const double t165 = 0.1e1 / t7 / t163;
    const double t173 = t82 * t82;
    const double t174 = 0.1e1 / t173;
    const double t175 = t174 * t85;
    const double t176 = t175 * t90;
    const double t177 = t172 * t176;
    const double t179 = 0.1e1 / t93 / t61;
    const double t180 = t91 * t179;
    const double t181 = t180 * t1;
    const double t183 = t119 + t144 - t149 - t162;
    const double t184 = t183 * t81;
    const double t185 = t182 * t184;
    const double t186 = t181 * t185;
    const double t189 = t88 * rho;
    const double t191 = 0.1e1 / t21 / t189;
    const double t192 = t191 * t91;
    const double t193 = t192 * t94;
    const double t194 = t193 * t98;
    const double t197 = -0.7e1 / 0.288e3 * sigma * t165 * t39 * t72 + t177 * t186 / 0.3072e4 - 0.7e1 / 0.4608e4 * t87 * t194;
    const double t198 = beta * t197;
    const double t200 = t107 * t107;
    const double t201 = 0.1e1 / t200;
    const double t202 = t76 * t201;
    const double t204 = beta * t171 * t174;
    const double t206 = t79 * t81;
    const double t211 = t204 * t102 * t183 * t206 + t104 * t83 * t197;
    const double t212 = t202 * t211;
    const double t214 = -t103 * t212 + t198 * t109;
    const double t215 = 0.1e1 / t111;
    const double t217 = t62 * t214 * t215;
    const double t220 = rho * gamma;
    const double t228 = t75 * t84 * sigma;
    const double t231 = t65 * t39 * t68 * t224 / 0.96e2 + t228 * t99 / 0.1536e4;
    const double t232 = beta * t231;
    const double t235 = t234 * t102;
    const double t236 = t235 * t171;
    const double t237 = t201 * t83;
    const double t238 = t237 * t231;
    const double t240 = t232 * t109 - t236 * t238;


    eps = -t32 + t57 + t113;
    vrho = -t32 + t57 + t113 + rho * ( t119 + t144 - t149 - t162 + t217 );
    vsigma = t220 * t61 * t240 * t215;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_fxc_unpolar_impl( double rho, double sigma, double& v2rho2, double& v2rhosigma, double& v2sigma2 ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t39 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t18 = t1 * t1;
    constexpr double t19 = t3 * t3;
    constexpr double t20 = t18 * t19;
    constexpr double t70 = 0.1e1 / t3;
    constexpr double t75 = BB * beta;
    constexpr double t76 = 0.1e1 / gamma;
    constexpr double t91 = t39 * t39;
    constexpr double t96 = 0.1e1 / t19;
    constexpr double t97 = t1 * t96;
    constexpr double t98 = t97 * t6;
    constexpr double t104 = beta * t76;
    constexpr double t125 = t3 * t6;
    constexpr double t170 = gamma * gamma;
    constexpr double t171 = 0.1e1 / t170;
    constexpr double t172 = t75 * t171;
    constexpr double t182 = t96 * t6;
    constexpr double t224 = t18 * t70 * t5;
    constexpr double t234 = beta * beta;
    constexpr double t252 = t4 * t6;
    constexpr double t267 = t19 * t5;
    constexpr double t340 = 0.1e1 / t170 / gamma;
    constexpr double t341 = t75 * t340;
    constexpr double t395 = beta * t340;
    constexpr double t472 = t234 * BB;
    constexpr double t488 = t234 * beta;


    const double t7 = safe_math::cbrt( rho );
    const double t10 = t4 * t6 / t7;
    const double t12 = 0.1e1 + 0.53425e-1 * t10;
    const double t13 = safe_math::sqrt( t10 );
    const double t16 = pow_3_2( t10 );
    const double t21 = t7 * t7;
    const double t24 = t20 * t5 / t21;
    const double t26 = 0.379785e1 * t13 + 0.8969e0 * t10 + 0.204775e0 * t16 + 0.123235e0 * t24;
    const double t29 = 0.1e1 + 0.16081979498692535067e2 / t26;
    const double t30 = safe_math::log( t29 );
    const double t32 = 0.621814e-1 * t12 * t30;
    const double t33 = 0.1e1 <= zeta_tol;
    const double t34 = safe_math::cbrt( zeta_tol );
    const double t36 = piecewise_functor_3( t33, t34 * zeta_tol, 1.0 );
    const double t43 = ( 0.2e1 * t36 - 0.2e1 ) / ( 0.2e1 * t39 - 0.2e1 );
    const double t45 = 0.1e1 + 0.278125e-1 * t10;
    const double t50 = 0.51785e1 * t13 + 0.905775e0 * t10 + 0.1100325e0 * t16 + 0.1241775e0 * t24;
    const double t53 = 0.1e1 + 0.29608749977793437516e2 / t50;
    const double t54 = safe_math::log( t53 );
    const double t57 = 0.19751673498613801407e-1 * t43 * t45 * t54;
    const double t58 = t34 * t34;
    const double t59 = piecewise_functor_3( t33, t58, 1.0 );
    const double t60 = t59 * t59;
    const double t61 = t60 * t59;
    const double t62 = gamma * t61;
    const double t63 = rho * rho;
    const double t65 = 0.1e1 / t7 / t63;
    const double t68 = 0.1e1 / t60;
    const double t72 = t68 * t18 * t70 * t5;
    const double t79 = 0.1e1 / t61;
    const double t81 = safe_math::exp( -( -t32 + t57 ) * t76 * t79 );
    const double t82 = t81 - 0.1e1;
    const double t83 = 0.1e1 / t82;
    const double t84 = t76 * t83;
    const double t85 = sigma * sigma;
    const double t87 = t75 * t84 * t85;
    const double t88 = t63 * t63;
    const double t90 = 0.1e1 / t21 / t88;
    const double t92 = t90 * t91;
    const double t93 = t60 * t60;
    const double t94 = 0.1e1 / t93;
    const double t95 = t92 * t94;
    const double t99 = t95 * t98;
    const double t102 = sigma * t65 * t39 * t72 / 0.96e2 + t87 * t99 / 0.3072e4;
    const double t103 = beta * t102;
    const double t107 = t104 * t83 * t102 + 0.1e1;
    const double t108 = 0.1e1 / t107;
    const double t109 = t76 * t108;
    const double t111 = t103 * t109 + 0.1e1;
    const double t115 = 0.1e1 / t7 / rho;
    const double t116 = t6 * t115;
    const double t118 = t4 * t116 * t30;
    const double t119 = 0.11073470983333333333e-2 * t118;
    const double t120 = t26 * t26;
    const double t121 = 0.1e1 / t120;
    const double t122 = t12 * t121;
    const double t124 = 0.1e1 / t13 * t1;
    const double t126 = t125 * t115;
    const double t127 = t124 * t126;
    const double t129 = t4 * t116;
    const double t131 = safe_math::sqrt( t10 );
    const double t132 = t131 * t1;
    const double t133 = t132 * t126;
    const double t138 = t20 * t5 / t21 / rho;
    const double t140 = -0.632975e0 * t127 - 0.29896666666666666667e0 * t129 - 0.1023875e0 * t133 - 0.82156666666666666667e-1 * t138;
    const double t141 = 0.1e1 / t29;
    const double t142 = t140 * t141;
    const double t143 = t122 * t142;
    const double t144 = 0.1e1 * t143;
    const double t145 = t43 * t1;
    const double t148 = t145 * t125 * t115 * t54;
    const double t149 = 0.18311447306006545054e-3 * t148;
    const double t150 = t43 * t45;
    const double t151 = t50 * t50;
    const double t152 = 0.1e1 / t151;
    const double t157 = -0.86308333333333333334e0 * t127 - 0.301925e0 * t129 - 0.5501625e-1 * t133 - 0.82785e-1 * t138;
    const double t159 = 0.1e1 / t53;
    const double t160 = t152 * t157 * t159;
    const double t161 = t150 * t160;
    const double t162 = 0.5848223622634646207e0 * t161;
    const double t163 = t63 * rho;
    const double t165 = 0.1e1 / t7 / t163;
    const double t173 = t82 * t82;
    const double t174 = 0.1e1 / t173;
    const double t175 = t174 * t85;
    const double t176 = t175 * t90;
    const double t177 = t172 * t176;
    const double t179 = 0.1e1 / t93 / t61;
    const double t180 = t91 * t179;
    const double t181 = t180 * t1;
    const double t183 = t119 + t144 - t149 - t162;
    const double t184 = t183 * t81;
    const double t185 = t182 * t184;
    const double t186 = t181 * t185;
    const double t189 = t88 * rho;
    const double t191 = 0.1e1 / t21 / t189;
    const double t192 = t191 * t91;
    const double t193 = t192 * t94;
    const double t194 = t193 * t98;
    const double t197 = -0.7e1 / 0.288e3 * sigma * t165 * t39 * t72 + t177 * t186 / 0.3072e4 - 0.7e1 / 0.4608e4 * t87 * t194;
    const double t198 = beta * t197;
    const double t200 = t107 * t107;
    const double t201 = 0.1e1 / t200;
    const double t202 = t76 * t201;
    const double t204 = beta * t171 * t174;
    const double t206 = t79 * t81;
    const double t211 = t204 * t102 * t183 * t206 + t104 * t83 * t197;
    const double t212 = t202 * t211;
    const double t214 = -t103 * t212 + t198 * t109;
    const double t215 = 0.1e1 / t111;
    const double t217 = t62 * t214 * t215;
    const double t220 = rho * gamma;
    const double t228 = t75 * t84 * sigma;
    const double t231 = t65 * t39 * t68 * t224 / 0.96e2 + t228 * t99 / 0.1536e4;
    const double t232 = beta * t231;
    const double t235 = t234 * t102;
    const double t236 = t235 * t171;
    const double t237 = t201 * t83;
    const double t238 = t237 * t231;
    const double t240 = t232 * t109 - t236 * t238;
    const double t248 = t6 * t65;
    const double t250 = t4 * t248 * t30;
    const double t251 = 0.14764627977777777777e-2 * t250;
    const double t253 = t115 * t121;
    const double t255 = t252 * t253 * t142;
    const double t256 = 0.35616666666666666666e-1 * t255;
    const double t257 = t120 * t26;
    const double t258 = 0.1e1 / t257;
    const double t259 = t12 * t258;
    const double t260 = t140 * t140;
    const double t261 = t260 * t141;
    const double t262 = t259 * t261;
    const double t263 = 0.2e1 * t262;
    const double t266 = 0.1e1 / t13 / t10 * t18;
    const double t269 = 0.1e1 / t21 / t63;
    const double t270 = t267 * t269;
    const double t271 = t266 * t270;
    const double t273 = t125 * t65;
    const double t274 = t124 * t273;
    const double t276 = t4 * t248;
    const double t278 = 0.1e1/safe_math::sqrt( t10 );
    const double t279 = t278 * t18;
    const double t280 = t279 * t270;
    const double t282 = t132 * t273;
    const double t285 = t20 * t5 * t269;
    const double t287 = -0.42198333333333333333e0 * t271 + 0.84396666666666666666e0 * t274 + 0.39862222222222222223e0 * t276 + 0.68258333333333333333e-1 * t280 + 0.13651666666666666667e0 * t282 + 0.13692777777777777778e0 * t285;
    const double t288 = t287 * t141;
    const double t289 = t122 * t288;
    const double t290 = 0.1e1 * t289;
    const double t291 = t120 * t120;
    const double t292 = 0.1e1 / t291;
    const double t293 = t12 * t292;
    const double t294 = t29 * t29;
    const double t295 = 0.1e1 / t294;
    const double t296 = t260 * t295;
    const double t297 = t293 * t296;
    const double t298 = 0.16081979498692535067e2 * t297;
    const double t301 = t145 * t125 * t65 * t54;
    const double t302 = 0.24415263074675393405e-3 * t301;
    const double t303 = t43 * t4;
    const double t305 = t303 * t116 * t160;
    const double t306 = 0.10843581300301739842e-1 * t305;
    const double t307 = t151 * t50;
    const double t308 = 0.1e1 / t307;
    const double t309 = t157 * t157;
    const double t311 = t308 * t309 * t159;
    const double t312 = t150 * t311;
    const double t313 = 0.11696447245269292414e1 * t312;
    const double t320 = -0.57538888888888888889e0 * t271 + 0.11507777777777777778e1 * t274 + 0.40256666666666666667e0 * t276 + 0.366775e-1 * t280 + 0.73355e-1 * t282 + 0.137975e0 * t285;
    const double t322 = t152 * t320 * t159;
    const double t323 = t150 * t322;
    const double t324 = 0.5848223622634646207e0 * t323;
    const double t325 = t151 * t151;
    const double t326 = 0.1e1 / t325;
    const double t327 = t326 * t309;
    const double t328 = t53 * t53;
    const double t329 = 0.1e1 / t328;
    const double t330 = t327 * t329;
    const double t331 = t150 * t330;
    const double t332 = 0.17315859105681463759e2 * t331;
    const double t334 = 0.1e1 / t7 / t88;
    const double t343 = 0.1e1 / t173 / t82;
    const double t344 = t343 * t85;
    const double t345 = t344 * t90;
    const double t346 = t341 * t345;
    const double t347 = t93 * t93;
    const double t349 = 0.1e1 / t347 / t60;
    const double t351 = t91 * t349 * t1;
    const double t352 = t183 * t183;
    const double t353 = t81 * t81;
    const double t354 = t352 * t353;
    const double t356 = t351 * t182 * t354;
    const double t359 = t175 * t191;
    const double t360 = t172 * t359;
    const double t363 = -t251 - t256 - t263 + t290 + t298 + t302 + t306 + t313 - t324 - t332;
    const double t364 = t363 * t81;
    const double t366 = t181 * t182 * t364;
    const double t369 = t341 * t176;
    const double t370 = t352 * t81;
    const double t372 = t351 * t182 * t370;
    const double t375 = t88 * t63;
    const double t377 = 0.1e1 / t21 / t375;
    const double t380 = t377 * t91 * t94 * t98;
    const double t383 = 0.35e2 / 0.432e3 * sigma * t334 * t39 * t72 + t346 * t356 / 0.1536e4 - 0.7e1 / 0.2304e4 * t360 * t186 + t177 * t366 / 0.3072e4 - t369 * t372 / 0.3072e4 + 0.119e3 / 0.13824e5 * t87 * t380;
    const double t384 = beta * t383;
    const double t389 = 0.1e1 / t200 / t107;
    const double t390 = t76 * t389;
    const double t391 = t211 * t211;
    const double t392 = t390 * t391;
    const double t396 = t395 * t343;
    const double t397 = t102 * t352;
    const double t399 = 0.1e1 / t93 / t60;
    const double t400 = t399 * t353;
    const double t411 = t395 * t174;
    const double t412 = t399 * t81;
    const double t417 = t204 * t102 * t363 * t206 + 0.2e1 * t204 * t197 * t183 * t206 + t104 * t83 * t383 + 0.2e1 * t396 * t397 * t400 - t411 * t397 * t412;
    const double t418 = t202 * t417;
    const double t420 = 0.2e1 * t103 * t392 - t103 * t418 + t384 * t109 - 0.2e1 * t198 * t212;
    const double t422 = t62 * t420 * t215;
    const double t423 = t214 * t214;
    const double t424 = t111 * t111;
    const double t425 = 0.1e1 / t424;
    const double t427 = t62 * t423 * t425;
    const double t428 = -t251 - t256 - t263 + t290 + t298 + t302 + t306 + t313 - t324 - t332 + t422 - t427;
    const double t436 = t174 * sigma;
    const double t437 = t436 * t90;
    const double t438 = t172 * t437;
    const double t443 = -0.7e1 / 0.288e3 * t165 * t39 * t68 * t224 + t438 * t186 / 0.1536e4 - 0.7e1 / 0.2304e4 * t228 * t194;
    const double t444 = beta * t443;
    const double t447 = t234 * t197;
    const double t448 = t447 * t171;
    const double t450 = t389 * t83;
    const double t451 = t231 * t211;
    const double t452 = t450 * t451;
    const double t455 = t340 * t201;
    const double t456 = t235 * t455;
    const double t457 = t174 * t231;
    const double t459 = t183 * t79 * t81;
    const double t460 = t457 * t459;
    const double t462 = t237 * t443;
    const double t464 = t444 * t109 - t232 * t212 + 0.2e1 * t236 * t452 - t236 * t462 - t448 * t238 - t456 * t460;
    const double t468 = t220 * t61;
    const double t469 = t240 * t425;
    const double t470 = t469 * t214;
    const double t473 = t171 * t83;
    const double t479 = t91 * t94 * t1 * t182 * t108;
    const double t482 = t231 * t231;
    const double t483 = t234 * t482;
    const double t485 = t171 * t201 * t83;
    const double t489 = t488 * t102;
    const double t490 = t489 * t340;
    const double t491 = t389 * t174;
    const double t492 = t491 * t482;
    const double t496 = t201 * t174 * BB;
    const double t497 = t490 * t496;
    const double t500 = t472 * t473 * t90 * t479 / 0.1536e4 - 0.2e1 * t483 * t485 + 0.2e1 * t490 * t492 - t497 * t99 / 0.1536e4;
    const double t504 = t240 * t240;


    v2rho2 = 0.22146941966666666666e-2 * t118 + 0.2e1 * t143 - 0.36622894612013090108e-3 * t148 - 0.11696447245269292414e1 * t161 + 0.2e1 * t217 + rho * t428;
    v2rhosigma = t220 * t61 * t464 * t215 + t62 * t240 * t215 - t468 * t470;
    v2sigma2 = t220 * t61 * t500 * t215 - t220 * t61 * t504 * t425;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_vxc_fxc_unpolar_impl( double rho, double sigma, double& vrho, double& vsigma, double& v2rho2, double& v2rhosigma, double& v2sigma2 ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t39 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t18 = t1 * t1;
    constexpr double t19 = t3 * t3;
    constexpr double t20 = t18 * t19;
    constexpr double t70 = 0.1e1 / t3;
    constexpr double t75 = BB * beta;
    constexpr double t76 = 0.1e1 / gamma;
    constexpr double t91 = t39 * t39;
    constexpr double t96 = 0.1e1 / t19;
    constexpr double t97 = t1 * t96;
    constexpr double t98 = t97 * t6;
    constexpr double t104 = beta * t76;
    constexpr double t125 = t3 * t6;
    constexpr double t170 = gamma * gamma;
    constexpr double t171 = 0.1e1 / t170;
    constexpr double t172 = t75 * t171;
    constexpr double t182 = t96 * t6;
    constexpr double t224 = t18 * t70 * t5;
    constexpr double t234 = beta * beta;
    constexpr double t252 = t4 * t6;
    constexpr double t267 = t19 * t5;
    constexpr double t340 = 0.1e1 / t170 / gamma;
    constexpr double t341 = t75 * t340;
    constexpr double t395 = beta * t340;
    constexpr double t472 = t234 * BB;
    constexpr double t488 = t234 * beta;


    const double t7 = safe_math::cbrt( rho );
    const double t10 = t4 * t6 / t7;
    const double t12 = 0.1e1 + 0.53425e-1 * t10;
    const double t13 = safe_math::sqrt( t10 );
    const double t16 = pow_3_2( t10 );
    const double t21 = t7 * t7;
    const double t24 = t20 * t5 / t21;
    const double t26 = 0.379785e1 * t13 + 0.8969e0 * t10 + 0.204775e0 * t16 + 0.123235e0 * t24;
    const double t29 = 0.1e1 + 0.16081979498692535067e2 / t26;
    const double t30 = safe_math::log( t29 );
    const double t32 = 0.621814e-1 * t12 * t30;
    const double t33 = 0.1e1 <= zeta_tol;
    const double t34 = safe_math::cbrt( zeta_tol );
    const double t36 = piecewise_functor_3( t33, t34 * zeta_tol, 1.0 );
    const double t43 = ( 0.2e1 * t36 - 0.2e1 ) / ( 0.2e1 * t39 - 0.2e1 );
    const double t45 = 0.1e1 + 0.278125e-1 * t10;
    const double t50 = 0.51785e1 * t13 + 0.905775e0 * t10 + 0.1100325e0 * t16 + 0.1241775e0 * t24;
    const double t53 = 0.1e1 + 0.29608749977793437516e2 / t50;
    const double t54 = safe_math::log( t53 );
    const double t57 = 0.19751673498613801407e-1 * t43 * t45 * t54;
    const double t58 = t34 * t34;
    const double t59 = piecewise_functor_3( t33, t58, 1.0 );
    const double t60 = t59 * t59;
    const double t61 = t60 * t59;
    const double t62 = gamma * t61;
    const double t63 = rho * rho;
    const double t65 = 0.1e1 / t7 / t63;
    const double t68 = 0.1e1 / t60;
    const double t72 = t68 * t18 * t70 * t5;
    const double t79 = 0.1e1 / t61;
    const double t81 = safe_math::exp( -( -t32 + t57 ) * t76 * t79 );
    const double t82 = t81 - 0.1e1;
    const double t83 = 0.1e1 / t82;
    const double t84 = t76 * t83;
    const double t85 = sigma * sigma;
    const double t87 = t75 * t84 * t85;
    const double t88 = t63 * t63;
    const double t90 = 0.1e1 / t21 / t88;
    const double t92 = t90 * t91;
    const double t93 = t60 * t60;
    const double t94 = 0.1e1 / t93;
    const double t95 = t92 * t94;
    const double t99 = t95 * t98;
    const double t102 = sigma * t65 * t39 * t72 / 0.96e2 + t87 * t99 / 0.3072e4;
    const double t103 = beta * t102;
    const double t107 = t104 * t83 * t102 + 0.1e1;
    const double t108 = 0.1e1 / t107;
    const double t109 = t76 * t108;
    const double t111 = t103 * t109 + 0.1e1;
    const double t112 = safe_math::log( t111 );
    const double t113 = t62 * t112;
    const double t115 = 0.1e1 / t7 / rho;
    const double t116 = t6 * t115;
    const double t118 = t4 * t116 * t30;
    const double t119 = 0.11073470983333333333e-2 * t118;
    const double t120 = t26 * t26;
    const double t121 = 0.1e1 / t120;
    const double t122 = t12 * t121;
    const double t124 = 0.1e1 / t13 * t1;
    const double t126 = t125 * t115;
    const double t127 = t124 * t126;
    const double t129 = t4 * t116;
    const double t131 = safe_math::sqrt( t10 );
    const double t132 = t131 * t1;
    const double t133 = t132 * t126;
    const double t138 = t20 * t5 / t21 / rho;
    const double t140 = -0.632975e0 * t127 - 0.29896666666666666667e0 * t129 - 0.1023875e0 * t133 - 0.82156666666666666667e-1 * t138;
    const double t141 = 0.1e1 / t29;
    const double t142 = t140 * t141;
    const double t143 = t122 * t142;
    const double t144 = 0.1e1 * t143;
    const double t145 = t43 * t1;
    const double t148 = t145 * t125 * t115 * t54;
    const double t149 = 0.18311447306006545054e-3 * t148;
    const double t150 = t43 * t45;
    const double t151 = t50 * t50;
    const double t152 = 0.1e1 / t151;
    const double t157 = -0.86308333333333333334e0 * t127 - 0.301925e0 * t129 - 0.5501625e-1 * t133 - 0.82785e-1 * t138;
    const double t159 = 0.1e1 / t53;
    const double t160 = t152 * t157 * t159;
    const double t161 = t150 * t160;
    const double t162 = 0.5848223622634646207e0 * t161;
    const double t163 = t63 * rho;
    const double t165 = 0.1e1 / t7 / t163;
    const double t173 = t82 * t82;
    const double t174 = 0.1e1 / t173;
    const double t175 = t174 * t85;
    const double t176 = t175 * t90;
    const double t177 = t172 * t176;
    const double t179 = 0.1e1 / t93 / t61;
    const double t180 = t91 * t179;
    const double t181 = t180 * t1;
    const double t183 = t119 + t144 - t149 - t162;
    const double t184 = t183 * t81;
    const double t185 = t182 * t184;
    const double t186 = t181 * t185;
    const double t189 = t88 * rho;
    const double t191 = 0.1e1 / t21 / t189;
    const double t192 = t191 * t91;
    const double t193 = t192 * t94;
    const double t194 = t193 * t98;
    const double t197 = -0.7e1 / 0.288e3 * sigma * t165 * t39 * t72 + t177 * t186 / 0.3072e4 - 0.7e1 / 0.4608e4 * t87 * t194;
    const double t198 = beta * t197;
    const double t200 = t107 * t107;
    const double t201 = 0.1e1 / t200;
    const double t202 = t76 * t201;
    const double t204 = beta * t171 * t174;
    const double t206 = t79 * t81;
    const double t211 = t204 * t102 * t183 * t206 + t104 * t83 * t197;
    const double t212 = t202 * t211;
    const double t214 = -t103 * t212 + t198 * t109;
    const double t215 = 0.1e1 / t111;
    const double t217 = t62 * t214 * t215;
    const double t220 = rho * gamma;
    const double t228 = t75 * t84 * sigma;
    const double t231 = t65 * t39 * t68 * t224 / 0.96e2 + t228 * t99 / 0.1536e4;
    const double t232 = beta * t231;
    const double t235 = t234 * t102;
    const double t236 = t235 * t171;
    const double t237 = t201 * t83;
    const double t238 = t237 * t231;
    const double t240 = t232 * t109 - t236 * t238;
    const double t248 = t6 * t65;
    const double t250 = t4 * t248 * t30;
    const double t251 = 0.14764627977777777777e-2 * t250;
    const double t253 = t115 * t121;
    const double t255 = t252 * t253 * t142;
    const double t256 = 0.35616666666666666666e-1 * t255;
    const double t257 = t120 * t26;
    const double t258 = 0.1e1 / t257;
    const double t259 = t12 * t258;
    const double t260 = t140 * t140;
    const double t261 = t260 * t141;
    const double t262 = t259 * t261;
    const double t263 = 0.2e1 * t262;
    const double t266 = 0.1e1 / t13 / t10 * t18;
    const double t269 = 0.1e1 / t21 / t63;
    const double t270 = t267 * t269;
    const double t271 = t266 * t270;
    const double t273 = t125 * t65;
    const double t274 = t124 * t273;
    const double t276 = t4 * t248;
    const double t278 = 0.1e1/safe_math::sqrt( t10 );
    const double t279 = t278 * t18;
    const double t280 = t279 * t270;
    const double t282 = t132 * t273;
    const double t285 = t20 * t5 * t269;
    const double t287 = -0.42198333333333333333e0 * t271 + 0.84396666666666666666e0 * t274 + 0.39862222222222222223e0 * t276 + 0.68258333333333333333e-1 * t280 + 0.13651666666666666667e0 * t282 + 0.13692777777777777778e0 * t285;
    const double t288 = t287 * t141;
    const double t289 = t122 * t288;
    const double t290 = 0.1e1 * t289;
    const double t291 = t120 * t120;
    const double t292 = 0.1e1 / t291;
    const double t293 = t12 * t292;
    const double t294 = t29 * t29;
    const double t295 = 0.1e1 / t294;
    const double t296 = t260 * t295;
    const double t297 = t293 * t296;
    const double t298 = 0.16081979498692535067e2 * t297;
    const double t301 = t145 * t125 * t65 * t54;
    const double t302 = 0.24415263074675393405e-3 * t301;
    const double t303 = t43 * t4;
    const double t305 = t303 * t116 * t160;
    const double t306 = 0.10843581300301739842e-1 * t305;
    const double t307 = t151 * t50;
    const double t308 = 0.1e1 / t307;
    const double t309 = t157 * t157;
    const double t311 = t308 * t309 * t159;
    const double t312 = t150 * t311;
    const double t313 = 0.11696447245269292414e1 * t312;
    const double t320 = -0.57538888888888888889e0 * t271 + 0.11507777777777777778e1 * t274 + 0.40256666666666666667e0 * t276 + 0.366775e-1 * t280 + 0.73355e-1 * t282 + 0.137975e0 * t285;
    const double t322 = t152 * t320 * t159;
    const double t323 = t150 * t322;
    const double t324 = 0.5848223622634646207e0 * t323;
    const double t325 = t151 * t151;
    const double t326 = 0.1e1 / t325;
    const double t327 = t326 * t309;
    const double t328 = t53 * t53;
    const double t329 = 0.1e1 / t328;
    const double t330 = t327 * t329;
    const double t331 = t150 * t330;
    const double t332 = 0.17315859105681463759e2 * t331;
    const double t334 = 0.1e1 / t7 / t88;
    const double t343 = 0.1e1 / t173 / t82;
    const double t344 = t343 * t85;
    const double t345 = t344 * t90;
    const double t346 = t341 * t345;
    const double t347 = t93 * t93;
    const double t349 = 0.1e1 / t347 / t60;
    const double t351 = t91 * t349 * t1;
    const double t352 = t183 * t183;
    const double t353 = t81 * t81;
    const double t354 = t352 * t353;
    const double t356 = t351 * t182 * t354;
    const double t359 = t175 * t191;
    const double t360 = t172 * t359;
    const double t363 = -t251 - t256 - t263 + t290 + t298 + t302 + t306 + t313 - t324 - t332;
    const double t364 = t363 * t81;
    const double t366 = t181 * t182 * t364;
    const double t369 = t341 * t176;
    const double t370 = t352 * t81;
    const double t372 = t351 * t182 * t370;
    const double t375 = t88 * t63;
    const double t377 = 0.1e1 / t21 / t375;
    const double t380 = t377 * t91 * t94 * t98;
    const double t383 = 0.35e2 / 0.432e3 * sigma * t334 * t39 * t72 + t346 * t356 / 0.1536e4 - 0.7e1 / 0.2304e4 * t360 * t186 + t177 * t366 / 0.3072e4 - t369 * t372 / 0.3072e4 + 0.119e3 / 0.13824e5 * t87 * t380;
    const double t384 = beta * t383;
    const double t389 = 0.1e1 / t200 / t107;
    const double t390 = t76 * t389;
    const double t391 = t211 * t211;
    const double t392 = t390 * t391;
    const double t396 = t395 * t343;
    const double t397 = t102 * t352;
    const double t399 = 0.1e1 / t93 / t60;
    const double t400 = t399 * t353;
    const double t411 = t395 * t174;
    const double t412 = t399 * t81;
    const double t417 = t204 * t102 * t363 * t206 + 0.2e1 * t204 * t197 * t183 * t206 + t104 * t83 * t383 + 0.2e1 * t396 * t397 * t400 - t411 * t397 * t412;
    const double t418 = t202 * t417;
    const double t420 = 0.2e1 * t103 * t392 - t103 * t418 + t384 * t109 - 0.2e1 * t198 * t212;
    const double t422 = t62 * t420 * t215;
    const double t423 = t214 * t214;
    const double t424 = t111 * t111;
    const double t425 = 0.1e1 / t424;
    const double t427 = t62 * t423 * t425;
    const double t428 = -t251 - t256 - t263 + t290 + t298 + t302 + t306 + t313 - t324 - t332 + t422 - t427;
    const double t436 = t174 * sigma;
    const double t437 = t436 * t90;
    const double t438 = t172 * t437;
    const double t443 = -0.7e1 / 0.288e3 * t165 * t39 * t68 * t224 + t438 * t186 / 0.1536e4 - 0.7e1 / 0.2304e4 * t228 * t194;
    const double t444 = beta * t443;
    const double t447 = t234 * t197;
    const double t448 = t447 * t171;
    const double t450 = t389 * t83;
    const double t451 = t231 * t211;
    const double t452 = t450 * t451;
    const double t455 = t340 * t201;
    const double t456 = t235 * t455;
    const double t457 = t174 * t231;
    const double t459 = t183 * t79 * t81;
    const double t460 = t457 * t459;
    const double t462 = t237 * t443;
    const double t464 = t444 * t109 - t232 * t212 + 0.2e1 * t236 * t452 - t236 * t462 - t448 * t238 - t456 * t460;
    const double t468 = t220 * t61;
    const double t469 = t240 * t425;
    const double t470 = t469 * t214;
    const double t473 = t171 * t83;
    const double t479 = t91 * t94 * t1 * t182 * t108;
    const double t482 = t231 * t231;
    const double t483 = t234 * t482;
    const double t485 = t171 * t201 * t83;
    const double t489 = t488 * t102;
    const double t490 = t489 * t340;
    const double t491 = t389 * t174;
    const double t492 = t491 * t482;
    const double t496 = t201 * t174 * BB;
    const double t497 = t490 * t496;
    const double t500 = t472 * t473 * t90 * t479 / 0.1536e4 - 0.2e1 * t483 * t485 + 0.2e1 * t490 * t492 - t497 * t99 / 0.1536e4;
    const double t504 = t240 * t240;


    vrho = -t32 + t57 + t113 + rho * ( t119 + t144 - t149 - t162 + t217 );
    vsigma = t220 * t61 * t240 * t215;
    v2rho2 = 0.22146941966666666666e-2 * t118 + 0.2e1 * t143 - 0.36622894612013090108e-3 * t148 - 0.11696447245269292414e1 * t161 + 0.2e1 * t217 + rho * t428;
    v2rhosigma = t220 * t61 * t464 * t215 + t62 * t240 * t215 - t468 * t470;
    v2sigma2 = t220 * t61 * t500 * t215 - t220 * t61 * t504 * t425;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& eps ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t56 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t19 = t1 * t1;
    constexpr double t20 = t3 * t3;
    constexpr double t21 = t19 * t20;
    constexpr double t110 = 0.1e1 / t3;
    constexpr double t111 = t110 * t5;
    constexpr double t115 = BB * beta;
    constexpr double t116 = 0.1e1 / gamma;
    constexpr double t130 = t56 * t56;
    constexpr double t135 = 0.1e1 / t20;
    constexpr double t136 = t1 * t135;
    constexpr double t137 = t136 * t6;
    constexpr double t143 = beta * t116;


    const double t7 = rho_a + rho_b;
    const double t8 = safe_math::cbrt( t7 );
    const double t11 = t4 * t6 / t8;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t17 = pow_3_2( t11 );
    const double t22 = t8 * t8;
    const double t25 = t21 * t5 / t22;
    const double t27 = 0.379785e1 * t14 + 0.8969e0 * t11 + 0.204775e0 * t17 + 0.123235e0 * t25;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = rho_a - rho_b;
    const double t35 = t34 * t34;
    const double t36 = t35 * t35;
    const double t37 = t7 * t7;
    const double t38 = t37 * t37;
    const double t39 = 0.1e1 / t38;
    const double t40 = t36 * t39;
    const double t41 = 0.1e1 / t7;
    const double t42 = t34 * t41;
    const double t43 = 0.1e1 + t42;
    const double t44 = t43 <= zeta_tol;
    const double t45 = safe_math::cbrt( zeta_tol );
    const double t46 = t45 * zeta_tol;
    const double t47 = safe_math::cbrt( t43 );
    const double t48 = t47 * t43;
    const double t49 = piecewise_functor_3( t44, t46, t48 );
    const double t50 = 0.1e1 - t42;
    const double t51 = t50 <= zeta_tol;
    const double t52 = safe_math::cbrt( t50 );
    const double t53 = t52 * t50;
    const double t54 = piecewise_functor_3( t51, t46, t53 );
    const double t55 = t49 + t54 - 0.2e1;
    const double t59 = 0.1e1 / ( 0.2e1 * t56 - 0.2e1 );
    const double t60 = t55 * t59;
    const double t62 = 0.1e1 + 0.5137e-1 * t11;
    const double t67 = 0.705945e1 * t14 + 0.1549425e1 * t11 + 0.420775e0 * t17 + 0.1562925e0 * t25;
    const double t70 = 0.1e1 + 0.32163958997385070134e2 / t67;
    const double t71 = safe_math::log( t70 );
    const double t75 = 0.1e1 + 0.278125e-1 * t11;
    const double t80 = 0.51785e1 * t14 + 0.905775e0 * t11 + 0.1100325e0 * t17 + 0.1241775e0 * t25;
    const double t83 = 0.1e1 + 0.29608749977793437516e2 / t80;
    const double t84 = safe_math::log( t83 );
    const double t85 = t75 * t84;
    const double t87 = -0.310907e-1 * t62 * t71 + t33 - 0.19751673498613801407e-1 * t85;
    const double t88 = t60 * t87;
    const double t89 = t40 * t88;
    const double t91 = 0.19751673498613801407e-1 * t60 * t85;
    const double t92 = t45 * t45;
    const double t93 = t47 * t47;
    const double t94 = piecewise_functor_3( t44, t92, t93 );
    const double t95 = t52 * t52;
    const double t96 = piecewise_functor_3( t51, t92, t95 );
    const double t98 = t94 / 0.2e1 + t96 / 0.2e1;
    const double t99 = t98 * t98;
    const double t100 = t99 * t98;
    const double t101 = gamma * t100;
    const double t103 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t105 = 0.1e1 / t8 / t37;
    const double t106 = t103 * t105;
    const double t108 = 0.1e1 / t99;
    const double t112 = t108 * t19 * t111;
    const double t118 = ( -t33 + t89 + t91 ) * t116;
    const double t119 = 0.1e1 / t100;
    const double t121 = safe_math::exp( -t118 * t119 );
    const double t122 = t121 - 0.1e1;
    const double t123 = 0.1e1 / t122;
    const double t124 = t116 * t123;
    const double t125 = t103 * t103;
    const double t127 = t115 * t124 * t125;
    const double t129 = 0.1e1 / t22 / t38;
    const double t131 = t129 * t130;
    const double t132 = t99 * t99;
    const double t133 = 0.1e1 / t132;
    const double t134 = t131 * t133;
    const double t138 = t134 * t137;
    const double t141 = t106 * t56 * t112 / 0.96e2 + t127 * t138 / 0.3072e4;
    const double t142 = beta * t141;
    const double t146 = t143 * t123 * t141 + 0.1e1;
    const double t147 = 0.1e1 / t146;
    const double t148 = t116 * t147;
    const double t150 = t142 * t148 + 0.1e1;
    const double t151 = safe_math::log( t150 );
    const double t152 = t101 * t151;


    eps = -t33 + t89 + t91 + t152;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t56 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t19 = t1 * t1;
    constexpr double t20 = t3 * t3;
    constexpr double t21 = t19 * t20;
    constexpr double t110 = 0.1e1 / t3;
    constexpr double t111 = t110 * t5;
    constexpr double t115 = BB * beta;
    constexpr double t116 = 0.1e1 / gamma;
    constexpr double t130 = t56 * t56;
    constexpr double t135 = 0.1e1 / t20;
    constexpr double t136 = t1 * t135;
    constexpr double t137 = t136 * t6;
    constexpr double t143 = beta * t116;
    constexpr double t164 = t3 * t6;
    constexpr double t275 = t19 * t110;
    constexpr double t280 = t115 * t116;
    constexpr double t288 = t135 * t6;
    constexpr double t404 = t275 * t5;
    constexpr double t414 = beta * beta;
    constexpr double t416 = gamma * gamma;
    constexpr double t417 = 0.1e1 / t416;


    const double t7 = rho_a + rho_b;
    const double t8 = safe_math::cbrt( t7 );
    const double t11 = t4 * t6 / t8;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t17 = pow_3_2( t11 );
    const double t22 = t8 * t8;
    const double t25 = t21 * t5 / t22;
    const double t27 = 0.379785e1 * t14 + 0.8969e0 * t11 + 0.204775e0 * t17 + 0.123235e0 * t25;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = rho_a - rho_b;
    const double t35 = t34 * t34;
    const double t36 = t35 * t35;
    const double t37 = t7 * t7;
    const double t38 = t37 * t37;
    const double t39 = 0.1e1 / t38;
    const double t40 = t36 * t39;
    const double t41 = 0.1e1 / t7;
    const double t42 = t34 * t41;
    const double t43 = 0.1e1 + t42;
    const double t44 = t43 <= zeta_tol;
    const double t45 = safe_math::cbrt( zeta_tol );
    const double t46 = t45 * zeta_tol;
    const double t47 = safe_math::cbrt( t43 );
    const double t48 = t47 * t43;
    const double t49 = piecewise_functor_3( t44, t46, t48 );
    const double t50 = 0.1e1 - t42;
    const double t51 = t50 <= zeta_tol;
    const double t52 = safe_math::cbrt( t50 );
    const double t53 = t52 * t50;
    const double t54 = piecewise_functor_3( t51, t46, t53 );
    const double t55 = t49 + t54 - 0.2e1;
    const double t59 = 0.1e1 / ( 0.2e1 * t56 - 0.2e1 );
    const double t60 = t55 * t59;
    const double t62 = 0.1e1 + 0.5137e-1 * t11;
    const double t67 = 0.705945e1 * t14 + 0.1549425e1 * t11 + 0.420775e0 * t17 + 0.1562925e0 * t25;
    const double t70 = 0.1e1 + 0.32163958997385070134e2 / t67;
    const double t71 = safe_math::log( t70 );
    const double t75 = 0.1e1 + 0.278125e-1 * t11;
    const double t80 = 0.51785e1 * t14 + 0.905775e0 * t11 + 0.1100325e0 * t17 + 0.1241775e0 * t25;
    const double t83 = 0.1e1 + 0.29608749977793437516e2 / t80;
    const double t84 = safe_math::log( t83 );
    const double t85 = t75 * t84;
    const double t87 = -0.310907e-1 * t62 * t71 + t33 - 0.19751673498613801407e-1 * t85;
    const double t88 = t60 * t87;
    const double t89 = t40 * t88;
    const double t91 = 0.19751673498613801407e-1 * t60 * t85;
    const double t92 = t45 * t45;
    const double t93 = t47 * t47;
    const double t94 = piecewise_functor_3( t44, t92, t93 );
    const double t95 = t52 * t52;
    const double t96 = piecewise_functor_3( t51, t92, t95 );
    const double t98 = t94 / 0.2e1 + t96 / 0.2e1;
    const double t99 = t98 * t98;
    const double t100 = t99 * t98;
    const double t101 = gamma * t100;
    const double t103 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t105 = 0.1e1 / t8 / t37;
    const double t106 = t103 * t105;
    const double t108 = 0.1e1 / t99;
    const double t112 = t108 * t19 * t111;
    const double t118 = ( -t33 + t89 + t91 ) * t116;
    const double t119 = 0.1e1 / t100;
    const double t121 = safe_math::exp( -t118 * t119 );
    const double t122 = t121 - 0.1e1;
    const double t123 = 0.1e1 / t122;
    const double t124 = t116 * t123;
    const double t125 = t103 * t103;
    const double t127 = t115 * t124 * t125;
    const double t129 = 0.1e1 / t22 / t38;
    const double t131 = t129 * t130;
    const double t132 = t99 * t99;
    const double t133 = 0.1e1 / t132;
    const double t134 = t131 * t133;
    const double t138 = t134 * t137;
    const double t141 = t106 * t56 * t112 / 0.96e2 + t127 * t138 / 0.3072e4;
    const double t142 = beta * t141;
    const double t146 = t143 * t123 * t141 + 0.1e1;
    const double t147 = 0.1e1 / t146;
    const double t148 = t116 * t147;
    const double t150 = t142 * t148 + 0.1e1;
    const double t151 = safe_math::log( t150 );
    const double t152 = t101 * t151;
    const double t154 = 0.1e1 / t8 / t7;
    const double t155 = t6 * t154;
    const double t157 = t4 * t155 * t31;
    const double t158 = 0.11073470983333333333e-2 * t157;
    const double t159 = t27 * t27;
    const double t160 = 0.1e1 / t159;
    const double t161 = t13 * t160;
    const double t163 = 0.1e1 / t14 * t1;
    const double t165 = t164 * t154;
    const double t166 = t163 * t165;
    const double t168 = t4 * t155;
    const double t170 = safe_math::sqrt( t11 );
    const double t171 = t170 * t1;
    const double t172 = t171 * t165;
    const double t177 = t21 * t5 / t22 / t7;
    const double t179 = -0.632975e0 * t166 - 0.29896666666666666667e0 * t168 - 0.1023875e0 * t172 - 0.82156666666666666667e-1 * t177;
    const double t180 = 0.1e1 / t30;
    const double t181 = t179 * t180;
    const double t182 = t161 * t181;
    const double t183 = 0.1e1 * t182;
    const double t184 = t35 * t34;
    const double t185 = t184 * t39;
    const double t186 = t185 * t88;
    const double t187 = 0.4e1 * t186;
    const double t188 = t38 * t7;
    const double t189 = 0.1e1 / t188;
    const double t190 = t36 * t189;
    const double t191 = t190 * t88;
    const double t192 = 0.4e1 * t191;
    const double t193 = 0.1e1 / t37;
    const double t194 = t34 * t193;
    const double t195 = t41 - t194;
    const double t198 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.3e1 * t47 * t195 );
    const double t199 = -t195;
    const double t202 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.3e1 * t52 * t199 );
    const double t204 = ( t198 + t202 ) * t59;
    const double t205 = t204 * t87;
    const double t206 = t40 * t205;
    const double t210 = t67 * t67;
    const double t211 = 0.1e1 / t210;
    const double t212 = t62 * t211;
    const double t217 = -0.1176575e1 * t166 - 0.516475e0 * t168 - 0.2103875e0 * t172 - 0.104195e0 * t177;
    const double t218 = 0.1e1 / t70;
    const double t219 = t217 * t218;
    const double t225 = t80 * t80;
    const double t226 = 0.1e1 / t225;
    const double t227 = t75 * t226;
    const double t232 = -0.86308333333333333334e0 * t166 - 0.301925e0 * t168 - 0.5501625e-1 * t172 - 0.82785e-1 * t177;
    const double t233 = 0.1e1 / t83;
    const double t234 = t232 * t233;
    const double t237 = 0.53237641966666666666e-3 * t4 * t155 * t71 + 0.1e1 * t212 * t219 - t158 - t183 + 0.18311447306006545054e-3 * t4 * t155 * t84 + 0.5848223622634646207e0 * t227 * t234;
    const double t238 = t60 * t237;
    const double t239 = t40 * t238;
    const double t240 = t204 * t85;
    const double t241 = 0.19751673498613801407e-1 * t240;
    const double t242 = t60 * t1;
    const double t244 = t164 * t154 * t84;
    const double t245 = t242 * t244;
    const double t246 = 0.18311447306006545054e-3 * t245;
    const double t247 = t60 * t75;
    const double t249 = t226 * t232 * t233;
    const double t250 = t247 * t249;
    const double t251 = 0.5848223622634646207e0 * t250;
    const double t252 = gamma * t99;
    const double t253 = 0.1e1 / t47;
    const double t256 = piecewise_functor_3( t44, 0.0, 0.2e1 / 0.3e1 * t253 * t195 );
    const double t257 = 0.1e1 / t52;
    const double t260 = piecewise_functor_3( t51, 0.0, 0.2e1 / 0.3e1 * t257 * t199 );
    const double t262 = t256 / 0.2e1 + t260 / 0.2e1;
    const double t263 = t151 * t262;
    const double t264 = t252 * t263;
    const double t265 = 0.3e1 * t264;
    const double t266 = t37 * t7;
    const double t268 = 0.1e1 / t8 / t266;
    const double t269 = t103 * t268;
    const double t272 = 0.7e1 / 0.288e3 * t269 * t56 * t112;
    const double t273 = t56 * t119;
    const double t274 = t106 * t273;
    const double t276 = t5 * t262;
    const double t277 = t275 * t276;
    const double t281 = t122 * t122;
    const double t282 = 0.1e1 / t281;
    const double t283 = t282 * t125;
    const double t285 = t280 * t283 * t129;
    const double t286 = t130 * t133;
    const double t287 = t286 * t1;
    const double t290 = ( t158 + t183 + t187 - t192 + t206 + t239 + t241 - t246 - t251 ) * t116;
    const double t292 = t133 * t262;
    const double t295 = 0.3e1 * t118 * t292 - t290 * t119;
    const double t296 = t295 * t121;
    const double t297 = t288 * t296;
    const double t298 = t287 * t297;
    const double t302 = 0.1e1 / t22 / t188;
    const double t303 = t302 * t130;
    const double t304 = t303 * t133;
    const double t305 = t304 * t137;
    const double t307 = 0.7e1 / 0.4608e4 * t127 * t305;
    const double t308 = t123 * t125;
    const double t310 = t280 * t308 * t129;
    const double t312 = 0.1e1 / t132 / t98;
    const double t313 = t130 * t312;
    const double t314 = t313 * t1;
    const double t316 = t314 * t288 * t262;
    const double t319 = -t272 - t274 * t277 / 0.48e2 - t285 * t298 / 0.3072e4 - t307 - t310 * t316 / 0.768e3;
    const double t320 = beta * t319;
    const double t322 = t146 * t146;
    const double t323 = 0.1e1 / t322;
    const double t324 = t116 * t323;
    const double t325 = t143 * t282;
    const double t326 = t141 * t295;
    const double t331 = -t325 * t326 * t121 + t143 * t123 * t319;
    const double t332 = t324 * t331;
    const double t334 = -t142 * t332 + t320 * t148;
    const double t335 = 0.1e1 / t150;
    const double t336 = t334 * t335;
    const double t337 = t101 * t336;
    const double t338 = t158 + t183 + t187 - t192 + t206 + t239 + t241 - t246 - t251 + t265 + t337;
    const double t340 = -t41 - t194;
    const double t343 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.3e1 * t47 * t340 );
    const double t344 = -t340;
    const double t347 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.3e1 * t52 * t344 );
    const double t349 = ( t343 + t347 ) * t59;
    const double t350 = t349 * t87;
    const double t351 = t40 * t350;
    const double t352 = t349 * t85;
    const double t353 = 0.19751673498613801407e-1 * t352;
    const double t356 = piecewise_functor_3( t44, 0.0, 0.2e1 / 0.3e1 * t253 * t340 );
    const double t359 = piecewise_functor_3( t51, 0.0, 0.2e1 / 0.3e1 * t257 * t344 );
    const double t361 = t356 / 0.2e1 + t359 / 0.2e1;
    const double t362 = t151 * t361;
    const double t363 = t252 * t362;
    const double t364 = 0.3e1 * t363;
    const double t365 = t5 * t361;
    const double t366 = t275 * t365;
    const double t370 = ( t158 + t183 - t187 - t192 + t351 + t239 + t353 - t246 - t251 ) * t116;
    const double t372 = t133 * t361;
    const double t375 = 0.3e1 * t118 * t372 - t370 * t119;
    const double t376 = t375 * t121;
    const double t377 = t288 * t376;
    const double t378 = t287 * t377;
    const double t382 = t314 * t288 * t361;
    const double t385 = -t272 - t274 * t366 / 0.48e2 - t285 * t378 / 0.3072e4 - t307 - t310 * t382 / 0.768e3;
    const double t386 = beta * t385;
    const double t388 = t141 * t375;
    const double t393 = -t325 * t388 * t121 + t143 * t123 * t385;
    const double t394 = t324 * t393;
    const double t396 = -t142 * t394 + t386 * t148;
    const double t397 = t396 * t335;
    const double t398 = t101 * t397;
    const double t399 = t158 + t183 - t187 - t192 + t351 + t239 + t353 - t246 - t251 + t364 + t398;
    const double t401 = t7 * gamma;
    const double t402 = t105 * t56;
    const double t405 = t402 * t108 * t404;
    const double t408 = t115 * t124 * t103;
    const double t409 = t408 * t138;
    const double t411 = t405 / 0.96e2 + t409 / 0.1536e4;
    const double t412 = beta * t411;
    const double t415 = t414 * t141;
    const double t418 = t415 * t417;
    const double t419 = t323 * t123;
    const double t420 = t419 * t411;
    const double t422 = t412 * t148 - t418 * t420;
    const double t427 = t405 / 0.48e2 + t409 / 0.768e3;
    const double t428 = beta * t427;
    const double t430 = t419 * t427;
    const double t432 = t428 * t148 - t418 * t430;
    const double t433 = t100 * t432;


    eps = -t33 + t89 + t91 + t152;
    vrho_a = t7 * t338 + t152 - t33 + t89 + t91;
    vrho_b = t7 * t399 + t152 - t33 + t89 + t91;
    vsigma_aa = t401 * t100 * t422 * t335;
    vsigma_ab = t401 * t433 * t335;
    vsigma_bb = vsigma_aa;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_fxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& v2rho2_aa, double& v2rho2_ab, double& v2rho2_bb, double& v2rhosigma_a_aa, double& v2rhosigma_a_ab, double& v2rhosigma_a_bb, double& v2rhosigma_b_aa, double& v2rhosigma_b_ab, double& v2rhosigma_b_bb, double& v2sigma2_aa_aa, double& v2sigma2_aa_ab, double& v2sigma2_aa_bb, double& v2sigma2_ab_ab, double& v2sigma2_ab_bb, double& v2sigma2_bb_bb ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t56 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t19 = t1 * t1;
    constexpr double t20 = t3 * t3;
    constexpr double t21 = t19 * t20;
    constexpr double t110 = 0.1e1 / t3;
    constexpr double t111 = t110 * t5;
    constexpr double t115 = BB * beta;
    constexpr double t116 = 0.1e1 / gamma;
    constexpr double t130 = t56 * t56;
    constexpr double t135 = 0.1e1 / t20;
    constexpr double t136 = t1 * t135;
    constexpr double t137 = t136 * t6;
    constexpr double t143 = beta * t116;
    constexpr double t164 = t3 * t6;
    constexpr double t275 = t19 * t110;
    constexpr double t280 = t115 * t116;
    constexpr double t288 = t135 * t6;
    constexpr double t404 = t275 * t5;
    constexpr double t414 = beta * beta;
    constexpr double t416 = gamma * gamma;
    constexpr double t417 = 0.1e1 / t416;
    constexpr double t534 = t20 * t5;
    constexpr double t584 = t4 * t6;
    constexpr double t1264 = t414 * BB;
    constexpr double t1277 = t414 * beta;
    constexpr double t1280 = 0.1e1 / t416 / gamma;


    const double t7 = rho_a + rho_b;
    const double t8 = safe_math::cbrt( t7 );
    const double t11 = t4 * t6 / t8;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t17 = pow_3_2( t11 );
    const double t22 = t8 * t8;
    const double t25 = t21 * t5 / t22;
    const double t27 = 0.379785e1 * t14 + 0.8969e0 * t11 + 0.204775e0 * t17 + 0.123235e0 * t25;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = rho_a - rho_b;
    const double t35 = t34 * t34;
    const double t36 = t35 * t35;
    const double t37 = t7 * t7;
    const double t38 = t37 * t37;
    const double t39 = 0.1e1 / t38;
    const double t40 = t36 * t39;
    const double t41 = 0.1e1 / t7;
    const double t42 = t34 * t41;
    const double t43 = 0.1e1 + t42;
    const double t44 = t43 <= zeta_tol;
    const double t45 = safe_math::cbrt( zeta_tol );
    const double t46 = t45 * zeta_tol;
    const double t47 = safe_math::cbrt( t43 );
    const double t48 = t47 * t43;
    const double t49 = piecewise_functor_3( t44, t46, t48 );
    const double t50 = 0.1e1 - t42;
    const double t51 = t50 <= zeta_tol;
    const double t52 = safe_math::cbrt( t50 );
    const double t53 = t52 * t50;
    const double t54 = piecewise_functor_3( t51, t46, t53 );
    const double t55 = t49 + t54 - 0.2e1;
    const double t59 = 0.1e1 / ( 0.2e1 * t56 - 0.2e1 );
    const double t60 = t55 * t59;
    const double t62 = 0.1e1 + 0.5137e-1 * t11;
    const double t67 = 0.705945e1 * t14 + 0.1549425e1 * t11 + 0.420775e0 * t17 + 0.1562925e0 * t25;
    const double t70 = 0.1e1 + 0.32163958997385070134e2 / t67;
    const double t71 = safe_math::log( t70 );
    const double t75 = 0.1e1 + 0.278125e-1 * t11;
    const double t80 = 0.51785e1 * t14 + 0.905775e0 * t11 + 0.1100325e0 * t17 + 0.1241775e0 * t25;
    const double t83 = 0.1e1 + 0.29608749977793437516e2 / t80;
    const double t84 = safe_math::log( t83 );
    const double t85 = t75 * t84;
    const double t87 = -0.310907e-1 * t62 * t71 + t33 - 0.19751673498613801407e-1 * t85;
    const double t88 = t60 * t87;
    const double t89 = t40 * t88;
    const double t91 = 0.19751673498613801407e-1 * t60 * t85;
    const double t92 = t45 * t45;
    const double t93 = t47 * t47;
    const double t94 = piecewise_functor_3( t44, t92, t93 );
    const double t95 = t52 * t52;
    const double t96 = piecewise_functor_3( t51, t92, t95 );
    const double t98 = t94 / 0.2e1 + t96 / 0.2e1;
    const double t99 = t98 * t98;
    const double t100 = t99 * t98;
    const double t101 = gamma * t100;
    const double t103 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t105 = 0.1e1 / t8 / t37;
    const double t106 = t103 * t105;
    const double t108 = 0.1e1 / t99;
    const double t112 = t108 * t19 * t111;
    const double t118 = ( -t33 + t89 + t91 ) * t116;
    const double t119 = 0.1e1 / t100;
    const double t121 = safe_math::exp( -t118 * t119 );
    const double t122 = t121 - 0.1e1;
    const double t123 = 0.1e1 / t122;
    const double t124 = t116 * t123;
    const double t125 = t103 * t103;
    const double t127 = t115 * t124 * t125;
    const double t129 = 0.1e1 / t22 / t38;
    const double t131 = t129 * t130;
    const double t132 = t99 * t99;
    const double t133 = 0.1e1 / t132;
    const double t134 = t131 * t133;
    const double t138 = t134 * t137;
    const double t141 = t106 * t56 * t112 / 0.96e2 + t127 * t138 / 0.3072e4;
    const double t142 = beta * t141;
    const double t146 = t143 * t123 * t141 + 0.1e1;
    const double t147 = 0.1e1 / t146;
    const double t148 = t116 * t147;
    const double t150 = t142 * t148 + 0.1e1;
    const double t151 = safe_math::log( t150 );
    const double t154 = 0.1e1 / t8 / t7;
    const double t155 = t6 * t154;
    const double t157 = t4 * t155 * t31;
    const double t158 = 0.11073470983333333333e-2 * t157;
    const double t159 = t27 * t27;
    const double t160 = 0.1e1 / t159;
    const double t161 = t13 * t160;
    const double t163 = 0.1e1 / t14 * t1;
    const double t165 = t164 * t154;
    const double t166 = t163 * t165;
    const double t168 = t4 * t155;
    const double t170 = safe_math::sqrt( t11 );
    const double t171 = t170 * t1;
    const double t172 = t171 * t165;
    const double t177 = t21 * t5 / t22 / t7;
    const double t179 = -0.632975e0 * t166 - 0.29896666666666666667e0 * t168 - 0.1023875e0 * t172 - 0.82156666666666666667e-1 * t177;
    const double t180 = 0.1e1 / t30;
    const double t181 = t179 * t180;
    const double t182 = t161 * t181;
    const double t183 = 0.1e1 * t182;
    const double t184 = t35 * t34;
    const double t185 = t184 * t39;
    const double t186 = t185 * t88;
    const double t187 = 0.4e1 * t186;
    const double t188 = t38 * t7;
    const double t189 = 0.1e1 / t188;
    const double t190 = t36 * t189;
    const double t191 = t190 * t88;
    const double t192 = 0.4e1 * t191;
    const double t193 = 0.1e1 / t37;
    const double t194 = t34 * t193;
    const double t195 = t41 - t194;
    const double t198 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.3e1 * t47 * t195 );
    const double t199 = -t195;
    const double t202 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.3e1 * t52 * t199 );
    const double t204 = ( t198 + t202 ) * t59;
    const double t205 = t204 * t87;
    const double t206 = t40 * t205;
    const double t210 = t67 * t67;
    const double t211 = 0.1e1 / t210;
    const double t212 = t62 * t211;
    const double t217 = -0.1176575e1 * t166 - 0.516475e0 * t168 - 0.2103875e0 * t172 - 0.104195e0 * t177;
    const double t218 = 0.1e1 / t70;
    const double t219 = t217 * t218;
    const double t225 = t80 * t80;
    const double t226 = 0.1e1 / t225;
    const double t227 = t75 * t226;
    const double t232 = -0.86308333333333333334e0 * t166 - 0.301925e0 * t168 - 0.5501625e-1 * t172 - 0.82785e-1 * t177;
    const double t233 = 0.1e1 / t83;
    const double t234 = t232 * t233;
    const double t237 = 0.53237641966666666666e-3 * t4 * t155 * t71 + 0.1e1 * t212 * t219 - t158 - t183 + 0.18311447306006545054e-3 * t4 * t155 * t84 + 0.5848223622634646207e0 * t227 * t234;
    const double t238 = t60 * t237;
    const double t239 = t40 * t238;
    const double t240 = t204 * t85;
    const double t241 = 0.19751673498613801407e-1 * t240;
    const double t242 = t60 * t1;
    const double t244 = t164 * t154 * t84;
    const double t245 = t242 * t244;
    const double t246 = 0.18311447306006545054e-3 * t245;
    const double t247 = t60 * t75;
    const double t249 = t226 * t232 * t233;
    const double t250 = t247 * t249;
    const double t251 = 0.5848223622634646207e0 * t250;
    const double t252 = gamma * t99;
    const double t253 = 0.1e1 / t47;
    const double t256 = piecewise_functor_3( t44, 0.0, 0.2e1 / 0.3e1 * t253 * t195 );
    const double t257 = 0.1e1 / t52;
    const double t260 = piecewise_functor_3( t51, 0.0, 0.2e1 / 0.3e1 * t257 * t199 );
    const double t262 = t256 / 0.2e1 + t260 / 0.2e1;
    const double t263 = t151 * t262;
    const double t264 = t252 * t263;
    const double t265 = 0.3e1 * t264;
    const double t266 = t37 * t7;
    const double t268 = 0.1e1 / t8 / t266;
    const double t269 = t103 * t268;
    const double t272 = 0.7e1 / 0.288e3 * t269 * t56 * t112;
    const double t273 = t56 * t119;
    const double t274 = t106 * t273;
    const double t276 = t5 * t262;
    const double t277 = t275 * t276;
    const double t281 = t122 * t122;
    const double t282 = 0.1e1 / t281;
    const double t283 = t282 * t125;
    const double t285 = t280 * t283 * t129;
    const double t286 = t130 * t133;
    const double t287 = t286 * t1;
    const double t290 = ( t158 + t183 + t187 - t192 + t206 + t239 + t241 - t246 - t251 ) * t116;
    const double t292 = t133 * t262;
    const double t295 = 0.3e1 * t118 * t292 - t290 * t119;
    const double t296 = t295 * t121;
    const double t297 = t288 * t296;
    const double t298 = t287 * t297;
    const double t302 = 0.1e1 / t22 / t188;
    const double t303 = t302 * t130;
    const double t304 = t303 * t133;
    const double t305 = t304 * t137;
    const double t307 = 0.7e1 / 0.4608e4 * t127 * t305;
    const double t308 = t123 * t125;
    const double t310 = t280 * t308 * t129;
    const double t312 = 0.1e1 / t132 / t98;
    const double t313 = t130 * t312;
    const double t314 = t313 * t1;
    const double t316 = t314 * t288 * t262;
    const double t319 = -t272 - t274 * t277 / 0.48e2 - t285 * t298 / 0.3072e4 - t307 - t310 * t316 / 0.768e3;
    const double t320 = beta * t319;
    const double t322 = t146 * t146;
    const double t323 = 0.1e1 / t322;
    const double t324 = t116 * t323;
    const double t325 = t143 * t282;
    const double t326 = t141 * t295;
    const double t331 = -t325 * t326 * t121 + t143 * t123 * t319;
    const double t332 = t324 * t331;
    const double t334 = -t142 * t332 + t320 * t148;
    const double t335 = 0.1e1 / t150;
    const double t336 = t334 * t335;
    const double t337 = t101 * t336;
    const double t340 = -t41 - t194;
    const double t343 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.3e1 * t47 * t340 );
    const double t344 = -t340;
    const double t347 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.3e1 * t52 * t344 );
    const double t349 = ( t343 + t347 ) * t59;
    const double t350 = t349 * t87;
    const double t351 = t40 * t350;
    const double t352 = t349 * t85;
    const double t353 = 0.19751673498613801407e-1 * t352;
    const double t356 = piecewise_functor_3( t44, 0.0, 0.2e1 / 0.3e1 * t253 * t340 );
    const double t359 = piecewise_functor_3( t51, 0.0, 0.2e1 / 0.3e1 * t257 * t344 );
    const double t361 = t356 / 0.2e1 + t359 / 0.2e1;
    const double t362 = t151 * t361;
    const double t363 = t252 * t362;
    const double t364 = 0.3e1 * t363;
    const double t365 = t5 * t361;
    const double t366 = t275 * t365;
    const double t370 = ( t158 + t183 - t187 - t192 + t351 + t239 + t353 - t246 - t251 ) * t116;
    const double t372 = t133 * t361;
    const double t375 = 0.3e1 * t118 * t372 - t370 * t119;
    const double t376 = t375 * t121;
    const double t377 = t288 * t376;
    const double t378 = t287 * t377;
    const double t382 = t314 * t288 * t361;
    const double t385 = -t272 - t274 * t366 / 0.48e2 - t285 * t378 / 0.3072e4 - t307 - t310 * t382 / 0.768e3;
    const double t386 = beta * t385;
    const double t388 = t141 * t375;
    const double t393 = -t325 * t388 * t121 + t143 * t123 * t385;
    const double t394 = t324 * t393;
    const double t396 = -t142 * t394 + t386 * t148;
    const double t397 = t396 * t335;
    const double t398 = t101 * t397;
    const double t401 = t7 * gamma;
    const double t402 = t105 * t56;
    const double t405 = t402 * t108 * t404;
    const double t408 = t115 * t124 * t103;
    const double t409 = t408 * t138;
    const double t411 = t405 / 0.96e2 + t409 / 0.1536e4;
    const double t412 = beta * t411;
    const double t415 = t414 * t141;
    const double t418 = t415 * t417;
    const double t419 = t323 * t123;
    const double t420 = t419 * t411;
    const double t422 = t412 * t148 - t418 * t420;
    const double t427 = t405 / 0.48e2 + t409 / 0.768e3;
    const double t428 = beta * t427;
    const double t430 = t419 * t427;
    const double t432 = t428 * t148 - t418 * t430;
    const double t435 = 0.22146941966666666666e-2 * t157;
    const double t436 = 0.2e1 * t182;
    const double t437 = 0.8e1 * t186;
    const double t438 = 0.8e1 * t191;
    const double t440 = 0.2e1 * t239;
    const double t442 = 0.36622894612013090108e-3 * t245;
    const double t443 = 0.11696447245269292414e1 * t250;
    const double t446 = gamma * t98;
    const double t447 = t262 * t262;
    const double t449 = t446 * t151 * t447;
    const double t450 = 0.6e1 * t449;
    const double t451 = 0.1e1 / t48;
    const double t452 = t195 * t195;
    const double t455 = 0.1e1 / t266;
    const double t456 = t34 * t455;
    const double t458 = -0.2e1 * t193 + 0.2e1 * t456;
    const double t462 = piecewise_functor_3( t44, 0.0, -0.2e1 / 0.9e1 * t451 * t452 + 0.2e1 / 0.3e1 * t253 * t458 );
    const double t463 = 0.1e1 / t53;
    const double t464 = t199 * t199;
    const double t467 = -t458;
    const double t471 = piecewise_functor_3( t51, 0.0, -0.2e1 / 0.9e1 * t463 * t464 + 0.2e1 / 0.3e1 * t257 * t467 );
    const double t473 = t462 / 0.2e1 + t471 / 0.2e1;
    const double t474 = t151 * t473;
    const double t475 = t252 * t474;
    const double t476 = 0.3e1 * t475;
    const double t478 = 0.1e1 / t8 / t38;
    const double t479 = t103 * t478;
    const double t482 = 0.35e2 / 0.432e3 * t479 * t56 * t112;
    const double t483 = t269 * t273;
    const double t484 = t483 * t277;
    const double t486 = t56 * t133;
    const double t487 = t106 * t486;
    const double t488 = t5 * t447;
    const double t489 = t275 * t488;
    const double t493 = t275 * t5 * t473;
    const double t497 = 0.1e1 / t281 / t122;
    const double t498 = t497 * t125;
    const double t500 = t280 * t498 * t129;
    const double t501 = t295 * t295;
    const double t502 = t121 * t121;
    const double t503 = t501 * t502;
    const double t505 = t287 * t288 * t503;
    const double t509 = t280 * t283 * t302;
    const double t510 = t509 * t298;
    const double t513 = t280 * t283 * t131;
    const double t514 = t312 * t1;
    const double t515 = t514 * t135;
    const double t516 = t6 * t295;
    const double t517 = t121 * t262;
    const double t518 = t516 * t517;
    const double t519 = t515 * t518;
    const double t522 = t225 * t225;
    const double t523 = 0.1e1 / t522;
    const double t524 = t232 * t232;
    const double t525 = t523 * t524;
    const double t526 = t83 * t83;
    const double t527 = 0.1e1 / t526;
    const double t528 = t525 * t527;
    const double t529 = t247 * t528;
    const double t530 = 0.17315859105681463759e2 * t529;
    const double t533 = 0.1e1 / t14 / t11 * t19;
    const double t536 = 0.1e1 / t22 / t37;
    const double t537 = t534 * t536;
    const double t538 = t533 * t537;
    const double t540 = t164 * t105;
    const double t541 = t163 * t540;
    const double t543 = t6 * t105;
    const double t544 = t4 * t543;
    const double t546 = 0.1e1/safe_math::sqrt( t11 );
    const double t547 = t546 * t19;
    const double t548 = t547 * t537;
    const double t550 = t171 * t540;
    const double t553 = t21 * t5 * t536;
    const double t555 = -0.57538888888888888889e0 * t538 + 0.11507777777777777778e1 * t541 + 0.40256666666666666667e0 * t544 + 0.366775e-1 * t548 + 0.73355e-1 * t550 + 0.137975e0 * t553;
    const double t557 = t226 * t555 * t233;
    const double t558 = t247 * t557;
    const double t559 = 0.5848223622634646207e0 * t558;
    const double t560 = t204 * t75;
    const double t561 = t560 * t249;
    const double t562 = 0.11696447245269292414e1 * t561;
    const double t563 = 0.1e1 / t93;
    const double t569 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.9e1 * t563 * t452 + 0.4e1 / 0.3e1 * t47 * t458 );
    const double t570 = 0.1e1 / t95;
    const double t576 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.9e1 * t570 * t464 + 0.4e1 / 0.3e1 * t52 * t467 );
    const double t578 = ( t569 + t576 ) * t59;
    const double t579 = t578 * t85;
    const double t580 = 0.19751673498613801407e-1 * t579;
    const double t585 = t154 * t211;
    const double t589 = t210 * t67;
    const double t590 = 0.1e1 / t589;
    const double t591 = t62 * t590;
    const double t592 = t217 * t217;
    const double t593 = t592 * t218;
    const double t602 = -0.78438333333333333333e0 * t538 + 0.15687666666666666667e1 * t541 + 0.68863333333333333333e0 * t544 + 0.14025833333333333333e0 * t548 + 0.28051666666666666667e0 * t550 + 0.17365833333333333333e0 * t553;
    const double t603 = t602 * t218;
    const double t606 = t210 * t210;
    const double t607 = 0.1e1 / t606;
    const double t608 = t62 * t607;
    const double t609 = t70 * t70;
    const double t610 = 0.1e1 / t609;
    const double t611 = t592 * t610;
    const double t615 = t4 * t543 * t31;
    const double t616 = 0.14764627977777777777e-2 * t615;
    const double t617 = t154 * t160;
    const double t619 = t584 * t617 * t181;
    const double t620 = 0.35616666666666666666e-1 * t619;
    const double t621 = t159 * t27;
    const double t622 = 0.1e1 / t621;
    const double t623 = t13 * t622;
    const double t624 = t179 * t179;
    const double t625 = t624 * t180;
    const double t626 = t623 * t625;
    const double t627 = 0.2e1 * t626;
    const double t634 = -0.42198333333333333333e0 * t538 + 0.84396666666666666666e0 * t541 + 0.39862222222222222223e0 * t544 + 0.68258333333333333333e-1 * t548 + 0.13651666666666666667e0 * t550 + 0.13692777777777777778e0 * t553;
    const double t635 = t634 * t180;
    const double t636 = t161 * t635;
    const double t637 = 0.1e1 * t636;
    const double t638 = t159 * t159;
    const double t639 = 0.1e1 / t638;
    const double t640 = t13 * t639;
    const double t641 = t30 * t30;
    const double t642 = 0.1e1 / t641;
    const double t643 = t624 * t642;
    const double t644 = t640 * t643;
    const double t645 = 0.16081979498692535067e2 * t644;
    const double t649 = t154 * t226;
    const double t653 = t225 * t80;
    const double t654 = 0.1e1 / t653;
    const double t655 = t75 * t654;
    const double t656 = t524 * t233;
    const double t659 = t555 * t233;
    const double t662 = t75 * t523;
    const double t663 = t524 * t527;
    const double t666 = -0.70983522622222222221e-3 * t4 * t543 * t71 - 0.34246666666666666666e-1 * t584 * t585 * t219 - 0.2e1 * t591 * t593 + 0.1e1 * t212 * t603 + 0.32163958997385070134e2 * t608 * t611 + t616 + t620 + t627 - t637 - t645 - 0.24415263074675393405e-3 * t4 * t543 * t84 - 0.10843581300301739842e-1 * t584 * t649 * t234 - 0.11696447245269292414e1 * t655 * t656 + 0.5848223622634646207e0 * t227 * t659 + 0.17315859105681463759e2 * t662 * t663;
    const double t667 = t60 * t666;
    const double t668 = t40 * t667;
    const double t669 = t578 * t87;
    const double t670 = t40 * t669;
    const double t671 = t204 * t237;
    const double t672 = t40 * t671;
    const double t673 = 0.2e1 * t672;
    const double t674 = t190 * t205;
    const double t675 = 0.8e1 * t674;
    const double t676 = t190 * t238;
    const double t677 = 0.8e1 * t676;
    const double t678 = t185 * t205;
    const double t679 = 0.8e1 * t678;
    const double t680 = t185 * t238;
    const double t681 = 0.8e1 * t680;
    const double t682 = -t530 - t559 - t562 + t580 + t668 + t670 + t673 - t675 - t677 + t679 + t681;
    const double t683 = t38 * t37;
    const double t684 = 0.1e1 / t683;
    const double t685 = t36 * t684;
    const double t686 = t685 * t88;
    const double t687 = 0.2e2 * t686;
    const double t688 = t35 * t39;
    const double t689 = t688 * t88;
    const double t690 = 0.12e2 * t689;
    const double t691 = t184 * t189;
    const double t692 = t691 * t88;
    const double t693 = 0.32e2 * t692;
    const double t694 = t60 * t4;
    const double t695 = t155 * t249;
    const double t696 = t694 * t695;
    const double t697 = 0.10843581300301739842e-1 * t696;
    const double t698 = t204 * t1;
    const double t699 = t698 * t244;
    const double t700 = 0.36622894612013090108e-3 * t699;
    const double t702 = t654 * t524 * t233;
    const double t703 = t247 * t702;
    const double t704 = 0.11696447245269292414e1 * t703;
    const double t706 = t164 * t105 * t84;
    const double t707 = t242 * t706;
    const double t708 = 0.24415263074675393405e-3 * t707;
    const double t709 = -t627 + t687 + t690 - t693 - t616 + t637 + t645 + t697 - t700 + t704 - t620 + t708;
    const double t711 = ( t682 + t709 ) * t116;
    const double t715 = t312 * t447;
    const double t718 = t133 * t473;
    const double t721 = -0.12e2 * t118 * t715 + 0.3e1 * t118 * t718 - t711 * t119 + 0.6e1 * t290 * t292;
    const double t722 = t721 * t121;
    const double t724 = t287 * t288 * t722;
    const double t727 = t501 * t121;
    const double t729 = t287 * t288 * t727;
    const double t733 = 0.1e1 / t22 / t683;
    const double t734 = t733 * t130;
    const double t736 = t734 * t133 * t137;
    const double t738 = 0.119e3 / 0.13824e5 * t127 * t736;
    const double t740 = t280 * t308 * t302;
    const double t741 = t740 * t316;
    const double t744 = 0.1e1 / t132 / t99;
    const double t745 = t130 * t744;
    const double t746 = t745 * t1;
    const double t748 = t746 * t288 * t447;
    const double t752 = t314 * t288 * t473;
    const double t755 = t482 + 0.7e1 / 0.72e2 * t484 + t487 * t489 / 0.16e2 - t274 * t493 / 0.48e2 + t500 * t505 / 0.1536e4 + 0.7e1 / 0.2304e4 * t510 + t513 * t519 / 0.384e3 - t285 * t724 / 0.3072e4 - t285 * t729 / 0.3072e4 + t738 + 0.7e1 / 0.576e3 * t741 + 0.5e1 / 0.768e3 * t310 * t748 - t310 * t752 / 0.768e3;
    const double t756 = beta * t755;
    const double t761 = 0.1e1 / t322 / t146;
    const double t762 = t116 * t761;
    const double t763 = t331 * t331;
    const double t764 = t762 * t763;
    const double t767 = t143 * t497;
    const double t768 = t141 * t501;
    const double t772 = t319 * t295;
    const double t776 = t141 * t721;
    const double t783 = -t325 * t768 * t121 - 0.2e1 * t325 * t772 * t121 - t325 * t776 * t121 + t143 * t123 * t755 + 0.2e1 * t767 * t768 * t502;
    const double t784 = t324 * t783;
    const double t786 = 0.2e1 * t142 * t764 - t142 * t784 + t756 * t148 - 0.2e1 * t320 * t332;
    const double t787 = t786 * t335;
    const double t788 = t101 * t787;
    const double t789 = t334 * t334;
    const double t790 = t150 * t150;
    const double t791 = 0.1e1 / t790;
    const double t792 = t789 * t791;
    const double t793 = t101 * t792;
    const double t794 = t450 + t476 + t788 + t704 - t627 + t637 + t645 + t697 - t693 - t793 + t681 + t687 + t690 - t530;
    const double t796 = t252 * t336 * t262;
    const double t797 = 0.6e1 * t796;
    const double t798 = -t559 - t562 - t677 + t679 + t670 + t673 - t675 - t616 + t668 + t797 - t620 - t700 + t708 + t580;
    const double t801 = t185 * t350;
    const double t802 = 0.4e1 * t801;
    const double t803 = t190 * t350;
    const double t804 = 0.4e1 * t803;
    const double t805 = t563 * t340;
    const double t808 = t47 * t34;
    const double t812 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.9e1 * t805 * t195 + 0.8e1 / 0.3e1 * t808 * t455 );
    const double t813 = t570 * t344;
    const double t816 = t52 * t34;
    const double t820 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.9e1 * t813 * t199 - 0.8e1 / 0.3e1 * t816 * t455 );
    const double t822 = ( t812 + t820 ) * t59;
    const double t823 = t822 * t87;
    const double t824 = t40 * t823;
    const double t825 = t349 * t237;
    const double t826 = t40 * t825;
    const double t827 = t349 * t75;
    const double t828 = t827 * t249;
    const double t829 = 0.5848223622634646207e0 * t828;
    const double t830 = t349 * t1;
    const double t831 = t830 * t244;
    const double t832 = 0.18311447306006545054e-3 * t831;
    const double t833 = t396 * t791;
    const double t835 = t101 * t833 * t334;
    const double t837 = t252 * t397 * t262;
    const double t840 = t446 * t362 * t262;
    const double t842 = t704 + t802 - t804 + t824 + t826 - t627 + t637 + t645 + t697 - t829 - t832 - t835 + 0.3e1 * t837 + 0.6e1 * t840 + t687 - t690;
    const double t843 = 0.5848223622634646207e0 * t561;
    const double t844 = 0.4e1 * t678;
    const double t845 = 0.4e1 * t674;
    const double t846 = t822 * t85;
    const double t847 = 0.19751673498613801407e-1 * t846;
    const double t848 = 0.18311447306006545054e-3 * t699;
    const double t849 = t451 * t340;
    const double t852 = t253 * t34;
    const double t856 = piecewise_functor_3( t44, 0.0, -0.2e1 / 0.9e1 * t849 * t195 + 0.4e1 / 0.3e1 * t852 * t455 );
    const double t857 = t463 * t344;
    const double t860 = t257 * t34;
    const double t864 = piecewise_functor_3( t51, 0.0, -0.2e1 / 0.9e1 * t857 * t199 - 0.4e1 / 0.3e1 * t860 * t455 );
    const double t866 = t856 / 0.2e1 + t864 / 0.2e1;
    const double t867 = t151 * t866;
    const double t868 = t252 * t867;
    const double t871 = t483 * t366;
    const double t874 = t275 * t365 * t262;
    const double t877 = t5 * t866;
    const double t878 = t275 * t877;
    const double t882 = t280 * t498 * t131;
    const double t883 = t133 * t1;
    const double t884 = t883 * t135;
    const double t885 = t6 * t375;
    const double t886 = t502 * t295;
    const double t887 = t885 * t886;
    const double t888 = t884 * t887;
    const double t891 = t509 * t378;
    const double t893 = t885 * t517;
    const double t894 = t515 * t893;
    const double t897 = t704 + t802 - t804 + t824 + t826 - t627 + t637 + t645 + t697 - t829 - t832 + t687 - t690;
    const double t898 = -t530 - t559 - t843 - t677 - t844 + t672 - t845 - t616 + t668 + t847 - t620 - t848 + t708;
    const double t900 = ( t897 + t898 ) * t116;
    const double t906 = t312 * t361;
    const double t907 = t906 * t262;
    const double t910 = t133 * t866;
    const double t913 = -0.12e2 * t118 * t907 + 0.3e1 * t118 * t910 - t900 * t119 + 0.3e1 * t290 * t372 + 0.3e1 * t370 * t292;
    const double t914 = t913 * t121;
    const double t916 = t287 * t288 * t914;
    const double t919 = t885 * t296;
    const double t920 = t884 * t919;
    const double t925 = t6 * t361;
    const double t926 = t925 * t296;
    const double t927 = t515 * t926;
    const double t930 = t740 * t382;
    const double t932 = t361 * t262;
    const double t934 = t746 * t288 * t932;
    const double t938 = t314 * t288 * t866;
    const double t941 = t482 + 0.7e1 / 0.144e3 * t484 + 0.7e1 / 0.144e3 * t871 + t487 * t874 / 0.16e2 - t274 * t878 / 0.48e2 + t882 * t888 / 0.1536e4 + 0.7e1 / 0.4608e4 * t891 + t513 * t894 / 0.768e3 - t285 * t916 / 0.3072e4 - t513 * t920 / 0.3072e4 + 0.7e1 / 0.4608e4 * t510 + t738 + 0.7e1 / 0.1152e4 * t741 + t513 * t927 / 0.768e3 + 0.7e1 / 0.1152e4 * t930 + 0.5e1 / 0.768e3 * t310 * t934 - t310 * t938 / 0.768e3;
    const double t942 = beta * t941;
    const double t946 = t142 * t116;
    const double t947 = t761 * t393;
    const double t948 = t947 * t331;
    const double t954 = t319 * t375;
    const double t957 = t141 * t913;
    const double t962 = t385 * t295;
    const double t967 = -t325 * t954 * t121 - t325 * t957 * t121 - t325 * t962 * t121 + t143 * t123 * t941 - t325 * t388 * t296 + 0.2e1 * t767 * t388 * t886;
    const double t968 = t324 * t967;
    const double t970 = -t142 * t968 + t942 * t148 - t320 * t394 - t386 * t332 + 0.2e1 * t946 * t948;
    const double t971 = t970 * t335;
    const double t972 = t101 * t971;
    const double t973 = t336 * t361;
    const double t974 = t252 * t973;
    const double t976 = -t530 - t559 - t843 - t677 - t844 + t672 - t845 - t616 + t668 + t847 - t620 - t848 + t708 + 0.3e1 * t868 + t972 + 0.3e1 * t974;
    const double t983 = 0.8e1 * t801;
    const double t984 = 0.8e1 * t803;
    const double t985 = 0.2e1 * t826;
    const double t986 = t396 * t396;
    const double t987 = t986 * t791;
    const double t988 = t101 * t987;
    const double t989 = 0.11696447245269292414e1 * t828;
    const double t990 = 0.36622894612013090108e-3 * t831;
    const double t991 = t340 * t340;
    const double t995 = 0.2e1 * t193 + 0.2e1 * t456;
    const double t999 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.9e1 * t563 * t991 + 0.4e1 / 0.3e1 * t47 * t995 );
    const double t1000 = t344 * t344;
    const double t1003 = -t995;
    const double t1007 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.9e1 * t570 * t1000 + 0.4e1 / 0.3e1 * t52 * t1003 );
    const double t1009 = ( t999 + t1007 ) * t59;
    const double t1010 = t1009 * t87;
    const double t1011 = t40 * t1010;
    const double t1017 = piecewise_functor_3( t44, 0.0, -0.2e1 / 0.9e1 * t451 * t991 + 0.2e1 / 0.3e1 * t253 * t995 );
    const double t1023 = piecewise_functor_3( t51, 0.0, -0.2e1 / 0.9e1 * t463 * t1000 + 0.2e1 / 0.3e1 * t257 * t1003 );
    const double t1025 = t1017 / 0.2e1 + t1023 / 0.2e1;
    const double t1026 = t151 * t1025;
    const double t1027 = t252 * t1026;
    const double t1028 = 0.3e1 * t1027;
    const double t1030 = t361 * t361;
    const double t1031 = t5 * t1030;
    const double t1032 = t275 * t1031;
    const double t1035 = t5 * t1025;
    const double t1036 = t275 * t1035;
    const double t1039 = t375 * t375;
    const double t1040 = t1039 * t502;
    const double t1042 = t287 * t288 * t1040;
    const double t1046 = t121 * t361;
    const double t1047 = t885 * t1046;
    const double t1048 = t515 * t1047;
    const double t1051 = t1009 * t85;
    const double t1052 = 0.19751673498613801407e-1 * t1051;
    const double t1053 = t1011 + t1052 - t989 - t983 - t984 + t985 - t530 - t559 + t668 - t677 - t681;
    const double t1054 = -t627 + t687 + t690 + t693 - t616 + t637 + t645 + t697 - t990 + t704 - t620 + t708;
    const double t1056 = ( t1053 + t1054 ) * t116;
    const double t1060 = t312 * t1030;
    const double t1063 = t133 * t1025;
    const double t1066 = -t1056 * t119 - 0.12e2 * t118 * t1060 + 0.3e1 * t118 * t1063 + 0.6e1 * t370 * t372;
    const double t1067 = t1066 * t121;
    const double t1069 = t287 * t288 * t1067;
    const double t1072 = t1039 * t121;
    const double t1074 = t287 * t288 * t1072;
    const double t1079 = t746 * t288 * t1030;
    const double t1083 = t314 * t288 * t1025;
    const double t1086 = t482 + 0.7e1 / 0.72e2 * t871 + t487 * t1032 / 0.16e2 - t274 * t1036 / 0.48e2 + t500 * t1042 / 0.1536e4 + 0.7e1 / 0.2304e4 * t891 + t513 * t1048 / 0.384e3 - t285 * t1069 / 0.3072e4 - t285 * t1074 / 0.3072e4 + t738 + 0.7e1 / 0.576e3 * t930 + 0.5e1 / 0.768e3 * t310 * t1079 - t310 * t1083 / 0.768e3;
    const double t1087 = beta * t1086;
    const double t1091 = t393 * t393;
    const double t1092 = t762 * t1091;
    const double t1095 = t141 * t1039;
    const double t1099 = t385 * t375;
    const double t1103 = t141 * t1066;
    const double t1110 = t143 * t123 * t1086 - t325 * t1095 * t121 + 0.2e1 * t767 * t1095 * t502 - 0.2e1 * t325 * t1099 * t121 - t325 * t1103 * t121;
    const double t1111 = t324 * t1110;
    const double t1113 = t1087 * t148 + 0.2e1 * t142 * t1092 - t142 * t1111 - 0.2e1 * t386 * t394;
    const double t1114 = t1113 * t335;
    const double t1115 = t101 * t1114;
    const double t1116 = t704 - t983 - t984 + t985 - t627 + t637 + t645 + t697 - t988 - t989 - t990 + t1011 + t1028 + t1115;
    const double t1117 = t151 * t1030;
    const double t1118 = t446 * t1117;
    const double t1119 = 0.6e1 * t1118;
    const double t1120 = t397 * t361;
    const double t1121 = t252 * t1120;
    const double t1122 = 0.6e1 * t1121;
    const double t1123 = t693 - t681 + t687 + t690 - t530 - t559 + t1052 - t677 - t616 + t668 + t1119 + t1122 - t620 + t708;
    const double t1126 = t422 * t335;
    const double t1127 = t101 * t1126;
    const double t1128 = t401 * t99;
    const double t1129 = t1126 * t262;
    const double t1132 = t268 * t56;
    const double t1134 = t1132 * t108 * t404;
    const double t1135 = 0.7e1 / 0.288e3 * t1134;
    const double t1136 = t402 * t119;
    const double t1137 = t1136 * t277;
    const double t1139 = t282 * t103;
    const double t1141 = t280 * t1139 * t129;
    const double t1142 = t1141 * t298;
    const double t1144 = t408 * t305;
    const double t1145 = 0.7e1 / 0.2304e4 * t1144;
    const double t1146 = t123 * t103;
    const double t1148 = t280 * t1146 * t129;
    const double t1149 = t1148 * t316;
    const double t1151 = -t1135 - t1137 / 0.48e2 - t1142 / 0.1536e4 - t1145 - t1149 / 0.384e3;
    const double t1152 = beta * t1151;
    const double t1155 = t414 * t319;
    const double t1156 = t1155 * t417;
    const double t1158 = t761 * t123;
    const double t1159 = t411 * t331;
    const double t1160 = t1158 * t1159;
    const double t1163 = t417 * t323;
    const double t1164 = t415 * t1163;
    const double t1165 = t282 * t411;
    const double t1166 = t1165 * t296;
    const double t1168 = t419 * t1151;
    const double t1170 = t1152 * t148 - t1156 * t420 + 0.2e1 * t418 * t1160 + t1164 * t1166 - t418 * t1168 - t412 * t332;
    const double t1174 = t401 * t100;
    const double t1175 = t422 * t791;
    const double t1176 = t1175 * t334;
    const double t1178 = t432 * t335;
    const double t1179 = t101 * t1178;
    const double t1180 = t1178 * t262;
    const double t1183 = 0.7e1 / 0.144e3 * t1134;
    const double t1186 = 0.7e1 / 0.1152e4 * t1144;
    const double t1188 = -t1183 - t1137 / 0.24e2 - t1142 / 0.768e3 - t1186 - t1149 / 0.192e3;
    const double t1189 = beta * t1188;
    const double t1194 = t1158 * t427 * t331;
    const double t1197 = t282 * t427;
    const double t1198 = t1197 * t296;
    const double t1200 = t419 * t1188;
    const double t1202 = -t1156 * t430 + t1164 * t1198 + t1189 * t148 + 0.2e1 * t418 * t1194 - t418 * t1200 - t428 * t332;
    const double t1206 = t432 * t791;
    const double t1207 = t1206 * t334;
    const double t1209 = t1126 * t361;
    const double t1212 = t1136 * t366;
    const double t1214 = t1141 * t378;
    const double t1216 = t1148 * t382;
    const double t1218 = -t1135 - t1212 / 0.48e2 - t1214 / 0.1536e4 - t1145 - t1216 / 0.384e3;
    const double t1219 = beta * t1218;
    const double t1222 = t414 * t385;
    const double t1223 = t1222 * t417;
    const double t1225 = t411 * t393;
    const double t1226 = t1158 * t1225;
    const double t1229 = t1165 * t376;
    const double t1231 = t419 * t1218;
    const double t1233 = t1164 * t1229 + t1219 * t148 - t1223 * t420 + 0.2e1 * t418 * t1226 - t418 * t1231 - t412 * t394;
    const double t1237 = t1175 * t396;
    const double t1239 = t1178 * t361;
    const double t1245 = -t1183 - t1212 / 0.24e2 - t1214 / 0.768e3 - t1186 - t1216 / 0.192e3;
    const double t1246 = beta * t1245;
    const double t1250 = t427 * t393;
    const double t1251 = t1158 * t1250;
    const double t1254 = t1197 * t376;
    const double t1256 = t419 * t1245;
    const double t1258 = t1164 * t1254 - t1223 * t430 + t1246 * t148 + 0.2e1 * t418 * t1251 - t418 * t1256 - t428 * t394;
    const double t1262 = t1206 * t396;
    const double t1265 = t417 * t123;
    const double t1269 = t287 * t288 * t147;
    const double t1270 = t1264 * t1265 * t129 * t1269;
    const double t1272 = t411 * t411;
    const double t1273 = t414 * t1272;
    const double t1274 = t1163 * t123;
    const double t1278 = t1277 * t141;
    const double t1281 = t1278 * t1280;
    const double t1282 = t761 * t282;
    const double t1283 = t1282 * t1272;
    const double t1286 = t323 * t282;
    const double t1287 = t1286 * BB;
    const double t1288 = t1281 * t1287;
    const double t1289 = t1288 * t138;
    const double t1291 = t1270 / 0.1536e4 - 0.2e1 * t1273 * t1274 + 0.2e1 * t1281 * t1283 - t1289 / 0.1536e4;
    const double t1295 = t422 * t422;
    const double t1300 = t414 * t427;
    const double t1301 = t1300 * t417;
    const double t1304 = t427 * t411;
    const double t1305 = t1282 * t1304;
    const double t1309 = t1270 / 0.768e3 - 0.2e1 * t1301 * t420 + 0.2e1 * t1281 * t1305 - t1289 / 0.768e3;
    const double t1313 = t1206 * t422;
    const double t1316 = t427 * t427;
    const double t1317 = t414 * t1316;
    const double t1320 = t1282 * t1316;
    const double t1324 = t1270 / 0.384e3 - 0.2e1 * t1317 * t1274 + 0.2e1 * t1281 * t1320 - t1289 / 0.384e3;
    const double t1328 = t432 * t432;


    v2rho2_aa = t435 + t436 + t437 - t438 + 0.2e1 * t206 + t440 + 0.39503346997227602814e-1 * t240 - t442 - t443 + 0.6e1 * t264 + 0.2e1 * t337 + t7 * ( t794 + t798 );
    v2rho2_ab = t435 + t436 - t438 + t206 + t440 + t241 - t442 - t443 + t265 + t337 + t351 + t353 + t364 + t398 + t7 * ( t842 + t976 );
    v2rho2_bb = t435 + t436 - t437 - t438 + 0.2e1 * t351 + t440 + 0.39503346997227602814e-1 * t352 - t442 - t443 + 0.6e1 * t363 + 0.2e1 * t398 + t7 * ( t1116 + t1123 );
    v2rhosigma_a_aa = t401 * t100 * t1170 * t335 + 0.3e1 * t1128 * t1129 - t1174 * t1176 + t1127;
    v2rhosigma_a_ab = t401 * t100 * t1202 * t335 + 0.3e1 * t1128 * t1180 - t1174 * t1207 + t1179;
    v2rhosigma_a_bb = v2rhosigma_a_aa;
    v2rhosigma_b_aa = t401 * t100 * t1233 * t335 + 0.3e1 * t1128 * t1209 - t1174 * t1237 + t1127;
    v2rhosigma_b_ab = t401 * t100 * t1258 * t335 + 0.3e1 * t1128 * t1239 - t1174 * t1262 + t1179;
    v2rhosigma_b_bb = v2rhosigma_b_aa;
    v2sigma2_aa_aa = t401 * t100 * t1291 * t335 - t401 * t100 * t1295 * t791;
    v2sigma2_aa_ab = t401 * t100 * t1309 * t335 - t1174 * t1313;
    v2sigma2_aa_bb = v2sigma2_aa_aa;
    v2sigma2_ab_ab = t401 * t100 * t1324 * t335 - t401 * t100 * t1328 * t791;
    v2sigma2_ab_bb = v2sigma2_aa_ab;
    v2sigma2_bb_bb = v2sigma2_aa_bb;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_vxc_fxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& v2rho2_aa, double& v2rho2_ab, double& v2rho2_bb, double& v2rhosigma_a_aa, double& v2rhosigma_a_ab, double& v2rhosigma_a_bb, double& v2rhosigma_b_aa, double& v2rhosigma_b_ab, double& v2rhosigma_b_bb, double& v2sigma2_aa_aa, double& v2sigma2_aa_ab, double& v2sigma2_aa_bb, double& v2sigma2_ab_ab, double& v2sigma2_ab_bb, double& v2sigma2_bb_bb ) {

    constexpr double t1 = constants::m_cbrt_3;
    constexpr double t3 = constants::m_cbrt_one_ov_pi;
    constexpr double t5 = constants::m_cbrt_4;
    constexpr double t56 = constants::m_cbrt_2;
    constexpr double t4 = t1 * t3;
    constexpr double t6 = t5 * t5;
    constexpr double t19 = t1 * t1;
    constexpr double t20 = t3 * t3;
    constexpr double t21 = t19 * t20;
    constexpr double t110 = 0.1e1 / t3;
    constexpr double t111 = t110 * t5;
    constexpr double t115 = BB * beta;
    constexpr double t116 = 0.1e1 / gamma;
    constexpr double t130 = t56 * t56;
    constexpr double t135 = 0.1e1 / t20;
    constexpr double t136 = t1 * t135;
    constexpr double t137 = t136 * t6;
    constexpr double t143 = beta * t116;
    constexpr double t164 = t3 * t6;
    constexpr double t275 = t19 * t110;
    constexpr double t280 = t115 * t116;
    constexpr double t288 = t135 * t6;
    constexpr double t404 = t275 * t5;
    constexpr double t414 = beta * beta;
    constexpr double t416 = gamma * gamma;
    constexpr double t417 = 0.1e1 / t416;
    constexpr double t534 = t20 * t5;
    constexpr double t584 = t4 * t6;
    constexpr double t1264 = t414 * BB;
    constexpr double t1277 = t414 * beta;
    constexpr double t1280 = 0.1e1 / t416 / gamma;


    const double t7 = rho_a + rho_b;
    const double t8 = safe_math::cbrt( t7 );
    const double t11 = t4 * t6 / t8;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t17 = pow_3_2( t11 );
    const double t22 = t8 * t8;
    const double t25 = t21 * t5 / t22;
    const double t27 = 0.379785e1 * t14 + 0.8969e0 * t11 + 0.204775e0 * t17 + 0.123235e0 * t25;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = rho_a - rho_b;
    const double t35 = t34 * t34;
    const double t36 = t35 * t35;
    const double t37 = t7 * t7;
    const double t38 = t37 * t37;
    const double t39 = 0.1e1 / t38;
    const double t40 = t36 * t39;
    const double t41 = 0.1e1 / t7;
    const double t42 = t34 * t41;
    const double t43 = 0.1e1 + t42;
    const double t44 = t43 <= zeta_tol;
    const double t45 = safe_math::cbrt( zeta_tol );
    const double t46 = t45 * zeta_tol;
    const double t47 = safe_math::cbrt( t43 );
    const double t48 = t47 * t43;
    const double t49 = piecewise_functor_3( t44, t46, t48 );
    const double t50 = 0.1e1 - t42;
    const double t51 = t50 <= zeta_tol;
    const double t52 = safe_math::cbrt( t50 );
    const double t53 = t52 * t50;
    const double t54 = piecewise_functor_3( t51, t46, t53 );
    const double t55 = t49 + t54 - 0.2e1;
    const double t59 = 0.1e1 / ( 0.2e1 * t56 - 0.2e1 );
    const double t60 = t55 * t59;
    const double t62 = 0.1e1 + 0.5137e-1 * t11;
    const double t67 = 0.705945e1 * t14 + 0.1549425e1 * t11 + 0.420775e0 * t17 + 0.1562925e0 * t25;
    const double t70 = 0.1e1 + 0.32163958997385070134e2 / t67;
    const double t71 = safe_math::log( t70 );
    const double t75 = 0.1e1 + 0.278125e-1 * t11;
    const double t80 = 0.51785e1 * t14 + 0.905775e0 * t11 + 0.1100325e0 * t17 + 0.1241775e0 * t25;
    const double t83 = 0.1e1 + 0.29608749977793437516e2 / t80;
    const double t84 = safe_math::log( t83 );
    const double t85 = t75 * t84;
    const double t87 = -0.310907e-1 * t62 * t71 + t33 - 0.19751673498613801407e-1 * t85;
    const double t88 = t60 * t87;
    const double t89 = t40 * t88;
    const double t91 = 0.19751673498613801407e-1 * t60 * t85;
    const double t92 = t45 * t45;
    const double t93 = t47 * t47;
    const double t94 = piecewise_functor_3( t44, t92, t93 );
    const double t95 = t52 * t52;
    const double t96 = piecewise_functor_3( t51, t92, t95 );
    const double t98 = t94 / 0.2e1 + t96 / 0.2e1;
    const double t99 = t98 * t98;
    const double t100 = t99 * t98;
    const double t101 = gamma * t100;
    const double t103 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t105 = 0.1e1 / t8 / t37;
    const double t106 = t103 * t105;
    const double t108 = 0.1e1 / t99;
    const double t112 = t108 * t19 * t111;
    const double t118 = ( -t33 + t89 + t91 ) * t116;
    const double t119 = 0.1e1 / t100;
    const double t121 = safe_math::exp( -t118 * t119 );
    const double t122 = t121 - 0.1e1;
    const double t123 = 0.1e1 / t122;
    const double t124 = t116 * t123;
    const double t125 = t103 * t103;
    const double t127 = t115 * t124 * t125;
    const double t129 = 0.1e1 / t22 / t38;
    const double t131 = t129 * t130;
    const double t132 = t99 * t99;
    const double t133 = 0.1e1 / t132;
    const double t134 = t131 * t133;
    const double t138 = t134 * t137;
    const double t141 = t106 * t56 * t112 / 0.96e2 + t127 * t138 / 0.3072e4;
    const double t142 = beta * t141;
    const double t146 = t143 * t123 * t141 + 0.1e1;
    const double t147 = 0.1e1 / t146;
    const double t148 = t116 * t147;
    const double t150 = t142 * t148 + 0.1e1;
    const double t151 = safe_math::log( t150 );
    const double t152 = t101 * t151;
    const double t154 = 0.1e1 / t8 / t7;
    const double t155 = t6 * t154;
    const double t157 = t4 * t155 * t31;
    const double t158 = 0.11073470983333333333e-2 * t157;
    const double t159 = t27 * t27;
    const double t160 = 0.1e1 / t159;
    const double t161 = t13 * t160;
    const double t163 = 0.1e1 / t14 * t1;
    const double t165 = t164 * t154;
    const double t166 = t163 * t165;
    const double t168 = t4 * t155;
    const double t170 = safe_math::sqrt( t11 );
    const double t171 = t170 * t1;
    const double t172 = t171 * t165;
    const double t177 = t21 * t5 / t22 / t7;
    const double t179 = -0.632975e0 * t166 - 0.29896666666666666667e0 * t168 - 0.1023875e0 * t172 - 0.82156666666666666667e-1 * t177;
    const double t180 = 0.1e1 / t30;
    const double t181 = t179 * t180;
    const double t182 = t161 * t181;
    const double t183 = 0.1e1 * t182;
    const double t184 = t35 * t34;
    const double t185 = t184 * t39;
    const double t186 = t185 * t88;
    const double t187 = 0.4e1 * t186;
    const double t188 = t38 * t7;
    const double t189 = 0.1e1 / t188;
    const double t190 = t36 * t189;
    const double t191 = t190 * t88;
    const double t192 = 0.4e1 * t191;
    const double t193 = 0.1e1 / t37;
    const double t194 = t34 * t193;
    const double t195 = t41 - t194;
    const double t198 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.3e1 * t47 * t195 );
    const double t199 = -t195;
    const double t202 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.3e1 * t52 * t199 );
    const double t204 = ( t198 + t202 ) * t59;
    const double t205 = t204 * t87;
    const double t206 = t40 * t205;
    const double t210 = t67 * t67;
    const double t211 = 0.1e1 / t210;
    const double t212 = t62 * t211;
    const double t217 = -0.1176575e1 * t166 - 0.516475e0 * t168 - 0.2103875e0 * t172 - 0.104195e0 * t177;
    const double t218 = 0.1e1 / t70;
    const double t219 = t217 * t218;
    const double t225 = t80 * t80;
    const double t226 = 0.1e1 / t225;
    const double t227 = t75 * t226;
    const double t232 = -0.86308333333333333334e0 * t166 - 0.301925e0 * t168 - 0.5501625e-1 * t172 - 0.82785e-1 * t177;
    const double t233 = 0.1e1 / t83;
    const double t234 = t232 * t233;
    const double t237 = 0.53237641966666666666e-3 * t4 * t155 * t71 + 0.1e1 * t212 * t219 - t158 - t183 + 0.18311447306006545054e-3 * t4 * t155 * t84 + 0.5848223622634646207e0 * t227 * t234;
    const double t238 = t60 * t237;
    const double t239 = t40 * t238;
    const double t240 = t204 * t85;
    const double t241 = 0.19751673498613801407e-1 * t240;
    const double t242 = t60 * t1;
    const double t244 = t164 * t154 * t84;
    const double t245 = t242 * t244;
    const double t246 = 0.18311447306006545054e-3 * t245;
    const double t247 = t60 * t75;
    const double t249 = t226 * t232 * t233;
    const double t250 = t247 * t249;
    const double t251 = 0.5848223622634646207e0 * t250;
    const double t252 = gamma * t99;
    const double t253 = 0.1e1 / t47;
    const double t256 = piecewise_functor_3( t44, 0.0, 0.2e1 / 0.3e1 * t253 * t195 );
    const double t257 = 0.1e1 / t52;
    const double t260 = piecewise_functor_3( t51, 0.0, 0.2e1 / 0.3e1 * t257 * t199 );
    const double t262 = t256 / 0.2e1 + t260 / 0.2e1;
    const double t263 = t151 * t262;
    const double t264 = t252 * t263;
    const double t265 = 0.3e1 * t264;
    const double t266 = t37 * t7;
    const double t268 = 0.1e1 / t8 / t266;
    const double t269 = t103 * t268;
    const double t272 = 0.7e1 / 0.288e3 * t269 * t56 * t112;
    const double t273 = t56 * t119;
    const double t274 = t106 * t273;
    const double t276 = t5 * t262;
    const double t277 = t275 * t276;
    const double t281 = t122 * t122;
    const double t282 = 0.1e1 / t281;
    const double t283 = t282 * t125;
    const double t285 = t280 * t283 * t129;
    const double t286 = t130 * t133;
    const double t287 = t286 * t1;
    const double t290 = ( t158 + t183 + t187 - t192 + t206 + t239 + t241 - t246 - t251 ) * t116;
    const double t292 = t133 * t262;
    const double t295 = 0.3e1 * t118 * t292 - t290 * t119;
    const double t296 = t295 * t121;
    const double t297 = t288 * t296;
    const double t298 = t287 * t297;
    const double t302 = 0.1e1 / t22 / t188;
    const double t303 = t302 * t130;
    const double t304 = t303 * t133;
    const double t305 = t304 * t137;
    const double t307 = 0.7e1 / 0.4608e4 * t127 * t305;
    const double t308 = t123 * t125;
    const double t310 = t280 * t308 * t129;
    const double t312 = 0.1e1 / t132 / t98;
    const double t313 = t130 * t312;
    const double t314 = t313 * t1;
    const double t316 = t314 * t288 * t262;
    const double t319 = -t272 - t274 * t277 / 0.48e2 - t285 * t298 / 0.3072e4 - t307 - t310 * t316 / 0.768e3;
    const double t320 = beta * t319;
    const double t322 = t146 * t146;
    const double t323 = 0.1e1 / t322;
    const double t324 = t116 * t323;
    const double t325 = t143 * t282;
    const double t326 = t141 * t295;
    const double t331 = -t325 * t326 * t121 + t143 * t123 * t319;
    const double t332 = t324 * t331;
    const double t334 = -t142 * t332 + t320 * t148;
    const double t335 = 0.1e1 / t150;
    const double t336 = t334 * t335;
    const double t337 = t101 * t336;
    const double t338 = t158 + t183 + t187 - t192 + t206 + t239 + t241 - t246 - t251 + t265 + t337;
    const double t340 = -t41 - t194;
    const double t343 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.3e1 * t47 * t340 );
    const double t344 = -t340;
    const double t347 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.3e1 * t52 * t344 );
    const double t349 = ( t343 + t347 ) * t59;
    const double t350 = t349 * t87;
    const double t351 = t40 * t350;
    const double t352 = t349 * t85;
    const double t353 = 0.19751673498613801407e-1 * t352;
    const double t356 = piecewise_functor_3( t44, 0.0, 0.2e1 / 0.3e1 * t253 * t340 );
    const double t359 = piecewise_functor_3( t51, 0.0, 0.2e1 / 0.3e1 * t257 * t344 );
    const double t361 = t356 / 0.2e1 + t359 / 0.2e1;
    const double t362 = t151 * t361;
    const double t363 = t252 * t362;
    const double t364 = 0.3e1 * t363;
    const double t365 = t5 * t361;
    const double t366 = t275 * t365;
    const double t370 = ( t158 + t183 - t187 - t192 + t351 + t239 + t353 - t246 - t251 ) * t116;
    const double t372 = t133 * t361;
    const double t375 = 0.3e1 * t118 * t372 - t370 * t119;
    const double t376 = t375 * t121;
    const double t377 = t288 * t376;
    const double t378 = t287 * t377;
    const double t382 = t314 * t288 * t361;
    const double t385 = -t272 - t274 * t366 / 0.48e2 - t285 * t378 / 0.3072e4 - t307 - t310 * t382 / 0.768e3;
    const double t386 = beta * t385;
    const double t388 = t141 * t375;
    const double t393 = -t325 * t388 * t121 + t143 * t123 * t385;
    const double t394 = t324 * t393;
    const double t396 = -t142 * t394 + t386 * t148;
    const double t397 = t396 * t335;
    const double t398 = t101 * t397;
    const double t399 = t158 + t183 - t187 - t192 + t351 + t239 + t353 - t246 - t251 + t364 + t398;
    const double t401 = t7 * gamma;
    const double t402 = t105 * t56;
    const double t405 = t402 * t108 * t404;
    const double t408 = t115 * t124 * t103;
    const double t409 = t408 * t138;
    const double t411 = t405 / 0.96e2 + t409 / 0.1536e4;
    const double t412 = beta * t411;
    const double t415 = t414 * t141;
    const double t418 = t415 * t417;
    const double t419 = t323 * t123;
    const double t420 = t419 * t411;
    const double t422 = t412 * t148 - t418 * t420;
    const double t427 = t405 / 0.48e2 + t409 / 0.768e3;
    const double t428 = beta * t427;
    const double t430 = t419 * t427;
    const double t432 = t428 * t148 - t418 * t430;
    const double t433 = t100 * t432;
    const double t435 = 0.22146941966666666666e-2 * t157;
    const double t436 = 0.2e1 * t182;
    const double t437 = 0.8e1 * t186;
    const double t438 = 0.8e1 * t191;
    const double t440 = 0.2e1 * t239;
    const double t442 = 0.36622894612013090108e-3 * t245;
    const double t443 = 0.11696447245269292414e1 * t250;
    const double t446 = gamma * t98;
    const double t447 = t262 * t262;
    const double t449 = t446 * t151 * t447;
    const double t450 = 0.6e1 * t449;
    const double t451 = 0.1e1 / t48;
    const double t452 = t195 * t195;
    const double t455 = 0.1e1 / t266;
    const double t456 = t34 * t455;
    const double t458 = -0.2e1 * t193 + 0.2e1 * t456;
    const double t462 = piecewise_functor_3( t44, 0.0, -0.2e1 / 0.9e1 * t451 * t452 + 0.2e1 / 0.3e1 * t253 * t458 );
    const double t463 = 0.1e1 / t53;
    const double t464 = t199 * t199;
    const double t467 = -t458;
    const double t471 = piecewise_functor_3( t51, 0.0, -0.2e1 / 0.9e1 * t463 * t464 + 0.2e1 / 0.3e1 * t257 * t467 );
    const double t473 = t462 / 0.2e1 + t471 / 0.2e1;
    const double t474 = t151 * t473;
    const double t475 = t252 * t474;
    const double t476 = 0.3e1 * t475;
    const double t478 = 0.1e1 / t8 / t38;
    const double t479 = t103 * t478;
    const double t482 = 0.35e2 / 0.432e3 * t479 * t56 * t112;
    const double t483 = t269 * t273;
    const double t484 = t483 * t277;
    const double t486 = t56 * t133;
    const double t487 = t106 * t486;
    const double t488 = t5 * t447;
    const double t489 = t275 * t488;
    const double t493 = t275 * t5 * t473;
    const double t497 = 0.1e1 / t281 / t122;
    const double t498 = t497 * t125;
    const double t500 = t280 * t498 * t129;
    const double t501 = t295 * t295;
    const double t502 = t121 * t121;
    const double t503 = t501 * t502;
    const double t505 = t287 * t288 * t503;
    const double t509 = t280 * t283 * t302;
    const double t510 = t509 * t298;
    const double t513 = t280 * t283 * t131;
    const double t514 = t312 * t1;
    const double t515 = t514 * t135;
    const double t516 = t6 * t295;
    const double t517 = t121 * t262;
    const double t518 = t516 * t517;
    const double t519 = t515 * t518;
    const double t522 = t225 * t225;
    const double t523 = 0.1e1 / t522;
    const double t524 = t232 * t232;
    const double t525 = t523 * t524;
    const double t526 = t83 * t83;
    const double t527 = 0.1e1 / t526;
    const double t528 = t525 * t527;
    const double t529 = t247 * t528;
    const double t530 = 0.17315859105681463759e2 * t529;
    const double t533 = 0.1e1 / t14 / t11 * t19;
    const double t536 = 0.1e1 / t22 / t37;
    const double t537 = t534 * t536;
    const double t538 = t533 * t537;
    const double t540 = t164 * t105;
    const double t541 = t163 * t540;
    const double t543 = t6 * t105;
    const double t544 = t4 * t543;
    const double t546 = 0.1e1/safe_math::sqrt( t11 );
    const double t547 = t546 * t19;
    const double t548 = t547 * t537;
    const double t550 = t171 * t540;
    const double t553 = t21 * t5 * t536;
    const double t555 = -0.57538888888888888889e0 * t538 + 0.11507777777777777778e1 * t541 + 0.40256666666666666667e0 * t544 + 0.366775e-1 * t548 + 0.73355e-1 * t550 + 0.137975e0 * t553;
    const double t557 = t226 * t555 * t233;
    const double t558 = t247 * t557;
    const double t559 = 0.5848223622634646207e0 * t558;
    const double t560 = t204 * t75;
    const double t561 = t560 * t249;
    const double t562 = 0.11696447245269292414e1 * t561;
    const double t563 = 0.1e1 / t93;
    const double t569 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.9e1 * t563 * t452 + 0.4e1 / 0.3e1 * t47 * t458 );
    const double t570 = 0.1e1 / t95;
    const double t576 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.9e1 * t570 * t464 + 0.4e1 / 0.3e1 * t52 * t467 );
    const double t578 = ( t569 + t576 ) * t59;
    const double t579 = t578 * t85;
    const double t580 = 0.19751673498613801407e-1 * t579;
    const double t585 = t154 * t211;
    const double t589 = t210 * t67;
    const double t590 = 0.1e1 / t589;
    const double t591 = t62 * t590;
    const double t592 = t217 * t217;
    const double t593 = t592 * t218;
    const double t602 = -0.78438333333333333333e0 * t538 + 0.15687666666666666667e1 * t541 + 0.68863333333333333333e0 * t544 + 0.14025833333333333333e0 * t548 + 0.28051666666666666667e0 * t550 + 0.17365833333333333333e0 * t553;
    const double t603 = t602 * t218;
    const double t606 = t210 * t210;
    const double t607 = 0.1e1 / t606;
    const double t608 = t62 * t607;
    const double t609 = t70 * t70;
    const double t610 = 0.1e1 / t609;
    const double t611 = t592 * t610;
    const double t615 = t4 * t543 * t31;
    const double t616 = 0.14764627977777777777e-2 * t615;
    const double t617 = t154 * t160;
    const double t619 = t584 * t617 * t181;
    const double t620 = 0.35616666666666666666e-1 * t619;
    const double t621 = t159 * t27;
    const double t622 = 0.1e1 / t621;
    const double t623 = t13 * t622;
    const double t624 = t179 * t179;
    const double t625 = t624 * t180;
    const double t626 = t623 * t625;
    const double t627 = 0.2e1 * t626;
    const double t634 = -0.42198333333333333333e0 * t538 + 0.84396666666666666666e0 * t541 + 0.39862222222222222223e0 * t544 + 0.68258333333333333333e-1 * t548 + 0.13651666666666666667e0 * t550 + 0.13692777777777777778e0 * t553;
    const double t635 = t634 * t180;
    const double t636 = t161 * t635;
    const double t637 = 0.1e1 * t636;
    const double t638 = t159 * t159;
    const double t639 = 0.1e1 / t638;
    const double t640 = t13 * t639;
    const double t641 = t30 * t30;
    const double t642 = 0.1e1 / t641;
    const double t643 = t624 * t642;
    const double t644 = t640 * t643;
    const double t645 = 0.16081979498692535067e2 * t644;
    const double t649 = t154 * t226;
    const double t653 = t225 * t80;
    const double t654 = 0.1e1 / t653;
    const double t655 = t75 * t654;
    const double t656 = t524 * t233;
    const double t659 = t555 * t233;
    const double t662 = t75 * t523;
    const double t663 = t524 * t527;
    const double t666 = -0.70983522622222222221e-3 * t4 * t543 * t71 - 0.34246666666666666666e-1 * t584 * t585 * t219 - 0.2e1 * t591 * t593 + 0.1e1 * t212 * t603 + 0.32163958997385070134e2 * t608 * t611 + t616 + t620 + t627 - t637 - t645 - 0.24415263074675393405e-3 * t4 * t543 * t84 - 0.10843581300301739842e-1 * t584 * t649 * t234 - 0.11696447245269292414e1 * t655 * t656 + 0.5848223622634646207e0 * t227 * t659 + 0.17315859105681463759e2 * t662 * t663;
    const double t667 = t60 * t666;
    const double t668 = t40 * t667;
    const double t669 = t578 * t87;
    const double t670 = t40 * t669;
    const double t671 = t204 * t237;
    const double t672 = t40 * t671;
    const double t673 = 0.2e1 * t672;
    const double t674 = t190 * t205;
    const double t675 = 0.8e1 * t674;
    const double t676 = t190 * t238;
    const double t677 = 0.8e1 * t676;
    const double t678 = t185 * t205;
    const double t679 = 0.8e1 * t678;
    const double t680 = t185 * t238;
    const double t681 = 0.8e1 * t680;
    const double t682 = -t530 - t559 - t562 + t580 + t668 + t670 + t673 - t675 - t677 + t679 + t681;
    const double t683 = t38 * t37;
    const double t684 = 0.1e1 / t683;
    const double t685 = t36 * t684;
    const double t686 = t685 * t88;
    const double t687 = 0.2e2 * t686;
    const double t688 = t35 * t39;
    const double t689 = t688 * t88;
    const double t690 = 0.12e2 * t689;
    const double t691 = t184 * t189;
    const double t692 = t691 * t88;
    const double t693 = 0.32e2 * t692;
    const double t694 = t60 * t4;
    const double t695 = t155 * t249;
    const double t696 = t694 * t695;
    const double t697 = 0.10843581300301739842e-1 * t696;
    const double t698 = t204 * t1;
    const double t699 = t698 * t244;
    const double t700 = 0.36622894612013090108e-3 * t699;
    const double t702 = t654 * t524 * t233;
    const double t703 = t247 * t702;
    const double t704 = 0.11696447245269292414e1 * t703;
    const double t706 = t164 * t105 * t84;
    const double t707 = t242 * t706;
    const double t708 = 0.24415263074675393405e-3 * t707;
    const double t709 = -t627 + t687 + t690 - t693 - t616 + t637 + t645 + t697 - t700 + t704 - t620 + t708;
    const double t711 = ( t682 + t709 ) * t116;
    const double t715 = t312 * t447;
    const double t718 = t133 * t473;
    const double t721 = -0.12e2 * t118 * t715 + 0.3e1 * t118 * t718 - t711 * t119 + 0.6e1 * t290 * t292;
    const double t722 = t721 * t121;
    const double t724 = t287 * t288 * t722;
    const double t727 = t501 * t121;
    const double t729 = t287 * t288 * t727;
    const double t733 = 0.1e1 / t22 / t683;
    const double t734 = t733 * t130;
    const double t736 = t734 * t133 * t137;
    const double t738 = 0.119e3 / 0.13824e5 * t127 * t736;
    const double t740 = t280 * t308 * t302;
    const double t741 = t740 * t316;
    const double t744 = 0.1e1 / t132 / t99;
    const double t745 = t130 * t744;
    const double t746 = t745 * t1;
    const double t748 = t746 * t288 * t447;
    const double t752 = t314 * t288 * t473;
    const double t755 = t482 + 0.7e1 / 0.72e2 * t484 + t487 * t489 / 0.16e2 - t274 * t493 / 0.48e2 + t500 * t505 / 0.1536e4 + 0.7e1 / 0.2304e4 * t510 + t513 * t519 / 0.384e3 - t285 * t724 / 0.3072e4 - t285 * t729 / 0.3072e4 + t738 + 0.7e1 / 0.576e3 * t741 + 0.5e1 / 0.768e3 * t310 * t748 - t310 * t752 / 0.768e3;
    const double t756 = beta * t755;
    const double t761 = 0.1e1 / t322 / t146;
    const double t762 = t116 * t761;
    const double t763 = t331 * t331;
    const double t764 = t762 * t763;
    const double t767 = t143 * t497;
    const double t768 = t141 * t501;
    const double t772 = t319 * t295;
    const double t776 = t141 * t721;
    const double t783 = -t325 * t768 * t121 - 0.2e1 * t325 * t772 * t121 - t325 * t776 * t121 + t143 * t123 * t755 + 0.2e1 * t767 * t768 * t502;
    const double t784 = t324 * t783;
    const double t786 = 0.2e1 * t142 * t764 - t142 * t784 + t756 * t148 - 0.2e1 * t320 * t332;
    const double t787 = t786 * t335;
    const double t788 = t101 * t787;
    const double t789 = t334 * t334;
    const double t790 = t150 * t150;
    const double t791 = 0.1e1 / t790;
    const double t792 = t789 * t791;
    const double t793 = t101 * t792;
    const double t794 = t450 + t476 + t788 + t704 - t627 + t637 + t645 + t697 - t693 - t793 + t681 + t687 + t690 - t530;
    const double t796 = t252 * t336 * t262;
    const double t797 = 0.6e1 * t796;
    const double t798 = -t559 - t562 - t677 + t679 + t670 + t673 - t675 - t616 + t668 + t797 - t620 - t700 + t708 + t580;
    const double t801 = t185 * t350;
    const double t802 = 0.4e1 * t801;
    const double t803 = t190 * t350;
    const double t804 = 0.4e1 * t803;
    const double t805 = t563 * t340;
    const double t808 = t47 * t34;
    const double t812 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.9e1 * t805 * t195 + 0.8e1 / 0.3e1 * t808 * t455 );
    const double t813 = t570 * t344;
    const double t816 = t52 * t34;
    const double t820 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.9e1 * t813 * t199 - 0.8e1 / 0.3e1 * t816 * t455 );
    const double t822 = ( t812 + t820 ) * t59;
    const double t823 = t822 * t87;
    const double t824 = t40 * t823;
    const double t825 = t349 * t237;
    const double t826 = t40 * t825;
    const double t827 = t349 * t75;
    const double t828 = t827 * t249;
    const double t829 = 0.5848223622634646207e0 * t828;
    const double t830 = t349 * t1;
    const double t831 = t830 * t244;
    const double t832 = 0.18311447306006545054e-3 * t831;
    const double t833 = t396 * t791;
    const double t835 = t101 * t833 * t334;
    const double t837 = t252 * t397 * t262;
    const double t840 = t446 * t362 * t262;
    const double t842 = t704 + t802 - t804 + t824 + t826 - t627 + t637 + t645 + t697 - t829 - t832 - t835 + 0.3e1 * t837 + 0.6e1 * t840 + t687 - t690;
    const double t843 = 0.5848223622634646207e0 * t561;
    const double t844 = 0.4e1 * t678;
    const double t845 = 0.4e1 * t674;
    const double t846 = t822 * t85;
    const double t847 = 0.19751673498613801407e-1 * t846;
    const double t848 = 0.18311447306006545054e-3 * t699;
    const double t849 = t451 * t340;
    const double t852 = t253 * t34;
    const double t856 = piecewise_functor_3( t44, 0.0, -0.2e1 / 0.9e1 * t849 * t195 + 0.4e1 / 0.3e1 * t852 * t455 );
    const double t857 = t463 * t344;
    const double t860 = t257 * t34;
    const double t864 = piecewise_functor_3( t51, 0.0, -0.2e1 / 0.9e1 * t857 * t199 - 0.4e1 / 0.3e1 * t860 * t455 );
    const double t866 = t856 / 0.2e1 + t864 / 0.2e1;
    const double t867 = t151 * t866;
    const double t868 = t252 * t867;
    const double t871 = t483 * t366;
    const double t874 = t275 * t365 * t262;
    const double t877 = t5 * t866;
    const double t878 = t275 * t877;
    const double t882 = t280 * t498 * t131;
    const double t883 = t133 * t1;
    const double t884 = t883 * t135;
    const double t885 = t6 * t375;
    const double t886 = t502 * t295;
    const double t887 = t885 * t886;
    const double t888 = t884 * t887;
    const double t891 = t509 * t378;
    const double t893 = t885 * t517;
    const double t894 = t515 * t893;
    const double t897 = t704 + t802 - t804 + t824 + t826 - t627 + t637 + t645 + t697 - t829 - t832 + t687 - t690;
    const double t898 = -t530 - t559 - t843 - t677 - t844 + t672 - t845 - t616 + t668 + t847 - t620 - t848 + t708;
    const double t900 = ( t897 + t898 ) * t116;
    const double t906 = t312 * t361;
    const double t907 = t906 * t262;
    const double t910 = t133 * t866;
    const double t913 = -0.12e2 * t118 * t907 + 0.3e1 * t118 * t910 - t900 * t119 + 0.3e1 * t290 * t372 + 0.3e1 * t370 * t292;
    const double t914 = t913 * t121;
    const double t916 = t287 * t288 * t914;
    const double t919 = t885 * t296;
    const double t920 = t884 * t919;
    const double t925 = t6 * t361;
    const double t926 = t925 * t296;
    const double t927 = t515 * t926;
    const double t930 = t740 * t382;
    const double t932 = t361 * t262;
    const double t934 = t746 * t288 * t932;
    const double t938 = t314 * t288 * t866;
    const double t941 = t482 + 0.7e1 / 0.144e3 * t484 + 0.7e1 / 0.144e3 * t871 + t487 * t874 / 0.16e2 - t274 * t878 / 0.48e2 + t882 * t888 / 0.1536e4 + 0.7e1 / 0.4608e4 * t891 + t513 * t894 / 0.768e3 - t285 * t916 / 0.3072e4 - t513 * t920 / 0.3072e4 + 0.7e1 / 0.4608e4 * t510 + t738 + 0.7e1 / 0.1152e4 * t741 + t513 * t927 / 0.768e3 + 0.7e1 / 0.1152e4 * t930 + 0.5e1 / 0.768e3 * t310 * t934 - t310 * t938 / 0.768e3;
    const double t942 = beta * t941;
    const double t946 = t142 * t116;
    const double t947 = t761 * t393;
    const double t948 = t947 * t331;
    const double t954 = t319 * t375;
    const double t957 = t141 * t913;
    const double t962 = t385 * t295;
    const double t967 = -t325 * t954 * t121 - t325 * t957 * t121 - t325 * t962 * t121 + t143 * t123 * t941 - t325 * t388 * t296 + 0.2e1 * t767 * t388 * t886;
    const double t968 = t324 * t967;
    const double t970 = -t142 * t968 + t942 * t148 - t320 * t394 - t386 * t332 + 0.2e1 * t946 * t948;
    const double t971 = t970 * t335;
    const double t972 = t101 * t971;
    const double t973 = t336 * t361;
    const double t974 = t252 * t973;
    const double t976 = -t530 - t559 - t843 - t677 - t844 + t672 - t845 - t616 + t668 + t847 - t620 - t848 + t708 + 0.3e1 * t868 + t972 + 0.3e1 * t974;
    const double t983 = 0.8e1 * t801;
    const double t984 = 0.8e1 * t803;
    const double t985 = 0.2e1 * t826;
    const double t986 = t396 * t396;
    const double t987 = t986 * t791;
    const double t988 = t101 * t987;
    const double t989 = 0.11696447245269292414e1 * t828;
    const double t990 = 0.36622894612013090108e-3 * t831;
    const double t991 = t340 * t340;
    const double t995 = 0.2e1 * t193 + 0.2e1 * t456;
    const double t999 = piecewise_functor_3( t44, 0.0, 0.4e1 / 0.9e1 * t563 * t991 + 0.4e1 / 0.3e1 * t47 * t995 );
    const double t1000 = t344 * t344;
    const double t1003 = -t995;
    const double t1007 = piecewise_functor_3( t51, 0.0, 0.4e1 / 0.9e1 * t570 * t1000 + 0.4e1 / 0.3e1 * t52 * t1003 );
    const double t1009 = ( t999 + t1007 ) * t59;
    const double t1010 = t1009 * t87;
    const double t1011 = t40 * t1010;
    const double t1017 = piecewise_functor_3( t44, 0.0, -0.2e1 / 0.9e1 * t451 * t991 + 0.2e1 / 0.3e1 * t253 * t995 );
    const double t1023 = piecewise_functor_3( t51, 0.0, -0.2e1 / 0.9e1 * t463 * t1000 + 0.2e1 / 0.3e1 * t257 * t1003 );
    const double t1025 = t1017 / 0.2e1 + t1023 / 0.2e1;
    const double t1026 = t151 * t1025;
    const double t1027 = t252 * t1026;
    const double t1028 = 0.3e1 * t1027;
    const double t1030 = t361 * t361;
    const double t1031 = t5 * t1030;
    const double t1032 = t275 * t1031;
    const double t1035 = t5 * t1025;
    const double t1036 = t275 * t1035;
    const double t1039 = t375 * t375;
    const double t1040 = t1039 * t502;
    const double t1042 = t287 * t288 * t1040;
    const double t1046 = t121 * t361;
    const double t1047 = t885 * t1046;
    const double t1048 = t515 * t1047;
    const double t1051 = t1009 * t85;
    const double t1052 = 0.19751673498613801407e-1 * t1051;
    const double t1053 = t1011 + t1052 - t989 - t983 - t984 + t985 - t530 - t559 + t668 - t677 - t681;
    const double t1054 = -t627 + t687 + t690 + t693 - t616 + t637 + t645 + t697 - t990 + t704 - t620 + t708;
    const double t1056 = ( t1053 + t1054 ) * t116;
    const double t1060 = t312 * t1030;
    const double t1063 = t133 * t1025;
    const double t1066 = -t1056 * t119 - 0.12e2 * t118 * t1060 + 0.3e1 * t118 * t1063 + 0.6e1 * t370 * t372;
    const double t1067 = t1066 * t121;
    const double t1069 = t287 * t288 * t1067;
    const double t1072 = t1039 * t121;
    const double t1074 = t287 * t288 * t1072;
    const double t1079 = t746 * t288 * t1030;
    const double t1083 = t314 * t288 * t1025;
    const double t1086 = t482 + 0.7e1 / 0.72e2 * t871 + t487 * t1032 / 0.16e2 - t274 * t1036 / 0.48e2 + t500 * t1042 / 0.1536e4 + 0.7e1 / 0.2304e4 * t891 + t513 * t1048 / 0.384e3 - t285 * t1069 / 0.3072e4 - t285 * t1074 / 0.3072e4 + t738 + 0.7e1 / 0.576e3 * t930 + 0.5e1 / 0.768e3 * t310 * t1079 - t310 * t1083 / 0.768e3;
    const double t1087 = beta * t1086;
    const double t1091 = t393 * t393;
    const double t1092 = t762 * t1091;
    const double t1095 = t141 * t1039;
    const double t1099 = t385 * t375;
    const double t1103 = t141 * t1066;
    const double t1110 = t143 * t123 * t1086 - t325 * t1095 * t121 + 0.2e1 * t767 * t1095 * t502 - 0.2e1 * t325 * t1099 * t121 - t325 * t1103 * t121;
    const double t1111 = t324 * t1110;
    const double t1113 = t1087 * t148 + 0.2e1 * t142 * t1092 - t142 * t1111 - 0.2e1 * t386 * t394;
    const double t1114 = t1113 * t335;
    const double t1115 = t101 * t1114;
    const double t1116 = t704 - t983 - t984 + t985 - t627 + t637 + t645 + t697 - t988 - t989 - t990 + t1011 + t1028 + t1115;
    const double t1117 = t151 * t1030;
    const double t1118 = t446 * t1117;
    const double t1119 = 0.6e1 * t1118;
    const double t1120 = t397 * t361;
    const double t1121 = t252 * t1120;
    const double t1122 = 0.6e1 * t1121;
    const double t1123 = t693 - t681 + t687 + t690 - t530 - t559 + t1052 - t677 - t616 + t668 + t1119 + t1122 - t620 + t708;
    const double t1126 = t422 * t335;
    const double t1127 = t101 * t1126;
    const double t1128 = t401 * t99;
    const double t1129 = t1126 * t262;
    const double t1132 = t268 * t56;
    const double t1134 = t1132 * t108 * t404;
    const double t1135 = 0.7e1 / 0.288e3 * t1134;
    const double t1136 = t402 * t119;
    const double t1137 = t1136 * t277;
    const double t1139 = t282 * t103;
    const double t1141 = t280 * t1139 * t129;
    const double t1142 = t1141 * t298;
    const double t1144 = t408 * t305;
    const double t1145 = 0.7e1 / 0.2304e4 * t1144;
    const double t1146 = t123 * t103;
    const double t1148 = t280 * t1146 * t129;
    const double t1149 = t1148 * t316;
    const double t1151 = -t1135 - t1137 / 0.48e2 - t1142 / 0.1536e4 - t1145 - t1149 / 0.384e3;
    const double t1152 = beta * t1151;
    const double t1155 = t414 * t319;
    const double t1156 = t1155 * t417;
    const double t1158 = t761 * t123;
    const double t1159 = t411 * t331;
    const double t1160 = t1158 * t1159;
    const double t1163 = t417 * t323;
    const double t1164 = t415 * t1163;
    const double t1165 = t282 * t411;
    const double t1166 = t1165 * t296;
    const double t1168 = t419 * t1151;
    const double t1170 = t1152 * t148 - t1156 * t420 + 0.2e1 * t418 * t1160 + t1164 * t1166 - t418 * t1168 - t412 * t332;
    const double t1174 = t401 * t100;
    const double t1175 = t422 * t791;
    const double t1176 = t1175 * t334;
    const double t1178 = t432 * t335;
    const double t1179 = t101 * t1178;
    const double t1180 = t1178 * t262;
    const double t1183 = 0.7e1 / 0.144e3 * t1134;
    const double t1186 = 0.7e1 / 0.1152e4 * t1144;
    const double t1188 = -t1183 - t1137 / 0.24e2 - t1142 / 0.768e3 - t1186 - t1149 / 0.192e3;
    const double t1189 = beta * t1188;
    const double t1194 = t1158 * t427 * t331;
    const double t1197 = t282 * t427;
    const double t1198 = t1197 * t296;
    const double t1200 = t419 * t1188;
    const double t1202 = -t1156 * t430 + t1164 * t1198 + t1189 * t148 + 0.2e1 * t418 * t1194 - t418 * t1200 - t428 * t332;
    const double t1206 = t432 * t791;
    const double t1207 = t1206 * t334;
    const double t1209 = t1126 * t361;
    const double t1212 = t1136 * t366;
    const double t1214 = t1141 * t378;
    const double t1216 = t1148 * t382;
    const double t1218 = -t1135 - t1212 / 0.48e2 - t1214 / 0.1536e4 - t1145 - t1216 / 0.384e3;
    const double t1219 = beta * t1218;
    const double t1222 = t414 * t385;
    const double t1223 = t1222 * t417;
    const double t1225 = t411 * t393;
    const double t1226 = t1158 * t1225;
    const double t1229 = t1165 * t376;
    const double t1231 = t419 * t1218;
    const double t1233 = t1164 * t1229 + t1219 * t148 - t1223 * t420 + 0.2e1 * t418 * t1226 - t418 * t1231 - t412 * t394;
    const double t1237 = t1175 * t396;
    const double t1239 = t1178 * t361;
    const double t1245 = -t1183 - t1212 / 0.24e2 - t1214 / 0.768e3 - t1186 - t1216 / 0.192e3;
    const double t1246 = beta * t1245;
    const double t1250 = t427 * t393;
    const double t1251 = t1158 * t1250;
    const double t1254 = t1197 * t376;
    const double t1256 = t419 * t1245;
    const double t1258 = t1164 * t1254 - t1223 * t430 + t1246 * t148 + 0.2e1 * t418 * t1251 - t418 * t1256 - t428 * t394;
    const double t1262 = t1206 * t396;
    const double t1265 = t417 * t123;
    const double t1269 = t287 * t288 * t147;
    const double t1270 = t1264 * t1265 * t129 * t1269;
    const double t1272 = t411 * t411;
    const double t1273 = t414 * t1272;
    const double t1274 = t1163 * t123;
    const double t1278 = t1277 * t141;
    const double t1281 = t1278 * t1280;
    const double t1282 = t761 * t282;
    const double t1283 = t1282 * t1272;
    const double t1286 = t323 * t282;
    const double t1287 = t1286 * BB;
    const double t1288 = t1281 * t1287;
    const double t1289 = t1288 * t138;
    const double t1291 = t1270 / 0.1536e4 - 0.2e1 * t1273 * t1274 + 0.2e1 * t1281 * t1283 - t1289 / 0.1536e4;
    const double t1295 = t422 * t422;
    const double t1300 = t414 * t427;
    const double t1301 = t1300 * t417;
    const double t1304 = t427 * t411;
    const double t1305 = t1282 * t1304;
    const double t1309 = t1270 / 0.768e3 - 0.2e1 * t1301 * t420 + 0.2e1 * t1281 * t1305 - t1289 / 0.768e3;
    const double t1313 = t1206 * t422;
    const double t1316 = t427 * t427;
    const double t1317 = t414 * t1316;
    const double t1320 = t1282 * t1316;
    const double t1324 = t1270 / 0.384e3 - 0.2e1 * t1317 * t1274 + 0.2e1 * t1281 * t1320 - t1289 / 0.384e3;
    const double t1328 = t432 * t432;


    vrho_a = t7 * t338 + t152 - t33 + t89 + t91;
    vrho_b = t7 * t399 + t152 - t33 + t89 + t91;
    vsigma_aa = t401 * t100 * t422 * t335;
    vsigma_ab = t401 * t433 * t335;
    vsigma_bb = vsigma_aa;
    v2rho2_aa = t435 + t436 + t437 - t438 + 0.2e1 * t206 + t440 + 0.39503346997227602814e-1 * t240 - t442 - t443 + 0.6e1 * t264 + 0.2e1 * t337 + t7 * ( t794 + t798 );
    v2rho2_ab = t435 + t436 - t438 + t206 + t440 + t241 - t442 - t443 + t265 + t337 + t351 + t353 + t364 + t398 + t7 * ( t842 + t976 );
    v2rho2_bb = t435 + t436 - t437 - t438 + 0.2e1 * t351 + t440 + 0.39503346997227602814e-1 * t352 - t442 - t443 + 0.6e1 * t363 + 0.2e1 * t398 + t7 * ( t1116 + t1123 );
    v2rhosigma_a_aa = t401 * t100 * t1170 * t335 + 0.3e1 * t1128 * t1129 - t1174 * t1176 + t1127;
    v2rhosigma_a_ab = t401 * t100 * t1202 * t335 + 0.3e1 * t1128 * t1180 - t1174 * t1207 + t1179;
    v2rhosigma_a_bb = v2rhosigma_a_aa;
    v2rhosigma_b_aa = t401 * t100 * t1233 * t335 + 0.3e1 * t1128 * t1209 - t1174 * t1237 + t1127;
    v2rhosigma_b_ab = t401 * t100 * t1258 * t335 + 0.3e1 * t1128 * t1239 - t1174 * t1262 + t1179;
    v2rhosigma_b_bb = v2rhosigma_b_aa;
    v2sigma2_aa_aa = t401 * t100 * t1291 * t335 - t401 * t100 * t1295 * t791;
    v2sigma2_aa_ab = t401 * t100 * t1309 * t335 - t1174 * t1313;
    v2sigma2_aa_bb = v2sigma2_aa_aa;
    v2sigma2_ab_ab = t401 * t100 * t1324 * t335 - t401 * t100 * t1328 * t791;
    v2sigma2_ab_bb = v2sigma2_aa_ab;
    v2sigma2_bb_bb = v2sigma2_aa_bb;

  }


};

struct BuiltinPBE_SOL_C : detail::BuiltinKernelImpl< BuiltinPBE_SOL_C > {

  BuiltinPBE_SOL_C( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinPBE_SOL_C >(p) { }
  
  virtual ~BuiltinPBE_SOL_C() = default;

};



} // namespace ExchCXX
