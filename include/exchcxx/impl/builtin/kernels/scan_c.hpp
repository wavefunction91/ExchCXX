#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinSCAN_C > :
  public mgga_screening_interface< BuiltinSCAN_C > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;

  static constexpr double dens_tol  = 1e-15;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000027e-20;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = false;
  static constexpr double exx_coeff = 0.0;



  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t40 = constants::m_cbrt_2;
    constexpr double t61 = constants::m_pi_sq;
    constexpr double t116 = constants::m_cbrt_6;
    constexpr double t118 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t19 = t2 * t2;
    constexpr double t20 = t4 * t4;
    constexpr double t21 = t19 * t20;
    constexpr double t41 = t40 - 0.1e1;
    constexpr double t43 = 0.1e1 / t41 / 0.2e1;
    constexpr double t92 = 0.1e1 / t4;
    constexpr double t94 = t19 * t92 * t6;
    constexpr double t119 = t118 * t118;
    constexpr double t120 = 0.1e1 / t119;
    constexpr double t121 = t40 * t40;
    constexpr double t122 = t120 * t121;
    constexpr double t161 = t116 * t120;


    const double t8 = safe_math::cbrt( rho );
    const double t11 = t5 * t7 / t8;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t17 = pow_3_2( t11 );
    const double t22 = t8 * t8;
    const double t25 = t21 * t6 / t22;
    const double t27 = 0.379785e1 * t14 + 0.8969e0 * t11 + 0.204775e0 * t17 + 0.123235e0 * t25;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = 0.1e1 <= zeta_tol;
    const double t35 = safe_math::cbrt( zeta_tol );
    const double t37 = piecewise_functor_3( t34, t35 * zeta_tol, 1.0 );
    const double t39 = 0.2e1 * t37 - 0.2e1;
    const double t44 = t39 * t43;
    const double t46 = 0.1e1 + 0.278125e-1 * t11;
    const double t51 = 0.51785e1 * t14 + 0.905775e0 * t11 + 0.1100325e0 * t17 + 0.1241775e0 * t25;
    const double t54 = 0.1e1 + 0.29608749977793437516e2 / t51;
    const double t55 = safe_math::log( t54 );
    const double t58 = 0.19751673498613801407e-1 * t44 * t46 * t55;
    const double t59 = safe_math::log( 0.2e1 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 / t61;
    const double t64 = t35 * t35;
    const double t65 = piecewise_functor_3( t34, t64, 1.0 );
    const double t66 = t65 * t65;
    const double t67 = t66 * t65;
    const double t69 = 0.1e1 + 0.25e-1 * t11;
    const double t71 = 0.1e1 + 0.4445e-1 * t11;
    const double t72 = 0.1e1 / t71;
    const double t73 = t69 * t72;
    const double t74 = 0.1e1 / t60;
    const double t77 = 0.1e1 / t67;
    const double t78 = t61 * t77;
    const double t80 = safe_math::exp( -( -t33 + t58 ) * t74 * t78 );
    const double t81 = t80 - 0.1e1;
    const double t82 = 0.1e1 / t81;
    const double t83 = t74 * t82;
    const double t84 = t83 * sigma;
    const double t85 = t73 * t84;
    const double t86 = rho * rho;
    const double t88 = 0.1e1 / t8 / t86;
    const double t89 = t88 * t40;
    const double t90 = 0.1e1 / t66;
    const double t98 = 0.1e1 + 0.27439371595564631661e-1 * t85 * t89 * t90 * t94;
    const double t99 = pow_1_4( t98 );
    const double t101 = 0.1e1 - 0.1e1 / t99;
    const double t104 = 0.1e1 + 0.1e1 * t101 * t81;
    const double t105 = safe_math::log( t104 );
    const double t107 = t63 * t67 * t105;
    const double t109 = 0.1e1 / t22 / rho;
    const double t112 = 0.1e1 / t22 / t86;
    const double t124 = 0.5e1 / 0.9e1 * ( tau * t109 - sigma * t112 / 0.8e1 ) * t116 * t122;
    const double t125 = t124 <= 0.1e1;
    const double t126 = safe_math::log( DBL_EPSILON );
    const double t129 = t126 / ( -t126 + 0.64e0 );
    const double t130 = -t129 < t124;
    const double t131 = t124 < -t129;
    const double t132 = piecewise_functor_3( t131, t124, -t129 );
    const double t133 = 0.1e1 - t132;
    const double t134 = 0.1e1 / t133;
    const double t137 = safe_math::exp( -0.64e0 * t132 * t134 );
    const double t138 = piecewise_functor_3( t130, 0.0, t137 );
    const double t140 = safe_math::log( 0.14285714285714285714e1 * DBL_EPSILON );
    const double t143 = ( -t140 + 0.15e1 ) / t140;
    const double t144 = t124 < -t143;
    const double t145 = piecewise_functor_3( t144, -t143, t124 );
    const double t146 = 0.1e1 - t145;
    const double t149 = safe_math::exp( 0.15e1 / t146 );
    const double t151 = piecewise_functor_3( t144, 0.0, -0.7e0 * t149 );
    const double t152 = piecewise_functor_3( t125, t138, t151 );
    const double t155 = 0.1e1 + 0.4445e-1 * t14 + 0.3138525e-1 * t11;
    const double t156 = 0.1e1 / t155;
    const double t159 = safe_math::exp( 0.1e1 * t156 );
    const double t160 = t159 - 0.1e1;
    const double t162 = t121 * sigma;
    const double t166 = 0.1e1 + 0.21337642104376358333e-1 * t161 * t162 * t112;
    const double t167 = pow_1_4( t166 );
    const double t169 = 0.1e1 - 0.1e1 / t167;
    const double t171 = t160 * t169 + 0.1e1;
    const double t172 = safe_math::log( t171 );
    const double t178 = 0.1e1 - 0.2363e1 * t41 * t39 * t43;
    const double t180 = ( -0.285764e-1 * t156 + 0.285764e-1 * t172 ) * t178 + t33 - t58 - t107;
    const double t181 = t152 * t180;


    eps = -t33 + t58 + t107 + t181;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t40 = constants::m_cbrt_2;
    constexpr double t61 = constants::m_pi * constants::m_pi;
    constexpr double t116 = constants::m_cbrt_6;
    constexpr double t118 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t19 = t2 * t2;
    constexpr double t20 = t4 * t4;
    constexpr double t21 = t19 * t20;
    constexpr double t41 = t40 - 0.1e1;
    constexpr double t43 = 0.1e1 / t41 / 0.2e1;
    constexpr double t92 = 0.1e1 / t4;
    constexpr double t94 = t19 * t92 * t6;
    constexpr double t119 = t118 * t118;
    constexpr double t120 = 0.1e1 / t119;
    constexpr double t121 = t40 * t40;
    constexpr double t122 = t120 * t121;
    constexpr double t161 = t116 * t120;
    constexpr double t193 = t4 * t7;
    constexpr double t347 = t40 * t19;
    constexpr double t348 = t92 * t6;


    const double t8 = safe_math::cbrt( rho );
    const double t11 = t5 * t7 / t8;
    const double t13 = 0.1e1 + 0.53425e-1 * t11;
    const double t14 = safe_math::sqrt( t11 );
    const double t17 = pow_3_2( t11 );
    const double t22 = t8 * t8;
    const double t25 = t21 * t6 / t22;
    const double t27 = 0.379785e1 * t14 + 0.8969e0 * t11 + 0.204775e0 * t17 + 0.123235e0 * t25;
    const double t30 = 0.1e1 + 0.16081979498692535067e2 / t27;
    const double t31 = safe_math::log( t30 );
    const double t33 = 0.621814e-1 * t13 * t31;
    const double t34 = 0.1e1 <= zeta_tol;
    const double t35 = safe_math::cbrt( zeta_tol );
    const double t37 = piecewise_functor_3( t34, t35 * zeta_tol, 1.0 );
    const double t39 = 0.2e1 * t37 - 0.2e1;
    const double t44 = t39 * t43;
    const double t46 = 0.1e1 + 0.278125e-1 * t11;
    const double t51 = 0.51785e1 * t14 + 0.905775e0 * t11 + 0.1100325e0 * t17 + 0.1241775e0 * t25;
    const double t54 = 0.1e1 + 0.29608749977793437516e2 / t51;
    const double t55 = safe_math::log( t54 );
    const double t58 = 0.19751673498613801407e-1 * t44 * t46 * t55;
    const double t59 = safe_math::log( 0.2e1 );
    const double t60 = 0.1e1 - t59;
    const double t63 = t60 / t61;
    const double t64 = t35 * t35;
    const double t65 = piecewise_functor_3( t34, t64, 1.0 );
    const double t66 = t65 * t65;
    const double t67 = t66 * t65;
    const double t69 = 0.1e1 + 0.25e-1 * t11;
    const double t71 = 0.1e1 + 0.4445e-1 * t11;
    const double t72 = 0.1e1 / t71;
    const double t73 = t69 * t72;
    const double t74 = 0.1e1 / t60;
    const double t77 = 0.1e1 / t67;
    const double t78 = t61 * t77;
    const double t80 = safe_math::exp( -( -t33 + t58 ) * t74 * t78 );
    const double t81 = t80 - 0.1e1;
    const double t82 = 0.1e1 / t81;
    const double t83 = t74 * t82;
    const double t84 = t83 * sigma;
    const double t85 = t73 * t84;
    const double t86 = rho * rho;
    const double t88 = 0.1e1 / t8 / t86;
    const double t89 = t88 * t40;
    const double t90 = 0.1e1 / t66;
    const double t98 = 0.1e1 + 0.27439371595564631661e-1 * t85 * t89 * t90 * t94;
    const double t99 = pow_1_4( t98 );
    const double t101 = 0.1e1 - 0.1e1 / t99;
    const double t104 = 0.1e1 + 0.1e1 * t101 * t81;
    const double t105 = safe_math::log( t104 );
    const double t107 = t63 * t67 * t105;
    const double t109 = 0.1e1 / t22 / rho;
    const double t112 = 0.1e1 / t22 / t86;
    const double t124 = 0.5e1 / 0.9e1 * ( tau * t109 - sigma * t112 / 0.8e1 ) * t116 * t122;
    const double t125 = t124 <= 0.1e1;
    const double t126 = safe_math::log( DBL_EPSILON );
    const double t129 = t126 / ( -t126 + 0.64e0 );
    const double t130 = -t129 < t124;
    const double t131 = t124 < -t129;
    const double t132 = piecewise_functor_3( t131, t124, -t129 );
    const double t133 = 0.1e1 - t132;
    const double t134 = 0.1e1 / t133;
    const double t137 = safe_math::exp( -0.64e0 * t132 * t134 );
    const double t138 = piecewise_functor_3( t130, 0.0, t137 );
    const double t140 = safe_math::log( 0.14285714285714285714e1 * DBL_EPSILON );
    const double t143 = ( -t140 + 0.15e1 ) / t140;
    const double t144 = t124 < -t143;
    const double t145 = piecewise_functor_3( t144, -t143, t124 );
    const double t146 = 0.1e1 - t145;
    const double t149 = safe_math::exp( 0.15e1 / t146 );
    const double t151 = piecewise_functor_3( t144, 0.0, -0.7e0 * t149 );
    const double t152 = piecewise_functor_3( t125, t138, t151 );
    const double t155 = 0.1e1 + 0.4445e-1 * t14 + 0.3138525e-1 * t11;
    const double t156 = 0.1e1 / t155;
    const double t159 = safe_math::exp( 0.1e1 * t156 );
    const double t160 = t159 - 0.1e1;
    const double t162 = t121 * sigma;
    const double t166 = 0.1e1 + 0.21337642104376358333e-1 * t161 * t162 * t112;
    const double t167 = pow_1_4( t166 );
    const double t169 = 0.1e1 - 0.1e1 / t167;
    const double t171 = t160 * t169 + 0.1e1;
    const double t172 = safe_math::log( t171 );
    const double t178 = 0.1e1 - 0.2363e1 * t41 * t39 * t43;
    const double t180 = ( -0.285764e-1 * t156 + 0.285764e-1 * t172 ) * t178 + t33 - t58 - t107;
    const double t181 = t152 * t180;
    const double t183 = 0.1e1 / t8 / rho;
    const double t184 = t7 * t183;
    const double t186 = t5 * t184 * t31;
    const double t187 = 0.11073470983333333333e-2 * t186;
    const double t188 = t27 * t27;
    const double t189 = 0.1e1 / t188;
    const double t190 = t13 * t189;
    const double t192 = 0.1e1 / t14 * t2;
    const double t194 = t193 * t183;
    const double t195 = t192 * t194;
    const double t197 = t5 * t184;
    const double t199 = safe_math::sqrt( t11 );
    const double t200 = t199 * t2;
    const double t201 = t200 * t194;
    const double t204 = t21 * t6 * t109;
    const double t206 = -0.632975e0 * t195 - 0.29896666666666666667e0 * t197 - 0.1023875e0 * t201 - 0.82156666666666666667e-1 * t204;
    const double t207 = 0.1e1 / t30;
    const double t208 = t206 * t207;
    const double t209 = t190 * t208;
    const double t210 = 0.1e1 * t209;
    const double t211 = t44 * t2;
    const double t214 = t211 * t193 * t183 * t55;
    const double t215 = 0.18311447306006545054e-3 * t214;
    const double t216 = t44 * t46;
    const double t217 = t51 * t51;
    const double t218 = 0.1e1 / t217;
    const double t223 = -0.86308333333333333334e0 * t195 - 0.301925e0 * t197 - 0.5501625e-1 * t201 - 0.82785e-1 * t204;
    const double t225 = 0.1e1 / t54;
    const double t226 = t218 * t223 * t225;
    const double t227 = t216 * t226;
    const double t228 = 0.5848223622634646207e0 * t227;
    const double t230 = 0.1e1 / t99 / t98;
    const double t231 = t86 * rho;
    const double t233 = 0.1e1 / t22 / t231;
    const double t234 = t233 * t72;
    const double t237 = t40 * t90;
    const double t238 = t82 * sigma * t237;
    const double t241 = t71 * t71;
    const double t242 = 0.1e1 / t241;
    const double t243 = t69 * t242;
    const double t244 = t243 * t83;
    const double t245 = sigma * t233;
    const double t249 = t60 * t60;
    const double t250 = 0.1e1 / t249;
    const double t251 = t73 * t250;
    const double t252 = t81 * t81;
    const double t253 = 0.1e1 / t252;
    const double t254 = t253 * sigma;
    const double t255 = t254 * t89;
    const double t256 = t251 * t255;
    const double t257 = t66 * t66;
    const double t259 = 0.1e1 / t257 / t65;
    const double t260 = t259 * t19;
    const double t261 = t260 * t92;
    const double t262 = t187 + t210 - t215 - t228;
    const double t264 = t61 * t80;
    const double t265 = t6 * t262 * t264;
    const double t266 = t261 * t265;
    const double t270 = 0.1e1 / t8 / t231;
    const double t271 = t270 * t40;
    const double t276 = -0.27439371595564631661e-2 * t234 * t74 * t238 + 0.48787202696913915093e-2 * t244 * t245 * t237 + 0.27439371595564631661e-1 * t256 * t266 - 0.64025200389650807209e-1 * t85 * t271 * t90 * t94;
    const double t277 = t230 * t276;
    const double t282 = t78 * t80;
    const double t285 = 0.25e0 * t277 * t81 - 0.1e1 * t101 * t262 * t74 * t282;
    const double t287 = 0.1e1 / t104;
    const double t289 = t63 * t67 * t285 * t287;
    const double t296 = 0.5e1 / 0.9e1 * ( -0.5e1 / 0.3e1 * tau * t112 + t245 / 0.3e1 ) * t116 * t122;
    const double t297 = piecewise_functor_3( t131, t296, 0.0 );
    const double t300 = t133 * t133;
    const double t301 = 0.1e1 / t300;
    const double t302 = t132 * t301;
    const double t305 = -0.64e0 * t297 * t134 - 0.64e0 * t302 * t297;
    const double t306 = t305 * t137;
    const double t307 = piecewise_functor_3( t130, 0.0, t306 );
    const double t308 = t146 * t146;
    const double t309 = 0.1e1 / t308;
    const double t310 = piecewise_functor_3( t144, 0.0, t296 );
    const double t314 = piecewise_functor_3( t144, 0.0, -0.105e1 * t309 * t310 * t149 );
    const double t315 = piecewise_functor_3( t125, t307, t314 );
    const double t316 = t315 * t180;
    const double t317 = t155 * t155;
    const double t318 = 0.1e1 / t317;
    const double t321 = -0.74083333333333333333e-2 * t195 - 0.1046175e-1 * t197;
    const double t322 = t318 * t321;
    const double t324 = t159 * t169;
    const double t328 = 0.1e1 / t167 / t166;
    const double t329 = t160 * t328;
    const double t330 = t329 * t116;
    const double t334 = -0.1e1 * t322 * t324 - 0.14225094736250905555e-1 * t330 * t122 * t245;
    const double t335 = 0.1e1 / t171;
    const double t340 = ( 0.285764e-1 * t322 + 0.285764e-1 * t334 * t335 ) * t178 - t187 - t210 + t215 + t228 - t289;
    const double t341 = t152 * t340;
    const double t344 = t65 * t230;
    const double t345 = t73 * t88;
    const double t346 = t344 * t345;
    const double t349 = t348 * t287;
    const double t350 = t347 * t349;
    const double t352 = 0.69504740211613770831e-3 * t346 * t350;
    const double t353 = t112 * t116;
    const double t354 = t353 * t122;
    const double t355 = 0.5e1 / 0.72e2 * t354;
    const double t356 = piecewise_functor_3( t131, -t355, 0.0 );
    const double t361 = -0.64e0 * t356 * t134 - 0.64e0 * t302 * t356;
    const double t362 = t361 * t137;
    const double t363 = piecewise_functor_3( t130, 0.0, t362 );
    const double t364 = piecewise_functor_3( t144, 0.0, -t355 );
    const double t368 = piecewise_functor_3( t144, 0.0, -0.105e1 * t309 * t364 * t149 );
    const double t369 = piecewise_functor_3( t125, t363, t368 );
    const double t370 = t369 * t180;
    const double t371 = t329 * t353;
    const double t372 = t335 * t178;
    const double t373 = t122 * t372;
    const double t376 = 0.15243824895787514157e-3 * t371 * t373 - t352;
    const double t377 = t152 * t376;
    const double t381 = 0.5e1 / 0.9e1 * t109 * t116 * t122;
    const double t382 = piecewise_functor_3( t131, t381, 0.0 );
    const double t387 = -0.64e0 * t382 * t134 - 0.64e0 * t302 * t382;
    const double t388 = t387 * t137;
    const double t389 = piecewise_functor_3( t130, 0.0, t388 );
    const double t390 = piecewise_functor_3( t144, 0.0, t381 );
    const double t394 = piecewise_functor_3( t144, 0.0, -0.105e1 * t309 * t390 * t149 );
    const double t395 = piecewise_functor_3( t125, t389, t394 );
    const double t396 = rho * t395;


    eps = -t33 + t58 + t107 + t181;
    vrho = -t33 + t58 + t107 + t181 + rho * ( t187 + t210 - t215 - t228 + t289 + t316 + t341 );
    vsigma = rho * ( t352 + t370 + t377 );
    vlapl = 0.e0;
    vtau = t396 * t180;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t57 = constants::m_cbrt_2;
    constexpr double t95 = constants::m_pi_sq;
    constexpr double t173 = constants::m_cbrt_6;
    constexpr double t175 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t20 = t2 * t2;
    constexpr double t21 = t4 * t4;
    constexpr double t22 = t20 * t21;
    constexpr double t58 = t57 - 0.1e1;
    constexpr double t60 = 0.1e1 / t58 / 0.2e1;
    constexpr double t132 = 0.1e1 / t4;
    constexpr double t133 = t20 * t132;
    constexpr double t134 = t133 * t6;
    constexpr double t176 = t175 * t175;
    constexpr double t177 = 0.1e1 / t176;
    constexpr double t219 = t173 * t177;
    constexpr double t220 = t57 * t57;


    const double t8 = rho_a + rho_b;
    const double t9 = safe_math::cbrt( t8 );
    const double t12 = t5 * t7 / t9;
    const double t14 = 0.1e1 + 0.53425e-1 * t12;
    const double t15 = safe_math::sqrt( t12 );
    const double t18 = pow_3_2( t12 );
    const double t23 = t9 * t9;
    const double t26 = t22 * t6 / t23;
    const double t28 = 0.379785e1 * t15 + 0.8969e0 * t12 + 0.204775e0 * t18 + 0.123235e0 * t26;
    const double t31 = 0.1e1 + 0.16081979498692535067e2 / t28;
    const double t32 = safe_math::log( t31 );
    const double t34 = 0.621814e-1 * t14 * t32;
    const double t35 = rho_a - rho_b;
    const double t36 = t35 * t35;
    const double t37 = t36 * t36;
    const double t38 = t8 * t8;
    const double t39 = t38 * t38;
    const double t40 = 0.1e1 / t39;
    const double t41 = t37 * t40;
    const double t42 = 0.1e1 / t8;
    const double t43 = t35 * t42;
    const double t44 = 0.1e1 + t43;
    const double t45 = t44 <= zeta_tol;
    const double t46 = safe_math::cbrt( zeta_tol );
    const double t47 = t46 * zeta_tol;
    const double t48 = safe_math::cbrt( t44 );
    const double t49 = t48 * t44;
    const double t50 = piecewise_functor_3( t45, t47, t49 );
    const double t51 = 0.1e1 - t43;
    const double t52 = t51 <= zeta_tol;
    const double t53 = safe_math::cbrt( t51 );
    const double t54 = t53 * t51;
    const double t55 = piecewise_functor_3( t52, t47, t54 );
    const double t56 = t50 + t55 - 0.2e1;
    const double t61 = t56 * t60;
    const double t63 = 0.1e1 + 0.5137e-1 * t12;
    const double t68 = 0.705945e1 * t15 + 0.1549425e1 * t12 + 0.420775e0 * t18 + 0.1562925e0 * t26;
    const double t71 = 0.1e1 + 0.32163958997385070134e2 / t68;
    const double t72 = safe_math::log( t71 );
    const double t76 = 0.1e1 + 0.278125e-1 * t12;
    const double t81 = 0.51785e1 * t15 + 0.905775e0 * t12 + 0.1100325e0 * t18 + 0.1241775e0 * t26;
    const double t84 = 0.1e1 + 0.29608749977793437516e2 / t81;
    const double t85 = safe_math::log( t84 );
    const double t86 = t76 * t85;
    const double t88 = -0.310907e-1 * t63 * t72 + t34 - 0.19751673498613801407e-1 * t86;
    const double t89 = t61 * t88;
    const double t90 = t41 * t89;
    const double t92 = 0.19751673498613801407e-1 * t61 * t86;
    const double t93 = safe_math::log( 0.2e1 );
    const double t94 = 0.1e1 - t93;
    const double t97 = t94 / t95;
    const double t98 = t46 * t46;
    const double t99 = t48 * t48;
    const double t100 = piecewise_functor_3( t45, t98, t99 );
    const double t101 = t53 * t53;
    const double t102 = piecewise_functor_3( t52, t98, t101 );
    const double t104 = t100 / 0.2e1 + t102 / 0.2e1;
    const double t105 = t104 * t104;
    const double t106 = t105 * t104;
    const double t108 = 0.1e1 + 0.25e-1 * t12;
    const double t110 = 0.1e1 + 0.4445e-1 * t12;
    const double t111 = 0.1e1 / t110;
    const double t112 = t108 * t111;
    const double t113 = 0.1e1 / t94;
    const double t115 = ( -t34 + t90 + t92 ) * t113;
    const double t116 = 0.1e1 / t106;
    const double t117 = t95 * t116;
    const double t119 = safe_math::exp( -t115 * t117 );
    const double t120 = t119 - 0.1e1;
    const double t121 = 0.1e1 / t120;
    const double t122 = t113 * t121;
    const double t124 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t125 = t122 * t124;
    const double t126 = t112 * t125;
    const double t128 = 0.1e1 / t9 / t38;
    const double t129 = t128 * t57;
    const double t130 = 0.1e1 / t105;
    const double t138 = 0.1e1 + 0.27439371595564631661e-1 * t126 * t129 * t130 * t134;
    const double t139 = pow_1_4( t138 );
    const double t141 = 0.1e1 - 0.1e1 / t139;
    const double t144 = 0.1e1 + 0.1e1 * t141 * t120;
    const double t145 = safe_math::log( t144 );
    const double t147 = t97 * t106 * t145;
    const double t148 = safe_math::cbrt( rho_a );
    const double t149 = t148 * t148;
    const double t151 = 0.1e1 / t149 / rho_a;
    const double t152 = tau_a * t151;
    const double t153 = t44 / 0.2e1;
    const double t154 = safe_math::cbrt( t153 );
    const double t155 = t154 * t154;
    const double t156 = t155 * t153;
    const double t158 = safe_math::cbrt( rho_b );
    const double t159 = t158 * t158;
    const double t161 = 0.1e1 / t159 / rho_b;
    const double t162 = tau_b * t161;
    const double t163 = t51 / 0.2e1;
    const double t164 = safe_math::cbrt( t163 );
    const double t165 = t164 * t164;
    const double t166 = t165 * t163;
    const double t169 = 0.1e1 / t23 / t38;
    const double t174 = ( t152 * t156 + t162 * t166 - t124 * t169 / 0.8e1 ) * t173;
    const double t178 = t156 + t166;
    const double t179 = 0.1e1 / t178;
    const double t180 = t177 * t179;
    const double t182 = 0.5e1 / 0.9e1 * t174 * t180;
    const double t183 = t182 <= 0.1e1;
    const double t184 = safe_math::log( DBL_EPSILON );
    const double t187 = t184 / ( -t184 + 0.64e0 );
    const double t188 = -t187 < t182;
    const double t189 = t182 < -t187;
    const double t190 = piecewise_functor_3( t189, t182, -t187 );
    const double t191 = 0.1e1 - t190;
    const double t192 = 0.1e1 / t191;
    const double t195 = safe_math::exp( -0.64e0 * t190 * t192 );
    const double t196 = piecewise_functor_3( t188, 0.0, t195 );
    const double t198 = safe_math::log( 0.14285714285714285714e1 * DBL_EPSILON );
    const double t201 = ( -t198 + 0.15e1 ) / t198;
    const double t202 = t182 < -t201;
    const double t203 = piecewise_functor_3( t202, -t201, t182 );
    const double t204 = 0.1e1 - t203;
    const double t207 = safe_math::exp( 0.15e1 / t204 );
    const double t209 = piecewise_functor_3( t202, 0.0, -0.7e0 * t207 );
    const double t210 = piecewise_functor_3( t183, t196, t209 );
    const double t213 = 0.1e1 + 0.4445e-1 * t15 + 0.3138525e-1 * t12;
    const double t214 = 0.1e1 / t213;
    const double t217 = safe_math::exp( 0.1e1 * t214 );
    const double t218 = t217 - 0.1e1;
    const double t221 = t220 * t124;
    const double t225 = 0.1e1 + 0.21337642104376358333e-1 * t219 * t221 * t169;
    const double t226 = pow_1_4( t225 );
    const double t228 = 0.1e1 - 0.1e1 / t226;
    const double t230 = t218 * t228 + 0.1e1;
    const double t231 = safe_math::log( t230 );
    const double t233 = -0.285764e-1 * t214 + 0.285764e-1 * t231;
    const double t237 = 0.1e1 - 0.2363e1 * t58 * t56 * t60;
    const double t238 = t233 * t237;
    const double t239 = t37 * t37;
    const double t240 = t239 * t37;
    const double t241 = t39 * t39;
    const double t242 = t241 * t39;
    const double t243 = 0.1e1 / t242;
    const double t245 = -t240 * t243 + 0.1e1;
    const double t247 = t238 * t245 - t147 + t34 - t90 - t92;
    const double t248 = t210 * t247;


    eps = -t34 + t90 + t92 + t147 + t248;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t2 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_one_ov_pi;
    constexpr double t6 = constants::m_cbrt_4;
    constexpr double t57 = constants::m_cbrt_2;
    constexpr double t95 = constants::m_pi_sq;
    constexpr double t173 = constants::m_cbrt_6;
    constexpr double t175 = constants::m_cbrt_pi_sq;
    constexpr double t5 = t2 * t4;
    constexpr double t7 = t6 * t6;
    constexpr double t20 = t2 * t2;
    constexpr double t21 = t4 * t4;
    constexpr double t22 = t20 * t21;
    constexpr double t58 = t57 - 0.1e1;
    constexpr double t60 = 0.1e1 / t58 / 0.2e1;
    constexpr double t132 = 0.1e1 / t4;
    constexpr double t133 = t20 * t132;
    constexpr double t134 = t133 * t6;
    constexpr double t176 = t175 * t175;
    constexpr double t177 = 0.1e1 / t176;
    constexpr double t219 = t173 * t177;
    constexpr double t220 = t57 * t57;
    constexpr double t260 = t4 * t7;
    constexpr double t389 = t132 * t6;
    constexpr double t493 = t177 * t220;
    constexpr double t623 = t57 * t20;


    const double t8 = rho_a + rho_b;
    const double t9 = safe_math::cbrt( t8 );
    const double t12 = t5 * t7 / t9;
    const double t14 = 0.1e1 + 0.53425e-1 * t12;
    const double t15 = safe_math::sqrt( t12 );
    const double t18 = pow_3_2( t12 );
    const double t23 = t9 * t9;
    const double t26 = t22 * t6 / t23;
    const double t28 = 0.379785e1 * t15 + 0.8969e0 * t12 + 0.204775e0 * t18 + 0.123235e0 * t26;
    const double t31 = 0.1e1 + 0.16081979498692535067e2 / t28;
    const double t32 = safe_math::log( t31 );
    const double t34 = 0.621814e-1 * t14 * t32;
    const double t35 = rho_a - rho_b;
    const double t36 = t35 * t35;
    const double t37 = t36 * t36;
    const double t38 = t8 * t8;
    const double t39 = t38 * t38;
    const double t40 = 0.1e1 / t39;
    const double t41 = t37 * t40;
    const double t42 = 0.1e1 / t8;
    const double t43 = t35 * t42;
    const double t44 = 0.1e1 + t43;
    const double t45 = t44 <= zeta_tol;
    const double t46 = safe_math::cbrt( zeta_tol );
    const double t47 = t46 * zeta_tol;
    const double t48 = safe_math::cbrt( t44 );
    const double t49 = t48 * t44;
    const double t50 = piecewise_functor_3( t45, t47, t49 );
    const double t51 = 0.1e1 - t43;
    const double t52 = t51 <= zeta_tol;
    const double t53 = safe_math::cbrt( t51 );
    const double t54 = t53 * t51;
    const double t55 = piecewise_functor_3( t52, t47, t54 );
    const double t56 = t50 + t55 - 0.2e1;
    const double t61 = t56 * t60;
    const double t63 = 0.1e1 + 0.5137e-1 * t12;
    const double t68 = 0.705945e1 * t15 + 0.1549425e1 * t12 + 0.420775e0 * t18 + 0.1562925e0 * t26;
    const double t71 = 0.1e1 + 0.32163958997385070134e2 / t68;
    const double t72 = safe_math::log( t71 );
    const double t76 = 0.1e1 + 0.278125e-1 * t12;
    const double t81 = 0.51785e1 * t15 + 0.905775e0 * t12 + 0.1100325e0 * t18 + 0.1241775e0 * t26;
    const double t84 = 0.1e1 + 0.29608749977793437516e2 / t81;
    const double t85 = safe_math::log( t84 );
    const double t86 = t76 * t85;
    const double t88 = -0.310907e-1 * t63 * t72 + t34 - 0.19751673498613801407e-1 * t86;
    const double t89 = t61 * t88;
    const double t90 = t41 * t89;
    const double t92 = 0.19751673498613801407e-1 * t61 * t86;
    const double t93 = safe_math::log( 0.2e1 );
    const double t94 = 0.1e1 - t93;
    const double t97 = t94 / t95;
    const double t98 = t46 * t46;
    const double t99 = t48 * t48;
    const double t100 = piecewise_functor_3( t45, t98, t99 );
    const double t101 = t53 * t53;
    const double t102 = piecewise_functor_3( t52, t98, t101 );
    const double t104 = t100 / 0.2e1 + t102 / 0.2e1;
    const double t105 = t104 * t104;
    const double t106 = t105 * t104;
    const double t108 = 0.1e1 + 0.25e-1 * t12;
    const double t110 = 0.1e1 + 0.4445e-1 * t12;
    const double t111 = 0.1e1 / t110;
    const double t112 = t108 * t111;
    const double t113 = 0.1e1 / t94;
    const double t115 = ( -t34 + t90 + t92 ) * t113;
    const double t116 = 0.1e1 / t106;
    const double t117 = t95 * t116;
    const double t119 = safe_math::exp( -t115 * t117 );
    const double t120 = t119 - 0.1e1;
    const double t121 = 0.1e1 / t120;
    const double t122 = t113 * t121;
    const double t124 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t125 = t122 * t124;
    const double t126 = t112 * t125;
    const double t128 = 0.1e1 / t9 / t38;
    const double t129 = t128 * t57;
    const double t130 = 0.1e1 / t105;
    const double t138 = 0.1e1 + 0.27439371595564631661e-1 * t126 * t129 * t130 * t134;
    const double t139 = pow_1_4( t138 );
    const double t141 = 0.1e1 - 0.1e1 / t139;
    const double t144 = 0.1e1 + 0.1e1 * t141 * t120;
    const double t145 = safe_math::log( t144 );
    const double t147 = t97 * t106 * t145;
    const double t148 = safe_math::cbrt( rho_a );
    const double t149 = t148 * t148;
    const double t151 = 0.1e1 / t149 / rho_a;
    const double t152 = tau_a * t151;
    const double t153 = t44 / 0.2e1;
    const double t154 = safe_math::cbrt( t153 );
    const double t155 = t154 * t154;
    const double t156 = t155 * t153;
    const double t158 = safe_math::cbrt( rho_b );
    const double t159 = t158 * t158;
    const double t161 = 0.1e1 / t159 / rho_b;
    const double t162 = tau_b * t161;
    const double t163 = t51 / 0.2e1;
    const double t164 = safe_math::cbrt( t163 );
    const double t165 = t164 * t164;
    const double t166 = t165 * t163;
    const double t169 = 0.1e1 / t23 / t38;
    const double t174 = ( t152 * t156 + t162 * t166 - t124 * t169 / 0.8e1 ) * t173;
    const double t178 = t156 + t166;
    const double t179 = 0.1e1 / t178;
    const double t180 = t177 * t179;
    const double t182 = 0.5e1 / 0.9e1 * t174 * t180;
    const double t183 = t182 <= 0.1e1;
    const double t184 = safe_math::log( DBL_EPSILON );
    const double t187 = t184 / ( -t184 + 0.64e0 );
    const double t188 = -t187 < t182;
    const double t189 = t182 < -t187;
    const double t190 = piecewise_functor_3( t189, t182, -t187 );
    const double t191 = 0.1e1 - t190;
    const double t192 = 0.1e1 / t191;
    const double t195 = safe_math::exp( -0.64e0 * t190 * t192 );
    const double t196 = piecewise_functor_3( t188, 0.0, t195 );
    const double t198 = safe_math::log( 0.14285714285714285714e1 * DBL_EPSILON );
    const double t201 = ( -t198 + 0.15e1 ) / t198;
    const double t202 = t182 < -t201;
    const double t203 = piecewise_functor_3( t202, -t201, t182 );
    const double t204 = 0.1e1 - t203;
    const double t207 = safe_math::exp( 0.15e1 / t204 );
    const double t209 = piecewise_functor_3( t202, 0.0, -0.7e0 * t207 );
    const double t210 = piecewise_functor_3( t183, t196, t209 );
    const double t213 = 0.1e1 + 0.4445e-1 * t15 + 0.3138525e-1 * t12;
    const double t214 = 0.1e1 / t213;
    const double t217 = safe_math::exp( 0.1e1 * t214 );
    const double t218 = t217 - 0.1e1;
    const double t221 = t220 * t124;
    const double t225 = 0.1e1 + 0.21337642104376358333e-1 * t219 * t221 * t169;
    const double t226 = pow_1_4( t225 );
    const double t228 = 0.1e1 - 0.1e1 / t226;
    const double t230 = t218 * t228 + 0.1e1;
    const double t231 = safe_math::log( t230 );
    const double t233 = -0.285764e-1 * t214 + 0.285764e-1 * t231;
    const double t237 = 0.1e1 - 0.2363e1 * t58 * t56 * t60;
    const double t238 = t233 * t237;
    const double t239 = t37 * t37;
    const double t240 = t239 * t37;
    const double t241 = t39 * t39;
    const double t242 = t241 * t39;
    const double t243 = 0.1e1 / t242;
    const double t245 = -t240 * t243 + 0.1e1;
    const double t247 = t238 * t245 - t147 + t34 - t90 - t92;
    const double t248 = t210 * t247;
    const double t250 = 0.1e1 / t9 / t8;
    const double t251 = t7 * t250;
    const double t253 = t5 * t251 * t32;
    const double t254 = 0.11073470983333333333e-2 * t253;
    const double t255 = t28 * t28;
    const double t256 = 0.1e1 / t255;
    const double t257 = t14 * t256;
    const double t259 = 0.1e1 / t15 * t2;
    const double t261 = t260 * t250;
    const double t262 = t259 * t261;
    const double t264 = t5 * t251;
    const double t266 = safe_math::sqrt( t12 );
    const double t267 = t266 * t2;
    const double t268 = t267 * t261;
    const double t273 = t22 * t6 / t23 / t8;
    const double t275 = -0.632975e0 * t262 - 0.29896666666666666667e0 * t264 - 0.1023875e0 * t268 - 0.82156666666666666667e-1 * t273;
    const double t276 = 0.1e1 / t31;
    const double t277 = t275 * t276;
    const double t278 = t257 * t277;
    const double t279 = 0.1e1 * t278;
    const double t280 = t36 * t35;
    const double t281 = t280 * t40;
    const double t282 = t281 * t89;
    const double t283 = 0.4e1 * t282;
    const double t284 = t39 * t8;
    const double t285 = 0.1e1 / t284;
    const double t286 = t37 * t285;
    const double t287 = t286 * t89;
    const double t288 = 0.4e1 * t287;
    const double t289 = 0.1e1 / t38;
    const double t290 = t35 * t289;
    const double t291 = t42 - t290;
    const double t294 = piecewise_functor_3( t45, 0.0, 0.4e1 / 0.3e1 * t48 * t291 );
    const double t295 = -t291;
    const double t298 = piecewise_functor_3( t52, 0.0, 0.4e1 / 0.3e1 * t53 * t295 );
    const double t299 = t294 + t298;
    const double t300 = t299 * t60;
    const double t301 = t300 * t88;
    const double t302 = t41 * t301;
    const double t306 = t68 * t68;
    const double t307 = 0.1e1 / t306;
    const double t308 = t63 * t307;
    const double t313 = -0.1176575e1 * t262 - 0.516475e0 * t264 - 0.2103875e0 * t268 - 0.104195e0 * t273;
    const double t314 = 0.1e1 / t71;
    const double t315 = t313 * t314;
    const double t321 = t81 * t81;
    const double t322 = 0.1e1 / t321;
    const double t323 = t76 * t322;
    const double t328 = -0.86308333333333333334e0 * t262 - 0.301925e0 * t264 - 0.5501625e-1 * t268 - 0.82785e-1 * t273;
    const double t329 = 0.1e1 / t84;
    const double t330 = t328 * t329;
    const double t333 = 0.53237641966666666666e-3 * t5 * t251 * t72 + 0.1e1 * t308 * t315 - t254 - t279 + 0.18311447306006545054e-3 * t5 * t251 * t85 + 0.5848223622634646207e0 * t323 * t330;
    const double t334 = t61 * t333;
    const double t335 = t41 * t334;
    const double t336 = t300 * t86;
    const double t337 = 0.19751673498613801407e-1 * t336;
    const double t338 = t61 * t2;
    const double t340 = t260 * t250 * t85;
    const double t341 = t338 * t340;
    const double t342 = 0.18311447306006545054e-3 * t341;
    const double t343 = t61 * t76;
    const double t345 = t322 * t328 * t329;
    const double t346 = t343 * t345;
    const double t347 = 0.5848223622634646207e0 * t346;
    const double t348 = t105 * t145;
    const double t349 = 0.1e1 / t48;
    const double t352 = piecewise_functor_3( t45, 0.0, 0.2e1 / 0.3e1 * t349 * t291 );
    const double t353 = 0.1e1 / t53;
    const double t356 = piecewise_functor_3( t52, 0.0, 0.2e1 / 0.3e1 * t353 * t295 );
    const double t358 = t352 / 0.2e1 + t356 / 0.2e1;
    const double t360 = t97 * t348 * t358;
    const double t361 = 0.3e1 * t360;
    const double t363 = 0.1e1 / t139 / t138;
    const double t364 = t38 * t8;
    const double t366 = 0.1e1 / t23 / t364;
    const double t367 = t366 * t111;
    const double t369 = t121 * t124;
    const double t370 = t57 * t130;
    const double t371 = t369 * t370;
    const double t373 = 0.27439371595564631661e-2 * t367 * t113 * t371;
    const double t374 = t110 * t110;
    const double t375 = 0.1e1 / t374;
    const double t376 = t108 * t375;
    const double t377 = t376 * t122;
    const double t378 = t124 * t366;
    const double t381 = 0.48787202696913915093e-2 * t377 * t378 * t370;
    const double t382 = t112 * t113;
    const double t383 = t120 * t120;
    const double t384 = 0.1e1 / t383;
    const double t385 = t384 * t124;
    const double t387 = t382 * t385 * t128;
    const double t388 = t370 * t20;
    const double t391 = ( t254 + t279 + t283 - t288 + t302 + t335 + t337 - t342 - t347 ) * t113;
    const double t393 = t105 * t105;
    const double t394 = 0.1e1 / t393;
    const double t395 = t95 * t394;
    const double t396 = t395 * t358;
    const double t399 = 0.3e1 * t115 * t396 - t391 * t117;
    const double t400 = t399 * t119;
    const double t402 = t388 * t389 * t400;
    const double t406 = 0.1e1 / t9 / t364;
    const double t407 = t406 * t57;
    const double t411 = 0.64025200389650807209e-1 * t126 * t407 * t130 * t134;
    const double t413 = t382 * t369 * t128;
    const double t414 = t57 * t116;
    const double t415 = t414 * t20;
    const double t417 = t415 * t389 * t358;
    const double t420 = -t373 + t381 - 0.27439371595564631661e-1 * t387 * t402 - t411 - 0.54878743191129263322e-1 * t413 * t417;
    const double t421 = t363 * t420;
    const double t427 = 0.25e0 * t421 * t120 + 0.1e1 * t141 * t399 * t119;
    const double t429 = 0.1e1 / t144;
    const double t431 = t97 * t106 * t427 * t429;
    const double t432 = rho_a * rho_a;
    const double t434 = 0.1e1 / t149 / t432;
    const double t435 = tau_a * t434;
    const double t438 = t291 / 0.2e1;
    const double t439 = t155 * t438;
    const double t442 = -t438;
    const double t443 = t165 * t442;
    const double t446 = t378 / 0.3e1;
    const double t448 = ( -0.5e1 / 0.3e1 * t435 * t156 + 0.5e1 / 0.3e1 * t152 * t439 + 0.5e1 / 0.3e1 * t162 * t443 + t446 ) * t173;
    const double t450 = t178 * t178;
    const double t451 = 0.1e1 / t450;
    const double t452 = t177 * t451;
    const double t454 = 0.5e1 / 0.3e1 * t439 + 0.5e1 / 0.3e1 * t443;
    const double t455 = t452 * t454;
    const double t458 = -0.5e1 / 0.9e1 * t174 * t455 + 0.5e1 / 0.9e1 * t448 * t180;
    const double t459 = piecewise_functor_3( t189, t458, 0.0 );
    const double t462 = t191 * t191;
    const double t463 = 0.1e1 / t462;
    const double t464 = t190 * t463;
    const double t467 = -0.64e0 * t459 * t192 - 0.64e0 * t464 * t459;
    const double t468 = t467 * t195;
    const double t469 = piecewise_functor_3( t188, 0.0, t468 );
    const double t470 = t204 * t204;
    const double t471 = 0.1e1 / t470;
    const double t472 = piecewise_functor_3( t202, 0.0, t458 );
    const double t476 = piecewise_functor_3( t202, 0.0, -0.105e1 * t471 * t472 * t207 );
    const double t477 = piecewise_functor_3( t183, t469, t476 );
    const double t478 = t477 * t247;
    const double t479 = t213 * t213;
    const double t480 = 0.1e1 / t479;
    const double t483 = -0.74083333333333333333e-2 * t262 - 0.1046175e-1 * t264;
    const double t484 = t480 * t483;
    const double t486 = t217 * t228;
    const double t490 = 0.1e1 / t226 / t225;
    const double t491 = t218 * t490;
    const double t492 = t491 * t173;
    const double t497 = -0.1e1 * t484 * t486 - 0.14225094736250905555e-1 * t492 * t493 * t378;
    const double t498 = 0.1e1 / t230;
    const double t501 = 0.285764e-1 * t484 + 0.285764e-1 * t497 * t498;
    const double t502 = t501 * t237;
    const double t503 = t502 * t245;
    const double t504 = t233 * t58;
    const double t505 = t300 * t245;
    const double t508 = t239 * t280;
    const double t509 = t508 * t243;
    const double t510 = t241 * t284;
    const double t511 = 0.1e1 / t510;
    const double t512 = t240 * t511;
    const double t514 = -0.12e2 * t509 + 0.12e2 * t512;
    const double t516 = t503 - 0.2363e1 * t504 * t505 + t238 * t514 - t254 - t279 - t283 + t288 - t302 - t335 - t337 + t342 + t347 - t361 - t431;
    const double t517 = t210 * t516;
    const double t518 = t254 + t279 + t283 - t288 + t302 + t335 + t337 - t342 - t347 + t361 + t431 + t478 + t517;
    const double t520 = -t42 - t290;
    const double t523 = piecewise_functor_3( t45, 0.0, 0.4e1 / 0.3e1 * t48 * t520 );
    const double t524 = -t520;
    const double t527 = piecewise_functor_3( t52, 0.0, 0.4e1 / 0.3e1 * t53 * t524 );
    const double t528 = t523 + t527;
    const double t529 = t528 * t60;
    const double t530 = t529 * t88;
    const double t531 = t41 * t530;
    const double t532 = t529 * t86;
    const double t533 = 0.19751673498613801407e-1 * t532;
    const double t536 = piecewise_functor_3( t45, 0.0, 0.2e1 / 0.3e1 * t349 * t520 );
    const double t539 = piecewise_functor_3( t52, 0.0, 0.2e1 / 0.3e1 * t353 * t524 );
    const double t541 = t536 / 0.2e1 + t539 / 0.2e1;
    const double t543 = t97 * t348 * t541;
    const double t544 = 0.3e1 * t543;
    const double t546 = ( t254 + t279 - t283 - t288 + t531 + t335 + t533 - t342 - t347 ) * t113;
    const double t548 = t395 * t541;
    const double t551 = 0.3e1 * t115 * t548 - t546 * t117;
    const double t552 = t551 * t119;
    const double t554 = t388 * t389 * t552;
    const double t558 = t415 * t389 * t541;
    const double t561 = -t373 + t381 - 0.27439371595564631661e-1 * t387 * t554 - t411 - 0.54878743191129263322e-1 * t413 * t558;
    const double t562 = t363 * t561;
    const double t565 = t141 * t551;
    const double t568 = 0.25e0 * t562 * t120 + 0.1e1 * t565 * t119;
    const double t571 = t97 * t106 * t568 * t429;
    const double t572 = t520 / 0.2e1;
    const double t573 = t155 * t572;
    const double t576 = rho_b * rho_b;
    const double t578 = 0.1e1 / t159 / t576;
    const double t579 = tau_b * t578;
    const double t582 = -t572;
    const double t583 = t165 * t582;
    const double t587 = ( 0.5e1 / 0.3e1 * t152 * t573 - 0.5e1 / 0.3e1 * t579 * t166 + 0.5e1 / 0.3e1 * t162 * t583 + t446 ) * t173;
    const double t590 = 0.5e1 / 0.3e1 * t573 + 0.5e1 / 0.3e1 * t583;
    const double t591 = t452 * t590;
    const double t594 = -0.5e1 / 0.9e1 * t174 * t591 + 0.5e1 / 0.9e1 * t587 * t180;
    const double t595 = piecewise_functor_3( t189, t594, 0.0 );
    const double t600 = -0.64e0 * t595 * t192 - 0.64e0 * t464 * t595;
    const double t601 = t600 * t195;
    const double t602 = piecewise_functor_3( t188, 0.0, t601 );
    const double t603 = piecewise_functor_3( t202, 0.0, t594 );
    const double t607 = piecewise_functor_3( t202, 0.0, -0.105e1 * t471 * t603 * t207 );
    const double t608 = piecewise_functor_3( t183, t602, t607 );
    const double t609 = t608 * t247;
    const double t610 = t529 * t245;
    const double t614 = 0.12e2 * t509 + 0.12e2 * t512;
    const double t616 = t503 - 0.2363e1 * t504 * t610 + t238 * t614 - t254 - t279 + t283 + t288 - t531 - t335 - t533 + t342 + t347 - t544 - t571;
    const double t617 = t210 * t616;
    const double t618 = t254 + t279 - t283 - t288 + t531 + t335 + t533 - t342 - t347 + t544 + t571 + t609 + t617;
    const double t620 = t104 * t363;
    const double t621 = t112 * t128;
    const double t622 = t620 * t621;
    const double t624 = t389 * t429;
    const double t625 = t623 * t624;
    const double t626 = t622 * t625;
    const double t627 = 0.69504740211613770831e-3 * t626;
    const double t628 = t169 * t173;
    const double t629 = t628 * t180;
    const double t630 = 0.5e1 / 0.72e2 * t629;
    const double t631 = piecewise_functor_3( t189, -t630, 0.0 );
    const double t636 = -0.64e0 * t631 * t192 - 0.64e0 * t464 * t631;
    const double t637 = t636 * t195;
    const double t638 = piecewise_functor_3( t188, 0.0, t637 );
    const double t639 = piecewise_functor_3( t202, 0.0, -t630 );
    const double t643 = piecewise_functor_3( t202, 0.0, -0.105e1 * t471 * t639 * t207 );
    const double t644 = piecewise_functor_3( t183, t638, t643 );
    const double t645 = t644 * t247;
    const double t646 = t491 * t219;
    const double t647 = t220 * t169;
    const double t648 = t498 * t237;
    const double t649 = t648 * t245;
    const double t651 = t646 * t647 * t649;
    const double t653 = 0.15243824895787514157e-3 * t651 - t627;
    const double t654 = t210 * t653;
    const double t656 = 0.13900948042322754166e-2 * t626;
    const double t657 = 0.5e1 / 0.36e2 * t629;
    const double t658 = piecewise_functor_3( t189, -t657, 0.0 );
    const double t663 = -0.64e0 * t658 * t192 - 0.64e0 * t464 * t658;
    const double t664 = t663 * t195;
    const double t665 = piecewise_functor_3( t188, 0.0, t664 );
    const double t666 = piecewise_functor_3( t202, 0.0, -t657 );
    const double t670 = piecewise_functor_3( t202, 0.0, -0.105e1 * t471 * t666 * t207 );
    const double t671 = piecewise_functor_3( t183, t665, t670 );
    const double t672 = t671 * t247;
    const double t674 = 0.30487649791575028312e-3 * t651 - t656;
    const double t675 = t210 * t674;
    const double t677 = t151 * t156;
    const double t678 = t219 * t179;
    const double t680 = 0.5e1 / 0.9e1 * t677 * t678;
    const double t681 = piecewise_functor_3( t189, t680, 0.0 );
    const double t686 = -0.64e0 * t681 * t192 - 0.64e0 * t464 * t681;
    const double t687 = t686 * t195;
    const double t688 = piecewise_functor_3( t188, 0.0, t687 );
    const double t689 = piecewise_functor_3( t202, 0.0, t680 );
    const double t693 = piecewise_functor_3( t202, 0.0, -0.105e1 * t471 * t689 * t207 );
    const double t694 = piecewise_functor_3( t183, t688, t693 );
    const double t695 = t8 * t694;
    const double t696 = t161 * t166;
    const double t698 = 0.5e1 / 0.9e1 * t696 * t678;
    const double t699 = piecewise_functor_3( t189, t698, 0.0 );
    const double t704 = -0.64e0 * t699 * t192 - 0.64e0 * t464 * t699;
    const double t705 = t704 * t195;
    const double t706 = piecewise_functor_3( t188, 0.0, t705 );
    const double t707 = piecewise_functor_3( t202, 0.0, t698 );
    const double t711 = piecewise_functor_3( t202, 0.0, -0.105e1 * t471 * t707 * t207 );
    const double t712 = piecewise_functor_3( t183, t706, t711 );
    const double t713 = t8 * t712;


    eps = -t34 + t90 + t92 + t147 + t248;
    vrho_a = t8 * t518 + t147 + t248 - t34 + t90 + t92;
    vrho_b = t8 * t618 + t147 + t248 - t34 + t90 + t92;
    vsigma_aa = t8 * ( t627 + t645 + t654 );
    vsigma_ab = t8 * ( t656 + t672 + t675 );
    vsigma_bb = vsigma_aa;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t695 * t247;
    vtau_b = t713 * t247;

  }


};

struct BuiltinSCAN_C : detail::BuiltinKernelImpl< BuiltinSCAN_C > {

  BuiltinSCAN_C( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinSCAN_C >(p) { }
  
  virtual ~BuiltinSCAN_C() = default;

};



} // namespace ExchCXX
