#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinTPSS_X > :
  public mgga_screening_interface< BuiltinTPSS_X > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;
  static constexpr bool is_epc  = false;

  static constexpr double dens_tol  = 1e-15;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000027e-20;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = false;
  static constexpr double exx_coeff = 0.0;

  static constexpr double b = 0.40;
  static constexpr double c = 1.59096;
  static constexpr double e = 1.537;
  static constexpr double kappa = 0.804;
  static constexpr double mu = 0.21951;
  static constexpr double BLOC_a = 2.0;
  static constexpr double BLOC_b = 0.0;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t46 = constants::m_cbrt_6;
    constexpr double t48 = constants::m_pi_sq;
    constexpr double t49 = constants::m_cbrt_pi_sq;
    constexpr double t53 = constants::m_cbrt_2;
    constexpr double t7 = t4 / t5;
    constexpr double t50 = t49 * t49;
    constexpr double t51 = 0.1e1 / t50;
    constexpr double t54 = t53 * t53;
    constexpr double t73 = t46 * t51;
    constexpr double t88 = t46 * t46;
    constexpr double t90 = 0.1e1 / t49 / t48;
    constexpr double t91 = t88 * t90;
    constexpr double t105 = 0.1e1 / kappa * t88;
    constexpr double t106 = t105 * t90;
    constexpr double t114 = e * mu;
    constexpr double t115 = t48 * t48;
    constexpr double t116 = 0.1e1 / t115;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t21 = 0.1e1 / rho;
    const double t23 = 0.1e1 / tau;
    const double t25 = sigma * t21 * t23 / 0.8e1;
    const double t26 = BLOC_b * sigma;
    const double t30 = BLOC_a + t26 * t21 * t23 / 0.8e1;
    const double t31 = safe_math::pow( t25, t30 );
    const double t32 = c * t31;
    const double t33 = sigma * sigma;
    const double t34 = rho * rho;
    const double t35 = 0.1e1 / t34;
    const double t36 = t33 * t35;
    const double t37 = tau * tau;
    const double t38 = 0.1e1 / t37;
    const double t39 = t36 * t38;
    const double t41 = 0.1e1 + t39 / 0.64e2;
    const double t42 = t41 * t41;
    const double t43 = 0.1e1 / t42;
    const double t47 = ( 0.1e2 / 0.81e2 + t32 * t43 ) * t46;
    const double t52 = t47 * t51;
    const double t55 = sigma * t54;
    const double t56 = t19 * t19;
    const double t58 = 0.1e1 / t56 / t34;
    const double t59 = t55 * t58;
    const double t62 = tau * t54;
    const double t64 = 0.1e1 / t56 / rho;
    const double t67 = t62 * t64 - t59 / 0.8e1;
    const double t71 = 0.5e1 / 0.9e1 * t67 * t46 * t51 - 0.1e1;
    const double t72 = b * t67;
    const double t74 = t73 * t71;
    const double t77 = 0.5e1 * t72 * t74 + 0.9e1;
    const double t78 = safe_math::sqrt( t77 );
    const double t79 = 0.1e1 / t78;
    const double t84 = 0.27e2 / 0.2e2 * t71 * t79 + t73 * t59 / 0.36e2;
    const double t85 = t84 * t84;
    const double t92 = t33 * t53;
    const double t93 = t34 * t34;
    const double t94 = t93 * rho;
    const double t96 = 0.1e1 / t19 / t94;
    const double t97 = t92 * t96;
    const double t100 = 0.1e3 * t91 * t97 + 0.162e3 * t39;
    const double t101 = safe_math::sqrt( t100 );
    const double t109 = safe_math::sqrt( e );
    const double t110 = t109 * t33;
    const double t111 = t35 * t38;
    const double t117 = t33 * sigma;
    const double t118 = t116 * t117;
    const double t119 = t93 * t93;
    const double t120 = 0.1e1 / t119;
    const double t124 = t52 * t59 / 0.24e2 + 0.146e3 / 0.2025e4 * t85 - 0.73e2 / 0.972e5 * t84 * t101 + 0.25e2 / 0.472392e6 * t106 * t97 + t110 * t111 / 0.72e3 + t114 * t118 * t120 / 0.576e3;
    const double t125 = t109 * t46;
    const double t129 = 0.1e1 + t125 * t51 * t59 / 0.24e2;
    const double t130 = t129 * t129;
    const double t131 = 0.1e1 / t130;
    const double t133 = t124 * t131 + kappa;
    const double t138 = 0.1e1 + kappa * ( 0.1e1 - kappa / t133 );
    const double t142 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t138 );


    eps = 0.2e1 * t142;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t46 = constants::m_cbrt_6;
    constexpr double t48 = constants::m_pi_sq;
    constexpr double t49 = constants::m_cbrt_pi_sq;
    constexpr double t53 = constants::m_cbrt_2;
    constexpr double t7 = t4 / t5;
    constexpr double t50 = t49 * t49;
    constexpr double t51 = 0.1e1 / t50;
    constexpr double t54 = t53 * t53;
    constexpr double t73 = t46 * t51;
    constexpr double t88 = t46 * t46;
    constexpr double t90 = 0.1e1 / t49 / t48;
    constexpr double t91 = t88 * t90;
    constexpr double t105 = 0.1e1 / kappa * t88;
    constexpr double t106 = t105 * t90;
    constexpr double t114 = e * mu;
    constexpr double t115 = t48 * t48;
    constexpr double t116 = 0.1e1 / t115;
    constexpr double t149 = kappa * kappa;
    constexpr double t268 = t51 * t54;
    constexpr double t276 = b * t54;
    constexpr double t281 = t90 * t54;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t21 = 0.1e1 / rho;
    const double t23 = 0.1e1 / tau;
    const double t25 = sigma * t21 * t23 / 0.8e1;
    const double t26 = BLOC_b * sigma;
    const double t30 = BLOC_a + t26 * t21 * t23 / 0.8e1;
    const double t31 = safe_math::pow( t25, t30 );
    const double t32 = c * t31;
    const double t33 = sigma * sigma;
    const double t34 = rho * rho;
    const double t35 = 0.1e1 / t34;
    const double t36 = t33 * t35;
    const double t37 = tau * tau;
    const double t38 = 0.1e1 / t37;
    const double t39 = t36 * t38;
    const double t41 = 0.1e1 + t39 / 0.64e2;
    const double t42 = t41 * t41;
    const double t43 = 0.1e1 / t42;
    const double t47 = ( 0.1e2 / 0.81e2 + t32 * t43 ) * t46;
    const double t52 = t47 * t51;
    const double t55 = sigma * t54;
    const double t56 = t19 * t19;
    const double t58 = 0.1e1 / t56 / t34;
    const double t59 = t55 * t58;
    const double t62 = tau * t54;
    const double t64 = 0.1e1 / t56 / rho;
    const double t67 = t62 * t64 - t59 / 0.8e1;
    const double t71 = 0.5e1 / 0.9e1 * t67 * t46 * t51 - 0.1e1;
    const double t72 = b * t67;
    const double t74 = t73 * t71;
    const double t77 = 0.5e1 * t72 * t74 + 0.9e1;
    const double t78 = safe_math::sqrt( t77 );
    const double t79 = 0.1e1 / t78;
    const double t84 = 0.27e2 / 0.2e2 * t71 * t79 + t73 * t59 / 0.36e2;
    const double t85 = t84 * t84;
    const double t92 = t33 * t53;
    const double t93 = t34 * t34;
    const double t94 = t93 * rho;
    const double t96 = 0.1e1 / t19 / t94;
    const double t97 = t92 * t96;
    const double t100 = 0.1e3 * t91 * t97 + 0.162e3 * t39;
    const double t101 = safe_math::sqrt( t100 );
    const double t109 = safe_math::sqrt( e );
    const double t110 = t109 * t33;
    const double t111 = t35 * t38;
    const double t117 = t33 * sigma;
    const double t118 = t116 * t117;
    const double t119 = t93 * t93;
    const double t120 = 0.1e1 / t119;
    const double t124 = t52 * t59 / 0.24e2 + 0.146e3 / 0.2025e4 * t85 - 0.73e2 / 0.972e5 * t84 * t101 + 0.25e2 / 0.472392e6 * t106 * t97 + t110 * t111 / 0.72e3 + t114 * t118 * t120 / 0.576e3;
    const double t125 = t109 * t46;
    const double t129 = 0.1e1 + t125 * t51 * t59 / 0.24e2;
    const double t130 = t129 * t129;
    const double t131 = 0.1e1 / t130;
    const double t133 = t124 * t131 + kappa;
    const double t138 = 0.1e1 + kappa * ( 0.1e1 - kappa / t133 );
    const double t142 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t138 );
    const double t143 = 0.1e1 / t56;
    const double t144 = t18 * t143;
    const double t148 = t7 * t18;
    const double t150 = t19 * t149;
    const double t151 = t133 * t133;
    const double t152 = 0.1e1 / t151;
    const double t153 = t35 * t23;
    const double t154 = safe_math::log( t25 );
    const double t159 = -t26 * t153 * t154 / 0.8e1 - t30 * t21;
    const double t160 = t159 * t43;
    const double t163 = 0.1e1 / t42 / t41;
    const double t164 = t32 * t163;
    const double t165 = t34 * rho;
    const double t166 = 0.1e1 / t165;
    const double t167 = t33 * t166;
    const double t168 = t167 * t38;
    const double t172 = ( t32 * t160 + t164 * t168 / 0.16e2 ) * t46;
    const double t173 = t172 * t51;
    const double t177 = 0.1e1 / t56 / t165;
    const double t178 = t55 * t177;
    const double t184 = -0.5e1 / 0.3e1 * t62 * t58 + t178 / 0.3e1;
    const double t185 = t184 * t46;
    const double t186 = t51 * t79;
    const double t190 = 0.1e1 / t78 / t77;
    const double t191 = t71 * t190;
    const double t195 = t91 * t184;
    const double t198 = 0.5e1 * b * t184 * t74 + 0.25e2 / 0.9e1 * t72 * t195;
    const double t203 = 0.3e1 / 0.4e1 * t185 * t186 - 0.27e2 / 0.4e2 * t191 * t198 - 0.2e1 / 0.27e2 * t73 * t178;
    const double t208 = 0.1e1 / t101;
    const double t209 = t84 * t208;
    const double t211 = t93 * t34;
    const double t213 = 0.1e1 / t19 / t211;
    const double t214 = t92 * t213;
    const double t217 = -0.324e3 * t168 - 0.16e4 / 0.3e1 * t91 * t214;
    const double t222 = t166 * t38;
    const double t225 = t119 * rho;
    const double t226 = 0.1e1 / t225;
    const double t230 = t173 * t59 / 0.24e2 - t52 * t178 / 0.9e1 + 0.292e3 / 0.2025e4 * t84 * t203 - 0.73e2 / 0.972e5 * t203 * t101 - 0.73e2 / 0.1944e6 * t209 * t217 - 0.5e2 / 0.177147e6 * t106 * t214 - t110 * t222 / 0.36e3 - t114 * t118 * t226 / 0.72e2;
    const double t232 = t130 * t129;
    const double t233 = 0.1e1 / t232;
    const double t234 = t124 * t233;
    const double t235 = t234 * t125;
    const double t236 = t51 * sigma;
    const double t237 = t54 * t177;
    const double t238 = t236 * t237;
    const double t241 = t230 * t131 + 0.2e1 / 0.9e1 * t235 * t238;
    const double t242 = t152 * t241;
    const double t247 = piecewise_functor_3( t3, 0.0, -t7 * t144 * t138 / 0.8e1 - 0.3e1 / 0.8e1 * t148 * t150 * t242 );
    const double t250 = BLOC_b * t21;
    const double t251 = t23 * t154;
    const double t254 = 0.1e1 / sigma;
    const double t256 = t250 * t251 / 0.8e1 + t30 * t254;
    const double t257 = t256 * t43;
    const double t258 = t32 * t257;
    const double t259 = sigma * t35;
    const double t260 = t259 * t38;
    const double t264 = ( t258 - t164 * t260 / 0.16e2 ) * t46;
    const double t265 = t264 * t51;
    const double t269 = t268 * t58;
    const double t272 = t54 * t58;
    const double t273 = t73 * t79;
    const double t274 = t272 * t273;
    const double t277 = t276 * t58;
    const double t278 = t277 * t74;
    const double t280 = t72 * t88;
    const double t283 = t280 * t281 * t58;
    const double t285 = -0.5e1 / 0.8e1 * t278 - 0.25e2 / 0.72e2 * t283;
    const double t288 = t272 * t73;
    const double t290 = -0.3e1 / 0.32e2 * t274 - 0.27e2 / 0.4e2 * t191 * t285 + t288 / 0.36e2;
    const double t296 = sigma * t53;
    const double t297 = t296 * t96;
    const double t300 = 0.2e3 * t91 * t297 + 0.324e3 * t260;
    const double t305 = t109 * sigma;
    const double t308 = t116 * t33;
    const double t312 = t265 * t59 / 0.24e2 + t47 * t269 / 0.24e2 + 0.292e3 / 0.2025e4 * t84 * t290 - 0.73e2 / 0.972e5 * t290 * t101 - 0.73e2 / 0.1944e6 * t209 * t300 + 0.25e2 / 0.236196e6 * t106 * t297 + t305 * t111 / 0.36e3 + t114 * t308 * t120 / 0.192e3;
    const double t314 = t234 * t109;
    const double t317 = t312 * t131 - t314 * t288 / 0.12e2;
    const double t318 = t152 * t317;
    const double t322 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t148 * t150 * t318 );
    const double t324 = t7 * t20;
    const double t325 = t149 * t152;
    const double t326 = t21 * t38;
    const double t331 = -t26 * t326 * t154 / 0.8e1 - t30 * t23;
    const double t332 = t331 * t43;
    const double t333 = t32 * t332;
    const double t334 = t37 * tau;
    const double t335 = 0.1e1 / t334;
    const double t336 = t36 * t335;
    const double t340 = ( t333 + t164 * t336 / 0.16e2 ) * t46;
    const double t341 = t340 * t51;
    const double t344 = t54 * t64;
    const double t347 = t276 * t64;
    const double t353 = 0.5e1 * t347 * t74 + 0.25e2 / 0.9e1 * t280 * t281 * t64;
    const double t356 = 0.3e1 / 0.4e1 * t344 * t273 - 0.27e2 / 0.4e2 * t191 * t353;
    const double t363 = t35 * t335;
    const double t366 = t341 * t59 / 0.24e2 + 0.292e3 / 0.2025e4 * t84 * t356 - 0.73e2 / 0.972e5 * t356 * t101 + 0.73e2 / 0.6e3 * t209 * t336 - t110 * t363 / 0.36e3;
    const double t367 = t366 * t131;
    const double t368 = t325 * t367;
    const double t371 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t324 * t368 );


    eps = 0.2e1 * t142;
    vrho = 0.2e1 * rho * t247 + 0.2e1 * t142;
    vsigma = 0.2e1 * rho * t322;
    vlapl = 0.e0;
    vtau = 0.2e1 * rho * t371;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t54 = constants::m_cbrt_6;
    constexpr double t56 = constants::m_pi_sq;
    constexpr double t57 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t58 = t57 * t57;
    constexpr double t59 = 0.1e1 / t58;
    constexpr double t79 = t54 * t59;
    constexpr double t94 = t54 * t54;
    constexpr double t96 = 0.1e1 / t57 / t56;
    constexpr double t97 = t94 * t96;
    constexpr double t110 = 0.1e1 / kappa * t94;
    constexpr double t120 = e * mu;
    constexpr double t121 = t56 * t56;
    constexpr double t122 = 0.1e1 / t121;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t29 = 0.1e1 / rho_a;
    const double t31 = 0.1e1 / tau_a;
    const double t33 = sigma_aa * t29 * t31 / 0.8e1;
    const double t34 = BLOC_b * sigma_aa;
    const double t38 = BLOC_a + t34 * t29 * t31 / 0.8e1;
    const double t39 = safe_math::pow( t33, t38 );
    const double t40 = c * t39;
    const double t41 = sigma_aa * sigma_aa;
    const double t42 = rho_a * rho_a;
    const double t43 = 0.1e1 / t42;
    const double t44 = t41 * t43;
    const double t45 = tau_a * tau_a;
    const double t46 = 0.1e1 / t45;
    const double t47 = t44 * t46;
    const double t49 = 0.1e1 + t47 / 0.64e2;
    const double t50 = t49 * t49;
    const double t51 = 0.1e1 / t50;
    const double t55 = ( 0.1e2 / 0.81e2 + t40 * t51 ) * t54;
    const double t60 = t59 * sigma_aa;
    const double t61 = safe_math::cbrt( rho_a );
    const double t62 = t61 * t61;
    const double t64 = 0.1e1 / t62 / t42;
    const double t65 = t60 * t64;
    const double t69 = 0.1e1 / t62 / rho_a;
    const double t71 = sigma_aa * t64;
    const double t73 = tau_a * t69 - t71 / 0.8e1;
    const double t77 = 0.5e1 / 0.9e1 * t73 * t54 * t59 - 0.1e1;
    const double t78 = b * t73;
    const double t80 = t79 * t77;
    const double t83 = 0.5e1 * t78 * t80 + 0.9e1;
    const double t84 = safe_math::sqrt( t83 );
    const double t85 = 0.1e1 / t84;
    const double t90 = 0.27e2 / 0.2e2 * t77 * t85 + t79 * t71 / 0.36e2;
    const double t91 = t90 * t90;
    const double t98 = t42 * t42;
    const double t99 = t98 * rho_a;
    const double t101 = 0.1e1 / t61 / t99;
    const double t105 = 0.5e2 * t97 * t41 * t101 + 0.162e3 * t47;
    const double t106 = safe_math::sqrt( t105 );
    const double t111 = t96 * t41;
    const double t115 = safe_math::sqrt( e );
    const double t116 = t115 * t41;
    const double t117 = t43 * t46;
    const double t123 = t41 * sigma_aa;
    const double t124 = t122 * t123;
    const double t125 = t98 * t98;
    const double t126 = 0.1e1 / t125;
    const double t130 = t55 * t65 / 0.24e2 + 0.146e3 / 0.2025e4 * t91 - 0.73e2 / 0.972e5 * t90 * t106 + 0.25e2 / 0.944784e6 * t110 * t111 * t101 + t116 * t117 / 0.72e3 + t120 * t124 * t126 / 0.2304e4;
    const double t131 = t115 * t54;
    const double t134 = 0.1e1 + t131 * t65 / 0.24e2;
    const double t135 = t134 * t134;
    const double t136 = 0.1e1 / t135;
    const double t138 = t130 * t136 + kappa;
    const double t143 = 0.1e1 + kappa * ( 0.1e1 - kappa / t138 );
    const double t147 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t143 );
    const double t148 = rho_b <= dens_tol;
    const double t149 = -t17;
    const double t151 = piecewise_functor_5( t15, t12, t11, t16, t149 * t8 );
    const double t152 = 0.1e1 + t151;
    const double t153 = t152 <= zeta_tol;
    const double t154 = safe_math::cbrt( t152 );
    const double t156 = piecewise_functor_3( t153, t23, t154 * t152 );
    const double t157 = t156 * t27;
    const double t158 = 0.1e1 / rho_b;
    const double t160 = 0.1e1 / tau_b;
    const double t162 = sigma_bb * t158 * t160 / 0.8e1;
    const double t163 = BLOC_b * sigma_bb;
    const double t167 = BLOC_a + t163 * t158 * t160 / 0.8e1;
    const double t168 = safe_math::pow( t162, t167 );
    const double t169 = c * t168;
    const double t170 = sigma_bb * sigma_bb;
    const double t171 = rho_b * rho_b;
    const double t172 = 0.1e1 / t171;
    const double t173 = t170 * t172;
    const double t174 = tau_b * tau_b;
    const double t175 = 0.1e1 / t174;
    const double t176 = t173 * t175;
    const double t178 = 0.1e1 + t176 / 0.64e2;
    const double t179 = t178 * t178;
    const double t180 = 0.1e1 / t179;
    const double t183 = ( 0.1e2 / 0.81e2 + t169 * t180 ) * t54;
    const double t184 = t59 * sigma_bb;
    const double t185 = safe_math::cbrt( rho_b );
    const double t186 = t185 * t185;
    const double t188 = 0.1e1 / t186 / t171;
    const double t189 = t184 * t188;
    const double t193 = 0.1e1 / t186 / rho_b;
    const double t195 = sigma_bb * t188;
    const double t197 = tau_b * t193 - t195 / 0.8e1;
    const double t201 = 0.5e1 / 0.9e1 * t197 * t54 * t59 - 0.1e1;
    const double t202 = b * t197;
    const double t203 = t79 * t201;
    const double t206 = 0.5e1 * t202 * t203 + 0.9e1;
    const double t207 = safe_math::sqrt( t206 );
    const double t208 = 0.1e1 / t207;
    const double t213 = 0.27e2 / 0.2e2 * t201 * t208 + t79 * t195 / 0.36e2;
    const double t214 = t213 * t213;
    const double t217 = t171 * t171;
    const double t218 = t217 * rho_b;
    const double t220 = 0.1e1 / t185 / t218;
    const double t224 = 0.5e2 * t97 * t170 * t220 + 0.162e3 * t176;
    const double t225 = safe_math::sqrt( t224 );
    const double t228 = t96 * t170;
    const double t232 = t115 * t170;
    const double t233 = t172 * t175;
    const double t236 = t170 * sigma_bb;
    const double t237 = t122 * t236;
    const double t238 = t217 * t217;
    const double t239 = 0.1e1 / t238;
    const double t243 = t183 * t189 / 0.24e2 + 0.146e3 / 0.2025e4 * t214 - 0.73e2 / 0.972e5 * t213 * t225 + 0.25e2 / 0.944784e6 * t110 * t228 * t220 + t232 * t233 / 0.72e3 + t120 * t237 * t239 / 0.2304e4;
    const double t246 = 0.1e1 + t131 * t189 / 0.24e2;
    const double t247 = t246 * t246;
    const double t248 = 0.1e1 / t247;
    const double t250 = t243 * t248 + kappa;
    const double t255 = 0.1e1 + kappa * ( 0.1e1 - kappa / t250 );
    const double t259 = piecewise_functor_3( t148, 0.0, -0.3e1 / 0.8e1 * t6 * t157 * t255 );


    eps = t147 + t259;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t54 = constants::m_cbrt_6;
    constexpr double t56 = constants::m_pi_sq;
    constexpr double t57 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t58 = t57 * t57;
    constexpr double t59 = 0.1e1 / t58;
    constexpr double t79 = t54 * t59;
    constexpr double t94 = t54 * t54;
    constexpr double t96 = 0.1e1 / t57 / t56;
    constexpr double t97 = t94 * t96;
    constexpr double t110 = 0.1e1 / kappa * t94;
    constexpr double t120 = e * mu;
    constexpr double t121 = t56 * t56;
    constexpr double t122 = 0.1e1 / t121;
    constexpr double t279 = kappa * kappa;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t29 = 0.1e1 / rho_a;
    const double t31 = 0.1e1 / tau_a;
    const double t33 = sigma_aa * t29 * t31 / 0.8e1;
    const double t34 = BLOC_b * sigma_aa;
    const double t38 = BLOC_a + t34 * t29 * t31 / 0.8e1;
    const double t39 = safe_math::pow( t33, t38 );
    const double t40 = c * t39;
    const double t41 = sigma_aa * sigma_aa;
    const double t42 = rho_a * rho_a;
    const double t43 = 0.1e1 / t42;
    const double t44 = t41 * t43;
    const double t45 = tau_a * tau_a;
    const double t46 = 0.1e1 / t45;
    const double t47 = t44 * t46;
    const double t49 = 0.1e1 + t47 / 0.64e2;
    const double t50 = t49 * t49;
    const double t51 = 0.1e1 / t50;
    const double t55 = ( 0.1e2 / 0.81e2 + t40 * t51 ) * t54;
    const double t60 = t59 * sigma_aa;
    const double t61 = safe_math::cbrt( rho_a );
    const double t62 = t61 * t61;
    const double t64 = 0.1e1 / t62 / t42;
    const double t65 = t60 * t64;
    const double t69 = 0.1e1 / t62 / rho_a;
    const double t71 = sigma_aa * t64;
    const double t73 = tau_a * t69 - t71 / 0.8e1;
    const double t77 = 0.5e1 / 0.9e1 * t73 * t54 * t59 - 0.1e1;
    const double t78 = b * t73;
    const double t80 = t79 * t77;
    const double t83 = 0.5e1 * t78 * t80 + 0.9e1;
    const double t84 = safe_math::sqrt( t83 );
    const double t85 = 0.1e1 / t84;
    const double t90 = 0.27e2 / 0.2e2 * t77 * t85 + t79 * t71 / 0.36e2;
    const double t91 = t90 * t90;
    const double t98 = t42 * t42;
    const double t99 = t98 * rho_a;
    const double t101 = 0.1e1 / t61 / t99;
    const double t105 = 0.5e2 * t97 * t41 * t101 + 0.162e3 * t47;
    const double t106 = safe_math::sqrt( t105 );
    const double t111 = t96 * t41;
    const double t115 = safe_math::sqrt( e );
    const double t116 = t115 * t41;
    const double t117 = t43 * t46;
    const double t123 = t41 * sigma_aa;
    const double t124 = t122 * t123;
    const double t125 = t98 * t98;
    const double t126 = 0.1e1 / t125;
    const double t130 = t55 * t65 / 0.24e2 + 0.146e3 / 0.2025e4 * t91 - 0.73e2 / 0.972e5 * t90 * t106 + 0.25e2 / 0.944784e6 * t110 * t111 * t101 + t116 * t117 / 0.72e3 + t120 * t124 * t126 / 0.2304e4;
    const double t131 = t115 * t54;
    const double t134 = 0.1e1 + t131 * t65 / 0.24e2;
    const double t135 = t134 * t134;
    const double t136 = 0.1e1 / t135;
    const double t138 = t130 * t136 + kappa;
    const double t143 = 0.1e1 + kappa * ( 0.1e1 - kappa / t138 );
    const double t147 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t143 );
    const double t148 = rho_b <= dens_tol;
    const double t149 = -t17;
    const double t151 = piecewise_functor_5( t15, t12, t11, t16, t149 * t8 );
    const double t152 = 0.1e1 + t151;
    const double t153 = t152 <= zeta_tol;
    const double t154 = safe_math::cbrt( t152 );
    const double t156 = piecewise_functor_3( t153, t23, t154 * t152 );
    const double t157 = t156 * t27;
    const double t158 = 0.1e1 / rho_b;
    const double t160 = 0.1e1 / tau_b;
    const double t162 = sigma_bb * t158 * t160 / 0.8e1;
    const double t163 = BLOC_b * sigma_bb;
    const double t167 = BLOC_a + t163 * t158 * t160 / 0.8e1;
    const double t168 = safe_math::pow( t162, t167 );
    const double t169 = c * t168;
    const double t170 = sigma_bb * sigma_bb;
    const double t171 = rho_b * rho_b;
    const double t172 = 0.1e1 / t171;
    const double t173 = t170 * t172;
    const double t174 = tau_b * tau_b;
    const double t175 = 0.1e1 / t174;
    const double t176 = t173 * t175;
    const double t178 = 0.1e1 + t176 / 0.64e2;
    const double t179 = t178 * t178;
    const double t180 = 0.1e1 / t179;
    const double t183 = ( 0.1e2 / 0.81e2 + t169 * t180 ) * t54;
    const double t184 = t59 * sigma_bb;
    const double t185 = safe_math::cbrt( rho_b );
    const double t186 = t185 * t185;
    const double t188 = 0.1e1 / t186 / t171;
    const double t189 = t184 * t188;
    const double t193 = 0.1e1 / t186 / rho_b;
    const double t195 = sigma_bb * t188;
    const double t197 = tau_b * t193 - t195 / 0.8e1;
    const double t201 = 0.5e1 / 0.9e1 * t197 * t54 * t59 - 0.1e1;
    const double t202 = b * t197;
    const double t203 = t79 * t201;
    const double t206 = 0.5e1 * t202 * t203 + 0.9e1;
    const double t207 = safe_math::sqrt( t206 );
    const double t208 = 0.1e1 / t207;
    const double t213 = 0.27e2 / 0.2e2 * t201 * t208 + t79 * t195 / 0.36e2;
    const double t214 = t213 * t213;
    const double t217 = t171 * t171;
    const double t218 = t217 * rho_b;
    const double t220 = 0.1e1 / t185 / t218;
    const double t224 = 0.5e2 * t97 * t170 * t220 + 0.162e3 * t176;
    const double t225 = safe_math::sqrt( t224 );
    const double t228 = t96 * t170;
    const double t232 = t115 * t170;
    const double t233 = t172 * t175;
    const double t236 = t170 * sigma_bb;
    const double t237 = t122 * t236;
    const double t238 = t217 * t217;
    const double t239 = 0.1e1 / t238;
    const double t243 = t183 * t189 / 0.24e2 + 0.146e3 / 0.2025e4 * t214 - 0.73e2 / 0.972e5 * t213 * t225 + 0.25e2 / 0.944784e6 * t110 * t228 * t220 + t232 * t233 / 0.72e3 + t120 * t237 * t239 / 0.2304e4;
    const double t246 = 0.1e1 + t131 * t189 / 0.24e2;
    const double t247 = t246 * t246;
    const double t248 = 0.1e1 / t247;
    const double t250 = t243 * t248 + kappa;
    const double t255 = 0.1e1 + kappa * ( 0.1e1 - kappa / t250 );
    const double t259 = piecewise_functor_3( t148, 0.0, -0.3e1 / 0.8e1 * t6 * t157 * t255 );
    const double t260 = t7 * t7;
    const double t261 = 0.1e1 / t260;
    const double t262 = t17 * t261;
    const double t264 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t262 );
    const double t267 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t264 );
    const double t268 = t267 * t27;
    const double t272 = t27 * t27;
    const double t273 = 0.1e1 / t272;
    const double t274 = t26 * t273;
    const double t277 = t6 * t274 * t143 / 0.8e1;
    const double t278 = t6 * t26;
    const double t280 = t27 * t279;
    const double t281 = t138 * t138;
    const double t282 = 0.1e1 / t281;
    const double t283 = t43 * t31;
    const double t284 = safe_math::log( t33 );
    const double t289 = -t34 * t283 * t284 / 0.8e1 - t38 * t29;
    const double t290 = t289 * t51;
    const double t293 = 0.1e1 / t50 / t49;
    const double t294 = t40 * t293;
    const double t295 = t42 * rho_a;
    const double t296 = 0.1e1 / t295;
    const double t297 = t41 * t296;
    const double t298 = t297 * t46;
    const double t302 = ( t40 * t290 + t294 * t298 / 0.16e2 ) * t54;
    const double t306 = 0.1e1 / t62 / t295;
    const double t307 = t60 * t306;
    const double t312 = sigma_aa * t306;
    const double t314 = -0.5e1 / 0.3e1 * tau_a * t64 + t312 / 0.3e1;
    const double t315 = t314 * t54;
    const double t316 = t59 * t85;
    const double t320 = 0.1e1 / t84 / t83;
    const double t321 = t77 * t320;
    const double t325 = t97 * t314;
    const double t328 = 0.5e1 * b * t314 * t80 + 0.25e2 / 0.9e1 * t78 * t325;
    const double t331 = t79 * t312;
    const double t333 = 0.3e1 / 0.4e1 * t315 * t316 - 0.27e2 / 0.4e2 * t321 * t328 - 0.2e1 / 0.27e2 * t331;
    const double t338 = 0.1e1 / t106;
    const double t339 = t90 * t338;
    const double t341 = t98 * t42;
    const double t343 = 0.1e1 / t61 / t341;
    const double t347 = -0.324e3 * t298 - 0.8e3 / 0.3e1 * t97 * t41 * t343;
    const double t353 = t296 * t46;
    const double t356 = t125 * rho_a;
    const double t357 = 0.1e1 / t356;
    const double t361 = t302 * t65 / 0.24e2 - t55 * t307 / 0.9e1 + 0.292e3 / 0.2025e4 * t90 * t333 - 0.73e2 / 0.972e5 * t333 * t106 - 0.73e2 / 0.1944e6 * t339 * t347 - 0.25e2 / 0.177147e6 * t110 * t111 * t343 - t116 * t353 / 0.36e3 - t120 * t124 * t357 / 0.288e3;
    const double t363 = t135 * t134;
    const double t364 = 0.1e1 / t363;
    const double t366 = t130 * t364 * t115;
    const double t369 = t361 * t136 + 0.2e1 / 0.9e1 * t366 * t331;
    const double t370 = t282 * t369;
    const double t371 = t280 * t370;
    const double t375 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t268 * t143 - t277 - 0.3e1 / 0.8e1 * t278 * t371 );
    const double t376 = t149 * t261;
    const double t378 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t376 );
    const double t381 = piecewise_functor_3( t153, 0.0, 0.4e1 / 0.3e1 * t154 * t378 );
    const double t382 = t381 * t27;
    const double t386 = t156 * t273;
    const double t389 = t6 * t386 * t255 / 0.8e1;
    const double t391 = piecewise_functor_3( t148, 0.0, -0.3e1 / 0.8e1 * t6 * t382 * t255 - t389 );
    const double t395 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t262 );
    const double t398 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t395 );
    const double t399 = t398 * t27;
    const double t404 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t399 * t143 - t277 );
    const double t406 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t376 );
    const double t409 = piecewise_functor_3( t153, 0.0, 0.4e1 / 0.3e1 * t154 * t406 );
    const double t410 = t409 * t27;
    const double t414 = t6 * t156;
    const double t415 = t250 * t250;
    const double t416 = 0.1e1 / t415;
    const double t417 = t172 * t160;
    const double t418 = safe_math::log( t162 );
    const double t423 = -t163 * t417 * t418 / 0.8e1 - t167 * t158;
    const double t424 = t423 * t180;
    const double t427 = 0.1e1 / t179 / t178;
    const double t428 = t169 * t427;
    const double t429 = t171 * rho_b;
    const double t430 = 0.1e1 / t429;
    const double t431 = t170 * t430;
    const double t432 = t431 * t175;
    const double t436 = ( t169 * t424 + t428 * t432 / 0.16e2 ) * t54;
    const double t440 = 0.1e1 / t186 / t429;
    const double t441 = t184 * t440;
    const double t446 = sigma_bb * t440;
    const double t448 = -0.5e1 / 0.3e1 * tau_b * t188 + t446 / 0.3e1;
    const double t449 = t448 * t54;
    const double t450 = t59 * t208;
    const double t454 = 0.1e1 / t207 / t206;
    const double t455 = t201 * t454;
    const double t459 = t97 * t448;
    const double t462 = 0.5e1 * b * t448 * t203 + 0.25e2 / 0.9e1 * t202 * t459;
    const double t465 = t79 * t446;
    const double t467 = 0.3e1 / 0.4e1 * t449 * t450 - 0.27e2 / 0.4e2 * t455 * t462 - 0.2e1 / 0.27e2 * t465;
    const double t472 = 0.1e1 / t225;
    const double t473 = t213 * t472;
    const double t475 = t217 * t171;
    const double t477 = 0.1e1 / t185 / t475;
    const double t481 = -0.324e3 * t432 - 0.8e3 / 0.3e1 * t97 * t170 * t477;
    const double t487 = t430 * t175;
    const double t490 = t238 * rho_b;
    const double t491 = 0.1e1 / t490;
    const double t495 = t436 * t189 / 0.24e2 - t183 * t441 / 0.9e1 + 0.292e3 / 0.2025e4 * t213 * t467 - 0.73e2 / 0.972e5 * t467 * t225 - 0.73e2 / 0.1944e6 * t473 * t481 - 0.25e2 / 0.177147e6 * t110 * t228 * t477 - t232 * t487 / 0.36e3 - t120 * t237 * t491 / 0.288e3;
    const double t497 = t247 * t246;
    const double t498 = 0.1e1 / t497;
    const double t500 = t243 * t498 * t115;
    const double t503 = t495 * t248 + 0.2e1 / 0.9e1 * t500 * t465;
    const double t504 = t416 * t503;
    const double t505 = t280 * t504;
    const double t509 = piecewise_functor_3( t148, 0.0, -0.3e1 / 0.8e1 * t6 * t410 * t255 - t389 - 0.3e1 / 0.8e1 * t414 * t505 );
    const double t512 = BLOC_b * t29;
    const double t513 = t31 * t284;
    const double t516 = 0.1e1 / sigma_aa;
    const double t518 = t512 * t513 / 0.8e1 + t38 * t516;
    const double t519 = t518 * t51;
    const double t520 = t40 * t519;
    const double t521 = sigma_aa * t43;
    const double t522 = t521 * t46;
    const double t526 = ( t520 - t294 * t522 / 0.16e2 ) * t54;
    const double t529 = t59 * t64;
    const double t532 = t64 * t54;
    const double t533 = t532 * t316;
    const double t535 = b * t64;
    const double t536 = t535 * t80;
    const double t539 = t78 * t97 * t64;
    const double t541 = -0.5e1 / 0.8e1 * t536 - 0.25e2 / 0.72e2 * t539;
    const double t544 = t532 * t59;
    const double t546 = -0.3e1 / 0.32e2 * t533 - 0.27e2 / 0.4e2 * t321 * t541 + t544 / 0.36e2;
    const double t555 = 0.1e3 * t97 * sigma_aa * t101 + 0.324e3 * t522;
    const double t558 = t96 * sigma_aa;
    const double t562 = t115 * sigma_aa;
    const double t565 = t122 * t41;
    const double t569 = t526 * t65 / 0.24e2 + t55 * t529 / 0.24e2 + 0.292e3 / 0.2025e4 * t90 * t546 - 0.73e2 / 0.972e5 * t546 * t106 - 0.73e2 / 0.1944e6 * t339 * t555 + 0.25e2 / 0.472392e6 * t110 * t558 * t101 + t562 * t117 / 0.36e3 + t120 * t565 * t126 / 0.768e3;
    const double t573 = t569 * t136 - t366 * t544 / 0.12e2;
    const double t574 = t282 * t573;
    const double t575 = t280 * t574;
    const double t578 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t278 * t575 );
    const double t579 = BLOC_b * t158;
    const double t580 = t160 * t418;
    const double t583 = 0.1e1 / sigma_bb;
    const double t585 = t579 * t580 / 0.8e1 + t167 * t583;
    const double t586 = t585 * t180;
    const double t587 = t169 * t586;
    const double t588 = sigma_bb * t172;
    const double t589 = t588 * t175;
    const double t593 = ( t587 - t428 * t589 / 0.16e2 ) * t54;
    const double t596 = t59 * t188;
    const double t599 = t188 * t54;
    const double t600 = t599 * t450;
    const double t602 = b * t188;
    const double t603 = t602 * t203;
    const double t606 = t202 * t97 * t188;
    const double t608 = -0.5e1 / 0.8e1 * t603 - 0.25e2 / 0.72e2 * t606;
    const double t611 = t599 * t59;
    const double t613 = -0.3e1 / 0.32e2 * t600 - 0.27e2 / 0.4e2 * t455 * t608 + t611 / 0.36e2;
    const double t622 = 0.1e3 * t97 * sigma_bb * t220 + 0.324e3 * t589;
    const double t625 = t96 * sigma_bb;
    const double t629 = t115 * sigma_bb;
    const double t632 = t122 * t170;
    const double t636 = t593 * t189 / 0.24e2 + t183 * t596 / 0.24e2 + 0.292e3 / 0.2025e4 * t213 * t613 - 0.73e2 / 0.972e5 * t613 * t225 - 0.73e2 / 0.1944e6 * t473 * t622 + 0.25e2 / 0.472392e6 * t110 * t625 * t220 + t629 * t233 / 0.36e3 + t120 * t632 * t239 / 0.768e3;
    const double t640 = t636 * t248 - t500 * t611 / 0.12e2;
    const double t641 = t416 * t640;
    const double t642 = t280 * t641;
    const double t645 = piecewise_functor_3( t148, 0.0, -0.3e1 / 0.8e1 * t414 * t642 );
    const double t646 = t6 * t28;
    const double t647 = t279 * t282;
    const double t648 = t29 * t46;
    const double t653 = -t34 * t648 * t284 / 0.8e1 - t38 * t31;
    const double t654 = t653 * t51;
    const double t655 = t40 * t654;
    const double t656 = t45 * tau_a;
    const double t657 = 0.1e1 / t656;
    const double t658 = t44 * t657;
    const double t662 = ( t655 + t294 * t658 / 0.16e2 ) * t54;
    const double t665 = t69 * t54;
    const double t668 = b * t69;
    const double t674 = 0.5e1 * t668 * t80 + 0.25e2 / 0.9e1 * t78 * t97 * t69;
    const double t677 = 0.3e1 / 0.4e1 * t665 * t316 - 0.27e2 / 0.4e2 * t321 * t674;
    const double t684 = t43 * t657;
    const double t687 = t662 * t65 / 0.24e2 + 0.292e3 / 0.2025e4 * t90 * t677 - 0.73e2 / 0.972e5 * t677 * t106 + 0.73e2 / 0.6e3 * t339 * t658 - t116 * t684 / 0.36e3;
    const double t688 = t687 * t136;
    const double t689 = t647 * t688;
    const double t692 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t646 * t689 );
    const double t693 = t6 * t157;
    const double t694 = t279 * t416;
    const double t695 = t158 * t175;
    const double t700 = -t163 * t695 * t418 / 0.8e1 - t167 * t160;
    const double t701 = t700 * t180;
    const double t702 = t169 * t701;
    const double t703 = t174 * tau_b;
    const double t704 = 0.1e1 / t703;
    const double t705 = t173 * t704;
    const double t709 = ( t702 + t428 * t705 / 0.16e2 ) * t54;
    const double t712 = t193 * t54;
    const double t715 = b * t193;
    const double t721 = 0.5e1 * t715 * t203 + 0.25e2 / 0.9e1 * t202 * t97 * t193;
    const double t724 = 0.3e1 / 0.4e1 * t712 * t450 - 0.27e2 / 0.4e2 * t455 * t721;
    const double t731 = t172 * t704;
    const double t734 = t709 * t189 / 0.24e2 + 0.292e3 / 0.2025e4 * t213 * t724 - 0.73e2 / 0.972e5 * t724 * t225 + 0.73e2 / 0.6e3 * t473 * t705 - t232 * t731 / 0.36e3;
    const double t735 = t734 * t248;
    const double t736 = t694 * t735;
    const double t739 = piecewise_functor_3( t148, 0.0, -0.3e1 / 0.8e1 * t693 * t736 );


    eps = t147 + t259;
    vrho_a = t147 + t259 + t7 * ( t375 + t391 );
    vrho_b = t147 + t259 + t7 * ( t404 + t509 );
    vsigma_aa = t7 * t578;
    vsigma_ab = 0.e0;
    vsigma_bb = t7 * t645;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t7 * t692;
    vtau_b = t7 * t739;

  }


};

struct BuiltinTPSS_X : detail::BuiltinKernelImpl< BuiltinTPSS_X > {

  BuiltinTPSS_X( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinTPSS_X >(p) { }
  
  virtual ~BuiltinTPSS_X() = default;

};



} // namespace ExchCXX