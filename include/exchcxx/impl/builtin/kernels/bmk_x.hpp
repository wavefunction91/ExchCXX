/**
 * ExchCXX 
 *
 * Copyright (c) Microsoft Corporation.
 *
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * (1) Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 * 
 * (2) Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 * 
 * (3) Neither the name of the University of California, Lawrence Berkeley
 * National Laboratory, U.S. Dept. of Energy nor the names of its contributors
 * may be used to endorse or promote products derived from this software
 * without specific prior written permission.
 * 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 * 
 * You are under no obligation whatsoever to provide any bug fixes, patches,
 * or upgrades to the features, functionality or performance of the source
 * code ("Enhancements") to anyone; however, if you choose to make your
 * Enhancements available either publicly, or directly to Lawrence Berkeley
 * National Laboratory, without imposing a separate written license agreement
 * for such Enhancements, then you hereby grant the following license: a
 * non-exclusive, royalty-free perpetual license to install, use, modify,
 * prepare derivative works, incorporate into other computer software,
 * distribute, and sublicense such enhancements or derivative works thereof,
 * in binary and source code form.
 */


#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinBMK_X > :
  public mgga_screening_interface< BuiltinBMK_X > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;
  static constexpr bool is_epc  = false;

  static constexpr double dens_tol  = 1e-15;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 1.0000000000000027e-20;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;


  static constexpr double cx_local_0 = 0.474302;
  static constexpr double cx_local_1 = 2.77701;
  static constexpr double cx_local_2 = -11.4230;
  static constexpr double cx_local_3 = 11.7167;
  static constexpr double cx_nlocal_0 = -0.192212;
  static constexpr double cx_nlocal_1 = 4.73936;
  static constexpr double cx_nlocal_2 = -26.6188;
  static constexpr double cx_nlocal_3 = 22.4891;
  static constexpr double ax = 0.42;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t24 = constants::m_cbrt_2;
    constexpr double t76 = constants::m_cbrt_6;
    constexpr double t79 = constants::m_cbrt_pi_sq;
    constexpr double t7 = t4 / t5;
    constexpr double t22 = cx_local_1;
    constexpr double t25 = t24 * t24;
    constexpr double t39 = cx_local_2;
    constexpr double t52 = cx_local_3;
    constexpr double t63 = cx_nlocal_1;
    constexpr double t67 = cx_nlocal_2;
    constexpr double t71 = cx_nlocal_3;
    constexpr double t77 = t76 * t76;
    constexpr double t80 = t79 * t79;
    constexpr double t82 = 0.3e1 / 0.1e2 * t77 * t80;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t23 = t22 * sigma;
    const double t26 = rho * rho;
    const double t27 = t19 * t19;
    const double t29 = 0.1e1 / t27 / t26;
    const double t30 = t25 * t29;
    const double t34 = 0.1e1 + 0.4e-2 * sigma * t25 * t29;
    const double t35 = 0.1e1 / t34;
    const double t36 = t30 * t35;
    const double t40 = sigma * sigma;
    const double t41 = t39 * t40;
    const double t42 = t26 * t26;
    const double t43 = t42 * rho;
    const double t45 = 0.1e1 / t19 / t43;
    const double t46 = t24 * t45;
    const double t47 = t34 * t34;
    const double t48 = 0.1e1 / t47;
    const double t49 = t46 * t48;
    const double t53 = t40 * sigma;
    const double t54 = t52 * t53;
    const double t55 = t42 * t42;
    const double t56 = 0.1e1 / t55;
    const double t57 = t47 * t34;
    const double t58 = 0.1e1 / t57;
    const double t59 = t56 * t58;
    const double t64 = t63 * sigma;
    const double t68 = t67 * t40;
    const double t72 = t71 * t53;
    const double t75 = cx_nlocal_0 + 0.4e-2 * t64 * t36 + 0.32e-4 * t68 * t49 + 0.256e-6 * t72 * t59;
    const double t83 = tau * t25;
    const double t85 = 0.1e1 / t27 / rho;
    const double t86 = t83 * t85;
    const double t87 = t82 - t86;
    const double t88 = t82 + t86;
    const double t89 = 0.1e1 / t88;
    const double t91 = t87 * t87;
    const double t92 = t91 * t87;
    const double t93 = t88 * t88;
    const double t94 = t93 * t88;
    const double t95 = 0.1e1 / t94;
    const double t98 = t91 * t91;
    const double t99 = t98 * t87;
    const double t100 = t93 * t93;
    const double t102 = 0.1e1 / t100 / t88;
    const double t104 = t99 * t102 + t87 * t89 - 0.2e1 * t92 * t95;
    const double t106 = cx_local_0 + 0.4e-2 * t23 * t36 + 0.32e-4 * t41 * t49 + 0.256e-6 * t54 * t59 + t75 * t104;
    const double t110 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t106 );


    eps = 0.2e1 * t110;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t24 = constants::m_cbrt_2;
    constexpr double t76 = constants::m_cbrt_6;
    constexpr double t79 = constants::m_cbrt_pi_sq;
    constexpr double t7 = t4 / t5;
    constexpr double t22 = cx_local_1;
    constexpr double t25 = t24 * t24;
    constexpr double t39 = cx_local_2;
    constexpr double t52 = cx_local_3;
    constexpr double t63 = cx_nlocal_1;
    constexpr double t67 = cx_nlocal_2;
    constexpr double t71 = cx_nlocal_3;
    constexpr double t77 = t76 * t76;
    constexpr double t80 = t79 * t79;
    constexpr double t82 = 0.3e1 / 0.1e2 * t77 * t80;
    constexpr double t202 = t22 * t25;
    constexpr double t223 = t63 * t25;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t23 = t22 * sigma;
    const double t26 = rho * rho;
    const double t27 = t19 * t19;
    const double t29 = 0.1e1 / t27 / t26;
    const double t30 = t25 * t29;
    const double t34 = 0.1e1 + 0.4e-2 * sigma * t25 * t29;
    const double t35 = 0.1e1 / t34;
    const double t36 = t30 * t35;
    const double t40 = sigma * sigma;
    const double t41 = t39 * t40;
    const double t42 = t26 * t26;
    const double t43 = t42 * rho;
    const double t45 = 0.1e1 / t19 / t43;
    const double t46 = t24 * t45;
    const double t47 = t34 * t34;
    const double t48 = 0.1e1 / t47;
    const double t49 = t46 * t48;
    const double t53 = t40 * sigma;
    const double t54 = t52 * t53;
    const double t55 = t42 * t42;
    const double t56 = 0.1e1 / t55;
    const double t57 = t47 * t34;
    const double t58 = 0.1e1 / t57;
    const double t59 = t56 * t58;
    const double t64 = t63 * sigma;
    const double t68 = t67 * t40;
    const double t72 = t71 * t53;
    const double t75 = cx_nlocal_0 + 0.4e-2 * t64 * t36 + 0.32e-4 * t68 * t49 + 0.256e-6 * t72 * t59;
    const double t83 = tau * t25;
    const double t85 = 0.1e1 / t27 / rho;
    const double t86 = t83 * t85;
    const double t87 = t82 - t86;
    const double t88 = t82 + t86;
    const double t89 = 0.1e1 / t88;
    const double t91 = t87 * t87;
    const double t92 = t91 * t87;
    const double t93 = t88 * t88;
    const double t94 = t93 * t88;
    const double t95 = 0.1e1 / t94;
    const double t98 = t91 * t91;
    const double t99 = t98 * t87;
    const double t100 = t93 * t93;
    const double t102 = 0.1e1 / t100 / t88;
    const double t104 = t99 * t102 + t87 * t89 - 0.2e1 * t92 * t95;
    const double t106 = cx_local_0 + 0.4e-2 * t23 * t36 + 0.32e-4 * t41 * t49 + 0.256e-6 * t54 * t59 + t75 * t104;
    const double t110 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t106 );
    const double t111 = 0.1e1 / t27;
    const double t112 = t18 * t111;
    const double t116 = t26 * rho;
    const double t118 = 0.1e1 / t27 / t116;
    const double t119 = t25 * t118;
    const double t120 = t119 * t35;
    const double t123 = t22 * t40;
    const double t124 = t42 * t26;
    const double t126 = 0.1e1 / t19 / t124;
    const double t127 = t24 * t126;
    const double t128 = t127 * t48;
    const double t133 = t39 * t53;
    const double t134 = t55 * rho;
    const double t135 = 0.1e1 / t134;
    const double t136 = t135 * t58;
    const double t141 = t40 * t40;
    const double t142 = t52 * t141;
    const double t143 = t55 * t116;
    const double t145 = 0.1e1 / t27 / t143;
    const double t146 = t47 * t47;
    const double t147 = 0.1e1 / t146;
    const double t149 = t145 * t147 * t25;
    const double t154 = t63 * t40;
    const double t159 = t67 * t53;
    const double t164 = t71 * t141;
    const double t167 = -0.10666666666666666667e-1 * t64 * t120 + 0.85333333333333333336e-4 * t154 * t128 - 0.17066666666666666667e-3 * t68 * t128 + 0.13653333333333333334e-5 * t159 * t136 - 0.2048e-5 * t72 * t136 + 0.81920000000000000003e-8 * t164 * t149;
    const double t172 = 0.1e1 / t93;
    const double t173 = t87 * t172;
    const double t174 = t83 * t29;
    const double t177 = t91 * t95;
    const double t180 = 0.1e1 / t100;
    const double t181 = t92 * t180;
    const double t184 = t98 * t102;
    const double t188 = 0.1e1 / t100 / t93;
    const double t189 = t99 * t188;
    const double t192 = 0.5e1 / 0.3e1 * t83 * t29 * t89 + 0.5e1 / 0.3e1 * t173 * t174 - 0.1e2 * t177 * t174 - 0.1e2 * t181 * t174 + 0.25e2 / 0.3e1 * t184 * t174 + 0.25e2 / 0.3e1 * t189 * t174;
    const double t194 = -0.10666666666666666667e-1 * t23 * t120 + 0.85333333333333333336e-4 * t123 * t128 - 0.17066666666666666667e-3 * t41 * t128 + 0.13653333333333333334e-5 * t133 * t136 - 0.2048e-5 * t54 * t136 + 0.81920000000000000003e-8 * t142 * t149 + t167 * t104 + t75 * t192;
    const double t199 = piecewise_functor_3( t3, 0.0, -t7 * t112 * t106 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t194 );
    const double t203 = t29 * t35;
    const double t208 = t39 * sigma;
    const double t213 = t52 * t40;
    const double t216 = t55 * t26;
    const double t218 = 0.1e1 / t27 / t216;
    const double t220 = t218 * t147 * t25;
    const double t228 = t67 * sigma;
    const double t233 = t71 * t40;
    const double t238 = 0.4e-2 * t223 * t203 - 0.32e-4 * t64 * t49 + 0.64e-4 * t228 * t49 - 0.512e-6 * t68 * t59 + 0.768e-6 * t233 * t59 - 0.3072e-8 * t72 * t220;
    const double t240 = 0.4e-2 * t202 * t203 - 0.32e-4 * t23 * t49 + 0.64e-4 * t208 * t49 - 0.512e-6 * t41 * t59 + 0.768e-6 * t213 * t59 - 0.3072e-8 * t54 * t220 + t238 * t104;
    const double t244 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t240 );
    const double t246 = t7 * t18;
    const double t247 = t19 * t75;
    const double t248 = t25 * t85;
    const double t259 = -t173 * t248 + 0.6e1 * t177 * t248 + 0.6e1 * t181 * t248 - 0.5e1 * t184 * t248 - 0.5e1 * t189 * t248 - t248 * t89;
    const double t263 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t246 * t247 * t259 );


    eps = 0.2e1 * t110;
    vrho = 0.2e1 * rho * t199 + 0.2e1 * t110;
    vsigma = 0.2e1 * rho * t244;
    vlapl = 0.e0;
    vtau = 0.2e1 * rho * t263;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_fxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& v2rho2, double& v2rhosigma, double& v2rholapl, double& v2rhotau, double& v2sigma2, double& v2sigmalapl, double& v2sigmatau, double& v2lapl2, double& v2lapltau, double& v2tau2 ) {

    (void)(lapl);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t24 = constants::m_cbrt_2;
    constexpr double t76 = constants::m_cbrt_6;
    constexpr double t79 = constants::m_cbrt_pi_sq;
    constexpr double t7 = t4 / t5;
    constexpr double t22 = cx_local_1;
    constexpr double t25 = t24 * t24;
    constexpr double t39 = cx_local_2;
    constexpr double t52 = cx_local_3;
    constexpr double t63 = cx_nlocal_1;
    constexpr double t67 = cx_nlocal_2;
    constexpr double t71 = cx_nlocal_3;
    constexpr double t77 = t76 * t76;
    constexpr double t80 = t79 * t79;
    constexpr double t82 = 0.3e1 / 0.1e2 * t77 * t80;
    constexpr double t202 = t22 * t25;
    constexpr double t223 = t63 * t25;
    constexpr double t396 = t22 * t24;
    constexpr double t422 = t63 * t24;
    constexpr double t500 = t39 * t24;
    constexpr double t523 = t67 * t24;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t23 = t22 * sigma;
    const double t26 = rho * rho;
    const double t27 = t19 * t19;
    const double t29 = 0.1e1 / t27 / t26;
    const double t30 = t25 * t29;
    const double t34 = 0.1e1 + 0.4e-2 * sigma * t25 * t29;
    const double t35 = 0.1e1 / t34;
    const double t36 = t30 * t35;
    const double t40 = sigma * sigma;
    const double t41 = t39 * t40;
    const double t42 = t26 * t26;
    const double t43 = t42 * rho;
    const double t45 = 0.1e1 / t19 / t43;
    const double t46 = t24 * t45;
    const double t47 = t34 * t34;
    const double t48 = 0.1e1 / t47;
    const double t49 = t46 * t48;
    const double t53 = t40 * sigma;
    const double t54 = t52 * t53;
    const double t55 = t42 * t42;
    const double t56 = 0.1e1 / t55;
    const double t57 = t47 * t34;
    const double t58 = 0.1e1 / t57;
    const double t59 = t56 * t58;
    const double t64 = t63 * sigma;
    const double t68 = t67 * t40;
    const double t72 = t71 * t53;
    const double t75 = cx_nlocal_0 + 0.4e-2 * t64 * t36 + 0.32e-4 * t68 * t49 + 0.256e-6 * t72 * t59;
    const double t83 = tau * t25;
    const double t85 = 0.1e1 / t27 / rho;
    const double t86 = t83 * t85;
    const double t87 = t82 - t86;
    const double t88 = t82 + t86;
    const double t89 = 0.1e1 / t88;
    const double t91 = t87 * t87;
    const double t92 = t91 * t87;
    const double t93 = t88 * t88;
    const double t94 = t93 * t88;
    const double t95 = 0.1e1 / t94;
    const double t98 = t91 * t91;
    const double t99 = t98 * t87;
    const double t100 = t93 * t93;
    const double t102 = 0.1e1 / t100 / t88;
    const double t104 = t99 * t102 + t87 * t89 - 0.2e1 * t92 * t95;
    const double t106 = cx_local_0 + 0.4e-2 * t23 * t36 + 0.32e-4 * t41 * t49 + 0.256e-6 * t54 * t59 + t75 * t104;
    const double t111 = 0.1e1 / t27;
    const double t112 = t18 * t111;
    const double t116 = t26 * rho;
    const double t118 = 0.1e1 / t27 / t116;
    const double t119 = t25 * t118;
    const double t120 = t119 * t35;
    const double t123 = t22 * t40;
    const double t124 = t42 * t26;
    const double t126 = 0.1e1 / t19 / t124;
    const double t127 = t24 * t126;
    const double t128 = t127 * t48;
    const double t133 = t39 * t53;
    const double t134 = t55 * rho;
    const double t135 = 0.1e1 / t134;
    const double t136 = t135 * t58;
    const double t141 = t40 * t40;
    const double t142 = t52 * t141;
    const double t143 = t55 * t116;
    const double t145 = 0.1e1 / t27 / t143;
    const double t146 = t47 * t47;
    const double t147 = 0.1e1 / t146;
    const double t149 = t145 * t147 * t25;
    const double t154 = t63 * t40;
    const double t159 = t67 * t53;
    const double t164 = t71 * t141;
    const double t167 = -0.10666666666666666667e-1 * t64 * t120 + 0.85333333333333333336e-4 * t154 * t128 - 0.17066666666666666667e-3 * t68 * t128 + 0.13653333333333333334e-5 * t159 * t136 - 0.2048e-5 * t72 * t136 + 0.81920000000000000003e-8 * t164 * t149;
    const double t172 = 0.1e1 / t93;
    const double t173 = t87 * t172;
    const double t174 = t83 * t29;
    const double t177 = t91 * t95;
    const double t180 = 0.1e1 / t100;
    const double t181 = t92 * t180;
    const double t184 = t98 * t102;
    const double t188 = 0.1e1 / t100 / t93;
    const double t189 = t99 * t188;
    const double t192 = 0.5e1 / 0.3e1 * t83 * t29 * t89 + 0.5e1 / 0.3e1 * t173 * t174 - 0.1e2 * t177 * t174 - 0.1e2 * t181 * t174 + 0.25e2 / 0.3e1 * t184 * t174 + 0.25e2 / 0.3e1 * t189 * t174;
    const double t194 = -0.10666666666666666667e-1 * t23 * t120 + 0.85333333333333333336e-4 * t123 * t128 - 0.17066666666666666667e-3 * t41 * t128 + 0.13653333333333333334e-5 * t133 * t136 - 0.2048e-5 * t54 * t136 + 0.81920000000000000003e-8 * t142 * t149 + t167 * t104 + t75 * t192;
    const double t199 = piecewise_functor_3( t3, 0.0, -t7 * t112 * t106 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t194 );
    const double t203 = t29 * t35;
    const double t208 = t39 * sigma;
    const double t213 = t52 * t40;
    const double t216 = t55 * t26;
    const double t218 = 0.1e1 / t27 / t216;
    const double t220 = t218 * t147 * t25;
    const double t228 = t67 * sigma;
    const double t233 = t71 * t40;
    const double t238 = 0.4e-2 * t223 * t203 - 0.32e-4 * t64 * t49 + 0.64e-4 * t228 * t49 - 0.512e-6 * t68 * t59 + 0.768e-6 * t233 * t59 - 0.3072e-8 * t72 * t220;
    const double t240 = 0.4e-2 * t202 * t203 - 0.32e-4 * t23 * t49 + 0.64e-4 * t208 * t49 - 0.512e-6 * t41 * t59 + 0.768e-6 * t213 * t59 - 0.3072e-8 * t54 * t220 + t238 * t104;
    const double t244 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t240 );
    const double t246 = t7 * t18;
    const double t247 = t19 * t75;
    const double t248 = t25 * t85;
    const double t259 = -t173 * t248 + 0.6e1 * t177 * t248 + 0.6e1 * t181 * t248 - 0.5e1 * t184 * t248 - 0.5e1 * t189 * t248 - t248 * t89;
    const double t263 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t246 * t247 * t259 );
    const double t266 = t18 * t85;
    const double t274 = 0.1e1 / t27 / t42;
    const double t275 = t25 * t274;
    const double t276 = t275 * t35;
    const double t279 = t42 * t116;
    const double t281 = 0.1e1 / t19 / t279;
    const double t283 = t24 * t281 * t48;
    const double t286 = t22 * t53;
    const double t287 = 0.1e1 / t216;
    const double t288 = t287 * t58;
    const double t295 = t39 * t141;
    const double t296 = t55 * t42;
    const double t298 = 0.1e1 / t27 / t296;
    const double t300 = t298 * t147 * t25;
    const double t307 = t141 * sigma;
    const double t308 = t52 * t307;
    const double t313 = 0.1e1 / t146 / t34;
    const double t315 = 0.1e1 / t19 / t55 / t279 * t313 * t24;
    const double t322 = t63 * t53;
    const double t329 = t67 * t141;
    const double t336 = t71 * t307;
    const double t339 = 0.39111111111111111112e-1 * t64 * t276 - 0.76800000000000000003e-3 * t154 * t283 + 0.36408888888888888891e-5 * t322 * t288 + 0.10808888888888888889e-2 * t68 * t283 - 0.19569777777777777779e-4 * t159 * t288 + 0.4369066666666666667e-7 * t329 * t300 + 0.18432e-4 * t72 * t288 - 0.16110933333333333334e-6 * t164 * t300 + 0.69905066666666666671e-9 * t336 * t315;
    const double t346 = tau * tau;
    const double t347 = t346 * t24;
    const double t351 = t87 * t95;
    const double t352 = t347 * t45;
    const double t355 = t83 * t118;
    const double t358 = t91 * t180;
    const double t363 = t92 * t102;
    const double t368 = t98 * t188;
    const double t374 = 0.1e1 / t100 / t94;
    const double t375 = t99 * t374;
    const double t380 = -0.4e2 / 0.9e1 * t83 * t118 * t89 + 0.1e3 / 0.9e1 * t347 * t45 * t172 - 0.5e3 / 0.9e1 * t351 * t352 - 0.4e2 / 0.9e1 * t173 * t355 - 0.2e3 * t358 * t352 + 0.8e2 / 0.3e1 * t177 * t355 - 0.2e3 / 0.9e1 * t363 * t352 + 0.8e2 / 0.3e1 * t181 * t355 + 0.25e4 / 0.9e1 * t368 * t352 - 0.2e3 / 0.9e1 * t184 * t355 + 0.5e3 / 0.3e1 * t375 * t352 - 0.2e3 / 0.9e1 * t189 * t355;
    const double t382 = 0.39111111111111111112e-1 * t23 * t276 - 0.76800000000000000003e-3 * t123 * t283 + 0.36408888888888888891e-5 * t286 * t288 + 0.10808888888888888889e-2 * t41 * t283 - 0.19569777777777777779e-4 * t133 * t288 + 0.4369066666666666667e-7 * t295 * t300 + 0.18432e-4 * t54 * t288 - 0.16110933333333333334e-6 * t142 * t300 + 0.69905066666666666671e-9 * t308 * t315 + t339 * t104 + 0.2e1 * t167 * t192 + t75 * t380;
    const double t387 = piecewise_functor_3( t3, 0.0, t7 * t266 * t106 / 0.12e2 - t7 * t112 * t194 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t382 );
    const double t393 = t118 * t35;
    const double t397 = t126 * t48;
    const double t398 = t397 * sigma;
    const double t413 = t55 * t124;
    const double t417 = 0.1e1 / t19 / t413 * t313 * t24;
    const double t439 = -0.10666666666666666667e-1 * t223 * t393 + 0.25600000000000000001e-3 * t422 * t398 - 0.13653333333333333334e-5 * t154 * t136 - 0.34133333333333333333e-3 * t228 * t128 + 0.68266666666666666668e-5 * t68 * t136 - 0.16384000000000000001e-7 * t159 * t149 - 0.6144e-5 * t233 * t136 + 0.57344000000000000001e-7 * t72 * t149 - 0.26214400000000000001e-9 * t164 * t417;
    const double t442 = -0.10666666666666666667e-1 * t202 * t393 + 0.25600000000000000001e-3 * t396 * t398 - 0.13653333333333333334e-5 * t123 * t136 - 0.34133333333333333333e-3 * t208 * t128 + 0.68266666666666666668e-5 * t41 * t136 - 0.16384000000000000001e-7 * t133 * t149 - 0.6144e-5 * t213 * t136 + 0.57344000000000000001e-7 * t54 * t149 - 0.26214400000000000001e-9 * t142 * t417 + t439 * t104 + t238 * t192;
    const double t447 = piecewise_functor_3( t3, 0.0, -t7 * t112 * t240 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t442 );
    const double t450 = t111 * t75;
    const double t454 = t19 * t167;
    const double t462 = t24 / t19 / t42;
    const double t463 = t172 * tau;
    const double t466 = t462 * tau;
    const double t487 = 0.5e1 / 0.3e1 * t30 * t89 - 0.2e2 / 0.3e1 * t462 * t463 + 0.1e3 / 0.3e1 * t351 * t466 + 0.5e1 / 0.3e1 * t173 * t30 + 0.12e3 * t358 * t466 - 0.1e2 * t177 * t30 + 0.4e2 / 0.3e1 * t363 * t466 - 0.1e2 * t181 * t30 - 0.5e3 / 0.3e1 * t368 * t466 + 0.25e2 / 0.3e1 * t184 * t30 - 0.1e3 * t375 * t466 + 0.25e2 / 0.3e1 * t189 * t30;
    const double t492 = piecewise_functor_3( t3, 0.0, -t246 * t450 * t259 / 0.8e1 - 0.3e1 / 0.8e1 * t246 * t454 * t259 - 0.3e1 / 0.8e1 * t246 * t247 * t487 );
    const double t495 = t45 * t48;
    const double t507 = t52 * sigma;
    const double t512 = t55 * t43;
    const double t516 = 0.1e1 / t19 / t512 * t313 * t24;
    const double t530 = t71 * sigma;
    const double t537 = -0.64e-4 * t422 * t495 + 0.512e-6 * t64 * t59 + 0.64e-4 * t523 * t495 - 0.2048e-5 * t228 * t59 + 0.6144e-8 * t68 * t220 + 0.1536e-5 * t530 * t59 - 0.18432e-7 * t233 * t220 + 0.98304e-10 * t72 * t516;
    const double t539 = -0.64e-4 * t396 * t495 + 0.512e-6 * t23 * t59 + 0.64e-4 * t500 * t495 - 0.2048e-5 * t208 * t59 + 0.6144e-8 * t41 * t220 + 0.1536e-5 * t507 * t59 - 0.18432e-7 * t213 * t220 + 0.98304e-10 * t54 * t516 + t537 * t104;
    const double t543 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t539 );
    const double t545 = t19 * t238;
    const double t549 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t246 * t545 * t259 );
    const double t553 = t24 / t19 / t116;
    const double t566 = 0.4e1 * t553 * t172 - 0.2e2 * t351 * t553 - 0.72e2 * t358 * t553 - 0.8e1 * t363 * t553 + 0.1e3 * t368 * t553 + 0.6e2 * t375 * t553;
    const double t570 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t246 * t247 * t566 );


    v2rho2 = 0.2e1 * rho * t387 + 0.4e1 * t199;
    v2rhosigma = 0.2e1 * rho * t447 + 0.2e1 * t244;
    v2rholapl = 0.e0;
    v2rhotau = 0.2e1 * rho * t492 + 0.2e1 * t263;
    v2sigma2 = 0.2e1 * rho * t543;
    v2sigmalapl = 0.e0;
    v2sigmatau = 0.2e1 * rho * t549;
    v2lapl2 = 0.e0;
    v2lapltau = 0.e0;
    v2tau2 = 0.2e1 * rho * t570;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_vxc_fxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& vrho, double& vsigma, double& vlapl, double& vtau, double& v2rho2, double& v2rhosigma, double& v2rholapl, double& v2rhotau, double& v2sigma2, double& v2sigmalapl, double& v2sigmatau, double& v2lapl2, double& v2lapltau, double& v2tau2 ) {

    (void)(lapl);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t24 = constants::m_cbrt_2;
    constexpr double t76 = constants::m_cbrt_6;
    constexpr double t79 = constants::m_cbrt_pi_sq;
    constexpr double t7 = t4 / t5;
    constexpr double t22 = cx_local_1;
    constexpr double t25 = t24 * t24;
    constexpr double t39 = cx_local_2;
    constexpr double t52 = cx_local_3;
    constexpr double t63 = cx_nlocal_1;
    constexpr double t67 = cx_nlocal_2;
    constexpr double t71 = cx_nlocal_3;
    constexpr double t77 = t76 * t76;
    constexpr double t80 = t79 * t79;
    constexpr double t82 = 0.3e1 / 0.1e2 * t77 * t80;
    constexpr double t202 = t22 * t25;
    constexpr double t223 = t63 * t25;
    constexpr double t396 = t22 * t24;
    constexpr double t422 = t63 * t24;
    constexpr double t500 = t39 * t24;
    constexpr double t523 = t67 * t24;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = safe_math::cbrt( rho );
    const double t20 = t18 * t19;
    const double t23 = t22 * sigma;
    const double t26 = rho * rho;
    const double t27 = t19 * t19;
    const double t29 = 0.1e1 / t27 / t26;
    const double t30 = t25 * t29;
    const double t34 = 0.1e1 + 0.4e-2 * sigma * t25 * t29;
    const double t35 = 0.1e1 / t34;
    const double t36 = t30 * t35;
    const double t40 = sigma * sigma;
    const double t41 = t39 * t40;
    const double t42 = t26 * t26;
    const double t43 = t42 * rho;
    const double t45 = 0.1e1 / t19 / t43;
    const double t46 = t24 * t45;
    const double t47 = t34 * t34;
    const double t48 = 0.1e1 / t47;
    const double t49 = t46 * t48;
    const double t53 = t40 * sigma;
    const double t54 = t52 * t53;
    const double t55 = t42 * t42;
    const double t56 = 0.1e1 / t55;
    const double t57 = t47 * t34;
    const double t58 = 0.1e1 / t57;
    const double t59 = t56 * t58;
    const double t64 = t63 * sigma;
    const double t68 = t67 * t40;
    const double t72 = t71 * t53;
    const double t75 = cx_nlocal_0 + 0.4e-2 * t64 * t36 + 0.32e-4 * t68 * t49 + 0.256e-6 * t72 * t59;
    const double t83 = tau * t25;
    const double t85 = 0.1e1 / t27 / rho;
    const double t86 = t83 * t85;
    const double t87 = t82 - t86;
    const double t88 = t82 + t86;
    const double t89 = 0.1e1 / t88;
    const double t91 = t87 * t87;
    const double t92 = t91 * t87;
    const double t93 = t88 * t88;
    const double t94 = t93 * t88;
    const double t95 = 0.1e1 / t94;
    const double t98 = t91 * t91;
    const double t99 = t98 * t87;
    const double t100 = t93 * t93;
    const double t102 = 0.1e1 / t100 / t88;
    const double t104 = t99 * t102 + t87 * t89 - 0.2e1 * t92 * t95;
    const double t106 = cx_local_0 + 0.4e-2 * t23 * t36 + 0.32e-4 * t41 * t49 + 0.256e-6 * t54 * t59 + t75 * t104;
    const double t110 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t106 );
    const double t111 = 0.1e1 / t27;
    const double t112 = t18 * t111;
    const double t116 = t26 * rho;
    const double t118 = 0.1e1 / t27 / t116;
    const double t119 = t25 * t118;
    const double t120 = t119 * t35;
    const double t123 = t22 * t40;
    const double t124 = t42 * t26;
    const double t126 = 0.1e1 / t19 / t124;
    const double t127 = t24 * t126;
    const double t128 = t127 * t48;
    const double t133 = t39 * t53;
    const double t134 = t55 * rho;
    const double t135 = 0.1e1 / t134;
    const double t136 = t135 * t58;
    const double t141 = t40 * t40;
    const double t142 = t52 * t141;
    const double t143 = t55 * t116;
    const double t145 = 0.1e1 / t27 / t143;
    const double t146 = t47 * t47;
    const double t147 = 0.1e1 / t146;
    const double t149 = t145 * t147 * t25;
    const double t154 = t63 * t40;
    const double t159 = t67 * t53;
    const double t164 = t71 * t141;
    const double t167 = -0.10666666666666666667e-1 * t64 * t120 + 0.85333333333333333336e-4 * t154 * t128 - 0.17066666666666666667e-3 * t68 * t128 + 0.13653333333333333334e-5 * t159 * t136 - 0.2048e-5 * t72 * t136 + 0.81920000000000000003e-8 * t164 * t149;
    const double t172 = 0.1e1 / t93;
    const double t173 = t87 * t172;
    const double t174 = t83 * t29;
    const double t177 = t91 * t95;
    const double t180 = 0.1e1 / t100;
    const double t181 = t92 * t180;
    const double t184 = t98 * t102;
    const double t188 = 0.1e1 / t100 / t93;
    const double t189 = t99 * t188;
    const double t192 = 0.5e1 / 0.3e1 * t83 * t29 * t89 + 0.5e1 / 0.3e1 * t173 * t174 - 0.1e2 * t177 * t174 - 0.1e2 * t181 * t174 + 0.25e2 / 0.3e1 * t184 * t174 + 0.25e2 / 0.3e1 * t189 * t174;
    const double t194 = -0.10666666666666666667e-1 * t23 * t120 + 0.85333333333333333336e-4 * t123 * t128 - 0.17066666666666666667e-3 * t41 * t128 + 0.13653333333333333334e-5 * t133 * t136 - 0.2048e-5 * t54 * t136 + 0.81920000000000000003e-8 * t142 * t149 + t167 * t104 + t75 * t192;
    const double t199 = piecewise_functor_3( t3, 0.0, -t7 * t112 * t106 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t194 );
    const double t203 = t29 * t35;
    const double t208 = t39 * sigma;
    const double t213 = t52 * t40;
    const double t216 = t55 * t26;
    const double t218 = 0.1e1 / t27 / t216;
    const double t220 = t218 * t147 * t25;
    const double t228 = t67 * sigma;
    const double t233 = t71 * t40;
    const double t238 = 0.4e-2 * t223 * t203 - 0.32e-4 * t64 * t49 + 0.64e-4 * t228 * t49 - 0.512e-6 * t68 * t59 + 0.768e-6 * t233 * t59 - 0.3072e-8 * t72 * t220;
    const double t240 = 0.4e-2 * t202 * t203 - 0.32e-4 * t23 * t49 + 0.64e-4 * t208 * t49 - 0.512e-6 * t41 * t59 + 0.768e-6 * t213 * t59 - 0.3072e-8 * t54 * t220 + t238 * t104;
    const double t244 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t240 );
    const double t246 = t7 * t18;
    const double t247 = t19 * t75;
    const double t248 = t25 * t85;
    const double t259 = -t173 * t248 + 0.6e1 * t177 * t248 + 0.6e1 * t181 * t248 - 0.5e1 * t184 * t248 - 0.5e1 * t189 * t248 - t248 * t89;
    const double t263 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t246 * t247 * t259 );
    const double t266 = t18 * t85;
    const double t274 = 0.1e1 / t27 / t42;
    const double t275 = t25 * t274;
    const double t276 = t275 * t35;
    const double t279 = t42 * t116;
    const double t281 = 0.1e1 / t19 / t279;
    const double t283 = t24 * t281 * t48;
    const double t286 = t22 * t53;
    const double t287 = 0.1e1 / t216;
    const double t288 = t287 * t58;
    const double t295 = t39 * t141;
    const double t296 = t55 * t42;
    const double t298 = 0.1e1 / t27 / t296;
    const double t300 = t298 * t147 * t25;
    const double t307 = t141 * sigma;
    const double t308 = t52 * t307;
    const double t313 = 0.1e1 / t146 / t34;
    const double t315 = 0.1e1 / t19 / t55 / t279 * t313 * t24;
    const double t322 = t63 * t53;
    const double t329 = t67 * t141;
    const double t336 = t71 * t307;
    const double t339 = 0.39111111111111111112e-1 * t64 * t276 - 0.76800000000000000003e-3 * t154 * t283 + 0.36408888888888888891e-5 * t322 * t288 + 0.10808888888888888889e-2 * t68 * t283 - 0.19569777777777777779e-4 * t159 * t288 + 0.4369066666666666667e-7 * t329 * t300 + 0.18432e-4 * t72 * t288 - 0.16110933333333333334e-6 * t164 * t300 + 0.69905066666666666671e-9 * t336 * t315;
    const double t346 = tau * tau;
    const double t347 = t346 * t24;
    const double t351 = t87 * t95;
    const double t352 = t347 * t45;
    const double t355 = t83 * t118;
    const double t358 = t91 * t180;
    const double t363 = t92 * t102;
    const double t368 = t98 * t188;
    const double t374 = 0.1e1 / t100 / t94;
    const double t375 = t99 * t374;
    const double t380 = -0.4e2 / 0.9e1 * t83 * t118 * t89 + 0.1e3 / 0.9e1 * t347 * t45 * t172 - 0.5e3 / 0.9e1 * t351 * t352 - 0.4e2 / 0.9e1 * t173 * t355 - 0.2e3 * t358 * t352 + 0.8e2 / 0.3e1 * t177 * t355 - 0.2e3 / 0.9e1 * t363 * t352 + 0.8e2 / 0.3e1 * t181 * t355 + 0.25e4 / 0.9e1 * t368 * t352 - 0.2e3 / 0.9e1 * t184 * t355 + 0.5e3 / 0.3e1 * t375 * t352 - 0.2e3 / 0.9e1 * t189 * t355;
    const double t382 = 0.39111111111111111112e-1 * t23 * t276 - 0.76800000000000000003e-3 * t123 * t283 + 0.36408888888888888891e-5 * t286 * t288 + 0.10808888888888888889e-2 * t41 * t283 - 0.19569777777777777779e-4 * t133 * t288 + 0.4369066666666666667e-7 * t295 * t300 + 0.18432e-4 * t54 * t288 - 0.16110933333333333334e-6 * t142 * t300 + 0.69905066666666666671e-9 * t308 * t315 + t339 * t104 + 0.2e1 * t167 * t192 + t75 * t380;
    const double t387 = piecewise_functor_3( t3, 0.0, t7 * t266 * t106 / 0.12e2 - t7 * t112 * t194 / 0.4e1 - 0.3e1 / 0.8e1 * t7 * t20 * t382 );
    const double t393 = t118 * t35;
    const double t397 = t126 * t48;
    const double t398 = t397 * sigma;
    const double t413 = t55 * t124;
    const double t417 = 0.1e1 / t19 / t413 * t313 * t24;
    const double t439 = -0.10666666666666666667e-1 * t223 * t393 + 0.25600000000000000001e-3 * t422 * t398 - 0.13653333333333333334e-5 * t154 * t136 - 0.34133333333333333333e-3 * t228 * t128 + 0.68266666666666666668e-5 * t68 * t136 - 0.16384000000000000001e-7 * t159 * t149 - 0.6144e-5 * t233 * t136 + 0.57344000000000000001e-7 * t72 * t149 - 0.26214400000000000001e-9 * t164 * t417;
    const double t442 = -0.10666666666666666667e-1 * t202 * t393 + 0.25600000000000000001e-3 * t396 * t398 - 0.13653333333333333334e-5 * t123 * t136 - 0.34133333333333333333e-3 * t208 * t128 + 0.68266666666666666668e-5 * t41 * t136 - 0.16384000000000000001e-7 * t133 * t149 - 0.6144e-5 * t213 * t136 + 0.57344000000000000001e-7 * t54 * t149 - 0.26214400000000000001e-9 * t142 * t417 + t439 * t104 + t238 * t192;
    const double t447 = piecewise_functor_3( t3, 0.0, -t7 * t112 * t240 / 0.8e1 - 0.3e1 / 0.8e1 * t7 * t20 * t442 );
    const double t450 = t111 * t75;
    const double t454 = t19 * t167;
    const double t462 = t24 / t19 / t42;
    const double t463 = t172 * tau;
    const double t466 = t462 * tau;
    const double t487 = 0.5e1 / 0.3e1 * t30 * t89 - 0.2e2 / 0.3e1 * t462 * t463 + 0.1e3 / 0.3e1 * t351 * t466 + 0.5e1 / 0.3e1 * t173 * t30 + 0.12e3 * t358 * t466 - 0.1e2 * t177 * t30 + 0.4e2 / 0.3e1 * t363 * t466 - 0.1e2 * t181 * t30 - 0.5e3 / 0.3e1 * t368 * t466 + 0.25e2 / 0.3e1 * t184 * t30 - 0.1e3 * t375 * t466 + 0.25e2 / 0.3e1 * t189 * t30;
    const double t492 = piecewise_functor_3( t3, 0.0, -t246 * t450 * t259 / 0.8e1 - 0.3e1 / 0.8e1 * t246 * t454 * t259 - 0.3e1 / 0.8e1 * t246 * t247 * t487 );
    const double t495 = t45 * t48;
    const double t507 = t52 * sigma;
    const double t512 = t55 * t43;
    const double t516 = 0.1e1 / t19 / t512 * t313 * t24;
    const double t530 = t71 * sigma;
    const double t537 = -0.64e-4 * t422 * t495 + 0.512e-6 * t64 * t59 + 0.64e-4 * t523 * t495 - 0.2048e-5 * t228 * t59 + 0.6144e-8 * t68 * t220 + 0.1536e-5 * t530 * t59 - 0.18432e-7 * t233 * t220 + 0.98304e-10 * t72 * t516;
    const double t539 = -0.64e-4 * t396 * t495 + 0.512e-6 * t23 * t59 + 0.64e-4 * t500 * t495 - 0.2048e-5 * t208 * t59 + 0.6144e-8 * t41 * t220 + 0.1536e-5 * t507 * t59 - 0.18432e-7 * t213 * t220 + 0.98304e-10 * t54 * t516 + t537 * t104;
    const double t543 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t7 * t20 * t539 );
    const double t545 = t19 * t238;
    const double t549 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t246 * t545 * t259 );
    const double t553 = t24 / t19 / t116;
    const double t566 = 0.4e1 * t553 * t172 - 0.2e2 * t351 * t553 - 0.72e2 * t358 * t553 - 0.8e1 * t363 * t553 + 0.1e3 * t368 * t553 + 0.6e2 * t375 * t553;
    const double t570 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t246 * t247 * t566 );


    vrho = 0.2e1 * rho * t199 + 0.2e1 * t110;
    vsigma = 0.2e1 * rho * t244;
    vlapl = 0.e0;
    vtau = 0.2e1 * rho * t263;
    v2rho2 = 0.2e1 * rho * t387 + 0.4e1 * t199;
    v2rhosigma = 0.2e1 * rho * t447 + 0.2e1 * t244;
    v2rholapl = 0.e0;
    v2rhotau = 0.2e1 * rho * t492 + 0.2e1 * t263;
    v2sigma2 = 0.2e1 * rho * t543;
    v2sigmalapl = 0.e0;
    v2sigmatau = 0.2e1 * rho * t549;
    v2lapl2 = 0.e0;
    v2lapltau = 0.e0;
    v2tau2 = 0.2e1 * rho * t570;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t80 = constants::m_cbrt_6;
    constexpr double t83 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t29 = cx_local_0;
    constexpr double t30 = cx_local_1;
    constexpr double t44 = cx_local_2;
    constexpr double t56 = cx_local_3;
    constexpr double t66 = cx_nlocal_0;
    constexpr double t67 = cx_nlocal_1;
    constexpr double t71 = cx_nlocal_2;
    constexpr double t75 = cx_nlocal_3;
    constexpr double t81 = t80 * t80;
    constexpr double t84 = t83 * t83;
    constexpr double t86 = 0.3e1 / 0.1e2 * t81 * t84;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t31 = t30 * sigma_aa;
    const double t32 = rho_a * rho_a;
    const double t33 = safe_math::cbrt( rho_a );
    const double t34 = t33 * t33;
    const double t36 = 0.1e1 / t34 / t32;
    const double t39 = 0.1e1 + 0.4e-2 * sigma_aa * t36;
    const double t40 = 0.1e1 / t39;
    const double t41 = t36 * t40;
    const double t45 = sigma_aa * sigma_aa;
    const double t46 = t44 * t45;
    const double t47 = t32 * t32;
    const double t48 = t47 * rho_a;
    const double t50 = 0.1e1 / t33 / t48;
    const double t51 = t39 * t39;
    const double t52 = 0.1e1 / t51;
    const double t53 = t50 * t52;
    const double t57 = t45 * sigma_aa;
    const double t58 = t56 * t57;
    const double t59 = t47 * t47;
    const double t60 = 0.1e1 / t59;
    const double t61 = t51 * t39;
    const double t62 = 0.1e1 / t61;
    const double t63 = t60 * t62;
    const double t68 = t67 * sigma_aa;
    const double t72 = t71 * t45;
    const double t76 = t75 * t57;
    const double t79 = t66 + 0.4e-2 * t68 * t41 + 0.16e-4 * t72 * t53 + 0.64e-7 * t76 * t63;
    const double t88 = 0.1e1 / t34 / rho_a;
    const double t89 = tau_a * t88;
    const double t90 = t86 - t89;
    const double t91 = t86 + t89;
    const double t92 = 0.1e1 / t91;
    const double t94 = t90 * t90;
    const double t95 = t94 * t90;
    const double t96 = t91 * t91;
    const double t97 = t96 * t91;
    const double t98 = 0.1e1 / t97;
    const double t101 = t94 * t94;
    const double t102 = t101 * t90;
    const double t103 = t96 * t96;
    const double t105 = 0.1e1 / t103 / t91;
    const double t107 = t102 * t105 + t90 * t92 - 0.2e1 * t95 * t98;
    const double t109 = t29 + 0.4e-2 * t31 * t41 + 0.16e-4 * t46 * t53 + 0.64e-7 * t58 * t63 + t79 * t107;
    const double t113 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t109 );
    const double t114 = rho_b <= dens_tol;
    const double t115 = -t17;
    const double t117 = piecewise_functor_5( t15, t12, t11, t16, t115 * t8 );
    const double t118 = 0.1e1 + t117;
    const double t119 = t118 <= zeta_tol;
    const double t120 = safe_math::cbrt( t118 );
    const double t122 = piecewise_functor_3( t119, t23, t120 * t118 );
    const double t123 = t122 * t27;
    const double t124 = t30 * sigma_bb;
    const double t125 = rho_b * rho_b;
    const double t126 = safe_math::cbrt( rho_b );
    const double t127 = t126 * t126;
    const double t129 = 0.1e1 / t127 / t125;
    const double t132 = 0.1e1 + 0.4e-2 * sigma_bb * t129;
    const double t133 = 0.1e1 / t132;
    const double t134 = t129 * t133;
    const double t137 = sigma_bb * sigma_bb;
    const double t138 = t44 * t137;
    const double t139 = t125 * t125;
    const double t140 = t139 * rho_b;
    const double t142 = 0.1e1 / t126 / t140;
    const double t143 = t132 * t132;
    const double t144 = 0.1e1 / t143;
    const double t145 = t142 * t144;
    const double t148 = t137 * sigma_bb;
    const double t149 = t56 * t148;
    const double t150 = t139 * t139;
    const double t151 = 0.1e1 / t150;
    const double t152 = t143 * t132;
    const double t153 = 0.1e1 / t152;
    const double t154 = t151 * t153;
    const double t157 = t67 * sigma_bb;
    const double t160 = t71 * t137;
    const double t163 = t75 * t148;
    const double t166 = t66 + 0.4e-2 * t157 * t134 + 0.16e-4 * t160 * t145 + 0.64e-7 * t163 * t154;
    const double t168 = 0.1e1 / t127 / rho_b;
    const double t169 = tau_b * t168;
    const double t170 = t86 - t169;
    const double t171 = t86 + t169;
    const double t172 = 0.1e1 / t171;
    const double t174 = t170 * t170;
    const double t175 = t174 * t170;
    const double t176 = t171 * t171;
    const double t177 = t176 * t171;
    const double t178 = 0.1e1 / t177;
    const double t181 = t174 * t174;
    const double t182 = t181 * t170;
    const double t183 = t176 * t176;
    const double t185 = 0.1e1 / t183 / t171;
    const double t187 = t170 * t172 - 0.2e1 * t175 * t178 + t182 * t185;
    const double t189 = t29 + 0.4e-2 * t124 * t134 + 0.16e-4 * t138 * t145 + 0.64e-7 * t149 * t154 + t166 * t187;
    const double t193 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t189 );


    eps = t113 + t193;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t80 = constants::m_cbrt_6;
    constexpr double t83 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t29 = cx_local_0;
    constexpr double t30 = cx_local_1;
    constexpr double t44 = cx_local_2;
    constexpr double t56 = cx_local_3;
    constexpr double t66 = cx_nlocal_0;
    constexpr double t67 = cx_nlocal_1;
    constexpr double t71 = cx_nlocal_2;
    constexpr double t75 = cx_nlocal_3;
    constexpr double t81 = t80 * t80;
    constexpr double t84 = t83 * t83;
    constexpr double t86 = 0.3e1 / 0.1e2 * t81 * t84;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t31 = t30 * sigma_aa;
    const double t32 = rho_a * rho_a;
    const double t33 = safe_math::cbrt( rho_a );
    const double t34 = t33 * t33;
    const double t36 = 0.1e1 / t34 / t32;
    const double t39 = 0.1e1 + 0.4e-2 * sigma_aa * t36;
    const double t40 = 0.1e1 / t39;
    const double t41 = t36 * t40;
    const double t45 = sigma_aa * sigma_aa;
    const double t46 = t44 * t45;
    const double t47 = t32 * t32;
    const double t48 = t47 * rho_a;
    const double t50 = 0.1e1 / t33 / t48;
    const double t51 = t39 * t39;
    const double t52 = 0.1e1 / t51;
    const double t53 = t50 * t52;
    const double t57 = t45 * sigma_aa;
    const double t58 = t56 * t57;
    const double t59 = t47 * t47;
    const double t60 = 0.1e1 / t59;
    const double t61 = t51 * t39;
    const double t62 = 0.1e1 / t61;
    const double t63 = t60 * t62;
    const double t68 = t67 * sigma_aa;
    const double t72 = t71 * t45;
    const double t76 = t75 * t57;
    const double t79 = t66 + 0.4e-2 * t68 * t41 + 0.16e-4 * t72 * t53 + 0.64e-7 * t76 * t63;
    const double t88 = 0.1e1 / t34 / rho_a;
    const double t89 = tau_a * t88;
    const double t90 = t86 - t89;
    const double t91 = t86 + t89;
    const double t92 = 0.1e1 / t91;
    const double t94 = t90 * t90;
    const double t95 = t94 * t90;
    const double t96 = t91 * t91;
    const double t97 = t96 * t91;
    const double t98 = 0.1e1 / t97;
    const double t101 = t94 * t94;
    const double t102 = t101 * t90;
    const double t103 = t96 * t96;
    const double t105 = 0.1e1 / t103 / t91;
    const double t107 = t102 * t105 + t90 * t92 - 0.2e1 * t95 * t98;
    const double t109 = t29 + 0.4e-2 * t31 * t41 + 0.16e-4 * t46 * t53 + 0.64e-7 * t58 * t63 + t79 * t107;
    const double t113 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t109 );
    const double t114 = rho_b <= dens_tol;
    const double t115 = -t17;
    const double t117 = piecewise_functor_5( t15, t12, t11, t16, t115 * t8 );
    const double t118 = 0.1e1 + t117;
    const double t119 = t118 <= zeta_tol;
    const double t120 = safe_math::cbrt( t118 );
    const double t122 = piecewise_functor_3( t119, t23, t120 * t118 );
    const double t123 = t122 * t27;
    const double t124 = t30 * sigma_bb;
    const double t125 = rho_b * rho_b;
    const double t126 = safe_math::cbrt( rho_b );
    const double t127 = t126 * t126;
    const double t129 = 0.1e1 / t127 / t125;
    const double t132 = 0.1e1 + 0.4e-2 * sigma_bb * t129;
    const double t133 = 0.1e1 / t132;
    const double t134 = t129 * t133;
    const double t137 = sigma_bb * sigma_bb;
    const double t138 = t44 * t137;
    const double t139 = t125 * t125;
    const double t140 = t139 * rho_b;
    const double t142 = 0.1e1 / t126 / t140;
    const double t143 = t132 * t132;
    const double t144 = 0.1e1 / t143;
    const double t145 = t142 * t144;
    const double t148 = t137 * sigma_bb;
    const double t149 = t56 * t148;
    const double t150 = t139 * t139;
    const double t151 = 0.1e1 / t150;
    const double t152 = t143 * t132;
    const double t153 = 0.1e1 / t152;
    const double t154 = t151 * t153;
    const double t157 = t67 * sigma_bb;
    const double t160 = t71 * t137;
    const double t163 = t75 * t148;
    const double t166 = t66 + 0.4e-2 * t157 * t134 + 0.16e-4 * t160 * t145 + 0.64e-7 * t163 * t154;
    const double t168 = 0.1e1 / t127 / rho_b;
    const double t169 = tau_b * t168;
    const double t170 = t86 - t169;
    const double t171 = t86 + t169;
    const double t172 = 0.1e1 / t171;
    const double t174 = t170 * t170;
    const double t175 = t174 * t170;
    const double t176 = t171 * t171;
    const double t177 = t176 * t171;
    const double t178 = 0.1e1 / t177;
    const double t181 = t174 * t174;
    const double t182 = t181 * t170;
    const double t183 = t176 * t176;
    const double t185 = 0.1e1 / t183 / t171;
    const double t187 = t170 * t172 - 0.2e1 * t175 * t178 + t182 * t185;
    const double t189 = t29 + 0.4e-2 * t124 * t134 + 0.16e-4 * t138 * t145 + 0.64e-7 * t149 * t154 + t166 * t187;
    const double t193 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t189 );
    const double t194 = t7 * t7;
    const double t195 = 0.1e1 / t194;
    const double t196 = t17 * t195;
    const double t198 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t196 );
    const double t201 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t198 );
    const double t202 = t201 * t27;
    const double t206 = t27 * t27;
    const double t207 = 0.1e1 / t206;
    const double t208 = t26 * t207;
    const double t211 = t6 * t208 * t109 / 0.8e1;
    const double t212 = t32 * rho_a;
    const double t214 = 0.1e1 / t34 / t212;
    const double t215 = t214 * t40;
    const double t218 = t30 * t45;
    const double t219 = t47 * t32;
    const double t221 = 0.1e1 / t33 / t219;
    const double t222 = t221 * t52;
    const double t227 = t44 * t57;
    const double t228 = t59 * rho_a;
    const double t229 = 0.1e1 / t228;
    const double t230 = t229 * t62;
    const double t235 = t45 * t45;
    const double t236 = t56 * t235;
    const double t237 = t59 * t212;
    const double t239 = 0.1e1 / t34 / t237;
    const double t240 = t51 * t51;
    const double t241 = 0.1e1 / t240;
    const double t242 = t239 * t241;
    const double t247 = t67 * t45;
    const double t252 = t71 * t57;
    const double t257 = t75 * t235;
    const double t260 = -0.10666666666666666667e-1 * t68 * t215 + 0.42666666666666666668e-4 * t247 * t222 - 0.85333333333333333333e-4 * t72 * t222 + 0.34133333333333333334e-6 * t252 * t230 - 0.512e-6 * t76 * t230 + 0.20480000000000000001e-8 * t257 * t242;
    const double t262 = tau_a * t36;
    const double t265 = 0.1e1 / t96;
    const double t266 = t90 * t265;
    const double t269 = t94 * t98;
    const double t272 = 0.1e1 / t103;
    const double t273 = t95 * t272;
    const double t276 = t101 * t105;
    const double t280 = 0.1e1 / t103 / t96;
    const double t281 = t102 * t280;
    const double t284 = 0.5e1 / 0.3e1 * t262 * t92 + 0.5e1 / 0.3e1 * t266 * t262 - 0.1e2 * t269 * t262 - 0.1e2 * t273 * t262 + 0.25e2 / 0.3e1 * t276 * t262 + 0.25e2 / 0.3e1 * t281 * t262;
    const double t286 = -0.10666666666666666667e-1 * t31 * t215 + 0.42666666666666666668e-4 * t218 * t222 - 0.85333333333333333333e-4 * t46 * t222 + 0.34133333333333333334e-6 * t227 * t230 - 0.512e-6 * t58 * t230 + 0.20480000000000000001e-8 * t236 * t242 + t260 * t107 + t79 * t284;
    const double t291 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t202 * t109 - t211 - 0.3e1 / 0.8e1 * t6 * t28 * t286 );
    const double t292 = t115 * t195;
    const double t294 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t292 );
    const double t297 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.3e1 * t120 * t294 );
    const double t298 = t297 * t27;
    const double t302 = t122 * t207;
    const double t305 = t6 * t302 * t189 / 0.8e1;
    const double t307 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t298 * t189 - t305 );
    const double t311 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t196 );
    const double t314 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t311 );
    const double t315 = t314 * t27;
    const double t320 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t315 * t109 - t211 );
    const double t322 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t292 );
    const double t325 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.3e1 * t120 * t322 );
    const double t326 = t325 * t27;
    const double t330 = t125 * rho_b;
    const double t332 = 0.1e1 / t127 / t330;
    const double t333 = t332 * t133;
    const double t336 = t30 * t137;
    const double t337 = t139 * t125;
    const double t339 = 0.1e1 / t126 / t337;
    const double t340 = t339 * t144;
    const double t345 = t44 * t148;
    const double t346 = t150 * rho_b;
    const double t347 = 0.1e1 / t346;
    const double t348 = t347 * t153;
    const double t353 = t137 * t137;
    const double t354 = t56 * t353;
    const double t355 = t150 * t330;
    const double t357 = 0.1e1 / t127 / t355;
    const double t358 = t143 * t143;
    const double t359 = 0.1e1 / t358;
    const double t360 = t357 * t359;
    const double t365 = t67 * t137;
    const double t370 = t71 * t148;
    const double t375 = t75 * t353;
    const double t378 = -0.10666666666666666667e-1 * t157 * t333 + 0.42666666666666666668e-4 * t365 * t340 - 0.85333333333333333333e-4 * t160 * t340 + 0.34133333333333333334e-6 * t370 * t348 - 0.512e-6 * t163 * t348 + 0.20480000000000000001e-8 * t375 * t360;
    const double t380 = tau_b * t129;
    const double t383 = 0.1e1 / t176;
    const double t384 = t170 * t383;
    const double t387 = t174 * t178;
    const double t390 = 0.1e1 / t183;
    const double t391 = t175 * t390;
    const double t394 = t181 * t185;
    const double t398 = 0.1e1 / t183 / t176;
    const double t399 = t182 * t398;
    const double t402 = 0.5e1 / 0.3e1 * t380 * t172 + 0.5e1 / 0.3e1 * t384 * t380 - 0.1e2 * t387 * t380 - 0.1e2 * t391 * t380 + 0.25e2 / 0.3e1 * t394 * t380 + 0.25e2 / 0.3e1 * t399 * t380;
    const double t404 = -0.10666666666666666667e-1 * t124 * t333 + 0.42666666666666666668e-4 * t336 * t340 - 0.85333333333333333333e-4 * t138 * t340 + 0.34133333333333333334e-6 * t345 * t348 - 0.512e-6 * t149 * t348 + 0.20480000000000000001e-8 * t354 * t360 + t378 * t187 + t166 * t402;
    const double t409 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t326 * t189 - t305 - 0.3e1 / 0.8e1 * t6 * t123 * t404 );
    const double t417 = t44 * sigma_aa;
    const double t422 = t56 * t45;
    const double t425 = t59 * t32;
    const double t427 = 0.1e1 / t34 / t425;
    const double t428 = t427 * t241;
    const double t436 = t71 * sigma_aa;
    const double t441 = t75 * t45;
    const double t446 = 0.4e-2 * t67 * t36 * t40 - 0.16e-4 * t68 * t53 + 0.32e-4 * t436 * t53 - 0.128e-6 * t72 * t63 + 0.192e-6 * t441 * t63 - 0.768e-9 * t76 * t428;
    const double t448 = 0.4e-2 * t30 * t36 * t40 - 0.16e-4 * t31 * t53 + 0.32e-4 * t417 * t53 - 0.128e-6 * t46 * t63 + 0.192e-6 * t422 * t63 - 0.768e-9 * t58 * t428 + t446 * t107;
    const double t452 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t448 );
    const double t458 = t44 * sigma_bb;
    const double t463 = t56 * t137;
    const double t466 = t150 * t125;
    const double t468 = 0.1e1 / t127 / t466;
    const double t469 = t468 * t359;
    const double t477 = t71 * sigma_bb;
    const double t482 = t75 * t137;
    const double t487 = 0.4e-2 * t67 * t129 * t133 - 0.16e-4 * t157 * t145 + 0.32e-4 * t477 * t145 - 0.128e-6 * t160 * t154 + 0.192e-6 * t482 * t154 - 0.768e-9 * t163 * t469;
    const double t489 = 0.4e-2 * t30 * t129 * t133 - 0.16e-4 * t124 * t145 + 0.32e-4 * t458 * t145 - 0.128e-6 * t138 * t154 + 0.192e-6 * t463 * t154 - 0.768e-9 * t149 * t469 + t487 * t187;
    const double t493 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t489 );
    const double t494 = t6 * t26;
    const double t495 = t27 * t79;
    const double t506 = -t266 * t88 + 0.6e1 * t269 * t88 + 0.6e1 * t273 * t88 - 0.5e1 * t276 * t88 - 0.5e1 * t281 * t88 - t88 * t92;
    const double t507 = t495 * t506;
    const double t510 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t494 * t507 );
    const double t511 = t6 * t122;
    const double t512 = t27 * t166;
    const double t523 = -t168 * t172 - t384 * t168 + 0.6e1 * t387 * t168 + 0.6e1 * t391 * t168 - 0.5e1 * t394 * t168 - 0.5e1 * t399 * t168;
    const double t524 = t512 * t523;
    const double t527 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t511 * t524 );


    eps = t113 + t193;
    vrho_a = t113 + t193 + t7 * ( t291 + t307 );
    vrho_b = t113 + t193 + t7 * ( t320 + t409 );
    vsigma_aa = t7 * t452;
    vsigma_ab = 0.e0;
    vsigma_bb = t7 * t493;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t7 * t510;
    vtau_b = t7 * t527;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_fxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& v2rho2_aa, double& v2rho2_ab, double& v2rho2_bb, double& v2rhosigma_a_aa, double& v2rhosigma_a_ab, double& v2rhosigma_a_bb, double& v2rhosigma_b_aa, double& v2rhosigma_b_ab, double& v2rhosigma_b_bb, double& v2rholapl_a_a, double& v2rholapl_a_b, double& v2rholapl_b_a, double& v2rholapl_b_b, double& v2rhotau_a_a, double& v2rhotau_a_b, double& v2rhotau_b_a, double& v2rhotau_b_b, double& v2sigma2_aa_aa, double& v2sigma2_aa_ab, double& v2sigma2_aa_bb, double& v2sigma2_ab_ab, double& v2sigma2_ab_bb, double& v2sigma2_bb_bb, double& v2sigmalapl_aa_a, double& v2sigmalapl_aa_b, double& v2sigmalapl_ab_a, double& v2sigmalapl_ab_b, double& v2sigmalapl_bb_a, double& v2sigmalapl_bb_b, double& v2sigmatau_aa_a, double& v2sigmatau_aa_b, double& v2sigmatau_ab_a, double& v2sigmatau_ab_b, double& v2sigmatau_bb_a, double& v2sigmatau_bb_b, double& v2lapl2_aa, double& v2lapl2_ab, double& v2lapl2_bb, double& v2lapltau_a_a, double& v2lapltau_a_b, double& v2lapltau_b_a, double& v2lapltau_b_b, double& v2tau2_aa, double& v2tau2_ab, double& v2tau2_bb ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t80 = constants::m_cbrt_6;
    constexpr double t83 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t29 = cx_local_0;
    constexpr double t30 = cx_local_1;
    constexpr double t44 = cx_local_2;
    constexpr double t56 = cx_local_3;
    constexpr double t66 = cx_nlocal_0;
    constexpr double t67 = cx_nlocal_1;
    constexpr double t71 = cx_nlocal_2;
    constexpr double t75 = cx_nlocal_3;
    constexpr double t81 = t80 * t80;
    constexpr double t84 = t83 * t83;
    constexpr double t86 = 0.3e1 / 0.1e2 * t81 * t84;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t31 = t30 * sigma_aa;
    const double t32 = rho_a * rho_a;
    const double t33 = safe_math::cbrt( rho_a );
    const double t34 = t33 * t33;
    const double t36 = 0.1e1 / t34 / t32;
    const double t39 = 0.1e1 + 0.4e-2 * sigma_aa * t36;
    const double t40 = 0.1e1 / t39;
    const double t41 = t36 * t40;
    const double t45 = sigma_aa * sigma_aa;
    const double t46 = t44 * t45;
    const double t47 = t32 * t32;
    const double t48 = t47 * rho_a;
    const double t50 = 0.1e1 / t33 / t48;
    const double t51 = t39 * t39;
    const double t52 = 0.1e1 / t51;
    const double t53 = t50 * t52;
    const double t57 = t45 * sigma_aa;
    const double t58 = t56 * t57;
    const double t59 = t47 * t47;
    const double t60 = 0.1e1 / t59;
    const double t61 = t51 * t39;
    const double t62 = 0.1e1 / t61;
    const double t63 = t60 * t62;
    const double t68 = t67 * sigma_aa;
    const double t72 = t71 * t45;
    const double t76 = t75 * t57;
    const double t79 = t66 + 0.4e-2 * t68 * t41 + 0.16e-4 * t72 * t53 + 0.64e-7 * t76 * t63;
    const double t88 = 0.1e1 / t34 / rho_a;
    const double t89 = tau_a * t88;
    const double t90 = t86 - t89;
    const double t91 = t86 + t89;
    const double t92 = 0.1e1 / t91;
    const double t94 = t90 * t90;
    const double t95 = t94 * t90;
    const double t96 = t91 * t91;
    const double t97 = t96 * t91;
    const double t98 = 0.1e1 / t97;
    const double t101 = t94 * t94;
    const double t102 = t101 * t90;
    const double t103 = t96 * t96;
    const double t105 = 0.1e1 / t103 / t91;
    const double t107 = t102 * t105 + t90 * t92 - 0.2e1 * t95 * t98;
    const double t109 = t29 + 0.4e-2 * t31 * t41 + 0.16e-4 * t46 * t53 + 0.64e-7 * t58 * t63 + t79 * t107;
    const double t114 = rho_b <= dens_tol;
    const double t115 = -t17;
    const double t117 = piecewise_functor_5( t15, t12, t11, t16, t115 * t8 );
    const double t118 = 0.1e1 + t117;
    const double t119 = t118 <= zeta_tol;
    const double t120 = safe_math::cbrt( t118 );
    const double t122 = piecewise_functor_3( t119, t23, t120 * t118 );
    const double t123 = t122 * t27;
    const double t124 = t30 * sigma_bb;
    const double t125 = rho_b * rho_b;
    const double t126 = safe_math::cbrt( rho_b );
    const double t127 = t126 * t126;
    const double t129 = 0.1e1 / t127 / t125;
    const double t132 = 0.1e1 + 0.4e-2 * sigma_bb * t129;
    const double t133 = 0.1e1 / t132;
    const double t134 = t129 * t133;
    const double t137 = sigma_bb * sigma_bb;
    const double t138 = t44 * t137;
    const double t139 = t125 * t125;
    const double t140 = t139 * rho_b;
    const double t142 = 0.1e1 / t126 / t140;
    const double t143 = t132 * t132;
    const double t144 = 0.1e1 / t143;
    const double t145 = t142 * t144;
    const double t148 = t137 * sigma_bb;
    const double t149 = t56 * t148;
    const double t150 = t139 * t139;
    const double t151 = 0.1e1 / t150;
    const double t152 = t143 * t132;
    const double t153 = 0.1e1 / t152;
    const double t154 = t151 * t153;
    const double t157 = t67 * sigma_bb;
    const double t160 = t71 * t137;
    const double t163 = t75 * t148;
    const double t166 = t66 + 0.4e-2 * t157 * t134 + 0.16e-4 * t160 * t145 + 0.64e-7 * t163 * t154;
    const double t168 = 0.1e1 / t127 / rho_b;
    const double t169 = tau_b * t168;
    const double t170 = t86 - t169;
    const double t171 = t86 + t169;
    const double t172 = 0.1e1 / t171;
    const double t174 = t170 * t170;
    const double t175 = t174 * t170;
    const double t176 = t171 * t171;
    const double t177 = t176 * t171;
    const double t178 = 0.1e1 / t177;
    const double t181 = t174 * t174;
    const double t182 = t181 * t170;
    const double t183 = t176 * t176;
    const double t185 = 0.1e1 / t183 / t171;
    const double t187 = t170 * t172 - 0.2e1 * t175 * t178 + t182 * t185;
    const double t189 = t29 + 0.4e-2 * t124 * t134 + 0.16e-4 * t138 * t145 + 0.64e-7 * t149 * t154 + t166 * t187;
    const double t194 = t7 * t7;
    const double t195 = 0.1e1 / t194;
    const double t196 = t17 * t195;
    const double t198 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t196 );
    const double t201 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t198 );
    const double t202 = t201 * t27;
    const double t206 = t27 * t27;
    const double t207 = 0.1e1 / t206;
    const double t208 = t26 * t207;
    const double t211 = t6 * t208 * t109 / 0.8e1;
    const double t212 = t32 * rho_a;
    const double t214 = 0.1e1 / t34 / t212;
    const double t215 = t214 * t40;
    const double t218 = t30 * t45;
    const double t219 = t47 * t32;
    const double t221 = 0.1e1 / t33 / t219;
    const double t222 = t221 * t52;
    const double t227 = t44 * t57;
    const double t228 = t59 * rho_a;
    const double t229 = 0.1e1 / t228;
    const double t230 = t229 * t62;
    const double t235 = t45 * t45;
    const double t236 = t56 * t235;
    const double t237 = t59 * t212;
    const double t239 = 0.1e1 / t34 / t237;
    const double t240 = t51 * t51;
    const double t241 = 0.1e1 / t240;
    const double t242 = t239 * t241;
    const double t247 = t67 * t45;
    const double t252 = t71 * t57;
    const double t257 = t75 * t235;
    const double t260 = -0.10666666666666666667e-1 * t68 * t215 + 0.42666666666666666668e-4 * t247 * t222 - 0.85333333333333333333e-4 * t72 * t222 + 0.34133333333333333334e-6 * t252 * t230 - 0.512e-6 * t76 * t230 + 0.20480000000000000001e-8 * t257 * t242;
    const double t262 = tau_a * t36;
    const double t265 = 0.1e1 / t96;
    const double t266 = t90 * t265;
    const double t269 = t94 * t98;
    const double t272 = 0.1e1 / t103;
    const double t273 = t95 * t272;
    const double t276 = t101 * t105;
    const double t280 = 0.1e1 / t103 / t96;
    const double t281 = t102 * t280;
    const double t284 = 0.5e1 / 0.3e1 * t262 * t92 + 0.5e1 / 0.3e1 * t266 * t262 - 0.1e2 * t269 * t262 - 0.1e2 * t273 * t262 + 0.25e2 / 0.3e1 * t276 * t262 + 0.25e2 / 0.3e1 * t281 * t262;
    const double t286 = -0.10666666666666666667e-1 * t31 * t215 + 0.42666666666666666668e-4 * t218 * t222 - 0.85333333333333333333e-4 * t46 * t222 + 0.34133333333333333334e-6 * t227 * t230 - 0.512e-6 * t58 * t230 + 0.20480000000000000001e-8 * t236 * t242 + t260 * t107 + t79 * t284;
    const double t291 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t202 * t109 - t211 - 0.3e1 / 0.8e1 * t6 * t28 * t286 );
    const double t292 = t115 * t195;
    const double t294 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t292 );
    const double t297 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.3e1 * t120 * t294 );
    const double t298 = t297 * t27;
    const double t302 = t122 * t207;
    const double t305 = t6 * t302 * t189 / 0.8e1;
    const double t307 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t298 * t189 - t305 );
    const double t311 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t196 );
    const double t314 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t311 );
    const double t315 = t314 * t27;
    const double t320 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t315 * t109 - t211 );
    const double t322 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t292 );
    const double t325 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.3e1 * t120 * t322 );
    const double t326 = t325 * t27;
    const double t330 = t125 * rho_b;
    const double t332 = 0.1e1 / t127 / t330;
    const double t333 = t332 * t133;
    const double t336 = t30 * t137;
    const double t337 = t139 * t125;
    const double t339 = 0.1e1 / t126 / t337;
    const double t340 = t339 * t144;
    const double t345 = t44 * t148;
    const double t346 = t150 * rho_b;
    const double t347 = 0.1e1 / t346;
    const double t348 = t347 * t153;
    const double t353 = t137 * t137;
    const double t354 = t56 * t353;
    const double t355 = t150 * t330;
    const double t357 = 0.1e1 / t127 / t355;
    const double t358 = t143 * t143;
    const double t359 = 0.1e1 / t358;
    const double t360 = t357 * t359;
    const double t365 = t67 * t137;
    const double t370 = t71 * t148;
    const double t375 = t75 * t353;
    const double t378 = -0.10666666666666666667e-1 * t157 * t333 + 0.42666666666666666668e-4 * t365 * t340 - 0.85333333333333333333e-4 * t160 * t340 + 0.34133333333333333334e-6 * t370 * t348 - 0.512e-6 * t163 * t348 + 0.20480000000000000001e-8 * t375 * t360;
    const double t380 = tau_b * t129;
    const double t383 = 0.1e1 / t176;
    const double t384 = t170 * t383;
    const double t387 = t174 * t178;
    const double t390 = 0.1e1 / t183;
    const double t391 = t175 * t390;
    const double t394 = t181 * t185;
    const double t398 = 0.1e1 / t183 / t176;
    const double t399 = t182 * t398;
    const double t402 = 0.5e1 / 0.3e1 * t380 * t172 + 0.5e1 / 0.3e1 * t384 * t380 - 0.1e2 * t387 * t380 - 0.1e2 * t391 * t380 + 0.25e2 / 0.3e1 * t394 * t380 + 0.25e2 / 0.3e1 * t399 * t380;
    const double t404 = -0.10666666666666666667e-1 * t124 * t333 + 0.42666666666666666668e-4 * t336 * t340 - 0.85333333333333333333e-4 * t138 * t340 + 0.34133333333333333334e-6 * t345 * t348 - 0.512e-6 * t149 * t348 + 0.20480000000000000001e-8 * t354 * t360 + t378 * t187 + t166 * t402;
    const double t409 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t326 * t189 - t305 - 0.3e1 / 0.8e1 * t6 * t123 * t404 );
    const double t417 = t44 * sigma_aa;
    const double t422 = t56 * t45;
    const double t425 = t59 * t32;
    const double t427 = 0.1e1 / t34 / t425;
    const double t428 = t427 * t241;
    const double t436 = t71 * sigma_aa;
    const double t441 = t75 * t45;
    const double t446 = 0.4e-2 * t67 * t36 * t40 - 0.16e-4 * t68 * t53 + 0.32e-4 * t436 * t53 - 0.128e-6 * t72 * t63 + 0.192e-6 * t441 * t63 - 0.768e-9 * t76 * t428;
    const double t448 = 0.4e-2 * t30 * t36 * t40 - 0.16e-4 * t31 * t53 + 0.32e-4 * t417 * t53 - 0.128e-6 * t46 * t63 + 0.192e-6 * t422 * t63 - 0.768e-9 * t58 * t428 + t446 * t107;
    const double t452 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t448 );
    const double t458 = t44 * sigma_bb;
    const double t463 = t56 * t137;
    const double t466 = t150 * t125;
    const double t468 = 0.1e1 / t127 / t466;
    const double t469 = t468 * t359;
    const double t477 = t71 * sigma_bb;
    const double t482 = t75 * t137;
    const double t487 = 0.4e-2 * t67 * t129 * t133 - 0.16e-4 * t157 * t145 + 0.32e-4 * t477 * t145 - 0.128e-6 * t160 * t154 + 0.192e-6 * t482 * t154 - 0.768e-9 * t163 * t469;
    const double t489 = 0.4e-2 * t30 * t129 * t133 - 0.16e-4 * t124 * t145 + 0.32e-4 * t458 * t145 - 0.128e-6 * t138 * t154 + 0.192e-6 * t463 * t154 - 0.768e-9 * t149 * t469 + t487 * t187;
    const double t493 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t489 );
    const double t494 = t6 * t26;
    const double t495 = t27 * t79;
    const double t506 = -t266 * t88 + 0.6e1 * t269 * t88 + 0.6e1 * t273 * t88 - 0.5e1 * t276 * t88 - 0.5e1 * t281 * t88 - t88 * t92;
    const double t507 = t495 * t506;
    const double t510 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t494 * t507 );
    const double t511 = t6 * t122;
    const double t512 = t27 * t166;
    const double t523 = -t168 * t172 - t384 * t168 + 0.6e1 * t387 * t168 + 0.6e1 * t391 * t168 - 0.5e1 * t394 * t168 - 0.5e1 * t399 * t168;
    const double t524 = t512 * t523;
    const double t527 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t511 * t524 );
    const double t530 = t24 * t24;
    const double t531 = 0.1e1 / t530;
    const double t532 = t198 * t198;
    const double t535 = t194 * t7;
    const double t536 = 0.1e1 / t535;
    const double t537 = t17 * t536;
    const double t540 = piecewise_functor_5( t11, 0.0, t15, 0.0, -0.2e1 * t195 + 0.2e1 * t537 );
    const double t544 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.9e1 * t531 * t532 + 0.4e1 / 0.3e1 * t24 * t540 );
    const double t545 = t544 * t27;
    const double t549 = t201 * t207;
    const double t551 = t6 * t549 * t109;
    const double t557 = 0.1e1 / t206 / t7;
    const double t558 = t26 * t557;
    const double t561 = t6 * t558 * t109 / 0.12e2;
    const double t563 = t6 * t208 * t286;
    const double t566 = 0.1e1 / t34 / t47;
    const double t567 = t566 * t40;
    const double t570 = t47 * t212;
    const double t572 = 0.1e1 / t33 / t570;
    const double t573 = t572 * t52;
    const double t576 = t30 * t57;
    const double t577 = 0.1e1 / t425;
    const double t578 = t577 * t62;
    const double t585 = t44 * t235;
    const double t586 = t59 * t47;
    const double t588 = 0.1e1 / t34 / t586;
    const double t589 = t588 * t241;
    const double t596 = t235 * sigma_aa;
    const double t597 = t56 * t596;
    const double t602 = 0.1e1 / t240 / t39;
    const double t603 = 0.1e1 / t33 / t59 / t570 * t602;
    const double t610 = t67 * t57;
    const double t617 = t71 * t235;
    const double t624 = t75 * t596;
    const double t627 = 0.39111111111111111112e-1 * t68 * t567 - 0.38400000000000000001e-3 * t247 * t573 + 0.91022222222222222228e-6 * t610 * t578 + 0.54044444444444444444e-3 * t72 * t573 - 0.48924444444444444446e-5 * t252 * t578 + 0.10922666666666666667e-7 * t617 * t589 + 0.4608e-5 * t76 * t578 - 0.40277333333333333336e-7 * t257 * t589 + 0.8738133333333333334e-10 * t624 * t603;
    const double t631 = tau_a * t214;
    const double t634 = tau_a * tau_a;
    const double t635 = t634 * t50;
    const double t638 = t90 * t98;
    const double t643 = t94 * t272;
    const double t648 = t95 * t105;
    const double t653 = t101 * t280;
    const double t659 = 0.1e1 / t103 / t97;
    const double t660 = t102 * t659;
    const double t665 = -0.4e2 / 0.9e1 * t631 * t92 + 0.5e2 / 0.9e1 * t635 * t265 - 0.25e3 / 0.9e1 * t638 * t635 - 0.4e2 / 0.9e1 * t266 * t631 - 0.1e3 * t643 * t635 + 0.8e2 / 0.3e1 * t269 * t631 - 0.1e3 / 0.9e1 * t648 * t635 + 0.8e2 / 0.3e1 * t273 * t631 + 0.125e4 / 0.9e1 * t653 * t635 - 0.2e3 / 0.9e1 * t276 * t631 + 0.25e3 / 0.3e1 * t660 * t635 - 0.2e3 / 0.9e1 * t281 * t631;
    const double t667 = 0.39111111111111111112e-1 * t31 * t567 - 0.38400000000000000001e-3 * t218 * t573 + 0.91022222222222222228e-6 * t576 * t578 + 0.54044444444444444444e-3 * t46 * t573 - 0.48924444444444444446e-5 * t227 * t578 + 0.10922666666666666667e-7 * t585 * t589 + 0.4608e-5 * t58 * t578 - 0.40277333333333333336e-7 * t236 * t589 + 0.8738133333333333334e-10 * t597 * t603 + t627 * t107 + 0.2e1 * t260 * t284 + t79 * t665;
    const double t672 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t545 * t109 - t551 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t202 * t286 + t561 - t563 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t667 );
    const double t673 = t120 * t120;
    const double t674 = 0.1e1 / t673;
    const double t675 = t294 * t294;
    const double t678 = t115 * t536;
    const double t681 = piecewise_functor_5( t15, 0.0, t11, 0.0, 0.2e1 * t195 + 0.2e1 * t678 );
    const double t685 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.9e1 * t674 * t675 + 0.4e1 / 0.3e1 * t120 * t681 );
    const double t686 = t685 * t27;
    const double t690 = t297 * t207;
    const double t692 = t6 * t690 * t189;
    const double t694 = t122 * t557;
    const double t697 = t6 * t694 * t189 / 0.12e2;
    const double t699 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t686 * t189 - t692 / 0.4e1 + t697 );
    const double t715 = t314 * t207;
    const double t717 = t6 * t715 * t109;
    const double t739 = t325 * t207;
    const double t741 = t6 * t739 * t189;
    const double t748 = t6 * t302 * t404;
    const double t756 = t311 * t311;
    const double t761 = piecewise_functor_5( t11, 0.0, t15, 0.0, 0.2e1 * t195 + 0.2e1 * t537 );
    const double t765 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.9e1 * t531 * t756 + 0.4e1 / 0.3e1 * t24 * t761 );
    const double t766 = t765 * t27;
    const double t772 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t766 * t109 - t717 / 0.4e1 + t561 );
    const double t773 = t322 * t322;
    const double t778 = piecewise_functor_5( t15, 0.0, t11, 0.0, -0.2e1 * t195 + 0.2e1 * t678 );
    const double t782 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.9e1 * t674 * t773 + 0.4e1 / 0.3e1 * t120 * t778 );
    const double t783 = t782 * t27;
    const double t793 = 0.1e1 / t127 / t139;
    const double t794 = t793 * t133;
    const double t797 = t139 * t330;
    const double t799 = 0.1e1 / t126 / t797;
    const double t800 = t799 * t144;
    const double t803 = t30 * t148;
    const double t804 = 0.1e1 / t466;
    const double t805 = t804 * t153;
    const double t812 = t44 * t353;
    const double t813 = t150 * t139;
    const double t815 = 0.1e1 / t127 / t813;
    const double t816 = t815 * t359;
    const double t823 = t353 * sigma_bb;
    const double t824 = t56 * t823;
    const double t829 = 0.1e1 / t358 / t132;
    const double t830 = 0.1e1 / t126 / t150 / t797 * t829;
    const double t837 = t67 * t148;
    const double t844 = t71 * t353;
    const double t851 = t75 * t823;
    const double t854 = 0.39111111111111111112e-1 * t157 * t794 - 0.38400000000000000001e-3 * t365 * t800 + 0.91022222222222222228e-6 * t837 * t805 + 0.54044444444444444444e-3 * t160 * t800 - 0.48924444444444444446e-5 * t370 * t805 + 0.10922666666666666667e-7 * t844 * t816 + 0.4608e-5 * t163 * t805 - 0.40277333333333333336e-7 * t375 * t816 + 0.8738133333333333334e-10 * t851 * t830;
    const double t858 = tau_b * t332;
    const double t861 = tau_b * tau_b;
    const double t862 = t861 * t142;
    const double t865 = t170 * t178;
    const double t870 = t174 * t390;
    const double t875 = t175 * t185;
    const double t880 = t181 * t398;
    const double t886 = 0.1e1 / t183 / t177;
    const double t887 = t182 * t886;
    const double t892 = -0.4e2 / 0.9e1 * t858 * t172 + 0.5e2 / 0.9e1 * t862 * t383 - 0.25e3 / 0.9e1 * t865 * t862 - 0.4e2 / 0.9e1 * t384 * t858 - 0.1e3 * t870 * t862 + 0.8e2 / 0.3e1 * t387 * t858 - 0.1e3 / 0.9e1 * t875 * t862 + 0.8e2 / 0.3e1 * t391 * t858 + 0.125e4 / 0.9e1 * t880 * t862 - 0.2e3 / 0.9e1 * t394 * t858 + 0.25e3 / 0.3e1 * t887 * t862 - 0.2e3 / 0.9e1 * t399 * t858;
    const double t894 = 0.39111111111111111112e-1 * t124 * t794 - 0.38400000000000000001e-3 * t336 * t800 + 0.91022222222222222228e-6 * t803 * t805 + 0.54044444444444444444e-3 * t138 * t800 - 0.48924444444444444446e-5 * t345 * t805 + 0.10922666666666666667e-7 * t812 * t816 + 0.4608e-5 * t149 * t805 - 0.40277333333333333336e-7 * t354 * t816 + 0.8738133333333333334e-10 * t824 * t830 + t854 * t187 + 0.2e1 * t378 * t402 + t166 * t892;
    const double t899 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t783 * t189 - t741 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t326 * t404 + t697 - t748 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t123 * t894 );
    const double t907 = t6 * t208 * t448 / 0.8e1;
    const double t911 = t30 * t221;
    const double t912 = t52 * sigma_aa;
    const double t927 = t59 * t219;
    const double t930 = 0.1e1 / t33 / t927 * t602;
    const double t936 = t67 * t221;
    const double t953 = -0.10666666666666666667e-1 * t67 * t214 * t40 + 0.128e-3 * t936 * t912 - 0.34133333333333333334e-6 * t247 * t230 - 0.17066666666666666667e-3 * t436 * t222 + 0.17066666666666666667e-5 * t72 * t230 - 0.40960000000000000001e-8 * t252 * t242 - 0.1536e-5 * t441 * t230 + 0.14336e-7 * t76 * t242 - 0.32768000000000000001e-10 * t257 * t930;
    const double t956 = -0.10666666666666666667e-1 * t30 * t214 * t40 + 0.128e-3 * t911 * t912 - 0.34133333333333333334e-6 * t218 * t230 - 0.17066666666666666667e-3 * t417 * t222 + 0.17066666666666666667e-5 * t46 * t230 - 0.40960000000000000001e-8 * t227 * t242 - 0.1536e-5 * t422 * t230 + 0.14336e-7 * t58 * t242 - 0.32768000000000000001e-10 * t236 * t930 + t953 * t107 + t446 * t284;
    const double t961 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t202 * t448 - t907 - 0.3e1 / 0.8e1 * t6 * t28 * t956 );
    const double t968 = t6 * t302 * t489 / 0.8e1;
    const double t984 = t30 * t339;
    const double t985 = t144 * sigma_bb;
    const double t1000 = t150 * t337;
    const double t1003 = 0.1e1 / t126 / t1000 * t829;
    const double t1009 = t67 * t339;
    const double t1026 = -0.10666666666666666667e-1 * t67 * t332 * t133 + 0.128e-3 * t1009 * t985 - 0.34133333333333333334e-6 * t365 * t348 - 0.17066666666666666667e-3 * t477 * t340 + 0.17066666666666666667e-5 * t160 * t348 - 0.40960000000000000001e-8 * t370 * t360 - 0.1536e-5 * t482 * t348 + 0.14336e-7 * t163 * t360 - 0.32768000000000000001e-10 * t375 * t1003;
    const double t1029 = -0.10666666666666666667e-1 * t30 * t332 * t133 + 0.128e-3 * t984 * t985 - 0.34133333333333333334e-6 * t336 * t348 - 0.17066666666666666667e-3 * t458 * t340 + 0.17066666666666666667e-5 * t138 * t348 - 0.40960000000000000001e-8 * t345 * t360 - 0.1536e-5 * t463 * t348 + 0.14336e-7 * t149 * t360 - 0.32768000000000000001e-10 * t354 * t1003 + t1026 * t187 + t487 * t402;
    const double t1034 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t326 * t489 - t968 - 0.3e1 / 0.8e1 * t6 * t123 * t1029 );
    const double t1036 = t6 * t201;
    const double t1039 = t207 * t79;
    const double t1040 = t1039 * t506;
    const double t1042 = t494 * t1040 / 0.8e1;
    const double t1043 = t27 * t260;
    const double t1044 = t1043 * t506;
    const double t1050 = 0.1e1 / t33 / t47;
    const double t1051 = t1050 * t265;
    const double t1054 = t1050 * tau_a;
    const double t1075 = 0.5e1 / 0.3e1 * t36 * t92 - 0.1e2 / 0.3e1 * t1051 * tau_a + 0.5e2 / 0.3e1 * t638 * t1054 + 0.5e1 / 0.3e1 * t266 * t36 + 0.6e2 * t643 * t1054 - 0.1e2 * t269 * t36 + 0.2e2 / 0.3e1 * t648 * t1054 - 0.1e2 * t273 * t36 - 0.25e3 / 0.3e1 * t653 * t1054 + 0.25e2 / 0.3e1 * t276 * t36 - 0.5e2 * t660 * t1054 + 0.25e2 / 0.3e1 * t281 * t36;
    const double t1076 = t495 * t1075;
    const double t1080 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t1036 * t507 - t1042 - 0.3e1 / 0.8e1 * t494 * t1044 - 0.3e1 / 0.8e1 * t494 * t1076 );
    const double t1085 = t207 * t166;
    const double t1086 = t1085 * t523;
    const double t1088 = t511 * t1086 / 0.8e1;
    const double t1098 = t6 * t325;
    const double t1101 = t27 * t378;
    const double t1102 = t1101 * t523;
    const double t1108 = 0.1e1 / t126 / t139;
    const double t1109 = t1108 * t383;
    const double t1112 = t1108 * tau_b;
    const double t1133 = 0.5e1 / 0.3e1 * t129 * t172 - 0.1e2 / 0.3e1 * t1109 * tau_b + 0.5e2 / 0.3e1 * t865 * t1112 + 0.5e1 / 0.3e1 * t384 * t129 + 0.6e2 * t870 * t1112 - 0.1e2 * t387 * t129 + 0.2e2 / 0.3e1 * t875 * t1112 - 0.1e2 * t391 * t129 - 0.25e3 / 0.3e1 * t880 * t1112 + 0.25e2 / 0.3e1 * t394 * t129 - 0.5e2 * t887 * t1112 + 0.25e2 / 0.3e1 * t399 * t129;
    const double t1134 = t512 * t1133;
    const double t1138 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t1098 * t524 - t1088 - 0.3e1 / 0.8e1 * t511 * t1102 - 0.3e1 / 0.8e1 * t511 * t1134 );
    const double t1152 = t56 * sigma_aa;
    const double t1157 = t59 * t48;
    const double t1160 = 0.1e1 / t33 / t1157 * t602;
    const double t1175 = t75 * sigma_aa;
    const double t1182 = -0.32e-4 * t67 * t50 * t52 + 0.128e-6 * t68 * t63 + 0.32e-4 * t71 * t50 * t52 - 0.512e-6 * t436 * t63 + 0.1536e-8 * t72 * t428 + 0.384e-6 * t1175 * t63 - 0.4608e-8 * t441 * t428 + 0.12288e-10 * t76 * t1160;
    const double t1184 = -0.32e-4 * t30 * t50 * t52 + 0.128e-6 * t31 * t63 + 0.32e-4 * t44 * t50 * t52 - 0.512e-6 * t417 * t63 + 0.1536e-8 * t46 * t428 + 0.384e-6 * t1152 * t63 - 0.4608e-8 * t422 * t428 + 0.12288e-10 * t58 * t1160 + t1182 * t107;
    const double t1188 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t1184 );
    const double t1201 = t56 * sigma_bb;
    const double t1206 = t150 * t140;
    const double t1209 = 0.1e1 / t126 / t1206 * t829;
    const double t1224 = t75 * sigma_bb;
    const double t1231 = -0.32e-4 * t67 * t142 * t144 + 0.128e-6 * t157 * t154 + 0.32e-4 * t71 * t142 * t144 - 0.512e-6 * t477 * t154 + 0.1536e-8 * t160 * t469 + 0.384e-6 * t1224 * t154 - 0.4608e-8 * t482 * t469 + 0.12288e-10 * t163 * t1209;
    const double t1233 = -0.32e-4 * t30 * t142 * t144 + 0.128e-6 * t124 * t154 + 0.32e-4 * t44 * t142 * t144 - 0.512e-6 * t458 * t154 + 0.1536e-8 * t138 * t469 + 0.384e-6 * t1201 * t154 - 0.4608e-8 * t463 * t469 + 0.12288e-10 * t149 * t1209 + t1231 * t187;
    const double t1237 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t1233 );
    const double t1238 = t27 * t446;
    const double t1239 = t1238 * t506;
    const double t1242 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t494 * t1239 );
    const double t1243 = t27 * t487;
    const double t1244 = t1243 * t523;
    const double t1247 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t511 * t1244 );
    const double t1249 = 0.1e1 / t33 / t212;
    const double t1262 = 0.2e1 * t1249 * t265 - 0.1e2 * t638 * t1249 - 0.36e2 * t643 * t1249 - 0.4e1 * t648 * t1249 + 0.5e2 * t653 * t1249 + 0.3e2 * t660 * t1249;
    const double t1263 = t495 * t1262;
    const double t1266 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t494 * t1263 );
    const double t1268 = 0.1e1 / t126 / t330;
    const double t1281 = 0.2e1 * t1268 * t383 - 0.1e2 * t865 * t1268 - 0.36e2 * t870 * t1268 - 0.4e1 * t875 * t1268 + 0.5e2 * t880 * t1268 + 0.3e2 * t887 * t1268;
    const double t1282 = t512 * t1281;
    const double t1285 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t511 * t1282 );


    v2rho2_aa = 0.2e1 * t291 + 0.2e1 * t307 + t7 * ( t672 + t699 );
    v2rho2_bb = 0.2e1 * t320 + 0.2e1 * t409 + t7 * ( t772 + t899 );
    v2rhosigma_a_aa = t7 * t961 + t452;
    v2rhosigma_b_bb = t7 * t1034 + t493;
    v2rholapl_a_a = 0.e0;
    v2rholapl_b_b = 0.e0;
    v2rhotau_a_a = t7 * t1080 + t510;
    v2rhotau_b_b = t7 * t1138 + t527;
    v2sigma2_aa_aa = t7 * t1188;
    v2sigma2_bb_bb = t7 * t1237;
    v2sigmalapl_aa_a = 0.e0;
    v2sigmalapl_bb_b = 0.e0;
    v2sigmatau_aa_a = t7 * t1242;
    v2sigmatau_bb_b = t7 * t1247;
    v2lapl2_aa = 0.e0;
    v2lapl2_bb = 0.e0;
    v2lapltau_a_a = 0.e0;
    v2lapltau_b_b = 0.e0;
    v2tau2_aa = t7 * t1266;
    v2tau2_bb = t7 * t1285;
    v2rho2_ab = 0.0;
    v2rhosigma_a_ab = 0.0;
    v2rhosigma_a_bb = 0.0;
    v2rhosigma_b_aa = 0.0;
    v2rhosigma_b_ab = 0.0;
    v2rholapl_a_b = 0.0;
    v2rholapl_b_a = 0.0;
    v2rhotau_a_b = 0.0;
    v2rhotau_b_a = 0.0;
    v2sigma2_aa_ab = 0.0;
    v2sigma2_aa_bb = 0.0;
    v2sigma2_ab_ab = 0.0;
    v2sigma2_ab_bb = 0.0;
    v2sigmalapl_aa_b = 0.0;
    v2sigmalapl_ab_a = 0.0;
    v2sigmalapl_ab_b = 0.0;
    v2sigmalapl_bb_a = 0.0;
    v2sigmatau_aa_b = 0.0;
    v2sigmatau_ab_a = 0.0;
    v2sigmatau_ab_b = 0.0;
    v2sigmatau_bb_a = 0.0;
    v2lapl2_ab = 0.0;
    v2lapltau_a_b = 0.0;
    v2lapltau_b_a = 0.0;
    v2tau2_ab = 0.0;



  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_vxc_fxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b, double& v2rho2_aa, double& v2rho2_ab, double& v2rho2_bb, double& v2rhosigma_a_aa, double& v2rhosigma_a_ab, double& v2rhosigma_a_bb, double& v2rhosigma_b_aa, double& v2rhosigma_b_ab, double& v2rhosigma_b_bb, double& v2rholapl_a_a, double& v2rholapl_a_b, double& v2rholapl_b_a, double& v2rholapl_b_b, double& v2rhotau_a_a, double& v2rhotau_a_b, double& v2rhotau_b_a, double& v2rhotau_b_b, double& v2sigma2_aa_aa, double& v2sigma2_aa_ab, double& v2sigma2_aa_bb, double& v2sigma2_ab_ab, double& v2sigma2_ab_bb, double& v2sigma2_bb_bb, double& v2sigmalapl_aa_a, double& v2sigmalapl_aa_b, double& v2sigmalapl_ab_a, double& v2sigmalapl_ab_b, double& v2sigmalapl_bb_a, double& v2sigmalapl_bb_b, double& v2sigmatau_aa_a, double& v2sigmatau_aa_b, double& v2sigmatau_ab_a, double& v2sigmatau_ab_b, double& v2sigmatau_bb_a, double& v2sigmatau_bb_b, double& v2lapl2_aa, double& v2lapl2_ab, double& v2lapl2_bb, double& v2lapltau_a_a, double& v2lapltau_a_b, double& v2lapltau_b_a, double& v2lapltau_b_b, double& v2tau2_aa, double& v2tau2_ab, double& v2tau2_bb ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t80 = constants::m_cbrt_6;
    constexpr double t83 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t29 = cx_local_0;
    constexpr double t30 = cx_local_1;
    constexpr double t44 = cx_local_2;
    constexpr double t56 = cx_local_3;
    constexpr double t66 = cx_nlocal_0;
    constexpr double t67 = cx_nlocal_1;
    constexpr double t71 = cx_nlocal_2;
    constexpr double t75 = cx_nlocal_3;
    constexpr double t81 = t80 * t80;
    constexpr double t84 = t83 * t83;
    constexpr double t86 = 0.3e1 / 0.1e2 * t81 * t84;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = safe_math::cbrt( t7 );
    const double t28 = t26 * t27;
    const double t31 = t30 * sigma_aa;
    const double t32 = rho_a * rho_a;
    const double t33 = safe_math::cbrt( rho_a );
    const double t34 = t33 * t33;
    const double t36 = 0.1e1 / t34 / t32;
    const double t39 = 0.1e1 + 0.4e-2 * sigma_aa * t36;
    const double t40 = 0.1e1 / t39;
    const double t41 = t36 * t40;
    const double t45 = sigma_aa * sigma_aa;
    const double t46 = t44 * t45;
    const double t47 = t32 * t32;
    const double t48 = t47 * rho_a;
    const double t50 = 0.1e1 / t33 / t48;
    const double t51 = t39 * t39;
    const double t52 = 0.1e1 / t51;
    const double t53 = t50 * t52;
    const double t57 = t45 * sigma_aa;
    const double t58 = t56 * t57;
    const double t59 = t47 * t47;
    const double t60 = 0.1e1 / t59;
    const double t61 = t51 * t39;
    const double t62 = 0.1e1 / t61;
    const double t63 = t60 * t62;
    const double t68 = t67 * sigma_aa;
    const double t72 = t71 * t45;
    const double t76 = t75 * t57;
    const double t79 = t66 + 0.4e-2 * t68 * t41 + 0.16e-4 * t72 * t53 + 0.64e-7 * t76 * t63;
    const double t88 = 0.1e1 / t34 / rho_a;
    const double t89 = tau_a * t88;
    const double t90 = t86 - t89;
    const double t91 = t86 + t89;
    const double t92 = 0.1e1 / t91;
    const double t94 = t90 * t90;
    const double t95 = t94 * t90;
    const double t96 = t91 * t91;
    const double t97 = t96 * t91;
    const double t98 = 0.1e1 / t97;
    const double t101 = t94 * t94;
    const double t102 = t101 * t90;
    const double t103 = t96 * t96;
    const double t105 = 0.1e1 / t103 / t91;
    const double t107 = t102 * t105 + t90 * t92 - 0.2e1 * t95 * t98;
    const double t109 = t29 + 0.4e-2 * t31 * t41 + 0.16e-4 * t46 * t53 + 0.64e-7 * t58 * t63 + t79 * t107;
    const double t113 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t109 );
    const double t114 = rho_b <= dens_tol;
    const double t115 = -t17;
    const double t117 = piecewise_functor_5( t15, t12, t11, t16, t115 * t8 );
    const double t118 = 0.1e1 + t117;
    const double t119 = t118 <= zeta_tol;
    const double t120 = safe_math::cbrt( t118 );
    const double t122 = piecewise_functor_3( t119, t23, t120 * t118 );
    const double t123 = t122 * t27;
    const double t124 = t30 * sigma_bb;
    const double t125 = rho_b * rho_b;
    const double t126 = safe_math::cbrt( rho_b );
    const double t127 = t126 * t126;
    const double t129 = 0.1e1 / t127 / t125;
    const double t132 = 0.1e1 + 0.4e-2 * sigma_bb * t129;
    const double t133 = 0.1e1 / t132;
    const double t134 = t129 * t133;
    const double t137 = sigma_bb * sigma_bb;
    const double t138 = t44 * t137;
    const double t139 = t125 * t125;
    const double t140 = t139 * rho_b;
    const double t142 = 0.1e1 / t126 / t140;
    const double t143 = t132 * t132;
    const double t144 = 0.1e1 / t143;
    const double t145 = t142 * t144;
    const double t148 = t137 * sigma_bb;
    const double t149 = t56 * t148;
    const double t150 = t139 * t139;
    const double t151 = 0.1e1 / t150;
    const double t152 = t143 * t132;
    const double t153 = 0.1e1 / t152;
    const double t154 = t151 * t153;
    const double t157 = t67 * sigma_bb;
    const double t160 = t71 * t137;
    const double t163 = t75 * t148;
    const double t166 = t66 + 0.4e-2 * t157 * t134 + 0.16e-4 * t160 * t145 + 0.64e-7 * t163 * t154;
    const double t168 = 0.1e1 / t127 / rho_b;
    const double t169 = tau_b * t168;
    const double t170 = t86 - t169;
    const double t171 = t86 + t169;
    const double t172 = 0.1e1 / t171;
    const double t174 = t170 * t170;
    const double t175 = t174 * t170;
    const double t176 = t171 * t171;
    const double t177 = t176 * t171;
    const double t178 = 0.1e1 / t177;
    const double t181 = t174 * t174;
    const double t182 = t181 * t170;
    const double t183 = t176 * t176;
    const double t185 = 0.1e1 / t183 / t171;
    const double t187 = t170 * t172 - 0.2e1 * t175 * t178 + t182 * t185;
    const double t189 = t29 + 0.4e-2 * t124 * t134 + 0.16e-4 * t138 * t145 + 0.64e-7 * t149 * t154 + t166 * t187;
    const double t193 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t189 );
    const double t194 = t7 * t7;
    const double t195 = 0.1e1 / t194;
    const double t196 = t17 * t195;
    const double t198 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t196 );
    const double t201 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t198 );
    const double t202 = t201 * t27;
    const double t206 = t27 * t27;
    const double t207 = 0.1e1 / t206;
    const double t208 = t26 * t207;
    const double t211 = t6 * t208 * t109 / 0.8e1;
    const double t212 = t32 * rho_a;
    const double t214 = 0.1e1 / t34 / t212;
    const double t215 = t214 * t40;
    const double t218 = t30 * t45;
    const double t219 = t47 * t32;
    const double t221 = 0.1e1 / t33 / t219;
    const double t222 = t221 * t52;
    const double t227 = t44 * t57;
    const double t228 = t59 * rho_a;
    const double t229 = 0.1e1 / t228;
    const double t230 = t229 * t62;
    const double t235 = t45 * t45;
    const double t236 = t56 * t235;
    const double t237 = t59 * t212;
    const double t239 = 0.1e1 / t34 / t237;
    const double t240 = t51 * t51;
    const double t241 = 0.1e1 / t240;
    const double t242 = t239 * t241;
    const double t247 = t67 * t45;
    const double t252 = t71 * t57;
    const double t257 = t75 * t235;
    const double t260 = -0.10666666666666666667e-1 * t68 * t215 + 0.42666666666666666668e-4 * t247 * t222 - 0.85333333333333333333e-4 * t72 * t222 + 0.34133333333333333334e-6 * t252 * t230 - 0.512e-6 * t76 * t230 + 0.20480000000000000001e-8 * t257 * t242;
    const double t262 = tau_a * t36;
    const double t265 = 0.1e1 / t96;
    const double t266 = t90 * t265;
    const double t269 = t94 * t98;
    const double t272 = 0.1e1 / t103;
    const double t273 = t95 * t272;
    const double t276 = t101 * t105;
    const double t280 = 0.1e1 / t103 / t96;
    const double t281 = t102 * t280;
    const double t284 = 0.5e1 / 0.3e1 * t262 * t92 + 0.5e1 / 0.3e1 * t266 * t262 - 0.1e2 * t269 * t262 - 0.1e2 * t273 * t262 + 0.25e2 / 0.3e1 * t276 * t262 + 0.25e2 / 0.3e1 * t281 * t262;
    const double t286 = -0.10666666666666666667e-1 * t31 * t215 + 0.42666666666666666668e-4 * t218 * t222 - 0.85333333333333333333e-4 * t46 * t222 + 0.34133333333333333334e-6 * t227 * t230 - 0.512e-6 * t58 * t230 + 0.20480000000000000001e-8 * t236 * t242 + t260 * t107 + t79 * t284;
    const double t291 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t202 * t109 - t211 - 0.3e1 / 0.8e1 * t6 * t28 * t286 );
    const double t292 = t115 * t195;
    const double t294 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t292 );
    const double t297 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.3e1 * t120 * t294 );
    const double t298 = t297 * t27;
    const double t302 = t122 * t207;
    const double t305 = t6 * t302 * t189 / 0.8e1;
    const double t307 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t298 * t189 - t305 );
    const double t311 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t196 );
    const double t314 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t311 );
    const double t315 = t314 * t27;
    const double t320 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t315 * t109 - t211 );
    const double t322 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t292 );
    const double t325 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.3e1 * t120 * t322 );
    const double t326 = t325 * t27;
    const double t330 = t125 * rho_b;
    const double t332 = 0.1e1 / t127 / t330;
    const double t333 = t332 * t133;
    const double t336 = t30 * t137;
    const double t337 = t139 * t125;
    const double t339 = 0.1e1 / t126 / t337;
    const double t340 = t339 * t144;
    const double t345 = t44 * t148;
    const double t346 = t150 * rho_b;
    const double t347 = 0.1e1 / t346;
    const double t348 = t347 * t153;
    const double t353 = t137 * t137;
    const double t354 = t56 * t353;
    const double t355 = t150 * t330;
    const double t357 = 0.1e1 / t127 / t355;
    const double t358 = t143 * t143;
    const double t359 = 0.1e1 / t358;
    const double t360 = t357 * t359;
    const double t365 = t67 * t137;
    const double t370 = t71 * t148;
    const double t375 = t75 * t353;
    const double t378 = -0.10666666666666666667e-1 * t157 * t333 + 0.42666666666666666668e-4 * t365 * t340 - 0.85333333333333333333e-4 * t160 * t340 + 0.34133333333333333334e-6 * t370 * t348 - 0.512e-6 * t163 * t348 + 0.20480000000000000001e-8 * t375 * t360;
    const double t380 = tau_b * t129;
    const double t383 = 0.1e1 / t176;
    const double t384 = t170 * t383;
    const double t387 = t174 * t178;
    const double t390 = 0.1e1 / t183;
    const double t391 = t175 * t390;
    const double t394 = t181 * t185;
    const double t398 = 0.1e1 / t183 / t176;
    const double t399 = t182 * t398;
    const double t402 = 0.5e1 / 0.3e1 * t380 * t172 + 0.5e1 / 0.3e1 * t384 * t380 - 0.1e2 * t387 * t380 - 0.1e2 * t391 * t380 + 0.25e2 / 0.3e1 * t394 * t380 + 0.25e2 / 0.3e1 * t399 * t380;
    const double t404 = -0.10666666666666666667e-1 * t124 * t333 + 0.42666666666666666668e-4 * t336 * t340 - 0.85333333333333333333e-4 * t138 * t340 + 0.34133333333333333334e-6 * t345 * t348 - 0.512e-6 * t149 * t348 + 0.20480000000000000001e-8 * t354 * t360 + t378 * t187 + t166 * t402;
    const double t409 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t326 * t189 - t305 - 0.3e1 / 0.8e1 * t6 * t123 * t404 );
    const double t417 = t44 * sigma_aa;
    const double t422 = t56 * t45;
    const double t425 = t59 * t32;
    const double t427 = 0.1e1 / t34 / t425;
    const double t428 = t427 * t241;
    const double t436 = t71 * sigma_aa;
    const double t441 = t75 * t45;
    const double t446 = 0.4e-2 * t67 * t36 * t40 - 0.16e-4 * t68 * t53 + 0.32e-4 * t436 * t53 - 0.128e-6 * t72 * t63 + 0.192e-6 * t441 * t63 - 0.768e-9 * t76 * t428;
    const double t448 = 0.4e-2 * t30 * t36 * t40 - 0.16e-4 * t31 * t53 + 0.32e-4 * t417 * t53 - 0.128e-6 * t46 * t63 + 0.192e-6 * t422 * t63 - 0.768e-9 * t58 * t428 + t446 * t107;
    const double t452 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t448 );
    const double t458 = t44 * sigma_bb;
    const double t463 = t56 * t137;
    const double t466 = t150 * t125;
    const double t468 = 0.1e1 / t127 / t466;
    const double t469 = t468 * t359;
    const double t477 = t71 * sigma_bb;
    const double t482 = t75 * t137;
    const double t487 = 0.4e-2 * t67 * t129 * t133 - 0.16e-4 * t157 * t145 + 0.32e-4 * t477 * t145 - 0.128e-6 * t160 * t154 + 0.192e-6 * t482 * t154 - 0.768e-9 * t163 * t469;
    const double t489 = 0.4e-2 * t30 * t129 * t133 - 0.16e-4 * t124 * t145 + 0.32e-4 * t458 * t145 - 0.128e-6 * t138 * t154 + 0.192e-6 * t463 * t154 - 0.768e-9 * t149 * t469 + t487 * t187;
    const double t493 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t489 );
    const double t494 = t6 * t26;
    const double t495 = t27 * t79;
    const double t506 = -t266 * t88 + 0.6e1 * t269 * t88 + 0.6e1 * t273 * t88 - 0.5e1 * t276 * t88 - 0.5e1 * t281 * t88 - t88 * t92;
    const double t507 = t495 * t506;
    const double t510 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t494 * t507 );
    const double t511 = t6 * t122;
    const double t512 = t27 * t166;
    const double t523 = -t168 * t172 - t384 * t168 + 0.6e1 * t387 * t168 + 0.6e1 * t391 * t168 - 0.5e1 * t394 * t168 - 0.5e1 * t399 * t168;
    const double t524 = t512 * t523;
    const double t527 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t511 * t524 );
    const double t530 = t24 * t24;
    const double t531 = 0.1e1 / t530;
    const double t532 = t198 * t198;
    const double t535 = t194 * t7;
    const double t536 = 0.1e1 / t535;
    const double t537 = t17 * t536;
    const double t540 = piecewise_functor_5( t11, 0.0, t15, 0.0, -0.2e1 * t195 + 0.2e1 * t537 );
    const double t544 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.9e1 * t531 * t532 + 0.4e1 / 0.3e1 * t24 * t540 );
    const double t545 = t544 * t27;
    const double t549 = t201 * t207;
    const double t551 = t6 * t549 * t109;
    const double t557 = 0.1e1 / t206 / t7;
    const double t558 = t26 * t557;
    const double t561 = t6 * t558 * t109 / 0.12e2;
    const double t563 = t6 * t208 * t286;
    const double t566 = 0.1e1 / t34 / t47;
    const double t567 = t566 * t40;
    const double t570 = t47 * t212;
    const double t572 = 0.1e1 / t33 / t570;
    const double t573 = t572 * t52;
    const double t576 = t30 * t57;
    const double t577 = 0.1e1 / t425;
    const double t578 = t577 * t62;
    const double t585 = t44 * t235;
    const double t586 = t59 * t47;
    const double t588 = 0.1e1 / t34 / t586;
    const double t589 = t588 * t241;
    const double t596 = t235 * sigma_aa;
    const double t597 = t56 * t596;
    const double t602 = 0.1e1 / t240 / t39;
    const double t603 = 0.1e1 / t33 / t59 / t570 * t602;
    const double t610 = t67 * t57;
    const double t617 = t71 * t235;
    const double t624 = t75 * t596;
    const double t627 = 0.39111111111111111112e-1 * t68 * t567 - 0.38400000000000000001e-3 * t247 * t573 + 0.91022222222222222228e-6 * t610 * t578 + 0.54044444444444444444e-3 * t72 * t573 - 0.48924444444444444446e-5 * t252 * t578 + 0.10922666666666666667e-7 * t617 * t589 + 0.4608e-5 * t76 * t578 - 0.40277333333333333336e-7 * t257 * t589 + 0.8738133333333333334e-10 * t624 * t603;
    const double t631 = tau_a * t214;
    const double t634 = tau_a * tau_a;
    const double t635 = t634 * t50;
    const double t638 = t90 * t98;
    const double t643 = t94 * t272;
    const double t648 = t95 * t105;
    const double t653 = t101 * t280;
    const double t659 = 0.1e1 / t103 / t97;
    const double t660 = t102 * t659;
    const double t665 = -0.4e2 / 0.9e1 * t631 * t92 + 0.5e2 / 0.9e1 * t635 * t265 - 0.25e3 / 0.9e1 * t638 * t635 - 0.4e2 / 0.9e1 * t266 * t631 - 0.1e3 * t643 * t635 + 0.8e2 / 0.3e1 * t269 * t631 - 0.1e3 / 0.9e1 * t648 * t635 + 0.8e2 / 0.3e1 * t273 * t631 + 0.125e4 / 0.9e1 * t653 * t635 - 0.2e3 / 0.9e1 * t276 * t631 + 0.25e3 / 0.3e1 * t660 * t635 - 0.2e3 / 0.9e1 * t281 * t631;
    const double t667 = 0.39111111111111111112e-1 * t31 * t567 - 0.38400000000000000001e-3 * t218 * t573 + 0.91022222222222222228e-6 * t576 * t578 + 0.54044444444444444444e-3 * t46 * t573 - 0.48924444444444444446e-5 * t227 * t578 + 0.10922666666666666667e-7 * t585 * t589 + 0.4608e-5 * t58 * t578 - 0.40277333333333333336e-7 * t236 * t589 + 0.8738133333333333334e-10 * t597 * t603 + t627 * t107 + 0.2e1 * t260 * t284 + t79 * t665;
    const double t672 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t545 * t109 - t551 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t202 * t286 + t561 - t563 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t28 * t667 );
    const double t673 = t120 * t120;
    const double t674 = 0.1e1 / t673;
    const double t675 = t294 * t294;
    const double t678 = t115 * t536;
    const double t681 = piecewise_functor_5( t15, 0.0, t11, 0.0, 0.2e1 * t195 + 0.2e1 * t678 );
    const double t685 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.9e1 * t674 * t675 + 0.4e1 / 0.3e1 * t120 * t681 );
    const double t686 = t685 * t27;
    const double t690 = t297 * t207;
    const double t692 = t6 * t690 * t189;
    const double t694 = t122 * t557;
    const double t697 = t6 * t694 * t189 / 0.12e2;
    const double t699 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t686 * t189 - t692 / 0.4e1 + t697 );
    const double t715 = t314 * t207;
    const double t717 = t6 * t715 * t109;
    const double t739 = t325 * t207;
    const double t741 = t6 * t739 * t189;
    const double t748 = t6 * t302 * t404;
    const double t756 = t311 * t311;
    const double t761 = piecewise_functor_5( t11, 0.0, t15, 0.0, 0.2e1 * t195 + 0.2e1 * t537 );
    const double t765 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.9e1 * t531 * t756 + 0.4e1 / 0.3e1 * t24 * t761 );
    const double t766 = t765 * t27;
    const double t772 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t766 * t109 - t717 / 0.4e1 + t561 );
    const double t773 = t322 * t322;
    const double t778 = piecewise_functor_5( t15, 0.0, t11, 0.0, -0.2e1 * t195 + 0.2e1 * t678 );
    const double t782 = piecewise_functor_3( t119, 0.0, 0.4e1 / 0.9e1 * t674 * t773 + 0.4e1 / 0.3e1 * t120 * t778 );
    const double t783 = t782 * t27;
    const double t793 = 0.1e1 / t127 / t139;
    const double t794 = t793 * t133;
    const double t797 = t139 * t330;
    const double t799 = 0.1e1 / t126 / t797;
    const double t800 = t799 * t144;
    const double t803 = t30 * t148;
    const double t804 = 0.1e1 / t466;
    const double t805 = t804 * t153;
    const double t812 = t44 * t353;
    const double t813 = t150 * t139;
    const double t815 = 0.1e1 / t127 / t813;
    const double t816 = t815 * t359;
    const double t823 = t353 * sigma_bb;
    const double t824 = t56 * t823;
    const double t829 = 0.1e1 / t358 / t132;
    const double t830 = 0.1e1 / t126 / t150 / t797 * t829;
    const double t837 = t67 * t148;
    const double t844 = t71 * t353;
    const double t851 = t75 * t823;
    const double t854 = 0.39111111111111111112e-1 * t157 * t794 - 0.38400000000000000001e-3 * t365 * t800 + 0.91022222222222222228e-6 * t837 * t805 + 0.54044444444444444444e-3 * t160 * t800 - 0.48924444444444444446e-5 * t370 * t805 + 0.10922666666666666667e-7 * t844 * t816 + 0.4608e-5 * t163 * t805 - 0.40277333333333333336e-7 * t375 * t816 + 0.8738133333333333334e-10 * t851 * t830;
    const double t858 = tau_b * t332;
    const double t861 = tau_b * tau_b;
    const double t862 = t861 * t142;
    const double t865 = t170 * t178;
    const double t870 = t174 * t390;
    const double t875 = t175 * t185;
    const double t880 = t181 * t398;
    const double t886 = 0.1e1 / t183 / t177;
    const double t887 = t182 * t886;
    const double t892 = -0.4e2 / 0.9e1 * t858 * t172 + 0.5e2 / 0.9e1 * t862 * t383 - 0.25e3 / 0.9e1 * t865 * t862 - 0.4e2 / 0.9e1 * t384 * t858 - 0.1e3 * t870 * t862 + 0.8e2 / 0.3e1 * t387 * t858 - 0.1e3 / 0.9e1 * t875 * t862 + 0.8e2 / 0.3e1 * t391 * t858 + 0.125e4 / 0.9e1 * t880 * t862 - 0.2e3 / 0.9e1 * t394 * t858 + 0.25e3 / 0.3e1 * t887 * t862 - 0.2e3 / 0.9e1 * t399 * t858;
    const double t894 = 0.39111111111111111112e-1 * t124 * t794 - 0.38400000000000000001e-3 * t336 * t800 + 0.91022222222222222228e-6 * t803 * t805 + 0.54044444444444444444e-3 * t138 * t800 - 0.48924444444444444446e-5 * t345 * t805 + 0.10922666666666666667e-7 * t812 * t816 + 0.4608e-5 * t149 * t805 - 0.40277333333333333336e-7 * t354 * t816 + 0.8738133333333333334e-10 * t824 * t830 + t854 * t187 + 0.2e1 * t378 * t402 + t166 * t892;
    const double t899 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t783 * t189 - t741 / 0.4e1 - 0.3e1 / 0.4e1 * t6 * t326 * t404 + t697 - t748 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t123 * t894 );
    const double t907 = t6 * t208 * t448 / 0.8e1;
    const double t911 = t30 * t221;
    const double t912 = t52 * sigma_aa;
    const double t927 = t59 * t219;
    const double t930 = 0.1e1 / t33 / t927 * t602;
    const double t936 = t67 * t221;
    const double t953 = -0.10666666666666666667e-1 * t67 * t214 * t40 + 0.128e-3 * t936 * t912 - 0.34133333333333333334e-6 * t247 * t230 - 0.17066666666666666667e-3 * t436 * t222 + 0.17066666666666666667e-5 * t72 * t230 - 0.40960000000000000001e-8 * t252 * t242 - 0.1536e-5 * t441 * t230 + 0.14336e-7 * t76 * t242 - 0.32768000000000000001e-10 * t257 * t930;
    const double t956 = -0.10666666666666666667e-1 * t30 * t214 * t40 + 0.128e-3 * t911 * t912 - 0.34133333333333333334e-6 * t218 * t230 - 0.17066666666666666667e-3 * t417 * t222 + 0.17066666666666666667e-5 * t46 * t230 - 0.40960000000000000001e-8 * t227 * t242 - 0.1536e-5 * t422 * t230 + 0.14336e-7 * t58 * t242 - 0.32768000000000000001e-10 * t236 * t930 + t953 * t107 + t446 * t284;
    const double t961 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t202 * t448 - t907 - 0.3e1 / 0.8e1 * t6 * t28 * t956 );
    const double t968 = t6 * t302 * t489 / 0.8e1;
    const double t984 = t30 * t339;
    const double t985 = t144 * sigma_bb;
    const double t1000 = t150 * t337;
    const double t1003 = 0.1e1 / t126 / t1000 * t829;
    const double t1009 = t67 * t339;
    const double t1026 = -0.10666666666666666667e-1 * t67 * t332 * t133 + 0.128e-3 * t1009 * t985 - 0.34133333333333333334e-6 * t365 * t348 - 0.17066666666666666667e-3 * t477 * t340 + 0.17066666666666666667e-5 * t160 * t348 - 0.40960000000000000001e-8 * t370 * t360 - 0.1536e-5 * t482 * t348 + 0.14336e-7 * t163 * t360 - 0.32768000000000000001e-10 * t375 * t1003;
    const double t1029 = -0.10666666666666666667e-1 * t30 * t332 * t133 + 0.128e-3 * t984 * t985 - 0.34133333333333333334e-6 * t336 * t348 - 0.17066666666666666667e-3 * t458 * t340 + 0.17066666666666666667e-5 * t138 * t348 - 0.40960000000000000001e-8 * t345 * t360 - 0.1536e-5 * t463 * t348 + 0.14336e-7 * t149 * t360 - 0.32768000000000000001e-10 * t354 * t1003 + t1026 * t187 + t487 * t402;
    const double t1034 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t326 * t489 - t968 - 0.3e1 / 0.8e1 * t6 * t123 * t1029 );
    const double t1036 = t6 * t201;
    const double t1039 = t207 * t79;
    const double t1040 = t1039 * t506;
    const double t1042 = t494 * t1040 / 0.8e1;
    const double t1043 = t27 * t260;
    const double t1044 = t1043 * t506;
    const double t1050 = 0.1e1 / t33 / t47;
    const double t1051 = t1050 * t265;
    const double t1054 = t1050 * tau_a;
    const double t1075 = 0.5e1 / 0.3e1 * t36 * t92 - 0.1e2 / 0.3e1 * t1051 * tau_a + 0.5e2 / 0.3e1 * t638 * t1054 + 0.5e1 / 0.3e1 * t266 * t36 + 0.6e2 * t643 * t1054 - 0.1e2 * t269 * t36 + 0.2e2 / 0.3e1 * t648 * t1054 - 0.1e2 * t273 * t36 - 0.25e3 / 0.3e1 * t653 * t1054 + 0.25e2 / 0.3e1 * t276 * t36 - 0.5e2 * t660 * t1054 + 0.25e2 / 0.3e1 * t281 * t36;
    const double t1076 = t495 * t1075;
    const double t1080 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t1036 * t507 - t1042 - 0.3e1 / 0.8e1 * t494 * t1044 - 0.3e1 / 0.8e1 * t494 * t1076 );
    const double t1085 = t207 * t166;
    const double t1086 = t1085 * t523;
    const double t1088 = t511 * t1086 / 0.8e1;
    const double t1098 = t6 * t325;
    const double t1101 = t27 * t378;
    const double t1102 = t1101 * t523;
    const double t1108 = 0.1e1 / t126 / t139;
    const double t1109 = t1108 * t383;
    const double t1112 = t1108 * tau_b;
    const double t1133 = 0.5e1 / 0.3e1 * t129 * t172 - 0.1e2 / 0.3e1 * t1109 * tau_b + 0.5e2 / 0.3e1 * t865 * t1112 + 0.5e1 / 0.3e1 * t384 * t129 + 0.6e2 * t870 * t1112 - 0.1e2 * t387 * t129 + 0.2e2 / 0.3e1 * t875 * t1112 - 0.1e2 * t391 * t129 - 0.25e3 / 0.3e1 * t880 * t1112 + 0.25e2 / 0.3e1 * t394 * t129 - 0.5e2 * t887 * t1112 + 0.25e2 / 0.3e1 * t399 * t129;
    const double t1134 = t512 * t1133;
    const double t1138 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t1098 * t524 - t1088 - 0.3e1 / 0.8e1 * t511 * t1102 - 0.3e1 / 0.8e1 * t511 * t1134 );
    const double t1152 = t56 * sigma_aa;
    const double t1157 = t59 * t48;
    const double t1160 = 0.1e1 / t33 / t1157 * t602;
    const double t1175 = t75 * sigma_aa;
    const double t1182 = -0.32e-4 * t67 * t50 * t52 + 0.128e-6 * t68 * t63 + 0.32e-4 * t71 * t50 * t52 - 0.512e-6 * t436 * t63 + 0.1536e-8 * t72 * t428 + 0.384e-6 * t1175 * t63 - 0.4608e-8 * t441 * t428 + 0.12288e-10 * t76 * t1160;
    const double t1184 = -0.32e-4 * t30 * t50 * t52 + 0.128e-6 * t31 * t63 + 0.32e-4 * t44 * t50 * t52 - 0.512e-6 * t417 * t63 + 0.1536e-8 * t46 * t428 + 0.384e-6 * t1152 * t63 - 0.4608e-8 * t422 * t428 + 0.12288e-10 * t58 * t1160 + t1182 * t107;
    const double t1188 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t6 * t28 * t1184 );
    const double t1201 = t56 * sigma_bb;
    const double t1206 = t150 * t140;
    const double t1209 = 0.1e1 / t126 / t1206 * t829;
    const double t1224 = t75 * sigma_bb;
    const double t1231 = -0.32e-4 * t67 * t142 * t144 + 0.128e-6 * t157 * t154 + 0.32e-4 * t71 * t142 * t144 - 0.512e-6 * t477 * t154 + 0.1536e-8 * t160 * t469 + 0.384e-6 * t1224 * t154 - 0.4608e-8 * t482 * t469 + 0.12288e-10 * t163 * t1209;
    const double t1233 = -0.32e-4 * t30 * t142 * t144 + 0.128e-6 * t124 * t154 + 0.32e-4 * t44 * t142 * t144 - 0.512e-6 * t458 * t154 + 0.1536e-8 * t138 * t469 + 0.384e-6 * t1201 * t154 - 0.4608e-8 * t463 * t469 + 0.12288e-10 * t149 * t1209 + t1231 * t187;
    const double t1237 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t6 * t123 * t1233 );
    const double t1238 = t27 * t446;
    const double t1239 = t1238 * t506;
    const double t1242 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t494 * t1239 );
    const double t1243 = t27 * t487;
    const double t1244 = t1243 * t523;
    const double t1247 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t511 * t1244 );
    const double t1249 = 0.1e1 / t33 / t212;
    const double t1262 = 0.2e1 * t1249 * t265 - 0.1e2 * t638 * t1249 - 0.36e2 * t643 * t1249 - 0.4e1 * t648 * t1249 + 0.5e2 * t653 * t1249 + 0.3e2 * t660 * t1249;
    const double t1263 = t495 * t1262;
    const double t1266 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t494 * t1263 );
    const double t1268 = 0.1e1 / t126 / t330;
    const double t1281 = 0.2e1 * t1268 * t383 - 0.1e2 * t865 * t1268 - 0.36e2 * t870 * t1268 - 0.4e1 * t875 * t1268 + 0.5e2 * t880 * t1268 + 0.3e2 * t887 * t1268;
    const double t1282 = t512 * t1281;
    const double t1285 = piecewise_functor_3( t114, 0.0, -0.3e1 / 0.8e1 * t511 * t1282 );


    vrho_a = t113 + t193 + t7 * ( t291 + t307 );
    vrho_b = t113 + t193 + t7 * ( t320 + t409 );
    vsigma_aa = t7 * t452;
    vsigma_ab = 0.e0;
    vsigma_bb = t7 * t493;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t7 * t510;
    vtau_b = t7 * t527;
    v2rho2_aa = 0.2e1 * t291 + 0.2e1 * t307 + t7 * ( t672 + t699 );
    v2rho2_bb = 0.2e1 * t320 + 0.2e1 * t409 + t7 * ( t772 + t899 );
    v2rhosigma_a_aa = t7 * t961 + t452;
    v2rhosigma_b_bb = t7 * t1034 + t493;
    v2rholapl_a_a = 0.e0;
    v2rholapl_b_b = 0.e0;
    v2rhotau_a_a = t7 * t1080 + t510;
    v2rhotau_b_b = t7 * t1138 + t527;
    v2sigma2_aa_aa = t7 * t1188;
    v2sigma2_bb_bb = t7 * t1237;
    v2sigmalapl_aa_a = 0.e0;
    v2sigmalapl_bb_b = 0.e0;
    v2sigmatau_aa_a = t7 * t1242;
    v2sigmatau_bb_b = t7 * t1247;
    v2lapl2_aa = 0.e0;
    v2lapl2_bb = 0.e0;
    v2lapltau_a_a = 0.e0;
    v2lapltau_b_b = 0.e0;
    v2tau2_aa = t7 * t1266;
    v2tau2_bb = t7 * t1285;
    v2rho2_ab = 0.0;
    v2rhosigma_a_ab = 0.0;
    v2rhosigma_a_bb = 0.0;
    v2rhosigma_b_aa = 0.0;
    v2rhosigma_b_ab = 0.0;
    v2rholapl_a_b = 0.0;
    v2rholapl_b_a = 0.0;
    v2rhotau_a_b = 0.0;
    v2rhotau_b_a = 0.0;
    v2sigma2_aa_ab = 0.0;
    v2sigma2_aa_bb = 0.0;
    v2sigma2_ab_ab = 0.0;
    v2sigma2_ab_bb = 0.0;
    v2sigmalapl_aa_b = 0.0;
    v2sigmalapl_ab_a = 0.0;
    v2sigmalapl_ab_b = 0.0;
    v2sigmalapl_bb_a = 0.0;
    v2sigmatau_aa_b = 0.0;
    v2sigmatau_ab_a = 0.0;
    v2sigmatau_ab_b = 0.0;
    v2sigmatau_bb_a = 0.0;
    v2lapl2_ab = 0.0;
    v2lapltau_a_b = 0.0;
    v2lapltau_b_a = 0.0;
    v2tau2_ab = 0.0;



  }


};

struct BuiltinBMK_X : detail::BuiltinKernelImpl< BuiltinBMK_X > {

  BuiltinBMK_X( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinBMK_X >(p) { }
  
  virtual ~BuiltinBMK_X() = default;

};



} // namespace ExchCXX
