#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinR2SCAN_X > :
  public mgga_screening_interface< BuiltinR2SCAN_X > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;

  static constexpr double dens_tol  = 1e-11;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 2.1544346900318875e-15;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = false;
  static constexpr double exx_coeff = 0.0;

  static constexpr double c1 = 0.667;
  static constexpr double c2 = 0.8;
  static constexpr double d = 1.24;
  static constexpr double k1 = 0.065;
  static constexpr double eta = 0.001;
  static constexpr double dp2 = 0.361;

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t23 = constants::m_cbrt_6;
    constexpr double t25 = constants::m_pi_sq;
    constexpr double t26 = constants::m_cbrt_pi_sq;
    constexpr double t32 = constants::m_cbrt_2;
    constexpr double t7 = t4 / t5;
    constexpr double t22 = 0.2e2 / 0.27e2 + 0.5e1 / 0.3e1 * eta;
    constexpr double t24 = t23 * t23;
    constexpr double t27 = t26 * t25;
    constexpr double t28 = 0.1e1 / t27;
    constexpr double t29 = t24 * t28;
    constexpr double t39 = dp2 * dp2;
    constexpr double t40 = t39 * t39;
    constexpr double t41 = 0.1e1 / t40;
    constexpr double t50 = t26 * t26;
    constexpr double t51 = 0.1e1 / t50;
    constexpr double t53 = t32 * t32;
    constexpr double t118 = 0.1e1 / t26;
    constexpr double t119 = t24 * t118;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = t7 * t18;
    const double t20 = safe_math::cbrt( rho );
    const double t30 = sigma * sigma;
    const double t33 = rho * rho;
    const double t34 = t33 * t33;
    const double t35 = t34 * rho;
    const double t37 = 0.1e1 / t20 / t35;
    const double t38 = t32 * t37;
    const double t45 = safe_math::exp( -t29 * t30 * t38 * t41 / 0.288e3 );
    const double t49 = ( -0.162742215233874e0 * t22 * t45 + 0.1e2 / 0.81e2 ) * t23;
    const double t52 = t49 * t51;
    const double t54 = sigma * t53;
    const double t55 = t20 * t20;
    const double t57 = 0.1e1 / t55 / t33;
    const double t58 = t54 * t57;
    const double t61 = k1 + t52 * t58 / 0.24e2;
    const double t65 = k1 * ( 0.1e1 - k1 / t61 );
    const double t66 = tau * t53;
    const double t67 = t55 * rho;
    const double t68 = 0.1e1 / t67;
    const double t71 = t66 * t68 - t58 / 0.8e1;
    const double t75 = t53 * t57;
    const double t78 = 0.3e1 / 0.1e2 * t24 * t50 + eta * sigma * t75 / 0.8e1;
    const double t79 = 0.1e1 / t78;
    const double t80 = t71 * t79;
    const double t81 = t80 <= 0.e0;
    const double t82 = 0.e0 < t80;
    const double t83 = piecewise_functor_3( t82, 0.0, t80 );
    const double t84 = c1 * t83;
    const double t85 = 0.1e1 - t83;
    const double t86 = 0.1e1 / t85;
    const double t88 = safe_math::exp( -t84 * t86 );
    const double t89 = t80 <= 0.25e1;
    const double t90 = 0.25e1 < t80;
    const double t91 = piecewise_functor_3( t90, 0.25e1, t80 );
    const double t93 = t91 * t91;
    const double t95 = t93 * t91;
    const double t97 = t93 * t93;
    const double t99 = t97 * t91;
    const double t101 = t97 * t93;
    const double t106 = piecewise_functor_3( t90, t80, 0.25e1 );
    const double t107 = 0.1e1 - t106;
    const double t110 = safe_math::exp( c2 / t107 );
    const double t112 = piecewise_functor_5( t81, t88, t89, 0.1e1 - 0.667e0 * t91 - 0.4445555e0 * t93 - 0.663086601049e0 * t95 + 0.145129704449e1 * t97 - 0.887998041597e0 * t99 + 0.234528941479e0 * t101 - 0.23185843322e-1 * t97 * t95, -d * t110 );
    const double t113 = 0.174e0 - t65;
    const double t115 = t112 * t113 + t65 + 0.1e1;
    const double t117 = safe_math::sqrt( 0.3e1 );
    const double t120 = safe_math::sqrt( sigma );
    const double t121 = t120 * t32;
    const double t123 = 0.1e1 / t20 / rho;
    const double t125 = t119 * t121 * t123;
    const double t126 = safe_math::sqrt( t125 );
    const double t130 = safe_math::exp( -0.98958e1 * t117 / t126 );
    const double t131 = 0.1e1 - t130;
    const double t135 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t20 * t115 * t131 );


    eps = 0.2e1 * t135;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t4 = constants::m_cbrt_3;
    constexpr double t5 = constants::m_cbrt_pi;
    constexpr double t23 = constants::m_cbrt_6;
    constexpr double t25 = constants::m_pi_sq;
    constexpr double t26 = constants::m_cbrt_pi_sq;
    constexpr double t32 = constants::m_cbrt_2;
    constexpr double t7 = t4 / t5;
    constexpr double t22 = 0.2e2 / 0.27e2 + 0.5e1 / 0.3e1 * eta;
    constexpr double t24 = t23 * t23;
    constexpr double t27 = t26 * t25;
    constexpr double t28 = 0.1e1 / t27;
    constexpr double t29 = t24 * t28;
    constexpr double t39 = dp2 * dp2;
    constexpr double t40 = t39 * t39;
    constexpr double t41 = 0.1e1 / t40;
    constexpr double t50 = t26 * t26;
    constexpr double t51 = 0.1e1 / t50;
    constexpr double t53 = t32 * t32;
    constexpr double t118 = 0.1e1 / t26;
    constexpr double t119 = t24 * t118;
    constexpr double t141 = k1 * k1;
    constexpr double t198 = d * c2;
    constexpr double t240 = t51 * t53;
    constexpr double t247 = eta * t53;


    const double t3 = rho / 0.2e1 <= dens_tol;
    const double t8 = 0.1e1 <= zeta_tol;
    const double t9 = zeta_tol - 0.1e1;
    const double t11 = piecewise_functor_5( t8, t9, t8, -t9, 0.0 );
    const double t12 = 0.1e1 + t11;
    const double t14 = safe_math::cbrt( zeta_tol );
    const double t16 = safe_math::cbrt( t12 );
    const double t18 = piecewise_functor_3( t12 <= zeta_tol, t14 * zeta_tol, t16 * t12 );
    const double t19 = t7 * t18;
    const double t20 = safe_math::cbrt( rho );
    const double t30 = sigma * sigma;
    const double t33 = rho * rho;
    const double t34 = t33 * t33;
    const double t35 = t34 * rho;
    const double t37 = 0.1e1 / t20 / t35;
    const double t38 = t32 * t37;
    const double t45 = safe_math::exp( -t29 * t30 * t38 * t41 / 0.288e3 );
    const double t49 = ( -0.162742215233874e0 * t22 * t45 + 0.1e2 / 0.81e2 ) * t23;
    const double t52 = t49 * t51;
    const double t54 = sigma * t53;
    const double t55 = t20 * t20;
    const double t57 = 0.1e1 / t55 / t33;
    const double t58 = t54 * t57;
    const double t61 = k1 + t52 * t58 / 0.24e2;
    const double t65 = k1 * ( 0.1e1 - k1 / t61 );
    const double t66 = tau * t53;
    const double t67 = t55 * rho;
    const double t68 = 0.1e1 / t67;
    const double t71 = t66 * t68 - t58 / 0.8e1;
    const double t75 = t53 * t57;
    const double t78 = 0.3e1 / 0.1e2 * t24 * t50 + eta * sigma * t75 / 0.8e1;
    const double t79 = 0.1e1 / t78;
    const double t80 = t71 * t79;
    const double t81 = t80 <= 0.e0;
    const double t82 = 0.e0 < t80;
    const double t83 = piecewise_functor_3( t82, 0.0, t80 );
    const double t84 = c1 * t83;
    const double t85 = 0.1e1 - t83;
    const double t86 = 0.1e1 / t85;
    const double t88 = safe_math::exp( -t84 * t86 );
    const double t89 = t80 <= 0.25e1;
    const double t90 = 0.25e1 < t80;
    const double t91 = piecewise_functor_3( t90, 0.25e1, t80 );
    const double t93 = t91 * t91;
    const double t95 = t93 * t91;
    const double t97 = t93 * t93;
    const double t99 = t97 * t91;
    const double t101 = t97 * t93;
    const double t106 = piecewise_functor_3( t90, t80, 0.25e1 );
    const double t107 = 0.1e1 - t106;
    const double t110 = safe_math::exp( c2 / t107 );
    const double t112 = piecewise_functor_5( t81, t88, t89, 0.1e1 - 0.667e0 * t91 - 0.4445555e0 * t93 - 0.663086601049e0 * t95 + 0.145129704449e1 * t97 - 0.887998041597e0 * t99 + 0.234528941479e0 * t101 - 0.23185843322e-1 * t97 * t95, -d * t110 );
    const double t113 = 0.174e0 - t65;
    const double t115 = t112 * t113 + t65 + 0.1e1;
    const double t117 = safe_math::sqrt( 0.3e1 );
    const double t120 = safe_math::sqrt( sigma );
    const double t121 = t120 * t32;
    const double t123 = 0.1e1 / t20 / rho;
    const double t125 = t119 * t121 * t123;
    const double t126 = safe_math::sqrt( t125 );
    const double t130 = safe_math::exp( -0.98958e1 * t117 / t126 );
    const double t131 = 0.1e1 - t130;
    const double t135 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t20 * t115 * t131 );
    const double t136 = 0.1e1 / t55;
    const double t142 = t61 * t61;
    const double t143 = 0.1e1 / t142;
    const double t144 = t141 * t143;
    const double t145 = t30 * sigma;
    const double t146 = t22 * t145;
    const double t147 = t34 * t34;
    const double t148 = t147 * rho;
    const double t149 = 0.1e1 / t148;
    const double t151 = t149 * t41 * t45;
    const double t154 = t33 * rho;
    const double t156 = 0.1e1 / t55 / t154;
    const double t157 = t54 * t156;
    const double t160 = -0.15469524941471936742e-4 * t146 * t151 - t52 * t157 / 0.9e1;
    const double t165 = -0.5e1 / 0.3e1 * t66 * t57 + t157 / 0.3e1;
    const double t167 = t78 * t78;
    const double t168 = 0.1e1 / t167;
    const double t169 = t71 * t168;
    const double t170 = t169 * eta;
    const double t173 = t165 * t79 + t170 * t157 / 0.3e1;
    const double t174 = piecewise_functor_3( t82, 0.0, t173 );
    const double t177 = t85 * t85;
    const double t178 = 0.1e1 / t177;
    const double t179 = t178 * t174;
    const double t181 = -c1 * t174 * t86 - t84 * t179;
    const double t182 = t181 * t88;
    const double t183 = piecewise_functor_3( t90, 0.0, t173 );
    const double t185 = t91 * t183;
    const double t187 = t93 * t183;
    const double t189 = t95 * t183;
    const double t191 = t97 * t183;
    const double t193 = t99 * t183;
    const double t199 = t107 * t107;
    const double t200 = 0.1e1 / t199;
    const double t201 = piecewise_functor_3( t90, t173, 0.0 );
    const double t205 = piecewise_functor_5( t81, t182, t89, -0.667e0 * t183 - 0.889111e0 * t185 - 0.1989259803147e1 * t187 + 0.580518817796e1 * t189 - 0.4439990207985e1 * t191 + 0.1407173648874e1 * t193 - 0.162300903254e0 * t101 * t183, -t198 * t200 * t201 * t110 );
    const double t207 = t112 * t141;
    const double t208 = t143 * t160;
    const double t210 = t205 * t113 + t144 * t160 - t207 * t208;
    const double t215 = safe_math::pow( 0.3e1, 0.1e1 / 0.6e1 );
    const double t216 = t215 * t215;
    const double t217 = t216 * t216;
    const double t219 = t217 * t215 * t18;
    const double t220 = 0.1e1 / t33;
    const double t221 = t220 * t115;
    const double t223 = 0.1e1 / t126 / t125;
    const double t225 = t219 * t221 * t223;
    const double t226 = t121 * t130;
    const double t227 = t119 * t226;
    const double t231 = piecewise_functor_3( t3, 0.0, -t19 * t136 * t115 * t131 / 0.8e1 - 0.3e1 / 0.8e1 * t19 * t20 * t210 * t131 - 0.16891736332904387511e1 * t225 * t227 );
    const double t234 = t22 * t30;
    const double t235 = 0.1e1 / t147;
    const double t237 = t235 * t41 * t45;
    const double t244 = 0.58010718530519762783e-5 * t234 * t237 + t49 * t240 * t57 / 0.24e2;
    const double t246 = t75 * t79;
    const double t248 = t247 * t57;
    const double t251 = -t169 * t248 / 0.8e1 - t246 / 0.8e1;
    const double t252 = piecewise_functor_3( t82, 0.0, t251 );
    const double t253 = c1 * t252;
    const double t255 = t178 * t252;
    const double t257 = -t253 * t86 - t84 * t255;
    const double t258 = t257 * t88;
    const double t259 = piecewise_functor_3( t90, 0.0, t251 );
    const double t261 = t91 * t259;
    const double t263 = t93 * t259;
    const double t265 = t95 * t259;
    const double t267 = t97 * t259;
    const double t269 = t99 * t259;
    const double t274 = piecewise_functor_3( t90, t251, 0.0 );
    const double t278 = piecewise_functor_5( t81, t258, t89, -0.667e0 * t259 - 0.889111e0 * t261 - 0.1989259803147e1 * t263 + 0.580518817796e1 * t265 - 0.4439990207985e1 * t267 + 0.1407173648874e1 * t269 - 0.162300903254e0 * t101 * t259, -t198 * t200 * t274 * t110 );
    const double t280 = t143 * t244;
    const double t282 = t278 * t113 + t144 * t244 - t207 * t280;
    const double t287 = 0.1e1 / rho;
    const double t288 = t287 * t115;
    const double t290 = t219 * t288 * t223;
    const double t291 = 0.1e1 / t120;
    const double t293 = t291 * t32 * t130;
    const double t294 = t119 * t293;
    const double t298 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t20 * t282 * t131 + 0.63344011248391453166e0 * t290 * t294 );
    const double t301 = t53 * t68 * t79;
    const double t302 = piecewise_functor_3( t82, 0.0, t301 );
    const double t303 = c1 * t302;
    const double t305 = t178 * t302;
    const double t307 = -t303 * t86 - t84 * t305;
    const double t308 = t307 * t88;
    const double t309 = piecewise_functor_3( t90, 0.0, t301 );
    const double t311 = t91 * t309;
    const double t313 = t93 * t309;
    const double t315 = t95 * t309;
    const double t317 = t97 * t309;
    const double t319 = t99 * t309;
    const double t324 = piecewise_functor_3( t90, t301, 0.0 );
    const double t328 = piecewise_functor_5( t81, t308, t89, -0.667e0 * t309 - 0.889111e0 * t311 - 0.1989259803147e1 * t313 + 0.580518817796e1 * t315 - 0.4439990207985e1 * t317 + 0.1407173648874e1 * t319 - 0.162300903254e0 * t101 * t309, -t198 * t200 * t324 * t110 );
    const double t329 = t20 * t328;
    const double t330 = t113 * t131;
    const double t334 = piecewise_functor_3( t3, 0.0, -0.3e1 / 0.8e1 * t19 * t329 * t330 );


    eps = 0.2e1 * t135;
    vrho = 0.2e1 * rho * t231 + 0.2e1 * t135;
    vsigma = 0.2e1 * rho * t298;
    vlapl = 0.e0;
    vtau = 0.2e1 * rho * t334;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t31 = constants::m_cbrt_6;
    constexpr double t33 = constants::m_pi_sq;
    constexpr double t34 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t30 = 0.2e2 / 0.27e2 + 0.5e1 / 0.3e1 * eta;
    constexpr double t32 = t31 * t31;
    constexpr double t35 = t34 * t33;
    constexpr double t36 = 0.1e1 / t35;
    constexpr double t37 = t32 * t36;
    constexpr double t46 = dp2 * dp2;
    constexpr double t47 = t46 * t46;
    constexpr double t48 = 0.1e1 / t47;
    constexpr double t57 = t34 * t34;
    constexpr double t58 = 0.1e1 / t57;
    constexpr double t78 = 0.3e1 / 0.1e2 * t32 * t57;
    constexpr double t122 = 0.1e1 / t34;
    constexpr double t123 = t32 * t122;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = t6 * t26;
    const double t28 = safe_math::cbrt( t7 );
    const double t38 = sigma_aa * sigma_aa;
    const double t39 = rho_a * rho_a;
    const double t40 = t39 * t39;
    const double t41 = t40 * rho_a;
    const double t42 = safe_math::cbrt( rho_a );
    const double t44 = 0.1e1 / t42 / t41;
    const double t45 = t38 * t44;
    const double t52 = safe_math::exp( -t37 * t45 * t48 / 0.576e3 );
    const double t56 = ( -0.162742215233874e0 * t30 * t52 + 0.1e2 / 0.81e2 ) * t31;
    const double t59 = t58 * sigma_aa;
    const double t60 = t42 * t42;
    const double t61 = t60 * t39;
    const double t62 = 0.1e1 / t61;
    const double t66 = k1 + t56 * t59 * t62 / 0.24e2;
    const double t70 = k1 * ( 0.1e1 - k1 / t66 );
    const double t71 = t60 * rho_a;
    const double t72 = 0.1e1 / t71;
    const double t74 = sigma_aa * t62;
    const double t76 = tau_a * t72 - t74 / 0.8e1;
    const double t79 = eta * sigma_aa;
    const double t82 = t78 + t79 * t62 / 0.8e1;
    const double t83 = 0.1e1 / t82;
    const double t84 = t76 * t83;
    const double t85 = t84 <= 0.e0;
    const double t86 = 0.e0 < t84;
    const double t87 = piecewise_functor_3( t86, 0.0, t84 );
    const double t88 = c1 * t87;
    const double t89 = 0.1e1 - t87;
    const double t90 = 0.1e1 / t89;
    const double t92 = safe_math::exp( -t88 * t90 );
    const double t93 = t84 <= 0.25e1;
    const double t94 = 0.25e1 < t84;
    const double t95 = piecewise_functor_3( t94, 0.25e1, t84 );
    const double t97 = t95 * t95;
    const double t99 = t97 * t95;
    const double t101 = t97 * t97;
    const double t103 = t101 * t95;
    const double t105 = t101 * t97;
    const double t110 = piecewise_functor_3( t94, t84, 0.25e1 );
    const double t111 = 0.1e1 - t110;
    const double t114 = safe_math::exp( c2 / t111 );
    const double t116 = piecewise_functor_5( t85, t92, t93, 0.1e1 - 0.667e0 * t95 - 0.4445555e0 * t97 - 0.663086601049e0 * t99 + 0.145129704449e1 * t101 - 0.887998041597e0 * t103 + 0.234528941479e0 * t105 - 0.23185843322e-1 * t101 * t99, -d * t114 );
    const double t117 = 0.174e0 - t70;
    const double t119 = t116 * t117 + t70 + 0.1e1;
    const double t120 = t28 * t119;
    const double t121 = safe_math::sqrt( 0.3e1 );
    const double t124 = safe_math::sqrt( sigma_aa );
    const double t125 = t42 * rho_a;
    const double t126 = 0.1e1 / t125;
    const double t128 = t123 * t124 * t126;
    const double t129 = safe_math::sqrt( t128 );
    const double t133 = safe_math::exp( -0.98958e1 * t121 / t129 );
    const double t134 = 0.1e1 - t133;
    const double t135 = t120 * t134;
    const double t138 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t135 );
    const double t139 = rho_b <= dens_tol;
    const double t140 = -t17;
    const double t142 = piecewise_functor_5( t15, t12, t11, t16, t140 * t8 );
    const double t143 = 0.1e1 + t142;
    const double t144 = t143 <= zeta_tol;
    const double t145 = safe_math::cbrt( t143 );
    const double t147 = piecewise_functor_3( t144, t23, t145 * t143 );
    const double t148 = t6 * t147;
    const double t149 = sigma_bb * sigma_bb;
    const double t150 = rho_b * rho_b;
    const double t151 = t150 * t150;
    const double t152 = t151 * rho_b;
    const double t153 = safe_math::cbrt( rho_b );
    const double t155 = 0.1e1 / t153 / t152;
    const double t156 = t149 * t155;
    const double t160 = safe_math::exp( -t37 * t156 * t48 / 0.576e3 );
    const double t164 = ( -0.162742215233874e0 * t30 * t160 + 0.1e2 / 0.81e2 ) * t31;
    const double t165 = t58 * sigma_bb;
    const double t166 = t153 * t153;
    const double t167 = t166 * t150;
    const double t168 = 0.1e1 / t167;
    const double t172 = k1 + t164 * t165 * t168 / 0.24e2;
    const double t176 = k1 * ( 0.1e1 - k1 / t172 );
    const double t177 = t166 * rho_b;
    const double t178 = 0.1e1 / t177;
    const double t180 = sigma_bb * t168;
    const double t182 = tau_b * t178 - t180 / 0.8e1;
    const double t183 = eta * sigma_bb;
    const double t186 = t78 + t183 * t168 / 0.8e1;
    const double t187 = 0.1e1 / t186;
    const double t188 = t182 * t187;
    const double t189 = t188 <= 0.e0;
    const double t190 = 0.e0 < t188;
    const double t191 = piecewise_functor_3( t190, 0.0, t188 );
    const double t192 = c1 * t191;
    const double t193 = 0.1e1 - t191;
    const double t194 = 0.1e1 / t193;
    const double t196 = safe_math::exp( -t192 * t194 );
    const double t197 = t188 <= 0.25e1;
    const double t198 = 0.25e1 < t188;
    const double t199 = piecewise_functor_3( t198, 0.25e1, t188 );
    const double t201 = t199 * t199;
    const double t203 = t201 * t199;
    const double t205 = t201 * t201;
    const double t207 = t205 * t199;
    const double t209 = t205 * t201;
    const double t214 = piecewise_functor_3( t198, t188, 0.25e1 );
    const double t215 = 0.1e1 - t214;
    const double t218 = safe_math::exp( c2 / t215 );
    const double t220 = piecewise_functor_5( t189, t196, t197, 0.1e1 - 0.667e0 * t199 - 0.4445555e0 * t201 - 0.663086601049e0 * t203 + 0.145129704449e1 * t205 - 0.887998041597e0 * t207 + 0.234528941479e0 * t209 - 0.23185843322e-1 * t205 * t203, -d * t218 );
    const double t221 = 0.174e0 - t176;
    const double t223 = t220 * t221 + t176 + 0.1e1;
    const double t224 = t28 * t223;
    const double t225 = safe_math::sqrt( sigma_bb );
    const double t226 = t153 * rho_b;
    const double t227 = 0.1e1 / t226;
    const double t229 = t123 * t225 * t227;
    const double t230 = safe_math::sqrt( t229 );
    const double t234 = safe_math::exp( -0.98958e1 * t121 / t230 );
    const double t235 = 0.1e1 - t234;
    const double t236 = t224 * t235;
    const double t239 = piecewise_functor_3( t139, 0.0, -0.3e1 / 0.8e1 * t148 * t236 );


    eps = t138 + t239;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(sigma_ab);
    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t3 = constants::m_cbrt_3;
    constexpr double t4 = constants::m_cbrt_pi;
    constexpr double t31 = constants::m_cbrt_6;
    constexpr double t33 = constants::m_pi_sq;
    constexpr double t34 = constants::m_cbrt_pi_sq;
    constexpr double t6 = t3 / t4;
    constexpr double t30 = 0.2e2 / 0.27e2 + 0.5e1 / 0.3e1 * eta;
    constexpr double t32 = t31 * t31;
    constexpr double t35 = t34 * t33;
    constexpr double t36 = 0.1e1 / t35;
    constexpr double t37 = t32 * t36;
    constexpr double t46 = dp2 * dp2;
    constexpr double t47 = t46 * t46;
    constexpr double t48 = 0.1e1 / t47;
    constexpr double t57 = t34 * t34;
    constexpr double t58 = 0.1e1 / t57;
    constexpr double t78 = 0.3e1 / 0.1e2 * t32 * t57;
    constexpr double t122 = 0.1e1 / t34;
    constexpr double t123 = t32 * t122;
    constexpr double t257 = k1 * k1;
    constexpr double t315 = d * c2;


    const double t2 = rho_a <= dens_tol;
    const double t7 = rho_a + rho_b;
    const double t8 = 0.1e1 / t7;
    const double t11 = 0.2e1 * rho_a * t8 <= zeta_tol;
    const double t12 = zeta_tol - 0.1e1;
    const double t15 = 0.2e1 * rho_b * t8 <= zeta_tol;
    const double t16 = -t12;
    const double t17 = rho_a - rho_b;
    const double t19 = piecewise_functor_5( t11, t12, t15, t16, t17 * t8 );
    const double t20 = 0.1e1 + t19;
    const double t21 = t20 <= zeta_tol;
    const double t22 = safe_math::cbrt( zeta_tol );
    const double t23 = t22 * zeta_tol;
    const double t24 = safe_math::cbrt( t20 );
    const double t26 = piecewise_functor_3( t21, t23, t24 * t20 );
    const double t27 = t6 * t26;
    const double t28 = safe_math::cbrt( t7 );
    const double t38 = sigma_aa * sigma_aa;
    const double t39 = rho_a * rho_a;
    const double t40 = t39 * t39;
    const double t41 = t40 * rho_a;
    const double t42 = safe_math::cbrt( rho_a );
    const double t44 = 0.1e1 / t42 / t41;
    const double t45 = t38 * t44;
    const double t52 = safe_math::exp( -t37 * t45 * t48 / 0.576e3 );
    const double t56 = ( -0.162742215233874e0 * t30 * t52 + 0.1e2 / 0.81e2 ) * t31;
    const double t59 = t58 * sigma_aa;
    const double t60 = t42 * t42;
    const double t61 = t60 * t39;
    const double t62 = 0.1e1 / t61;
    const double t66 = k1 + t56 * t59 * t62 / 0.24e2;
    const double t70 = k1 * ( 0.1e1 - k1 / t66 );
    const double t71 = t60 * rho_a;
    const double t72 = 0.1e1 / t71;
    const double t74 = sigma_aa * t62;
    const double t76 = tau_a * t72 - t74 / 0.8e1;
    const double t79 = eta * sigma_aa;
    const double t82 = t78 + t79 * t62 / 0.8e1;
    const double t83 = 0.1e1 / t82;
    const double t84 = t76 * t83;
    const double t85 = t84 <= 0.e0;
    const double t86 = 0.e0 < t84;
    const double t87 = piecewise_functor_3( t86, 0.0, t84 );
    const double t88 = c1 * t87;
    const double t89 = 0.1e1 - t87;
    const double t90 = 0.1e1 / t89;
    const double t92 = safe_math::exp( -t88 * t90 );
    const double t93 = t84 <= 0.25e1;
    const double t94 = 0.25e1 < t84;
    const double t95 = piecewise_functor_3( t94, 0.25e1, t84 );
    const double t97 = t95 * t95;
    const double t99 = t97 * t95;
    const double t101 = t97 * t97;
    const double t103 = t101 * t95;
    const double t105 = t101 * t97;
    const double t110 = piecewise_functor_3( t94, t84, 0.25e1 );
    const double t111 = 0.1e1 - t110;
    const double t114 = safe_math::exp( c2 / t111 );
    const double t116 = piecewise_functor_5( t85, t92, t93, 0.1e1 - 0.667e0 * t95 - 0.4445555e0 * t97 - 0.663086601049e0 * t99 + 0.145129704449e1 * t101 - 0.887998041597e0 * t103 + 0.234528941479e0 * t105 - 0.23185843322e-1 * t101 * t99, -d * t114 );
    const double t117 = 0.174e0 - t70;
    const double t119 = t116 * t117 + t70 + 0.1e1;
    const double t120 = t28 * t119;
    const double t121 = safe_math::sqrt( 0.3e1 );
    const double t124 = safe_math::sqrt( sigma_aa );
    const double t125 = t42 * rho_a;
    const double t126 = 0.1e1 / t125;
    const double t128 = t123 * t124 * t126;
    const double t129 = safe_math::sqrt( t128 );
    const double t133 = safe_math::exp( -0.98958e1 * t121 / t129 );
    const double t134 = 0.1e1 - t133;
    const double t135 = t120 * t134;
    const double t138 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t135 );
    const double t139 = rho_b <= dens_tol;
    const double t140 = -t17;
    const double t142 = piecewise_functor_5( t15, t12, t11, t16, t140 * t8 );
    const double t143 = 0.1e1 + t142;
    const double t144 = t143 <= zeta_tol;
    const double t145 = safe_math::cbrt( t143 );
    const double t147 = piecewise_functor_3( t144, t23, t145 * t143 );
    const double t148 = t6 * t147;
    const double t149 = sigma_bb * sigma_bb;
    const double t150 = rho_b * rho_b;
    const double t151 = t150 * t150;
    const double t152 = t151 * rho_b;
    const double t153 = safe_math::cbrt( rho_b );
    const double t155 = 0.1e1 / t153 / t152;
    const double t156 = t149 * t155;
    const double t160 = safe_math::exp( -t37 * t156 * t48 / 0.576e3 );
    const double t164 = ( -0.162742215233874e0 * t30 * t160 + 0.1e2 / 0.81e2 ) * t31;
    const double t165 = t58 * sigma_bb;
    const double t166 = t153 * t153;
    const double t167 = t166 * t150;
    const double t168 = 0.1e1 / t167;
    const double t172 = k1 + t164 * t165 * t168 / 0.24e2;
    const double t176 = k1 * ( 0.1e1 - k1 / t172 );
    const double t177 = t166 * rho_b;
    const double t178 = 0.1e1 / t177;
    const double t180 = sigma_bb * t168;
    const double t182 = tau_b * t178 - t180 / 0.8e1;
    const double t183 = eta * sigma_bb;
    const double t186 = t78 + t183 * t168 / 0.8e1;
    const double t187 = 0.1e1 / t186;
    const double t188 = t182 * t187;
    const double t189 = t188 <= 0.e0;
    const double t190 = 0.e0 < t188;
    const double t191 = piecewise_functor_3( t190, 0.0, t188 );
    const double t192 = c1 * t191;
    const double t193 = 0.1e1 - t191;
    const double t194 = 0.1e1 / t193;
    const double t196 = safe_math::exp( -t192 * t194 );
    const double t197 = t188 <= 0.25e1;
    const double t198 = 0.25e1 < t188;
    const double t199 = piecewise_functor_3( t198, 0.25e1, t188 );
    const double t201 = t199 * t199;
    const double t203 = t201 * t199;
    const double t205 = t201 * t201;
    const double t207 = t205 * t199;
    const double t209 = t205 * t201;
    const double t214 = piecewise_functor_3( t198, t188, 0.25e1 );
    const double t215 = 0.1e1 - t214;
    const double t218 = safe_math::exp( c2 / t215 );
    const double t220 = piecewise_functor_5( t189, t196, t197, 0.1e1 - 0.667e0 * t199 - 0.4445555e0 * t201 - 0.663086601049e0 * t203 + 0.145129704449e1 * t205 - 0.887998041597e0 * t207 + 0.234528941479e0 * t209 - 0.23185843322e-1 * t205 * t203, -d * t218 );
    const double t221 = 0.174e0 - t176;
    const double t223 = t220 * t221 + t176 + 0.1e1;
    const double t224 = t28 * t223;
    const double t225 = safe_math::sqrt( sigma_bb );
    const double t226 = t153 * rho_b;
    const double t227 = 0.1e1 / t226;
    const double t229 = t123 * t225 * t227;
    const double t230 = safe_math::sqrt( t229 );
    const double t234 = safe_math::exp( -0.98958e1 * t121 / t230 );
    const double t235 = 0.1e1 - t234;
    const double t236 = t224 * t235;
    const double t239 = piecewise_functor_3( t139, 0.0, -0.3e1 / 0.8e1 * t148 * t236 );
    const double t240 = t7 * t7;
    const double t241 = 0.1e1 / t240;
    const double t242 = t17 * t241;
    const double t244 = piecewise_functor_5( t11, 0.0, t15, 0.0, t8 - t242 );
    const double t247 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t244 );
    const double t248 = t6 * t247;
    const double t251 = t28 * t28;
    const double t252 = 0.1e1 / t251;
    const double t253 = t252 * t119;
    const double t254 = t253 * t134;
    const double t256 = t27 * t254 / 0.8e1;
    const double t258 = t66 * t66;
    const double t259 = 0.1e1 / t258;
    const double t260 = t257 * t259;
    const double t261 = t38 * sigma_aa;
    const double t262 = t30 * t261;
    const double t263 = t40 * t40;
    const double t264 = t263 * rho_a;
    const double t265 = 0.1e1 / t264;
    const double t267 = t265 * t48 * t52;
    const double t270 = t39 * rho_a;
    const double t272 = 0.1e1 / t60 / t270;
    const double t276 = -0.38673812353679841857e-5 * t262 * t267 - t56 * t59 * t272 / 0.9e1;
    const double t282 = -0.5e1 / 0.3e1 * tau_a * t62 + sigma_aa * t272 / 0.3e1;
    const double t284 = t82 * t82;
    const double t285 = 0.1e1 / t284;
    const double t286 = t76 * t285;
    const double t287 = t79 * t272;
    const double t290 = t282 * t83 + t286 * t287 / 0.3e1;
    const double t291 = piecewise_functor_3( t86, 0.0, t290 );
    const double t294 = t89 * t89;
    const double t295 = 0.1e1 / t294;
    const double t296 = t295 * t291;
    const double t298 = -t291 * t90 * c1 - t296 * t88;
    const double t299 = t298 * t92;
    const double t300 = piecewise_functor_3( t94, 0.0, t290 );
    const double t302 = t95 * t300;
    const double t304 = t97 * t300;
    const double t306 = t99 * t300;
    const double t308 = t101 * t300;
    const double t310 = t103 * t300;
    const double t316 = t111 * t111;
    const double t317 = 0.1e1 / t316;
    const double t318 = piecewise_functor_3( t94, t290, 0.0 );
    const double t322 = piecewise_functor_5( t85, t299, t93, -0.667e0 * t300 - 0.889111e0 * t302 - 0.1989259803147e1 * t304 + 0.580518817796e1 * t306 - 0.4439990207985e1 * t308 + 0.1407173648874e1 * t310 - 0.162300903254e0 * t105 * t300, -t315 * t317 * t318 * t114 );
    const double t324 = t116 * t257;
    const double t325 = t259 * t276;
    const double t327 = t117 * t322 + t260 * t276 - t324 * t325;
    const double t328 = t28 * t327;
    const double t329 = t328 * t134;
    const double t332 = safe_math::pow( 0.3e1, 0.1e1 / 0.6e1 );
    const double t333 = t332 * t332;
    const double t334 = t333 * t333;
    const double t335 = t334 * t332;
    const double t336 = t335 * t26;
    const double t338 = 0.1e1 / t129 / t128;
    const double t339 = t120 * t338;
    const double t340 = t336 * t339;
    const double t342 = 0.1e1 / t42 / t39;
    const double t344 = t124 * t342 * t133;
    const double t345 = t123 * t344;
    const double t349 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t248 * t135 - t256 - 0.3e1 / 0.8e1 * t27 * t329 - 0.16891736332904387511e1 * t340 * t345 );
    const double t350 = t140 * t241;
    const double t352 = piecewise_functor_5( t15, 0.0, t11, 0.0, -t8 - t350 );
    const double t355 = piecewise_functor_3( t144, 0.0, 0.4e1 / 0.3e1 * t145 * t352 );
    const double t356 = t6 * t355;
    const double t359 = t252 * t223;
    const double t360 = t359 * t235;
    const double t362 = t148 * t360 / 0.8e1;
    const double t364 = piecewise_functor_3( t139, 0.0, -0.3e1 / 0.8e1 * t356 * t236 - t362 );
    const double t368 = piecewise_functor_5( t11, 0.0, t15, 0.0, -t8 - t242 );
    const double t371 = piecewise_functor_3( t21, 0.0, 0.4e1 / 0.3e1 * t24 * t368 );
    const double t372 = t6 * t371;
    const double t376 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t372 * t135 - t256 );
    const double t378 = piecewise_functor_5( t15, 0.0, t11, 0.0, t8 - t350 );
    const double t381 = piecewise_functor_3( t144, 0.0, 0.4e1 / 0.3e1 * t145 * t378 );
    const double t382 = t6 * t381;
    const double t385 = t172 * t172;
    const double t386 = 0.1e1 / t385;
    const double t387 = t257 * t386;
    const double t388 = t149 * sigma_bb;
    const double t389 = t30 * t388;
    const double t390 = t151 * t151;
    const double t391 = t390 * rho_b;
    const double t392 = 0.1e1 / t391;
    const double t394 = t392 * t48 * t160;
    const double t397 = t150 * rho_b;
    const double t399 = 0.1e1 / t166 / t397;
    const double t403 = -0.38673812353679841857e-5 * t389 * t394 - t164 * t165 * t399 / 0.9e1;
    const double t409 = -0.5e1 / 0.3e1 * tau_b * t168 + sigma_bb * t399 / 0.3e1;
    const double t411 = t186 * t186;
    const double t412 = 0.1e1 / t411;
    const double t413 = t182 * t412;
    const double t414 = t183 * t399;
    const double t417 = t409 * t187 + t413 * t414 / 0.3e1;
    const double t418 = piecewise_functor_3( t190, 0.0, t417 );
    const double t421 = t193 * t193;
    const double t422 = 0.1e1 / t421;
    const double t423 = t422 * t418;
    const double t425 = -t194 * t418 * c1 - t192 * t423;
    const double t426 = t425 * t196;
    const double t427 = piecewise_functor_3( t198, 0.0, t417 );
    const double t429 = t199 * t427;
    const double t431 = t201 * t427;
    const double t433 = t203 * t427;
    const double t435 = t205 * t427;
    const double t437 = t207 * t427;
    const double t442 = t215 * t215;
    const double t443 = 0.1e1 / t442;
    const double t444 = piecewise_functor_3( t198, t417, 0.0 );
    const double t448 = piecewise_functor_5( t189, t426, t197, -0.667e0 * t427 - 0.889111e0 * t429 - 0.1989259803147e1 * t431 + 0.580518817796e1 * t433 - 0.4439990207985e1 * t435 + 0.1407173648874e1 * t437 - 0.162300903254e0 * t209 * t427, -t315 * t443 * t444 * t218 );
    const double t450 = t220 * t257;
    const double t451 = t386 * t403;
    const double t453 = t221 * t448 + t387 * t403 - t450 * t451;
    const double t454 = t28 * t453;
    const double t455 = t454 * t235;
    const double t458 = t335 * t147;
    const double t460 = 0.1e1 / t230 / t229;
    const double t461 = t224 * t460;
    const double t462 = t458 * t461;
    const double t464 = 0.1e1 / t153 / t150;
    const double t466 = t225 * t464 * t234;
    const double t467 = t123 * t466;
    const double t471 = piecewise_functor_3( t139, 0.0, -0.3e1 / 0.8e1 * t382 * t236 - t362 - 0.3e1 / 0.8e1 * t148 * t455 - 0.16891736332904387511e1 * t462 * t467 );
    const double t474 = t30 * t38;
    const double t475 = 0.1e1 / t263;
    const double t477 = t475 * t48 * t52;
    const double t483 = 0.14502679632629940697e-5 * t474 * t477 + t56 * t58 * t62 / 0.24e2;
    const double t485 = t62 * t83;
    const double t486 = eta * t62;
    const double t489 = -t286 * t486 / 0.8e1 - t485 / 0.8e1;
    const double t490 = piecewise_functor_3( t86, 0.0, t489 );
    const double t491 = c1 * t490;
    const double t493 = t295 * t490;
    const double t495 = -t491 * t90 - t493 * t88;
    const double t496 = t495 * t92;
    const double t497 = piecewise_functor_3( t94, 0.0, t489 );
    const double t499 = t95 * t497;
    const double t501 = t97 * t497;
    const double t503 = t99 * t497;
    const double t505 = t101 * t497;
    const double t507 = t103 * t497;
    const double t512 = piecewise_functor_3( t94, t489, 0.0 );
    const double t516 = piecewise_functor_5( t85, t496, t93, -0.667e0 * t497 - 0.889111e0 * t499 - 0.1989259803147e1 * t501 + 0.580518817796e1 * t503 - 0.4439990207985e1 * t505 + 0.1407173648874e1 * t507 - 0.162300903254e0 * t105 * t497, -t315 * t317 * t512 * t114 );
    const double t518 = t259 * t483;
    const double t520 = t117 * t516 + t260 * t483 - t324 * t518;
    const double t521 = t28 * t520;
    const double t522 = t521 * t134;
    const double t525 = 0.1e1 / t124;
    const double t527 = t525 * t126 * t133;
    const double t528 = t123 * t527;
    const double t532 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t522 + 0.63344011248391453166e0 * t340 * t528 );
    const double t533 = t30 * t149;
    const double t534 = 0.1e1 / t390;
    const double t536 = t534 * t48 * t160;
    const double t542 = 0.14502679632629940697e-5 * t533 * t536 + t164 * t58 * t168 / 0.24e2;
    const double t544 = t168 * t187;
    const double t545 = eta * t168;
    const double t548 = -t413 * t545 / 0.8e1 - t544 / 0.8e1;
    const double t549 = piecewise_functor_3( t190, 0.0, t548 );
    const double t550 = c1 * t549;
    const double t552 = t422 * t549;
    const double t554 = -t192 * t552 - t194 * t550;
    const double t555 = t554 * t196;
    const double t556 = piecewise_functor_3( t198, 0.0, t548 );
    const double t558 = t199 * t556;
    const double t560 = t201 * t556;
    const double t562 = t203 * t556;
    const double t564 = t205 * t556;
    const double t566 = t207 * t556;
    const double t571 = piecewise_functor_3( t198, t548, 0.0 );
    const double t575 = piecewise_functor_5( t189, t555, t197, -0.667e0 * t556 - 0.889111e0 * t558 - 0.1989259803147e1 * t560 + 0.580518817796e1 * t562 - 0.4439990207985e1 * t564 + 0.1407173648874e1 * t566 - 0.162300903254e0 * t209 * t556, -t315 * t443 * t571 * t218 );
    const double t577 = t386 * t542;
    const double t579 = t221 * t575 + t387 * t542 - t450 * t577;
    const double t580 = t28 * t579;
    const double t581 = t580 * t235;
    const double t584 = 0.1e1 / t225;
    const double t586 = t584 * t227 * t234;
    const double t587 = t123 * t586;
    const double t591 = piecewise_functor_3( t139, 0.0, -0.3e1 / 0.8e1 * t148 * t581 + 0.63344011248391453166e0 * t462 * t587 );
    const double t592 = t72 * t83;
    const double t593 = piecewise_functor_3( t86, 0.0, t592 );
    const double t594 = c1 * t593;
    const double t596 = t295 * t593;
    const double t598 = -t594 * t90 - t596 * t88;
    const double t599 = t598 * t92;
    const double t600 = piecewise_functor_3( t94, 0.0, t592 );
    const double t602 = t95 * t600;
    const double t604 = t97 * t600;
    const double t606 = t99 * t600;
    const double t608 = t101 * t600;
    const double t610 = t103 * t600;
    const double t615 = piecewise_functor_3( t94, t592, 0.0 );
    const double t619 = piecewise_functor_5( t85, t599, t93, -0.667e0 * t600 - 0.889111e0 * t602 - 0.1989259803147e1 * t604 + 0.580518817796e1 * t606 - 0.4439990207985e1 * t608 + 0.1407173648874e1 * t610 - 0.162300903254e0 * t105 * t600, -t315 * t317 * t615 * t114 );
    const double t620 = t28 * t619;
    const double t621 = t117 * t134;
    const double t622 = t620 * t621;
    const double t625 = piecewise_functor_3( t2, 0.0, -0.3e1 / 0.8e1 * t27 * t622 );
    const double t626 = t178 * t187;
    const double t627 = piecewise_functor_3( t190, 0.0, t626 );
    const double t628 = c1 * t627;
    const double t630 = t422 * t627;
    const double t632 = -t192 * t630 - t194 * t628;
    const double t633 = t632 * t196;
    const double t634 = piecewise_functor_3( t198, 0.0, t626 );
    const double t636 = t199 * t634;
    const double t638 = t201 * t634;
    const double t640 = t203 * t634;
    const double t642 = t205 * t634;
    const double t644 = t207 * t634;
    const double t649 = piecewise_functor_3( t198, t626, 0.0 );
    const double t653 = piecewise_functor_5( t189, t633, t197, -0.667e0 * t634 - 0.889111e0 * t636 - 0.1989259803147e1 * t638 + 0.580518817796e1 * t640 - 0.4439990207985e1 * t642 + 0.1407173648874e1 * t644 - 0.162300903254e0 * t209 * t634, -t315 * t443 * t649 * t218 );
    const double t654 = t28 * t653;
    const double t655 = t221 * t235;
    const double t656 = t654 * t655;
    const double t659 = piecewise_functor_3( t139, 0.0, -0.3e1 / 0.8e1 * t148 * t656 );


    eps = t138 + t239;
    vrho_a = t138 + t239 + t7 * ( t349 + t364 );
    vrho_b = t138 + t239 + t7 * ( t376 + t471 );
    vsigma_aa = t7 * t532;
    vsigma_ab = 0.e0;
    vsigma_bb = t7 * t591;
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t7 * t625;
    vtau_b = t7 * t659;

  }


};

struct BuiltinR2SCAN_X : detail::BuiltinKernelImpl< BuiltinR2SCAN_X > {

  BuiltinR2SCAN_X( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinR2SCAN_X >(p) { }
  
  virtual ~BuiltinR2SCAN_X() = default;

};



} // namespace ExchCXX
