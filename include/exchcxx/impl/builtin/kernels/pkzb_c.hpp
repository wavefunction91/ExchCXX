#pragma once
#include <cmath>

#include <exchcxx/impl/builtin/fwd.hpp>
#include <exchcxx/impl/builtin/constants.hpp>
#include <exchcxx/impl/builtin/kernel_type.hpp>
#include <exchcxx/impl/builtin/util.hpp>

#include <exchcxx/impl/builtin/kernels/screening_interface.hpp>



namespace ExchCXX {

template <>
struct kernel_traits< BuiltinPKZB_C > :
  public mgga_screening_interface< BuiltinPKZB_C > {

  static constexpr bool is_lda  = false;
  static constexpr bool is_gga  = false;
  static constexpr bool is_mgga = true;
  static constexpr bool needs_laplacian = false;
  static constexpr bool is_kedf = false;
  static constexpr bool is_epc  = false;

  static constexpr double dens_tol  = 1e-13;
  static constexpr double zeta_tol  = 1e-15;
  static constexpr double sigma_tol  = 4.641588833612789e-18;
  static constexpr double tau_tol = is_kedf ? 0.0 : 1e-20;

  static constexpr bool is_hyb  = false;
  static constexpr double exx_coeff = 0.0;



  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t11 = constants::m_cbrt_3;
    constexpr double t13 = constants::m_cbrt_one_ov_pi;
    constexpr double t15 = constants::m_cbrt_4;
    constexpr double t49 = constants::m_cbrt_2;
    constexpr double t70 = constants::m_pi_sq;
    constexpr double t14 = t11 * t13;
    constexpr double t16 = t15 * t15;
    constexpr double t28 = t11 * t11;
    constexpr double t29 = t13 * t13;
    constexpr double t30 = t28 * t29;
    constexpr double t71 = 0.1e1 / t70;
    constexpr double t83 = 0.1e1 / t13;
    constexpr double t84 = t83 * t15;
    constexpr double t103 = t49 * t49;
    constexpr double t107 = 0.1e1 / t29;
    constexpr double t108 = t11 * t107;
    constexpr double t109 = t108 * t16;
    constexpr double t130 = t14 * t16;
    constexpr double t143 = t30 * t15;
    constexpr double t220 = t16 * t49;


    const double t2 = sigma * sigma;
    const double t3 = rho * rho;
    const double t4 = 0.1e1 / t3;
    const double t5 = t2 * t4;
    const double t6 = tau * tau;
    const double t7 = 0.1e1 / t6;
    const double t10 = 0.1e1 + 0.828125e-2 * t5 * t7;
    const double t17 = safe_math::cbrt( rho );
    const double t18 = 0.1e1 / t17;
    const double t20 = t14 * t16 * t18;
    const double t22 = 0.1e1 + 0.53425e-1 * t20;
    const double t23 = safe_math::sqrt( t20 );
    const double t26 = pow_3_2( t20 );
    const double t31 = t17 * t17;
    const double t32 = 0.1e1 / t31;
    const double t34 = t30 * t15 * t32;
    const double t36 = 0.379785e1 * t23 + 0.8969e0 * t20 + 0.204775e0 * t26 + 0.123235e0 * t34;
    const double t39 = 0.1e1 + 0.16081979498692535067e2 / t36;
    const double t40 = safe_math::log( t39 );
    const double t42 = 0.621814e-1 * t22 * t40;
    const double t43 = 0.1e1 <= zeta_tol;
    const double t44 = safe_math::cbrt( zeta_tol );
    const double t45 = t44 * zeta_tol;
    const double t46 = piecewise_functor_3( t43, t45, 1.0 );
    const double t52 = 0.1e1 / ( 0.2e1 * t49 - 0.2e1 );
    const double t53 = ( 0.2e1 * t46 - 0.2e1 ) * t52;
    const double t55 = 0.1e1 + 0.278125e-1 * t20;
    const double t60 = 0.51785e1 * t23 + 0.905775e0 * t20 + 0.1100325e0 * t26 + 0.1241775e0 * t34;
    const double t63 = 0.1e1 + 0.29608749977793437516e2 / t60;
    const double t64 = safe_math::log( t63 );
    const double t67 = 0.19751673498613801407e-1 * t53 * t55 * t64;
    const double t68 = safe_math::log( 0.2e1 );
    const double t69 = 0.1e1 - t68;
    const double t72 = t69 * t71;
    const double t73 = t44 * t44;
    const double t74 = piecewise_functor_3( t43, t73, 1.0 );
    const double t75 = t74 * t74;
    const double t76 = t75 * t74;
    const double t78 = 0.1e1 / t17 / t3;
    const double t79 = sigma * t78;
    const double t81 = 0.1e1 / t75;
    const double t85 = t81 * t28 * t84;
    const double t88 = 0.1e1 / t69;
    const double t91 = 0.1e1 / t76;
    const double t92 = t70 * t91;
    const double t94 = safe_math::exp( -( -t42 + t67 ) * t88 * t92 );
    const double t95 = t94 - 0.1e1;
    const double t96 = 0.1e1 / t95;
    const double t97 = t88 * t96;
    const double t98 = t3 * t3;
    const double t100 = 0.1e1 / t31 / t98;
    const double t101 = t2 * t100;
    const double t104 = t75 * t75;
    const double t105 = 0.1e1 / t104;
    const double t106 = t103 * t105;
    const double t110 = t106 * t109;
    const double t113 = t79 * t49 * t85 / 0.96e2 + 0.21437009059034868486e-3 * t97 * t101 * t110;
    const double t114 = t113 * t88;
    const double t117 = 0.1e1 + 0.65854491829355115987e0 * t97 * t113;
    const double t118 = 0.1e1 / t117;
    const double t121 = 0.1e1 + 0.65854491829355115987e0 * t114 * t118;
    const double t122 = safe_math::log( t121 );
    const double t125 = t72 * t76 * t122 - t42 + t67;
    const double t126 = t10 * t125;
    const double t129 = rho / 0.2e1 <= dens_tol || t43;
    const double t133 = piecewise_functor_3( t43, 0.1e1 / t44, 1.0 );
    const double t135 = t130 * t18 * t49 * t133;
    const double t137 = 0.1e1 + 0.53425e-1 * t135;
    const double t138 = safe_math::sqrt( t135 );
    const double t141 = pow_3_2( t135 );
    const double t145 = t133 * t133;
    const double t147 = t143 * t32 * t103 * t145;
    const double t149 = 0.379785e1 * t138 + 0.8969e0 * t135 + 0.204775e0 * t141 + 0.123235e0 * t147;
    const double t152 = 0.1e1 + 0.16081979498692535067e2 / t149;
    const double t153 = safe_math::log( t152 );
    const double t155 = 0.621814e-1 * t137 * t153;
    const double t156 = 0.2e1 <= zeta_tol;
    const double t158 = piecewise_functor_3( t156, t45, 0.2e1 * t49 );
    const double t159 = 0.e0 <= zeta_tol;
    const double t160 = piecewise_functor_3( t159, t45, 0.0 );
    const double t162 = ( t158 + t160 - 0.2e1 ) * t52;
    const double t164 = 0.1e1 + 0.5137e-1 * t135;
    const double t169 = 0.705945e1 * t138 + 0.1549425e1 * t135 + 0.420775e0 * t141 + 0.1562925e0 * t147;
    const double t172 = 0.1e1 + 0.32163958997385070134e2 / t169;
    const double t173 = safe_math::log( t172 );
    const double t177 = 0.1e1 + 0.278125e-1 * t135;
    const double t182 = 0.51785e1 * t138 + 0.905775e0 * t135 + 0.1100325e0 * t141 + 0.1241775e0 * t147;
    const double t185 = 0.1e1 + 0.29608749977793437516e2 / t182;
    const double t186 = safe_math::log( t185 );
    const double t187 = t177 * t186;
    const double t190 = t162 * ( -0.310907e-1 * t164 * t173 + t155 - 0.19751673498613801407e-1 * t187 );
    const double t192 = 0.19751673498613801407e-1 * t162 * t187;
    const double t193 = piecewise_functor_3( t156, t73, t103 );
    const double t194 = piecewise_functor_3( t159, t73, 0.0 );
    const double t196 = t193 / 0.2e1 + t194 / 0.2e1;
    const double t197 = t196 * t196;
    const double t198 = t197 * t196;
    const double t199 = 0.1e1 / t197;
    const double t200 = t199 * t28;
    const double t204 = t84 * t103 / t133;
    const double t209 = 0.1e1 / t198;
    const double t210 = t70 * t209;
    const double t212 = safe_math::exp( -( -t155 + t190 + t192 ) * t88 * t210 );
    const double t213 = t212 - 0.1e1;
    const double t214 = 0.1e1 / t213;
    const double t215 = t88 * t214;
    const double t216 = t197 * t197;
    const double t217 = 0.1e1 / t216;
    const double t221 = 0.1e1 / t145;
    const double t222 = t220 * t221;
    const double t223 = t108 * t222;
    const double t226 = t79 * t200 * t204 / 0.96e2 + 0.42874018118069736972e-3 * t215 * t101 * t217 * t223;
    const double t227 = t226 * t88;
    const double t230 = 0.1e1 + 0.65854491829355115987e0 * t215 * t226;
    const double t231 = 0.1e1 / t230;
    const double t234 = 0.1e1 + 0.65854491829355115987e0 * t227 * t231;
    const double t235 = safe_math::log( t234 );
    const double t239 = piecewise_functor_3( t43, zeta_tol, 1.0 );
    const double t242 = piecewise_functor_3( t129, 0.0, ( t72 * t198 * t235 - t155 + t190 + t192 ) * t239 / 0.2e1 );
    const double t243 = t7 * t242;
    const double t245 = 0.478125e-1 * t5 * t243;


    eps = t126 - t245;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_unpolar_impl( double rho, double sigma, double lapl, double tau, double& eps, double& vrho, double& vsigma, double& vlapl, double& vtau ) {

    (void)(lapl);
    (void)(eps);
    constexpr double t11 = constants::m_cbrt_3;
    constexpr double t13 = constants::m_cbrt_one_ov_pi;
    constexpr double t15 = constants::m_cbrt_4;
    constexpr double t49 = constants::m_cbrt_2;
    constexpr double t70 = constants::m_pi_sq;
    constexpr double t14 = t11 * t13;
    constexpr double t16 = t15 * t15;
    constexpr double t28 = t11 * t11;
    constexpr double t29 = t13 * t13;
    constexpr double t30 = t28 * t29;
    constexpr double t71 = 0.1e1 / t70;
    constexpr double t83 = 0.1e1 / t13;
    constexpr double t84 = t83 * t15;
    constexpr double t103 = t49 * t49;
    constexpr double t107 = 0.1e1 / t29;
    constexpr double t108 = t11 * t107;
    constexpr double t109 = t108 * t16;
    constexpr double t130 = t14 * t16;
    constexpr double t143 = t30 * t15;
    constexpr double t220 = t16 * t49;
    constexpr double t263 = t13 * t16;
    constexpr double t445 = t107 * t16;
    constexpr double t446 = t445 * t49;
    constexpr double t498 = t28 * t83 * t15;


    const double t2 = sigma * sigma;
    const double t3 = rho * rho;
    const double t4 = 0.1e1 / t3;
    const double t5 = t2 * t4;
    const double t6 = tau * tau;
    const double t7 = 0.1e1 / t6;
    const double t10 = 0.1e1 + 0.828125e-2 * t5 * t7;
    const double t17 = safe_math::cbrt( rho );
    const double t18 = 0.1e1 / t17;
    const double t20 = t14 * t16 * t18;
    const double t22 = 0.1e1 + 0.53425e-1 * t20;
    const double t23 = safe_math::sqrt( t20 );
    const double t26 = pow_3_2( t20 );
    const double t31 = t17 * t17;
    const double t32 = 0.1e1 / t31;
    const double t34 = t30 * t15 * t32;
    const double t36 = 0.379785e1 * t23 + 0.8969e0 * t20 + 0.204775e0 * t26 + 0.123235e0 * t34;
    const double t39 = 0.1e1 + 0.16081979498692535067e2 / t36;
    const double t40 = safe_math::log( t39 );
    const double t42 = 0.621814e-1 * t22 * t40;
    const double t43 = 0.1e1 <= zeta_tol;
    const double t44 = safe_math::cbrt( zeta_tol );
    const double t45 = t44 * zeta_tol;
    const double t46 = piecewise_functor_3( t43, t45, 1.0 );
    const double t52 = 0.1e1 / ( 0.2e1 * t49 - 0.2e1 );
    const double t53 = ( 0.2e1 * t46 - 0.2e1 ) * t52;
    const double t55 = 0.1e1 + 0.278125e-1 * t20;
    const double t60 = 0.51785e1 * t23 + 0.905775e0 * t20 + 0.1100325e0 * t26 + 0.1241775e0 * t34;
    const double t63 = 0.1e1 + 0.29608749977793437516e2 / t60;
    const double t64 = safe_math::log( t63 );
    const double t67 = 0.19751673498613801407e-1 * t53 * t55 * t64;
    const double t68 = safe_math::log( 0.2e1 );
    const double t69 = 0.1e1 - t68;
    const double t72 = t69 * t71;
    const double t73 = t44 * t44;
    const double t74 = piecewise_functor_3( t43, t73, 1.0 );
    const double t75 = t74 * t74;
    const double t76 = t75 * t74;
    const double t78 = 0.1e1 / t17 / t3;
    const double t79 = sigma * t78;
    const double t81 = 0.1e1 / t75;
    const double t85 = t81 * t28 * t84;
    const double t88 = 0.1e1 / t69;
    const double t91 = 0.1e1 / t76;
    const double t92 = t70 * t91;
    const double t94 = safe_math::exp( -( -t42 + t67 ) * t88 * t92 );
    const double t95 = t94 - 0.1e1;
    const double t96 = 0.1e1 / t95;
    const double t97 = t88 * t96;
    const double t98 = t3 * t3;
    const double t100 = 0.1e1 / t31 / t98;
    const double t101 = t2 * t100;
    const double t104 = t75 * t75;
    const double t105 = 0.1e1 / t104;
    const double t106 = t103 * t105;
    const double t110 = t106 * t109;
    const double t113 = t79 * t49 * t85 / 0.96e2 + 0.21437009059034868486e-3 * t97 * t101 * t110;
    const double t114 = t113 * t88;
    const double t117 = 0.1e1 + 0.65854491829355115987e0 * t97 * t113;
    const double t118 = 0.1e1 / t117;
    const double t121 = 0.1e1 + 0.65854491829355115987e0 * t114 * t118;
    const double t122 = safe_math::log( t121 );
    const double t125 = t72 * t76 * t122 - t42 + t67;
    const double t126 = t10 * t125;
    const double t129 = rho / 0.2e1 <= dens_tol || t43;
    const double t133 = piecewise_functor_3( t43, 0.1e1 / t44, 1.0 );
    const double t135 = t130 * t18 * t49 * t133;
    const double t137 = 0.1e1 + 0.53425e-1 * t135;
    const double t138 = safe_math::sqrt( t135 );
    const double t141 = pow_3_2( t135 );
    const double t145 = t133 * t133;
    const double t147 = t143 * t32 * t103 * t145;
    const double t149 = 0.379785e1 * t138 + 0.8969e0 * t135 + 0.204775e0 * t141 + 0.123235e0 * t147;
    const double t152 = 0.1e1 + 0.16081979498692535067e2 / t149;
    const double t153 = safe_math::log( t152 );
    const double t155 = 0.621814e-1 * t137 * t153;
    const double t156 = 0.2e1 <= zeta_tol;
    const double t158 = piecewise_functor_3( t156, t45, 0.2e1 * t49 );
    const double t159 = 0.e0 <= zeta_tol;
    const double t160 = piecewise_functor_3( t159, t45, 0.0 );
    const double t162 = ( t158 + t160 - 0.2e1 ) * t52;
    const double t164 = 0.1e1 + 0.5137e-1 * t135;
    const double t169 = 0.705945e1 * t138 + 0.1549425e1 * t135 + 0.420775e0 * t141 + 0.1562925e0 * t147;
    const double t172 = 0.1e1 + 0.32163958997385070134e2 / t169;
    const double t173 = safe_math::log( t172 );
    const double t177 = 0.1e1 + 0.278125e-1 * t135;
    const double t182 = 0.51785e1 * t138 + 0.905775e0 * t135 + 0.1100325e0 * t141 + 0.1241775e0 * t147;
    const double t185 = 0.1e1 + 0.29608749977793437516e2 / t182;
    const double t186 = safe_math::log( t185 );
    const double t187 = t177 * t186;
    const double t190 = t162 * ( -0.310907e-1 * t164 * t173 + t155 - 0.19751673498613801407e-1 * t187 );
    const double t192 = 0.19751673498613801407e-1 * t162 * t187;
    const double t193 = piecewise_functor_3( t156, t73, t103 );
    const double t194 = piecewise_functor_3( t159, t73, 0.0 );
    const double t196 = t193 / 0.2e1 + t194 / 0.2e1;
    const double t197 = t196 * t196;
    const double t198 = t197 * t196;
    const double t199 = 0.1e1 / t197;
    const double t200 = t199 * t28;
    const double t204 = t84 * t103 / t133;
    const double t209 = 0.1e1 / t198;
    const double t210 = t70 * t209;
    const double t212 = safe_math::exp( -( -t155 + t190 + t192 ) * t88 * t210 );
    const double t213 = t212 - 0.1e1;
    const double t214 = 0.1e1 / t213;
    const double t215 = t88 * t214;
    const double t216 = t197 * t197;
    const double t217 = 0.1e1 / t216;
    const double t221 = 0.1e1 / t145;
    const double t222 = t220 * t221;
    const double t223 = t108 * t222;
    const double t226 = t79 * t200 * t204 / 0.96e2 + 0.42874018118069736972e-3 * t215 * t101 * t217 * t223;
    const double t227 = t226 * t88;
    const double t230 = 0.1e1 + 0.65854491829355115987e0 * t215 * t226;
    const double t231 = 0.1e1 / t230;
    const double t234 = 0.1e1 + 0.65854491829355115987e0 * t227 * t231;
    const double t235 = safe_math::log( t234 );
    const double t239 = piecewise_functor_3( t43, zeta_tol, 1.0 );
    const double t242 = piecewise_functor_3( t129, 0.0, ( t72 * t198 * t235 - t155 + t190 + t192 ) * t239 / 0.2e1 );
    const double t243 = t7 * t242;
    const double t245 = 0.478125e-1 * t5 * t243;
    const double t246 = t3 * rho;
    const double t247 = 0.1e1 / t246;
    const double t248 = t2 * t247;
    const double t249 = t7 * t125;
    const double t250 = t248 * t249;
    const double t253 = 0.1e1 / t17 / rho;
    const double t254 = t16 * t253;
    const double t257 = 0.11073470983333333333e-2 * t14 * t254 * t40;
    const double t258 = t36 * t36;
    const double t259 = 0.1e1 / t258;
    const double t260 = t22 * t259;
    const double t262 = 0.1e1 / t23 * t11;
    const double t264 = t263 * t253;
    const double t265 = t262 * t264;
    const double t267 = t14 * t254;
    const double t269 = safe_math::sqrt( t20 );
    const double t270 = t269 * t11;
    const double t271 = t270 * t264;
    const double t274 = 0.1e1 / t31 / rho;
    const double t276 = t30 * t15 * t274;
    const double t278 = -0.632975e0 * t265 - 0.29896666666666666667e0 * t267 - 0.1023875e0 * t271 - 0.82156666666666666667e-1 * t276;
    const double t279 = 0.1e1 / t39;
    const double t280 = t278 * t279;
    const double t282 = 0.1e1 * t260 * t280;
    const double t283 = t53 * t11;
    const double t287 = 0.18311447306006545054e-3 * t283 * t263 * t253 * t64;
    const double t288 = t53 * t55;
    const double t289 = t60 * t60;
    const double t290 = 0.1e1 / t289;
    const double t295 = -0.86308333333333333334e0 * t265 - 0.301925e0 * t267 - 0.5501625e-1 * t271 - 0.82785e-1 * t276;
    const double t297 = 0.1e1 / t63;
    const double t298 = t290 * t295 * t297;
    const double t300 = 0.5848223622634646207e0 * t288 * t298;
    const double t302 = 0.1e1 / t17 / t246;
    const double t303 = sigma * t302;
    const double t307 = t69 * t69;
    const double t308 = 0.1e1 / t307;
    const double t309 = t95 * t95;
    const double t310 = 0.1e1 / t309;
    const double t311 = t308 * t310;
    const double t312 = t311 * t2;
    const double t313 = t100 * t103;
    const double t315 = 0.1e1 / t104 / t76;
    const double t316 = t313 * t315;
    const double t317 = t312 * t316;
    const double t318 = t257 + t282 - t287 - t300;
    const double t319 = t318 * t70;
    const double t320 = t319 * t94;
    const double t321 = t109 * t320;
    const double t324 = t98 * rho;
    const double t326 = 0.1e1 / t31 / t324;
    const double t327 = t2 * t326;
    const double t331 = -0.7e1 / 0.288e3 * t303 * t49 * t85 + 0.21437009059034868486e-3 * t317 * t321 - 0.10003937560882938627e-2 * t97 * t327 * t110;
    const double t332 = t331 * t88;
    const double t335 = t117 * t117;
    const double t336 = 0.1e1 / t335;
    const double t337 = t311 * t113;
    const double t338 = t91 * t94;
    const double t339 = t319 * t338;
    const double t344 = 0.65854491829355115987e0 * t337 * t339 + 0.65854491829355115987e0 * t97 * t331;
    const double t345 = t336 * t344;
    const double t348 = 0.65854491829355115987e0 * t332 * t118 - 0.65854491829355115987e0 * t114 * t345;
    const double t350 = 0.1e1 / t121;
    const double t353 = t72 * t76 * t348 * t350 + t257 + t282 - t287 - t300;
    const double t354 = t10 * t353;
    const double t355 = t248 * t243;
    const double t357 = t253 * t49;
    const double t358 = t133 * t153;
    const double t361 = 0.11073470983333333333e-2 * t130 * t357 * t358;
    const double t362 = t149 * t149;
    const double t363 = 0.1e1 / t362;
    const double t364 = t137 * t363;
    const double t367 = 0.1e1 / t138 * t11 * t13;
    const double t368 = t49 * t133;
    const double t369 = t254 * t368;
    const double t370 = t367 * t369;
    const double t372 = t357 * t133;
    const double t373 = t130 * t372;
    const double t375 = safe_math::sqrt( t135 );
    const double t377 = t375 * t11 * t13;
    const double t378 = t377 * t369;
    const double t382 = t143 * t274 * t103 * t145;
    const double t384 = -0.632975e0 * t370 - 0.29896666666666666667e0 * t373 - 0.1023875e0 * t378 - 0.82156666666666666667e-1 * t382;
    const double t385 = 0.1e1 / t152;
    const double t386 = t384 * t385;
    const double t388 = 0.1e1 * t364 * t386;
    const double t389 = t133 * t173;
    const double t393 = t169 * t169;
    const double t394 = 0.1e1 / t393;
    const double t395 = t164 * t394;
    const double t400 = -0.1176575e1 * t370 - 0.516475e0 * t373 - 0.2103875e0 * t378 - 0.104195e0 * t382;
    const double t401 = 0.1e1 / t172;
    const double t402 = t400 * t401;
    const double t405 = t133 * t186;
    const double t409 = t182 * t182;
    const double t410 = 0.1e1 / t409;
    const double t411 = t177 * t410;
    const double t416 = -0.86308333333333333334e0 * t370 - 0.301925e0 * t373 - 0.5501625e-1 * t378 - 0.82785e-1 * t382;
    const double t417 = 0.1e1 / t185;
    const double t418 = t416 * t417;
    const double t422 = t162 * ( 0.53237641966666666666e-3 * t130 * t357 * t389 + 0.1e1 * t395 * t402 - t361 - t388 + 0.18311447306006545054e-3 * t130 * t357 * t405 + 0.5848223622634646207e0 * t411 * t418 );
    const double t423 = t162 * t14;
    const double t424 = t368 * t186;
    const double t427 = 0.18311447306006545054e-3 * t423 * t254 * t424;
    const double t428 = t162 * t177;
    const double t430 = t410 * t416 * t417;
    const double t432 = 0.5848223622634646207e0 * t428 * t430;
    const double t436 = t213 * t213;
    const double t437 = 0.1e1 / t436;
    const double t438 = t308 * t437;
    const double t439 = t438 * t2;
    const double t441 = 0.1e1 / t216 / t198;
    const double t442 = t100 * t441;
    const double t443 = t442 * t11;
    const double t444 = t439 * t443;
    const double t447 = t361 + t388 + t422 - t427 - t432;
    const double t449 = t70 * t212;
    const double t450 = t221 * t447 * t449;
    const double t451 = t446 * t450;
    const double t458 = -0.7e1 / 0.288e3 * t303 * t200 * t204 + 0.42874018118069736972e-3 * t444 * t451 - 0.20007875121765877254e-2 * t215 * t327 * t217 * t223;
    const double t459 = t458 * t88;
    const double t462 = t230 * t230;
    const double t463 = 0.1e1 / t462;
    const double t464 = t438 * t226;
    const double t465 = t447 * t70;
    const double t466 = t209 * t212;
    const double t467 = t465 * t466;
    const double t472 = 0.65854491829355115987e0 * t464 * t467 + 0.65854491829355115987e0 * t215 * t458;
    const double t473 = t463 * t472;
    const double t476 = 0.65854491829355115987e0 * t459 * t231 - 0.65854491829355115987e0 * t227 * t473;
    const double t478 = 0.1e1 / t234;
    const double t484 = piecewise_functor_3( t129, 0.0, ( t72 * t198 * t476 * t478 + t361 + t388 + t422 - t427 - t432 ) * t239 / 0.2e1 );
    const double t485 = t7 * t484;
    const double t486 = t5 * t485;
    const double t490 = sigma * t4;
    const double t492 = 0.165625e-1 * t490 * t249;
    const double t493 = t10 * t69;
    const double t494 = t493 * t71;
    const double t495 = t78 * t49;
    const double t501 = sigma * t100;
    const double t505 = t495 * t81 * t498 / 0.96e2 + 0.42874018118069736972e-3 * t97 * t501 * t110;
    const double t506 = t505 * t88;
    const double t509 = t113 * t308;
    const double t510 = t336 * t96;
    const double t511 = t510 * t505;
    const double t514 = 0.65854491829355115987e0 * t506 * t118 - 0.4336814094102599731e0 * t509 * t511;
    const double t515 = t76 * t514;
    const double t516 = t515 * t350;
    const double t517 = t494 * t516;
    const double t519 = 0.95625e-1 * t490 * t243;
    const double t520 = t72 * t198;
    const double t529 = t78 * t199 * t28 * t204 / 0.96e2 + 0.85748036236139473944e-3 * t215 * t501 * t217 * t223;
    const double t530 = t529 * t88;
    const double t533 = t226 * t308;
    const double t534 = t463 * t214;
    const double t535 = t534 * t529;
    const double t538 = 0.65854491829355115987e0 * t530 * t231 - 0.4336814094102599731e0 * t533 * t535;
    const double t543 = piecewise_functor_3( t129, 0.0, t520 * t538 * t478 * t239 / 0.2e1 );
    const double t544 = t7 * t543;
    const double t546 = 0.478125e-1 * t5 * t544;
    const double t549 = 0.1e1 / t6 / tau;
    const double t550 = t549 * t125;
    const double t552 = 0.165625e-1 * t5 * t550;
    const double t553 = t549 * t242;
    const double t555 = 0.95625e-1 * t5 * t553;


    eps = t126 - t245;
    vrho = t126 - t245 + rho * ( -0.165625e-1 * t250 + t354 + 0.95625e-1 * t355 - 0.478125e-1 * t486 );
    vsigma = rho * ( t492 + t517 - t519 - t546 );
    vlapl = 0.e0;
    vtau = rho * ( -t552 + t555 );

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps ) {

    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t46 = constants::m_cbrt_3;
    constexpr double t48 = constants::m_cbrt_one_ov_pi;
    constexpr double t50 = constants::m_cbrt_4;
    constexpr double t95 = constants::m_cbrt_2;
    constexpr double t133 = constants::m_pi_sq;
    constexpr double t49 = t46 * t48;
    constexpr double t51 = t50 * t50;
    constexpr double t63 = t46 * t46;
    constexpr double t64 = t48 * t48;
    constexpr double t65 = t63 * t64;
    constexpr double t134 = 0.1e1 / t133;
    constexpr double t153 = 0.1e1 / t48;
    constexpr double t154 = t153 * t50;
    constexpr double t173 = t95 * t95;
    constexpr double t177 = 0.1e1 / t64;
    constexpr double t178 = t46 * t177;
    constexpr double t179 = t178 * t51;
    constexpr double t204 = t49 * t51;
    constexpr double t218 = t65 * t50;


    const double t2 = rho_a * rho_a;
    const double t3 = safe_math::cbrt( rho_a );
    const double t4 = t3 * t3;
    const double t6 = 0.1e1 / t4 / t2;
    const double t7 = sigma_aa * t6;
    const double t8 = rho_a - rho_b;
    const double t9 = rho_a + rho_b;
    const double t10 = 0.1e1 / t9;
    const double t11 = t8 * t10;
    const double t12 = 0.1e1 + t11;
    const double t13 = t12 / 0.2e1;
    const double t14 = safe_math::cbrt( t13 );
    const double t15 = t14 * t14;
    const double t16 = t15 * t13;
    const double t18 = rho_b * rho_b;
    const double t19 = safe_math::cbrt( rho_b );
    const double t20 = t19 * t19;
    const double t22 = 0.1e1 / t20 / t18;
    const double t23 = sigma_bb * t22;
    const double t24 = 0.1e1 - t11;
    const double t25 = t24 / 0.2e1;
    const double t26 = safe_math::cbrt( t25 );
    const double t27 = t26 * t26;
    const double t28 = t27 * t25;
    const double t30 = t16 * t7 + t23 * t28;
    const double t31 = t30 * t30;
    const double t33 = 0.1e1 / t4 / rho_a;
    const double t34 = tau_a * t33;
    const double t37 = 0.1e1 / t20 / rho_b;
    const double t38 = tau_b * t37;
    const double t40 = t16 * t34 + t28 * t38;
    const double t41 = t40 * t40;
    const double t42 = 0.1e1 / t41;
    const double t45 = 0.1e1 + 0.828125e-2 * t31 * t42;
    const double t52 = safe_math::cbrt( t9 );
    const double t53 = 0.1e1 / t52;
    const double t54 = t51 * t53;
    const double t55 = t49 * t54;
    const double t57 = 0.1e1 + 0.53425e-1 * t55;
    const double t58 = safe_math::sqrt( t55 );
    const double t61 = pow_3_2( t55 );
    const double t66 = t52 * t52;
    const double t67 = 0.1e1 / t66;
    const double t68 = t50 * t67;
    const double t69 = t65 * t68;
    const double t71 = 0.379785e1 * t58 + 0.8969e0 * t55 + 0.204775e0 * t61 + 0.123235e0 * t69;
    const double t74 = 0.1e1 + 0.16081979498692535067e2 / t71;
    const double t75 = safe_math::log( t74 );
    const double t77 = 0.621814e-1 * t57 * t75;
    const double t78 = t8 * t8;
    const double t79 = t78 * t78;
    const double t80 = t9 * t9;
    const double t81 = t80 * t80;
    const double t82 = 0.1e1 / t81;
    const double t83 = t79 * t82;
    const double t84 = t12 <= zeta_tol;
    const double t85 = safe_math::cbrt( zeta_tol );
    const double t86 = t85 * zeta_tol;
    const double t87 = safe_math::cbrt( t12 );
    const double t88 = t87 * t12;
    const double t89 = piecewise_functor_3( t84, t86, t88 );
    const double t90 = t24 <= zeta_tol;
    const double t91 = safe_math::cbrt( t24 );
    const double t92 = t91 * t24;
    const double t93 = piecewise_functor_3( t90, t86, t92 );
    const double t94 = t89 + t93 - 0.2e1;
    const double t98 = 0.1e1 / ( 0.2e1 * t95 - 0.2e1 );
    const double t99 = t94 * t98;
    const double t101 = 0.1e1 + 0.5137e-1 * t55;
    const double t106 = 0.705945e1 * t58 + 0.1549425e1 * t55 + 0.420775e0 * t61 + 0.1562925e0 * t69;
    const double t109 = 0.1e1 + 0.32163958997385070134e2 / t106;
    const double t110 = safe_math::log( t109 );
    const double t114 = 0.1e1 + 0.278125e-1 * t55;
    const double t119 = 0.51785e1 * t58 + 0.905775e0 * t55 + 0.1100325e0 * t61 + 0.1241775e0 * t69;
    const double t122 = 0.1e1 + 0.29608749977793437516e2 / t119;
    const double t123 = safe_math::log( t122 );
    const double t124 = t114 * t123;
    const double t126 = -0.310907e-1 * t101 * t110 + t77 - 0.19751673498613801407e-1 * t124;
    const double t127 = t99 * t126;
    const double t128 = t83 * t127;
    const double t130 = 0.19751673498613801407e-1 * t99 * t124;
    const double t131 = safe_math::log( 0.2e1 );
    const double t132 = 0.1e1 - t131;
    const double t135 = t132 * t134;
    const double t136 = t85 * t85;
    const double t137 = t87 * t87;
    const double t138 = piecewise_functor_3( t84, t136, t137 );
    const double t139 = t91 * t91;
    const double t140 = piecewise_functor_3( t90, t136, t139 );
    const double t142 = t138 / 0.2e1 + t140 / 0.2e1;
    const double t143 = t142 * t142;
    const double t144 = t143 * t142;
    const double t146 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t148 = 0.1e1 / t52 / t80;
    const double t149 = t146 * t148;
    const double t151 = 0.1e1 / t143;
    const double t155 = t151 * t63 * t154;
    const double t158 = 0.1e1 / t132;
    const double t160 = ( -t77 + t128 + t130 ) * t158;
    const double t161 = 0.1e1 / t144;
    const double t162 = t133 * t161;
    const double t164 = safe_math::exp( -t160 * t162 );
    const double t165 = t164 - 0.1e1;
    const double t166 = 0.1e1 / t165;
    const double t167 = t158 * t166;
    const double t168 = t146 * t146;
    const double t170 = 0.1e1 / t66 / t81;
    const double t171 = t168 * t170;
    const double t174 = t143 * t143;
    const double t175 = 0.1e1 / t174;
    const double t176 = t173 * t175;
    const double t180 = t176 * t179;
    const double t183 = t149 * t95 * t155 / 0.96e2 + 0.21437009059034868486e-3 * t167 * t171 * t180;
    const double t184 = t183 * t158;
    const double t187 = 0.1e1 + 0.65854491829355115987e0 * t167 * t183;
    const double t188 = 0.1e1 / t187;
    const double t191 = 0.1e1 + 0.65854491829355115987e0 * t184 * t188;
    const double t192 = safe_math::log( t191 );
    const double t195 = t135 * t144 * t192 + t128 + t130 - t77;
    const double t196 = t45 * t195;
    const double t197 = sigma_aa * sigma_aa;
    const double t198 = 0.1e1 / t2;
    const double t199 = t197 * t198;
    const double t200 = tau_a * tau_a;
    const double t201 = 0.1e1 / t200;
    const double t203 = rho_a <= dens_tol || t84;
    const double t205 = t53 * t95;
    const double t206 = 0.1e1 / t85;
    const double t207 = 0.1e1 / t87;
    const double t208 = piecewise_functor_3( t84, t206, t207 );
    const double t210 = t204 * t205 * t208;
    const double t212 = 0.1e1 + 0.53425e-1 * t210;
    const double t213 = safe_math::sqrt( t210 );
    const double t216 = pow_3_2( t210 );
    const double t219 = t67 * t173;
    const double t220 = t208 * t208;
    const double t222 = t218 * t219 * t220;
    const double t224 = 0.379785e1 * t213 + 0.8969e0 * t210 + 0.204775e0 * t216 + 0.123235e0 * t222;
    const double t227 = 0.1e1 + 0.16081979498692535067e2 / t224;
    const double t228 = safe_math::log( t227 );
    const double t230 = 0.621814e-1 * t212 * t228;
    const double t231 = 0.2e1 <= zeta_tol;
    const double t233 = piecewise_functor_3( t231, t86, 0.2e1 * t95 );
    const double t234 = 0.e0 <= zeta_tol;
    const double t235 = piecewise_functor_3( t234, t86, 0.0 );
    const double t237 = ( t233 + t235 - 0.2e1 ) * t98;
    const double t239 = 0.1e1 + 0.5137e-1 * t210;
    const double t244 = 0.705945e1 * t213 + 0.1549425e1 * t210 + 0.420775e0 * t216 + 0.1562925e0 * t222;
    const double t247 = 0.1e1 + 0.32163958997385070134e2 / t244;
    const double t248 = safe_math::log( t247 );
    const double t252 = 0.1e1 + 0.278125e-1 * t210;
    const double t257 = 0.51785e1 * t213 + 0.905775e0 * t210 + 0.1100325e0 * t216 + 0.1241775e0 * t222;
    const double t260 = 0.1e1 + 0.29608749977793437516e2 / t257;
    const double t261 = safe_math::log( t260 );
    const double t262 = t252 * t261;
    const double t265 = t237 * ( -0.310907e-1 * t239 * t248 + t230 - 0.19751673498613801407e-1 * t262 );
    const double t267 = 0.19751673498613801407e-1 * t237 * t262;
    const double t268 = piecewise_functor_3( t231, t136, t173 );
    const double t269 = piecewise_functor_3( t234, t136, 0.0 );
    const double t271 = t268 / 0.2e1 + t269 / 0.2e1;
    const double t272 = t271 * t271;
    const double t273 = t272 * t271;
    const double t274 = 0.1e1 / t272;
    const double t275 = t274 * t63;
    const double t276 = t7 * t275;
    const double t277 = 0.1e1 / t208;
    const double t279 = t154 * t52 * t277;
    const double t284 = 0.1e1 / t273;
    const double t285 = t133 * t284;
    const double t287 = safe_math::exp( -( -t230 + t265 + t267 ) * t158 * t285 );
    const double t288 = t287 - 0.1e1;
    const double t289 = 0.1e1 / t288;
    const double t290 = t158 * t289;
    const double t291 = t2 * t2;
    const double t292 = t291 * rho_a;
    const double t294 = 0.1e1 / t3 / t292;
    const double t295 = t197 * t294;
    const double t296 = t272 * t272;
    const double t297 = 0.1e1 / t296;
    const double t299 = t290 * t295 * t297;
    const double t300 = t51 * t66;
    const double t301 = 0.1e1 / t220;
    const double t302 = t300 * t301;
    const double t303 = t178 * t302;
    const double t306 = t276 * t279 / 0.96e2 + 0.21437009059034868486e-3 * t299 * t303;
    const double t307 = t306 * t158;
    const double t310 = 0.1e1 + 0.65854491829355115987e0 * t290 * t306;
    const double t311 = 0.1e1 / t310;
    const double t314 = 0.1e1 + 0.65854491829355115987e0 * t307 * t311;
    const double t315 = safe_math::log( t314 );
    const double t318 = t135 * t273 * t315 - t230 + t265 + t267;
    const double t319 = piecewise_functor_3( t84, zeta_tol, t12 );
    const double t322 = piecewise_functor_3( t203, 0.0, t318 * t319 / 0.2e1 );
    const double t323 = t201 * t322;
    const double t325 = 0.2390625e-1 * t199 * t323;
    const double t326 = sigma_bb * sigma_bb;
    const double t327 = 0.1e1 / t18;
    const double t328 = t326 * t327;
    const double t329 = tau_b * tau_b;
    const double t330 = 0.1e1 / t329;
    const double t332 = rho_b <= dens_tol || t90;
    const double t333 = 0.1e1 / t91;
    const double t334 = piecewise_functor_3( t90, t206, t333 );
    const double t336 = t204 * t205 * t334;
    const double t338 = 0.1e1 + 0.53425e-1 * t336;
    const double t339 = safe_math::sqrt( t336 );
    const double t342 = pow_3_2( t336 );
    const double t344 = t334 * t334;
    const double t346 = t218 * t219 * t344;
    const double t348 = 0.379785e1 * t339 + 0.8969e0 * t336 + 0.204775e0 * t342 + 0.123235e0 * t346;
    const double t351 = 0.1e1 + 0.16081979498692535067e2 / t348;
    const double t352 = safe_math::log( t351 );
    const double t354 = 0.621814e-1 * t338 * t352;
    const double t356 = 0.1e1 + 0.5137e-1 * t336;
    const double t361 = 0.705945e1 * t339 + 0.1549425e1 * t336 + 0.420775e0 * t342 + 0.1562925e0 * t346;
    const double t364 = 0.1e1 + 0.32163958997385070134e2 / t361;
    const double t365 = safe_math::log( t364 );
    const double t369 = 0.1e1 + 0.278125e-1 * t336;
    const double t374 = 0.51785e1 * t339 + 0.905775e0 * t336 + 0.1100325e0 * t342 + 0.1241775e0 * t346;
    const double t377 = 0.1e1 + 0.29608749977793437516e2 / t374;
    const double t378 = safe_math::log( t377 );
    const double t379 = t369 * t378;
    const double t382 = t237 * ( -0.310907e-1 * t356 * t365 + t354 - 0.19751673498613801407e-1 * t379 );
    const double t384 = 0.19751673498613801407e-1 * t237 * t379;
    const double t385 = t23 * t275;
    const double t386 = 0.1e1 / t334;
    const double t388 = t154 * t52 * t386;
    const double t394 = safe_math::exp( -( -t354 + t382 + t384 ) * t158 * t285 );
    const double t395 = t394 - 0.1e1;
    const double t396 = 0.1e1 / t395;
    const double t397 = t158 * t396;
    const double t398 = t18 * t18;
    const double t399 = t398 * rho_b;
    const double t401 = 0.1e1 / t19 / t399;
    const double t402 = t326 * t401;
    const double t404 = t397 * t402 * t297;
    const double t405 = 0.1e1 / t344;
    const double t406 = t300 * t405;
    const double t407 = t178 * t406;
    const double t410 = t385 * t388 / 0.96e2 + 0.21437009059034868486e-3 * t404 * t407;
    const double t411 = t410 * t158;
    const double t414 = 0.1e1 + 0.65854491829355115987e0 * t397 * t410;
    const double t415 = 0.1e1 / t414;
    const double t418 = 0.1e1 + 0.65854491829355115987e0 * t411 * t415;
    const double t419 = safe_math::log( t418 );
    const double t422 = t135 * t273 * t419 - t354 + t382 + t384;
    const double t423 = piecewise_functor_3( t90, zeta_tol, t24 );
    const double t426 = piecewise_functor_3( t332, 0.0, t422 * t423 / 0.2e1 );
    const double t427 = t330 * t426;
    const double t429 = 0.2390625e-1 * t328 * t427;


    eps = t196 - t325 - t429;

  }

  BUILTIN_KERNEL_EVAL_RETURN
    eval_exc_vxc_polar_impl( double rho_a, double rho_b, double sigma_aa, double sigma_ab, double sigma_bb, double lapl_a, double lapl_b, double tau_a, double tau_b, double& eps, double& vrho_a, double& vrho_b, double& vsigma_aa, double& vsigma_ab, double& vsigma_bb, double& vlapl_a, double& vlapl_b, double& vtau_a, double& vtau_b ) {

    (void)(lapl_a);
    (void)(lapl_b);
    (void)(eps);
    constexpr double t46 = constants::m_cbrt_3;
    constexpr double t48 = constants::m_cbrt_one_ov_pi;
    constexpr double t50 = constants::m_cbrt_4;
    constexpr double t95 = constants::m_cbrt_2;
    constexpr double t133 = constants::m_pi_sq;
    constexpr double t49 = t46 * t48;
    constexpr double t51 = t50 * t50;
    constexpr double t63 = t46 * t46;
    constexpr double t64 = t48 * t48;
    constexpr double t65 = t63 * t64;
    constexpr double t134 = 0.1e1 / t133;
    constexpr double t153 = 0.1e1 / t48;
    constexpr double t154 = t153 * t50;
    constexpr double t173 = t95 * t95;
    constexpr double t177 = 0.1e1 / t64;
    constexpr double t178 = t46 * t177;
    constexpr double t179 = t178 * t51;
    constexpr double t204 = t49 * t51;
    constexpr double t218 = t65 * t50;
    constexpr double t475 = t48 * t51;
    constexpr double t581 = t63 * t153;
    constexpr double t616 = t177 * t51;
    constexpr double t1283 = t581 * t50;


    const double t2 = rho_a * rho_a;
    const double t3 = safe_math::cbrt( rho_a );
    const double t4 = t3 * t3;
    const double t6 = 0.1e1 / t4 / t2;
    const double t7 = sigma_aa * t6;
    const double t8 = rho_a - rho_b;
    const double t9 = rho_a + rho_b;
    const double t10 = 0.1e1 / t9;
    const double t11 = t8 * t10;
    const double t12 = 0.1e1 + t11;
    const double t13 = t12 / 0.2e1;
    const double t14 = safe_math::cbrt( t13 );
    const double t15 = t14 * t14;
    const double t16 = t15 * t13;
    const double t18 = rho_b * rho_b;
    const double t19 = safe_math::cbrt( rho_b );
    const double t20 = t19 * t19;
    const double t22 = 0.1e1 / t20 / t18;
    const double t23 = sigma_bb * t22;
    const double t24 = 0.1e1 - t11;
    const double t25 = t24 / 0.2e1;
    const double t26 = safe_math::cbrt( t25 );
    const double t27 = t26 * t26;
    const double t28 = t27 * t25;
    const double t30 = t16 * t7 + t23 * t28;
    const double t31 = t30 * t30;
    const double t33 = 0.1e1 / t4 / rho_a;
    const double t34 = tau_a * t33;
    const double t37 = 0.1e1 / t20 / rho_b;
    const double t38 = tau_b * t37;
    const double t40 = t16 * t34 + t28 * t38;
    const double t41 = t40 * t40;
    const double t42 = 0.1e1 / t41;
    const double t45 = 0.1e1 + 0.828125e-2 * t31 * t42;
    const double t52 = safe_math::cbrt( t9 );
    const double t53 = 0.1e1 / t52;
    const double t54 = t51 * t53;
    const double t55 = t49 * t54;
    const double t57 = 0.1e1 + 0.53425e-1 * t55;
    const double t58 = safe_math::sqrt( t55 );
    const double t61 = pow_3_2( t55 );
    const double t66 = t52 * t52;
    const double t67 = 0.1e1 / t66;
    const double t68 = t50 * t67;
    const double t69 = t65 * t68;
    const double t71 = 0.379785e1 * t58 + 0.8969e0 * t55 + 0.204775e0 * t61 + 0.123235e0 * t69;
    const double t74 = 0.1e1 + 0.16081979498692535067e2 / t71;
    const double t75 = safe_math::log( t74 );
    const double t77 = 0.621814e-1 * t57 * t75;
    const double t78 = t8 * t8;
    const double t79 = t78 * t78;
    const double t80 = t9 * t9;
    const double t81 = t80 * t80;
    const double t82 = 0.1e1 / t81;
    const double t83 = t79 * t82;
    const double t84 = t12 <= zeta_tol;
    const double t85 = safe_math::cbrt( zeta_tol );
    const double t86 = t85 * zeta_tol;
    const double t87 = safe_math::cbrt( t12 );
    const double t88 = t87 * t12;
    const double t89 = piecewise_functor_3( t84, t86, t88 );
    const double t90 = t24 <= zeta_tol;
    const double t91 = safe_math::cbrt( t24 );
    const double t92 = t91 * t24;
    const double t93 = piecewise_functor_3( t90, t86, t92 );
    const double t94 = t89 + t93 - 0.2e1;
    const double t98 = 0.1e1 / ( 0.2e1 * t95 - 0.2e1 );
    const double t99 = t94 * t98;
    const double t101 = 0.1e1 + 0.5137e-1 * t55;
    const double t106 = 0.705945e1 * t58 + 0.1549425e1 * t55 + 0.420775e0 * t61 + 0.1562925e0 * t69;
    const double t109 = 0.1e1 + 0.32163958997385070134e2 / t106;
    const double t110 = safe_math::log( t109 );
    const double t114 = 0.1e1 + 0.278125e-1 * t55;
    const double t119 = 0.51785e1 * t58 + 0.905775e0 * t55 + 0.1100325e0 * t61 + 0.1241775e0 * t69;
    const double t122 = 0.1e1 + 0.29608749977793437516e2 / t119;
    const double t123 = safe_math::log( t122 );
    const double t124 = t114 * t123;
    const double t126 = -0.310907e-1 * t101 * t110 + t77 - 0.19751673498613801407e-1 * t124;
    const double t127 = t99 * t126;
    const double t128 = t83 * t127;
    const double t130 = 0.19751673498613801407e-1 * t99 * t124;
    const double t131 = safe_math::log( 0.2e1 );
    const double t132 = 0.1e1 - t131;
    const double t135 = t132 * t134;
    const double t136 = t85 * t85;
    const double t137 = t87 * t87;
    const double t138 = piecewise_functor_3( t84, t136, t137 );
    const double t139 = t91 * t91;
    const double t140 = piecewise_functor_3( t90, t136, t139 );
    const double t142 = t138 / 0.2e1 + t140 / 0.2e1;
    const double t143 = t142 * t142;
    const double t144 = t143 * t142;
    const double t146 = sigma_aa + 0.2e1 * sigma_ab + sigma_bb;
    const double t148 = 0.1e1 / t52 / t80;
    const double t149 = t146 * t148;
    const double t151 = 0.1e1 / t143;
    const double t155 = t151 * t63 * t154;
    const double t158 = 0.1e1 / t132;
    const double t160 = ( -t77 + t128 + t130 ) * t158;
    const double t161 = 0.1e1 / t144;
    const double t162 = t133 * t161;
    const double t164 = safe_math::exp( -t160 * t162 );
    const double t165 = t164 - 0.1e1;
    const double t166 = 0.1e1 / t165;
    const double t167 = t158 * t166;
    const double t168 = t146 * t146;
    const double t170 = 0.1e1 / t66 / t81;
    const double t171 = t168 * t170;
    const double t174 = t143 * t143;
    const double t175 = 0.1e1 / t174;
    const double t176 = t173 * t175;
    const double t180 = t176 * t179;
    const double t183 = t149 * t95 * t155 / 0.96e2 + 0.21437009059034868486e-3 * t167 * t171 * t180;
    const double t184 = t183 * t158;
    const double t187 = 0.1e1 + 0.65854491829355115987e0 * t167 * t183;
    const double t188 = 0.1e1 / t187;
    const double t191 = 0.1e1 + 0.65854491829355115987e0 * t184 * t188;
    const double t192 = safe_math::log( t191 );
    const double t195 = t135 * t144 * t192 + t128 + t130 - t77;
    const double t196 = t45 * t195;
    const double t197 = sigma_aa * sigma_aa;
    const double t198 = 0.1e1 / t2;
    const double t199 = t197 * t198;
    const double t200 = tau_a * tau_a;
    const double t201 = 0.1e1 / t200;
    const double t203 = rho_a <= dens_tol || t84;
    const double t205 = t53 * t95;
    const double t206 = 0.1e1 / t85;
    const double t207 = 0.1e1 / t87;
    const double t208 = piecewise_functor_3( t84, t206, t207 );
    const double t210 = t204 * t205 * t208;
    const double t212 = 0.1e1 + 0.53425e-1 * t210;
    const double t213 = safe_math::sqrt( t210 );
    const double t216 = pow_3_2( t210 );
    const double t219 = t67 * t173;
    const double t220 = t208 * t208;
    const double t222 = t218 * t219 * t220;
    const double t224 = 0.379785e1 * t213 + 0.8969e0 * t210 + 0.204775e0 * t216 + 0.123235e0 * t222;
    const double t227 = 0.1e1 + 0.16081979498692535067e2 / t224;
    const double t228 = safe_math::log( t227 );
    const double t230 = 0.621814e-1 * t212 * t228;
    const double t231 = 0.2e1 <= zeta_tol;
    const double t233 = piecewise_functor_3( t231, t86, 0.2e1 * t95 );
    const double t234 = 0.e0 <= zeta_tol;
    const double t235 = piecewise_functor_3( t234, t86, 0.0 );
    const double t237 = ( t233 + t235 - 0.2e1 ) * t98;
    const double t239 = 0.1e1 + 0.5137e-1 * t210;
    const double t244 = 0.705945e1 * t213 + 0.1549425e1 * t210 + 0.420775e0 * t216 + 0.1562925e0 * t222;
    const double t247 = 0.1e1 + 0.32163958997385070134e2 / t244;
    const double t248 = safe_math::log( t247 );
    const double t252 = 0.1e1 + 0.278125e-1 * t210;
    const double t257 = 0.51785e1 * t213 + 0.905775e0 * t210 + 0.1100325e0 * t216 + 0.1241775e0 * t222;
    const double t260 = 0.1e1 + 0.29608749977793437516e2 / t257;
    const double t261 = safe_math::log( t260 );
    const double t262 = t252 * t261;
    const double t265 = t237 * ( -0.310907e-1 * t239 * t248 + t230 - 0.19751673498613801407e-1 * t262 );
    const double t267 = 0.19751673498613801407e-1 * t237 * t262;
    const double t268 = piecewise_functor_3( t231, t136, t173 );
    const double t269 = piecewise_functor_3( t234, t136, 0.0 );
    const double t271 = t268 / 0.2e1 + t269 / 0.2e1;
    const double t272 = t271 * t271;
    const double t273 = t272 * t271;
    const double t274 = 0.1e1 / t272;
    const double t275 = t274 * t63;
    const double t276 = t7 * t275;
    const double t277 = 0.1e1 / t208;
    const double t279 = t154 * t52 * t277;
    const double t284 = 0.1e1 / t273;
    const double t285 = t133 * t284;
    const double t287 = safe_math::exp( -( -t230 + t265 + t267 ) * t158 * t285 );
    const double t288 = t287 - 0.1e1;
    const double t289 = 0.1e1 / t288;
    const double t290 = t158 * t289;
    const double t291 = t2 * t2;
    const double t292 = t291 * rho_a;
    const double t294 = 0.1e1 / t3 / t292;
    const double t295 = t197 * t294;
    const double t296 = t272 * t272;
    const double t297 = 0.1e1 / t296;
    const double t299 = t290 * t295 * t297;
    const double t300 = t51 * t66;
    const double t301 = 0.1e1 / t220;
    const double t302 = t300 * t301;
    const double t303 = t178 * t302;
    const double t306 = t276 * t279 / 0.96e2 + 0.21437009059034868486e-3 * t299 * t303;
    const double t307 = t306 * t158;
    const double t310 = 0.1e1 + 0.65854491829355115987e0 * t290 * t306;
    const double t311 = 0.1e1 / t310;
    const double t314 = 0.1e1 + 0.65854491829355115987e0 * t307 * t311;
    const double t315 = safe_math::log( t314 );
    const double t318 = t135 * t273 * t315 - t230 + t265 + t267;
    const double t319 = piecewise_functor_3( t84, zeta_tol, t12 );
    const double t322 = piecewise_functor_3( t203, 0.0, t318 * t319 / 0.2e1 );
    const double t323 = t201 * t322;
    const double t325 = 0.2390625e-1 * t199 * t323;
    const double t326 = sigma_bb * sigma_bb;
    const double t327 = 0.1e1 / t18;
    const double t328 = t326 * t327;
    const double t329 = tau_b * tau_b;
    const double t330 = 0.1e1 / t329;
    const double t332 = rho_b <= dens_tol || t90;
    const double t333 = 0.1e1 / t91;
    const double t334 = piecewise_functor_3( t90, t206, t333 );
    const double t336 = t204 * t205 * t334;
    const double t338 = 0.1e1 + 0.53425e-1 * t336;
    const double t339 = safe_math::sqrt( t336 );
    const double t342 = pow_3_2( t336 );
    const double t344 = t334 * t334;
    const double t346 = t218 * t219 * t344;
    const double t348 = 0.379785e1 * t339 + 0.8969e0 * t336 + 0.204775e0 * t342 + 0.123235e0 * t346;
    const double t351 = 0.1e1 + 0.16081979498692535067e2 / t348;
    const double t352 = safe_math::log( t351 );
    const double t354 = 0.621814e-1 * t338 * t352;
    const double t356 = 0.1e1 + 0.5137e-1 * t336;
    const double t361 = 0.705945e1 * t339 + 0.1549425e1 * t336 + 0.420775e0 * t342 + 0.1562925e0 * t346;
    const double t364 = 0.1e1 + 0.32163958997385070134e2 / t361;
    const double t365 = safe_math::log( t364 );
    const double t369 = 0.1e1 + 0.278125e-1 * t336;
    const double t374 = 0.51785e1 * t339 + 0.905775e0 * t336 + 0.1100325e0 * t342 + 0.1241775e0 * t346;
    const double t377 = 0.1e1 + 0.29608749977793437516e2 / t374;
    const double t378 = safe_math::log( t377 );
    const double t379 = t369 * t378;
    const double t382 = t237 * ( -0.310907e-1 * t356 * t365 + t354 - 0.19751673498613801407e-1 * t379 );
    const double t384 = 0.19751673498613801407e-1 * t237 * t379;
    const double t385 = t23 * t275;
    const double t386 = 0.1e1 / t334;
    const double t388 = t154 * t52 * t386;
    const double t394 = safe_math::exp( -( -t354 + t382 + t384 ) * t158 * t285 );
    const double t395 = t394 - 0.1e1;
    const double t396 = 0.1e1 / t395;
    const double t397 = t158 * t396;
    const double t398 = t18 * t18;
    const double t399 = t398 * rho_b;
    const double t401 = 0.1e1 / t19 / t399;
    const double t402 = t326 * t401;
    const double t404 = t397 * t402 * t297;
    const double t405 = 0.1e1 / t344;
    const double t406 = t300 * t405;
    const double t407 = t178 * t406;
    const double t410 = t385 * t388 / 0.96e2 + 0.21437009059034868486e-3 * t404 * t407;
    const double t411 = t410 * t158;
    const double t414 = 0.1e1 + 0.65854491829355115987e0 * t397 * t410;
    const double t415 = 0.1e1 / t414;
    const double t418 = 0.1e1 + 0.65854491829355115987e0 * t411 * t415;
    const double t419 = safe_math::log( t418 );
    const double t422 = t135 * t273 * t419 - t354 + t382 + t384;
    const double t423 = piecewise_functor_3( t90, zeta_tol, t24 );
    const double t426 = piecewise_functor_3( t332, 0.0, t422 * t423 / 0.2e1 );
    const double t427 = t330 * t426;
    const double t429 = 0.2390625e-1 * t328 * t427;
    const double t430 = t30 * t42;
    const double t431 = t2 * rho_a;
    const double t433 = 0.1e1 / t4 / t431;
    const double t434 = sigma_aa * t433;
    const double t437 = 0.1e1 / t80;
    const double t438 = t8 * t437;
    const double t439 = t10 - t438;
    const double t440 = t439 / 0.2e1;
    const double t441 = t15 * t440;
    const double t444 = -t440;
    const double t445 = t27 * t444;
    const double t448 = -0.8e1 / 0.3e1 * t434 * t16 + 0.5e1 / 0.3e1 * t7 * t441 + 0.5e1 / 0.3e1 * t23 * t445;
    const double t452 = 0.1e1 / t41 / t40;
    const double t453 = t31 * t452;
    const double t454 = tau_a * t6;
    const double t459 = -0.5e1 / 0.3e1 * t454 * t16 + 0.5e1 / 0.3e1 * t34 * t441 + 0.5e1 / 0.3e1 * t38 * t445;
    const double t462 = 0.165625e-1 * t430 * t448 - 0.165625e-1 * t453 * t459;
    const double t463 = t462 * t195;
    const double t464 = t52 * t9;
    const double t465 = 0.1e1 / t464;
    const double t466 = t51 * t465;
    const double t469 = 0.11073470983333333333e-2 * t49 * t466 * t75;
    const double t470 = t71 * t71;
    const double t471 = 0.1e1 / t470;
    const double t472 = t57 * t471;
    const double t474 = 0.1e1 / t58 * t46;
    const double t476 = t475 * t465;
    const double t477 = t474 * t476;
    const double t479 = t49 * t466;
    const double t481 = safe_math::sqrt( t55 );
    const double t482 = t481 * t46;
    const double t483 = t482 * t476;
    const double t486 = 0.1e1 / t66 / t9;
    const double t487 = t50 * t486;
    const double t488 = t65 * t487;
    const double t490 = -0.632975e0 * t477 - 0.29896666666666666667e0 * t479 - 0.1023875e0 * t483 - 0.82156666666666666667e-1 * t488;
    const double t491 = 0.1e1 / t74;
    const double t492 = t490 * t491;
    const double t494 = 0.1e1 * t472 * t492;
    const double t495 = t78 * t8;
    const double t496 = t495 * t82;
    const double t498 = 0.4e1 * t496 * t127;
    const double t499 = t81 * t9;
    const double t500 = 0.1e1 / t499;
    const double t501 = t79 * t500;
    const double t503 = 0.4e1 * t501 * t127;
    const double t506 = piecewise_functor_3( t84, 0.0, 0.4e1 / 0.3e1 * t87 * t439 );
    const double t507 = -t439;
    const double t510 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t507 );
    const double t512 = ( t506 + t510 ) * t98;
    const double t513 = t512 * t126;
    const double t514 = t83 * t513;
    const double t518 = t106 * t106;
    const double t519 = 0.1e1 / t518;
    const double t520 = t101 * t519;
    const double t525 = -0.1176575e1 * t477 - 0.516475e0 * t479 - 0.2103875e0 * t483 - 0.104195e0 * t488;
    const double t526 = 0.1e1 / t109;
    const double t527 = t525 * t526;
    const double t533 = t119 * t119;
    const double t534 = 0.1e1 / t533;
    const double t535 = t114 * t534;
    const double t540 = -0.86308333333333333334e0 * t477 - 0.301925e0 * t479 - 0.5501625e-1 * t483 - 0.82785e-1 * t488;
    const double t541 = 0.1e1 / t122;
    const double t542 = t540 * t541;
    const double t545 = 0.53237641966666666666e-3 * t49 * t466 * t110 + 0.1e1 * t520 * t527 - t469 - t494 + 0.18311447306006545054e-3 * t49 * t466 * t123 + 0.5848223622634646207e0 * t535 * t542;
    const double t546 = t99 * t545;
    const double t547 = t83 * t546;
    const double t549 = 0.19751673498613801407e-1 * t512 * t124;
    const double t550 = t99 * t46;
    const double t552 = t475 * t465 * t123;
    const double t554 = 0.18311447306006545054e-3 * t550 * t552;
    const double t555 = t99 * t114;
    const double t557 = t534 * t540 * t541;
    const double t559 = 0.5848223622634646207e0 * t555 * t557;
    const double t560 = t143 * t192;
    const double t563 = piecewise_functor_3( t84, 0.0, 0.2e1 / 0.3e1 * t207 * t439 );
    const double t566 = piecewise_functor_3( t90, 0.0, 0.2e1 / 0.3e1 * t333 * t507 );
    const double t568 = t563 / 0.2e1 + t566 / 0.2e1;
    const double t572 = t80 * t9;
    const double t574 = 0.1e1 / t52 / t572;
    const double t575 = t146 * t574;
    const double t578 = 0.7e1 / 0.288e3 * t575 * t95 * t155;
    const double t579 = t95 * t161;
    const double t580 = t149 * t579;
    const double t582 = t50 * t568;
    const double t583 = t581 * t582;
    const double t586 = t165 * t165;
    const double t587 = 0.1e1 / t586;
    const double t588 = t158 * t587;
    const double t589 = t171 * t173;
    const double t590 = t588 * t589;
    const double t591 = t175 * t46;
    const double t592 = t591 * t177;
    const double t594 = ( t469 + t494 + t498 - t503 + t514 + t547 + t549 - t554 - t559 ) * t158;
    const double t596 = t133 * t175;
    const double t597 = t596 * t568;
    const double t600 = 0.3e1 * t160 * t597 - t162 * t594;
    const double t601 = t51 * t600;
    const double t603 = t592 * t601 * t164;
    const double t607 = 0.1e1 / t66 / t499;
    const double t608 = t168 * t607;
    const double t611 = 0.10003937560882938627e-2 * t167 * t608 * t180;
    const double t612 = t167 * t589;
    const double t614 = 0.1e1 / t174 / t142;
    const double t615 = t614 * t46;
    const double t617 = t616 * t568;
    const double t618 = t615 * t617;
    const double t621 = -t578 - t580 * t583 / 0.48e2 - 0.21437009059034868486e-3 * t590 * t603 - t611 - 0.85748036236139473944e-3 * t612 * t618;
    const double t622 = t621 * t158;
    const double t625 = t187 * t187;
    const double t626 = 0.1e1 / t625;
    const double t633 = -0.65854491829355115987e0 * t588 * t183 * t600 * t164 + 0.65854491829355115987e0 * t167 * t621;
    const double t634 = t626 * t633;
    const double t637 = 0.65854491829355115987e0 * t622 * t188 - 0.65854491829355115987e0 * t184 * t634;
    const double t639 = 0.1e1 / t191;
    const double t642 = t135 * t144 * t637 * t639 + 0.3e1 * t135 * t560 * t568 + t469 + t494 + t498 - t503 + t514 + t547 + t549 - t554 - t559;
    const double t643 = t45 * t642;
    const double t644 = 0.1e1 / t431;
    const double t645 = t197 * t644;
    const double t646 = t645 * t323;
    const double t647 = 0.478125e-1 * t646;
    const double t648 = t465 * t95;
    const double t650 = t204 * t648 * t208;
    const double t651 = 0.17808333333333333333e-1 * t650;
    const double t652 = 0.1e1 / t88;
    const double t653 = t652 * t439;
    const double t655 = piecewise_functor_3( t84, 0.0, -t653 / 0.3e1 );
    const double t657 = t204 * t205 * t655;
    const double t659 = -t651 + 0.53425e-1 * t657;
    const double t661 = 0.621814e-1 * t659 * t228;
    const double t662 = t224 * t224;
    const double t663 = 0.1e1 / t662;
    const double t664 = t212 * t663;
    const double t665 = 0.1e1 / t213;
    const double t666 = t650 / 0.3e1;
    const double t667 = -t666 + t657;
    const double t668 = t665 * t667;
    const double t670 = 0.29896666666666666667e0 * t650;
    const double t672 = safe_math::sqrt( t210 );
    const double t673 = t672 * t667;
    const double t675 = t486 * t173;
    const double t677 = t218 * t675 * t220;
    const double t678 = 0.82156666666666666667e-1 * t677;
    const double t679 = t208 * t655;
    const double t681 = t218 * t219 * t679;
    const double t683 = 0.1898925e1 * t668 - t670 + 0.8969e0 * t657 + 0.3071625e0 * t673 - t678 + 0.24647e0 * t681;
    const double t684 = 0.1e1 / t227;
    const double t685 = t683 * t684;
    const double t687 = 0.1e1 * t664 * t685;
    const double t688 = 0.17123333333333333333e-1 * t650;
    const double t690 = -t688 + 0.5137e-1 * t657;
    const double t693 = t244 * t244;
    const double t694 = 0.1e1 / t693;
    const double t695 = t239 * t694;
    const double t697 = 0.516475e0 * t650;
    const double t700 = 0.104195e0 * t677;
    const double t702 = 0.3529725e1 * t668 - t697 + 0.1549425e1 * t657 + 0.6311625e0 * t673 - t700 + 0.312585e0 * t681;
    const double t703 = 0.1e1 / t247;
    const double t704 = t702 * t703;
    const double t707 = 0.92708333333333333333e-2 * t650;
    const double t709 = -t707 + 0.278125e-1 * t657;
    const double t710 = t709 * t261;
    const double t712 = t257 * t257;
    const double t713 = 0.1e1 / t712;
    const double t714 = t252 * t713;
    const double t716 = 0.301925e0 * t650;
    const double t719 = 0.82785e-1 * t677;
    const double t721 = 0.258925e1 * t668 - t716 + 0.905775e0 * t657 + 0.16504875e0 * t673 - t719 + 0.248355e0 * t681;
    const double t722 = 0.1e1 / t260;
    const double t723 = t721 * t722;
    const double t727 = t237 * ( -0.310907e-1 * t690 * t248 + 0.1e1 * t695 * t704 + t661 - t687 - 0.19751673498613801407e-1 * t710 + 0.5848223622634646207e0 * t714 * t723 );
    const double t729 = 0.19751673498613801407e-1 * t237 * t710;
    const double t730 = t237 * t252;
    const double t732 = t713 * t721 * t722;
    const double t734 = 0.5848223622634646207e0 * t730 * t732;
    const double t735 = t434 * t275;
    const double t739 = t154 * t67 * t277;
    const double t741 = t276 * t739 / 0.288e3;
    const double t742 = t52 * t301;
    const double t744 = t154 * t742 * t655;
    const double t747 = t132 * t132;
    const double t748 = 0.1e1 / t747;
    const double t749 = t288 * t288;
    const double t750 = 0.1e1 / t749;
    const double t751 = t748 * t750;
    const double t752 = t751 * t197;
    const double t754 = 0.1e1 / t296 / t273;
    const double t755 = t294 * t754;
    const double t756 = t755 * t46;
    const double t757 = t752 * t756;
    const double t758 = t616 * t66;
    const double t759 = -t661 + t687 + t727 + t729 - t734;
    const double t761 = t133 * t287;
    const double t762 = t301 * t759 * t761;
    const double t763 = t758 * t762;
    const double t766 = t291 * t2;
    const double t768 = 0.1e1 / t3 / t766;
    const double t771 = t290 * t197 * t768 * t297;
    const double t774 = t54 * t301;
    const double t775 = t178 * t774;
    const double t777 = 0.14291339372689912324e-3 * t299 * t775;
    const double t778 = t220 * t208;
    const double t779 = 0.1e1 / t778;
    const double t780 = t66 * t779;
    const double t782 = t179 * t780 * t655;
    const double t785 = -t735 * t279 / 0.36e2 + t741 - t276 * t744 / 0.96e2 + 0.21437009059034868486e-3 * t757 * t763 - 0.11433071498151929859e-2 * t771 * t303 + t777 - 0.42874018118069736972e-3 * t299 * t782;
    const double t786 = t785 * t158;
    const double t789 = t310 * t310;
    const double t790 = 0.1e1 / t789;
    const double t791 = t751 * t306;
    const double t792 = t759 * t133;
    const double t793 = t284 * t287;
    const double t794 = t792 * t793;
    const double t799 = 0.65854491829355115987e0 * t791 * t794 + 0.65854491829355115987e0 * t290 * t785;
    const double t800 = t790 * t799;
    const double t803 = 0.65854491829355115987e0 * t786 * t311 - 0.65854491829355115987e0 * t307 * t800;
    const double t805 = 0.1e1 / t314;
    const double t808 = t135 * t273 * t803 * t805 - t661 + t687 + t727 + t729 - t734;
    const double t810 = piecewise_functor_3( t84, 0.0, t439 );
    const double t814 = piecewise_functor_3( t203, 0.0, t318 * t810 / 0.2e1 + t808 * t319 / 0.2e1 );
    const double t815 = t201 * t814;
    const double t816 = t199 * t815;
    const double t817 = 0.2390625e-1 * t816;
    const double t819 = t204 * t648 * t334;
    const double t820 = 0.17808333333333333333e-1 * t819;
    const double t821 = 0.1e1 / t92;
    const double t822 = t821 * t507;
    const double t824 = piecewise_functor_3( t90, 0.0, -t822 / 0.3e1 );
    const double t826 = t204 * t205 * t824;
    const double t828 = -t820 + 0.53425e-1 * t826;
    const double t830 = 0.621814e-1 * t828 * t352;
    const double t831 = t348 * t348;
    const double t832 = 0.1e1 / t831;
    const double t833 = t338 * t832;
    const double t834 = 0.1e1 / t339;
    const double t835 = t819 / 0.3e1;
    const double t836 = -t835 + t826;
    const double t837 = t834 * t836;
    const double t839 = 0.29896666666666666667e0 * t819;
    const double t841 = safe_math::sqrt( t336 );
    const double t842 = t841 * t836;
    const double t845 = t218 * t675 * t344;
    const double t846 = 0.82156666666666666667e-1 * t845;
    const double t847 = t334 * t824;
    const double t849 = t218 * t219 * t847;
    const double t851 = 0.1898925e1 * t837 - t839 + 0.8969e0 * t826 + 0.3071625e0 * t842 - t846 + 0.24647e0 * t849;
    const double t852 = 0.1e1 / t351;
    const double t853 = t851 * t852;
    const double t855 = 0.1e1 * t833 * t853;
    const double t856 = 0.17123333333333333333e-1 * t819;
    const double t858 = -t856 + 0.5137e-1 * t826;
    const double t861 = t361 * t361;
    const double t862 = 0.1e1 / t861;
    const double t863 = t356 * t862;
    const double t865 = 0.516475e0 * t819;
    const double t868 = 0.104195e0 * t845;
    const double t870 = 0.3529725e1 * t837 - t865 + 0.1549425e1 * t826 + 0.6311625e0 * t842 - t868 + 0.312585e0 * t849;
    const double t871 = 0.1e1 / t364;
    const double t872 = t870 * t871;
    const double t875 = 0.92708333333333333333e-2 * t819;
    const double t877 = -t875 + 0.278125e-1 * t826;
    const double t878 = t877 * t378;
    const double t880 = t374 * t374;
    const double t881 = 0.1e1 / t880;
    const double t882 = t369 * t881;
    const double t884 = 0.301925e0 * t819;
    const double t887 = 0.82785e-1 * t845;
    const double t889 = 0.258925e1 * t837 - t884 + 0.905775e0 * t826 + 0.16504875e0 * t842 - t887 + 0.248355e0 * t849;
    const double t890 = 0.1e1 / t377;
    const double t891 = t889 * t890;
    const double t895 = t237 * ( -0.310907e-1 * t858 * t365 + 0.1e1 * t863 * t872 + t830 - t855 - 0.19751673498613801407e-1 * t878 + 0.5848223622634646207e0 * t882 * t891 );
    const double t897 = 0.19751673498613801407e-1 * t237 * t878;
    const double t898 = t237 * t369;
    const double t900 = t881 * t889 * t890;
    const double t902 = 0.5848223622634646207e0 * t898 * t900;
    const double t904 = t154 * t67 * t386;
    const double t906 = t385 * t904 / 0.288e3;
    const double t907 = t52 * t405;
    const double t909 = t154 * t907 * t824;
    const double t912 = t395 * t395;
    const double t913 = 0.1e1 / t912;
    const double t914 = t748 * t913;
    const double t915 = t914 * t326;
    const double t916 = t401 * t754;
    const double t917 = t916 * t46;
    const double t918 = t915 * t917;
    const double t919 = -t830 + t855 + t895 + t897 - t902;
    const double t921 = t133 * t394;
    const double t922 = t405 * t919 * t921;
    const double t923 = t758 * t922;
    const double t926 = t54 * t405;
    const double t927 = t178 * t926;
    const double t929 = 0.14291339372689912324e-3 * t404 * t927;
    const double t930 = t344 * t334;
    const double t931 = 0.1e1 / t930;
    const double t932 = t66 * t931;
    const double t934 = t179 * t932 * t824;
    const double t937 = t906 - t385 * t909 / 0.96e2 + 0.21437009059034868486e-3 * t918 * t923 + t929 - 0.42874018118069736972e-3 * t404 * t934;
    const double t938 = t937 * t158;
    const double t941 = t414 * t414;
    const double t942 = 0.1e1 / t941;
    const double t943 = t914 * t410;
    const double t944 = t919 * t133;
    const double t945 = t284 * t394;
    const double t946 = t944 * t945;
    const double t951 = 0.65854491829355115987e0 * t943 * t946 + 0.65854491829355115987e0 * t397 * t937;
    const double t952 = t942 * t951;
    const double t955 = 0.65854491829355115987e0 * t938 * t415 - 0.65854491829355115987e0 * t411 * t952;
    const double t957 = 0.1e1 / t418;
    const double t960 = t135 * t273 * t955 * t957 - t830 + t855 + t895 + t897 - t902;
    const double t962 = piecewise_functor_3( t90, 0.0, t507 );
    const double t966 = piecewise_functor_3( t332, 0.0, t422 * t962 / 0.2e1 + t960 * t423 / 0.2e1 );
    const double t967 = t330 * t966;
    const double t968 = t328 * t967;
    const double t969 = 0.2390625e-1 * t968;
    const double t972 = -t10 - t438;
    const double t973 = t972 / 0.2e1;
    const double t974 = t15 * t973;
    const double t977 = t18 * rho_b;
    const double t979 = 0.1e1 / t20 / t977;
    const double t980 = sigma_bb * t979;
    const double t983 = -t973;
    const double t984 = t27 * t983;
    const double t987 = 0.5e1 / 0.3e1 * t7 * t974 - 0.8e1 / 0.3e1 * t980 * t28 + 0.5e1 / 0.3e1 * t23 * t984;
    const double t991 = tau_b * t22;
    const double t995 = -0.5e1 / 0.3e1 * t991 * t28 + 0.5e1 / 0.3e1 * t34 * t974 + 0.5e1 / 0.3e1 * t38 * t984;
    const double t998 = 0.165625e-1 * t430 * t987 - 0.165625e-1 * t453 * t995;
    const double t999 = t998 * t195;
    const double t1002 = piecewise_functor_3( t84, 0.0, 0.4e1 / 0.3e1 * t87 * t972 );
    const double t1003 = -t972;
    const double t1006 = piecewise_functor_3( t90, 0.0, 0.4e1 / 0.3e1 * t91 * t1003 );
    const double t1008 = ( t1002 + t1006 ) * t98;
    const double t1009 = t1008 * t126;
    const double t1010 = t83 * t1009;
    const double t1012 = 0.19751673498613801407e-1 * t1008 * t124;
    const double t1015 = piecewise_functor_3( t84, 0.0, 0.2e1 / 0.3e1 * t207 * t972 );
    const double t1018 = piecewise_functor_3( t90, 0.0, 0.2e1 / 0.3e1 * t333 * t1003 );
    const double t1020 = t1015 / 0.2e1 + t1018 / 0.2e1;
    const double t1024 = t50 * t1020;
    const double t1025 = t581 * t1024;
    const double t1029 = ( t469 + t494 - t498 - t503 + t1010 + t547 + t1012 - t554 - t559 ) * t158;
    const double t1031 = t596 * t1020;
    const double t1034 = -t1029 * t162 + 0.3e1 * t1031 * t160;
    const double t1035 = t51 * t1034;
    const double t1037 = t592 * t1035 * t164;
    const double t1040 = t616 * t1020;
    const double t1041 = t615 * t1040;
    const double t1044 = -t578 - t580 * t1025 / 0.48e2 - 0.21437009059034868486e-3 * t590 * t1037 - t611 - 0.85748036236139473944e-3 * t612 * t1041;
    const double t1045 = t1044 * t158;
    const double t1054 = -0.65854491829355115987e0 * t588 * t183 * t1034 * t164 + 0.65854491829355115987e0 * t167 * t1044;
    const double t1055 = t626 * t1054;
    const double t1058 = 0.65854491829355115987e0 * t1045 * t188 - 0.65854491829355115987e0 * t184 * t1055;
    const double t1062 = t1058 * t135 * t144 * t639 + 0.3e1 * t1020 * t135 * t560 + t1010 + t1012 + t469 + t494 - t498 - t503 + t547 - t554 - t559;
    const double t1063 = t45 * t1062;
    const double t1064 = t652 * t972;
    const double t1066 = piecewise_functor_3( t84, 0.0, -t1064 / 0.3e1 );
    const double t1068 = t204 * t205 * t1066;
    const double t1070 = -t651 + 0.53425e-1 * t1068;
    const double t1072 = 0.621814e-1 * t1070 * t228;
    const double t1073 = -t666 + t1068;
    const double t1074 = t665 * t1073;
    const double t1077 = t672 * t1073;
    const double t1079 = t208 * t1066;
    const double t1081 = t218 * t219 * t1079;
    const double t1083 = 0.1898925e1 * t1074 - t670 + 0.8969e0 * t1068 + 0.3071625e0 * t1077 - t678 + 0.24647e0 * t1081;
    const double t1084 = t1083 * t684;
    const double t1086 = 0.1e1 * t664 * t1084;
    const double t1088 = -t688 + 0.5137e-1 * t1068;
    const double t1095 = 0.3529725e1 * t1074 - t697 + 0.1549425e1 * t1068 + 0.6311625e0 * t1077 - t700 + 0.312585e0 * t1081;
    const double t1096 = t1095 * t703;
    const double t1100 = -t707 + 0.278125e-1 * t1068;
    const double t1101 = t1100 * t261;
    const double t1107 = 0.258925e1 * t1074 - t716 + 0.905775e0 * t1068 + 0.16504875e0 * t1077 - t719 + 0.248355e0 * t1081;
    const double t1108 = t1107 * t722;
    const double t1112 = t237 * ( -0.310907e-1 * t1088 * t248 + 0.1e1 * t695 * t1096 + t1072 - t1086 - 0.19751673498613801407e-1 * t1101 + 0.5848223622634646207e0 * t714 * t1108 );
    const double t1114 = 0.19751673498613801407e-1 * t237 * t1101;
    const double t1116 = t713 * t1107 * t722;
    const double t1118 = 0.5848223622634646207e0 * t730 * t1116;
    const double t1120 = t154 * t742 * t1066;
    const double t1123 = -t1072 + t1086 + t1112 + t1114 - t1118;
    const double t1124 = t301 * t1123;
    const double t1125 = t1124 * t761;
    const double t1126 = t758 * t1125;
    const double t1130 = t179 * t780 * t1066;
    const double t1133 = t741 - t276 * t1120 / 0.96e2 + 0.21437009059034868486e-3 * t757 * t1126 + t777 - 0.42874018118069736972e-3 * t299 * t1130;
    const double t1134 = t1133 * t158;
    const double t1137 = t1123 * t133;
    const double t1138 = t1137 * t793;
    const double t1143 = 0.65854491829355115987e0 * t791 * t1138 + 0.65854491829355115987e0 * t290 * t1133;
    const double t1144 = t790 * t1143;
    const double t1147 = 0.65854491829355115987e0 * t1134 * t311 - 0.65854491829355115987e0 * t307 * t1144;
    const double t1151 = t1147 * t135 * t273 * t805 - t1072 + t1086 + t1112 + t1114 - t1118;
    const double t1153 = piecewise_functor_3( t84, 0.0, t972 );
    const double t1157 = piecewise_functor_3( t203, 0.0, t1151 * t319 / 0.2e1 + t318 * t1153 / 0.2e1 );
    const double t1158 = t201 * t1157;
    const double t1159 = t199 * t1158;
    const double t1160 = 0.2390625e-1 * t1159;
    const double t1161 = 0.1e1 / t977;
    const double t1162 = t326 * t1161;
    const double t1163 = t1162 * t427;
    const double t1164 = 0.478125e-1 * t1163;
    const double t1165 = t821 * t1003;
    const double t1167 = piecewise_functor_3( t90, 0.0, -t1165 / 0.3e1 );
    const double t1169 = t204 * t205 * t1167;
    const double t1171 = -t820 + 0.53425e-1 * t1169;
    const double t1173 = 0.621814e-1 * t1171 * t352;
    const double t1174 = -t835 + t1169;
    const double t1175 = t834 * t1174;
    const double t1178 = t841 * t1174;
    const double t1180 = t334 * t1167;
    const double t1182 = t218 * t219 * t1180;
    const double t1184 = 0.1898925e1 * t1175 - t839 + 0.8969e0 * t1169 + 0.3071625e0 * t1178 - t846 + 0.24647e0 * t1182;
    const double t1185 = t1184 * t852;
    const double t1187 = 0.1e1 * t833 * t1185;
    const double t1189 = -t856 + 0.5137e-1 * t1169;
    const double t1196 = 0.3529725e1 * t1175 - t865 + 0.1549425e1 * t1169 + 0.6311625e0 * t1178 - t868 + 0.312585e0 * t1182;
    const double t1197 = t1196 * t871;
    const double t1201 = -t875 + 0.278125e-1 * t1169;
    const double t1202 = t1201 * t378;
    const double t1208 = 0.258925e1 * t1175 - t884 + 0.905775e0 * t1169 + 0.16504875e0 * t1178 - t887 + 0.248355e0 * t1182;
    const double t1209 = t1208 * t890;
    const double t1213 = t237 * ( -0.310907e-1 * t1189 * t365 + 0.1e1 * t863 * t1197 + t1173 - t1187 - 0.19751673498613801407e-1 * t1202 + 0.5848223622634646207e0 * t882 * t1209 );
    const double t1215 = 0.19751673498613801407e-1 * t237 * t1202;
    const double t1217 = t881 * t1208 * t890;
    const double t1219 = 0.5848223622634646207e0 * t898 * t1217;
    const double t1220 = t980 * t275;
    const double t1224 = t154 * t907 * t1167;
    const double t1227 = -t1173 + t1187 + t1213 + t1215 - t1219;
    const double t1228 = t405 * t1227;
    const double t1229 = t1228 * t921;
    const double t1230 = t758 * t1229;
    const double t1233 = t398 * t18;
    const double t1235 = 0.1e1 / t19 / t1233;
    const double t1238 = t397 * t326 * t1235 * t297;
    const double t1242 = t179 * t932 * t1167;
    const double t1245 = -t1220 * t388 / 0.36e2 + t906 - t385 * t1224 / 0.96e2 + 0.21437009059034868486e-3 * t918 * t1230 - 0.11433071498151929859e-2 * t1238 * t407 + t929 - 0.42874018118069736972e-3 * t404 * t1242;
    const double t1246 = t1245 * t158;
    const double t1249 = t1227 * t133;
    const double t1250 = t1249 * t945;
    const double t1255 = 0.65854491829355115987e0 * t943 * t1250 + 0.65854491829355115987e0 * t397 * t1245;
    const double t1256 = t942 * t1255;
    const double t1259 = 0.65854491829355115987e0 * t1246 * t415 - 0.65854491829355115987e0 * t411 * t1256;
    const double t1263 = t1259 * t135 * t273 * t957 - t1173 + t1187 + t1213 + t1215 - t1219;
    const double t1265 = piecewise_functor_3( t90, 0.0, t1003 );
    const double t1269 = piecewise_functor_3( t332, 0.0, t1263 * t423 / 0.2e1 + t422 * t1265 / 0.2e1 );
    const double t1270 = t330 * t1269;
    const double t1271 = t328 * t1270;
    const double t1272 = 0.2390625e-1 * t1271;
    const double t1275 = t6 * t16;
    const double t1276 = t1275 * t195;
    const double t1278 = 0.165625e-1 * t430 * t1276;
    const double t1279 = t45 * t132;
    const double t1280 = t1279 * t134;
    const double t1281 = t148 * t95;
    const double t1284 = t1281 * t151 * t1283;
    const double t1286 = t146 * t170;
    const double t1288 = t167 * t1286 * t180;
    const double t1290 = t1284 / 0.96e2 + 0.42874018118069736972e-3 * t1288;
    const double t1291 = t1290 * t158;
    const double t1294 = t183 * t748;
    const double t1295 = t626 * t166;
    const double t1296 = t1295 * t1290;
    const double t1299 = 0.65854491829355115987e0 * t1291 * t188 - 0.4336814094102599731e0 * t1294 * t1296;
    const double t1300 = t144 * t1299;
    const double t1301 = t1300 * t639;
    const double t1302 = t1280 * t1301;
    const double t1303 = sigma_aa * t198;
    const double t1305 = 0.478125e-1 * t1303 * t323;
    const double t1306 = t135 * t273;
    const double t1307 = t6 * t274;
    const double t1308 = t1307 * t63;
    const double t1313 = t290 * sigma_aa * t294 * t297;
    const double t1316 = t1308 * t279 / 0.96e2 + 0.42874018118069736972e-3 * t1313 * t303;
    const double t1317 = t1316 * t158;
    const double t1320 = t306 * t748;
    const double t1321 = t790 * t289;
    const double t1322 = t1321 * t1316;
    const double t1325 = 0.65854491829355115987e0 * t1317 * t311 - 0.4336814094102599731e0 * t1320 * t1322;
    const double t1326 = t1325 * t805;
    const double t1330 = piecewise_functor_3( t203, 0.0, t1306 * t1326 * t319 / 0.2e1 );
    const double t1331 = t201 * t1330;
    const double t1333 = 0.2390625e-1 * t199 * t1331;
    const double t1335 = t9 * t45;
    const double t1336 = t1335 * t132;
    const double t1337 = t134 * t144;
    const double t1340 = t1284 / 0.48e2 + 0.85748036236139473944e-3 * t1288;
    const double t1341 = t1340 * t158;
    const double t1344 = t1295 * t1340;
    const double t1347 = 0.65854491829355115987e0 * t1341 * t188 - 0.4336814094102599731e0 * t1294 * t1344;
    const double t1348 = t1347 * t639;
    const double t1349 = t1337 * t1348;
    const double t1350 = t22 * t28;
    const double t1351 = t1350 * t195;
    const double t1353 = 0.165625e-1 * t430 * t1351;
    const double t1354 = sigma_bb * t327;
    const double t1356 = 0.478125e-1 * t1354 * t427;
    const double t1357 = t22 * t274;
    const double t1358 = t1357 * t63;
    const double t1363 = t397 * sigma_bb * t401 * t297;
    const double t1366 = t1358 * t388 / 0.96e2 + 0.42874018118069736972e-3 * t1363 * t407;
    const double t1367 = t1366 * t158;
    const double t1370 = t410 * t748;
    const double t1371 = t942 * t396;
    const double t1372 = t1371 * t1366;
    const double t1375 = 0.65854491829355115987e0 * t1367 * t415 - 0.4336814094102599731e0 * t1370 * t1372;
    const double t1376 = t1375 * t957;
    const double t1380 = piecewise_functor_3( t332, 0.0, t1306 * t1376 * t423 / 0.2e1 );
    const double t1381 = t330 * t1380;
    const double t1383 = 0.2390625e-1 * t328 * t1381;
    const double t1385 = t33 * t16;
    const double t1386 = t1385 * t195;
    const double t1388 = 0.165625e-1 * t453 * t1386;
    const double t1390 = 0.1e1 / t200 / tau_a;
    const double t1391 = t1390 * t322;
    const double t1393 = 0.478125e-1 * t199 * t1391;
    const double t1395 = t37 * t28;
    const double t1396 = t1395 * t195;
    const double t1398 = 0.165625e-1 * t453 * t1396;
    const double t1400 = 0.1e1 / t329 / tau_b;
    const double t1401 = t1400 * t426;
    const double t1403 = 0.478125e-1 * t328 * t1401;


    eps = t196 - t325 - t429;
    vrho_a = t196 - t325 - t429 + t9 * ( t463 + t643 + t647 - t817 - t969 );
    vrho_b = t196 - t325 - t429 + t9 * ( t999 + t1063 - t1160 + t1164 - t1272 );
    vsigma_aa = t9 * ( t1278 + t1302 - t1305 - t1333 );
    vsigma_ab = t1336 * t1349;
    vsigma_bb = t9 * ( t1353 + t1302 - t1356 - t1383 );
    vlapl_a = 0.e0;
    vlapl_b = 0.e0;
    vtau_a = t9 * ( -t1388 + t1393 );
    vtau_b = t9 * ( -t1398 + t1403 );

  }


};

struct BuiltinPKZB_C : detail::BuiltinKernelImpl< BuiltinPKZB_C > {

  BuiltinPKZB_C( Spin p ) :
    detail::BuiltinKernelImpl< BuiltinPKZB_C >(p) { }
  
  virtual ~BuiltinPKZB_C() = default;

};



} // namespace ExchCXX